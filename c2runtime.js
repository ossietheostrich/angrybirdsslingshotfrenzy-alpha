// Generated by Construct 3, the game and app creator :: https://www.construct.net
'use strict';var cr=window.cr={};cr.plugins_={};cr.behaviors={};"function"!==typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===typeof"test".__proto__?function(b){return b.__proto__}:function(b){return b.constructor.prototype});
(function(){function b(m,E){this.x=m;this.y=E;cr.seal(this)}function f(m,E,L,N){this.set(m,E,L,N);cr.seal(this)}function g(){this.bly=this.blx=this.bry=this.brx=this.try_=this.trx=this.tly=this.tlx=0;cr.seal(this)}function n(m,E,L,N){m<E?L<N?(x=m<L?m:L,A=E>N?E:N):(x=m<N?m:N,A=E>L?E:L):L<N?(x=E<L?E:L,A=m>N?m:N):(x=E<N?E:N,A=m>L?m:L)}function t(){this.items=this.s=null;this.item_count=0;z&&(this.s=new Set);this.values_cache=[];this.cache_valid=!0;cr.seal(this)}function e(m){O[Q++]=m}function c(){this.sum=
this.t=this.y=this.c=0;cr.seal(this)}function a(m,E){m||(m=[0,0,1,0,1,1,0,1]);this.pts_cache=[];this.bboxBottom=this.bboxRight=this.bboxTop=this.bboxLeft=0;this.convexpolys=null;this.enabled="undefined"===typeof E?!0:E;this.set_pts(m);cr.seal(this)}function d(m,E){this.cellwidth=m;this.cellheight=E;this.cells={}}function h(m,E){this.cellwidth=m;this.cellheight=E;this.cells={}}function u(m,E,L){d.prototype.totalCellCount++;if(k.length){var N=k.pop();N.grid=m;N.x=E;N.y=L;return N}return new cr.GridCell(m,
E,L)}function v(m,E,L){this.grid=m;this.x=E;this.y=L;this.objects=new cr.ObjectSet}function C(m,E,L){h.prototype.totalCellCount++;if(p.length){var N=p.pop();N.grid=m;N.x=E;N.y=L;return N}return new cr.RenderCell(m,E,L)}function w(m,E,L){this.grid=m;this.x=E;this.y=L;this.objects=[];this.is_sorted=!0;this.pending_removal=new cr.ObjectSet;this.any_pending_removal=!1}function r(m,E){return m.zindex-E.zindex}cr.logexport=function(m){window.console&&window.console.log&&window.console.log(m)};cr.logerror=
function(m){window.console&&window.console.error&&window.console.error(m)};cr.seal=function(m){return m};cr.freeze=function(m){return m};cr.is_undefined=function(m){return"undefined"===typeof m};cr.is_number=function(m){return"number"===typeof m};cr.is_string=function(m){return"string"===typeof m};cr.isPOT=function(m){return 0<m&&0===(m-1&m)};cr.nextHighestPowerOfTwo=function(m){--m;for(var E=1;32>E;E<<=1)m|=m>>E;return m+1};cr.abs=function(m){return 0>m?-m:m};cr.max=function(m,E){return m>E?m:E};
cr.min=function(m,E){return m<E?m:E};cr.PI=Math.PI;cr.round=function(m){return m+.5|0};cr.floor=function(m){return 0<=m?m|0:(m|0)-1};cr.ceil=function(m){var E=m|0;return E===m?E:E+1};b.prototype.offset=function(m,E){this.x+=m;this.y+=E;return this};b.prototype.mul=function(m,E){this.x*=m;this.y*=E;return this};cr.vector2=b;cr.segments_intersect=function(m,E,L,N,V,W,X,Y){if(m<L){var ea=m;var ha=L}else ea=L,ha=m;if(V<X){var q=V;var B=X}else q=X,B=V;if(ha<q||ea>B)return!1;E<N?(ea=E,ha=N):(ea=N,ha=E);
W<Y?(q=W,B=Y):(q=Y,B=W);if(ha<q||ea>B)return!1;ha=V-m+X-L;ea=W-E+Y-N;m=L-m;E=N-E;V=X-V;W=Y-W;Y=cr.abs(E*V-W*m);return cr.abs(V*ea-W*ha)>Y?!1:cr.abs(m*ea-E*ha)<=Y};f.prototype.set=function(m,E,L,N){this.left=m;this.top=E;this.right=L;this.bottom=N};f.prototype.copy=function(m){this.left=m.left;this.top=m.top;this.right=m.right;this.bottom=m.bottom};f.prototype.width=function(){return this.right-this.left};f.prototype.height=function(){return this.bottom-this.top};f.prototype.offset=function(m,E){this.left+=
m;this.top+=E;this.right+=m;this.bottom+=E;return this};f.prototype.normalize=function(){if(this.left>this.right){var m=this.left;this.left=this.right;this.right=m}this.top>this.bottom&&(m=this.top,this.top=this.bottom,this.bottom=m)};f.prototype.intersects_rect=function(m){return!(m.right<this.left||m.bottom<this.top||m.left>this.right||m.top>this.bottom)};f.prototype.intersects_rect_off=function(m,E,L){return!(m.right+E<this.left||m.bottom+L<this.top||m.left+E>this.right||m.top+L>this.bottom)};
f.prototype.contains_pt=function(m,E){return m>=this.left&&m<=this.right&&E>=this.top&&E<=this.bottom};f.prototype.equals=function(m){return this.left===m.left&&this.top===m.top&&this.right===m.right&&this.bottom===m.bottom};cr.rect=f;g.prototype.set_from_rect=function(m){this.tlx=m.left;this.tly=m.top;this.trx=m.right;this.try_=m.top;this.brx=m.right;this.bry=m.bottom;this.blx=m.left;this.bly=m.bottom};g.prototype.set_from_rotated_rect=function(m,E){if(0===E)this.set_from_rect(m);else{var L=Math.sin(E),
N=Math.cos(E);E=m.left*L;var V=m.top*L,W=m.right*L;L*=m.bottom;var X=m.left*N,Y=m.top*N,ea=m.right*N;m=m.bottom*N;this.tlx=X-V;this.tly=Y+E;this.trx=ea-V;this.try_=Y+W;this.brx=ea-L;this.bry=m+W;this.blx=X-L;this.bly=m+E}};g.prototype.offset=function(m,E){this.tlx+=m;this.tly+=E;this.trx+=m;this.try_+=E;this.brx+=m;this.bry+=E;this.blx+=m;this.bly+=E;return this};var x=0,A=0;g.prototype.bounding_box=function(m){n(this.tlx,this.trx,this.brx,this.blx);m.left=x;m.right=A;n(this.tly,this.try_,this.bry,
this.bly);m.top=x;m.bottom=A};g.prototype.contains_pt=function(m,E){var L=this.tlx,N=this.tly,V=this.trx-L,W=this.try_-N,X=this.brx-L,Y=this.bry-N;m-=L;E-=N;var ea=V*V+W*W,ha=V*X+W*Y;W=V*m+W*E;var q=X*X+Y*Y,B=X*m+Y*E,G=1/(ea*q-ha*ha);V=(q*W-ha*B)*G;ea=(ea*B-ha*W)*G;if(0<=V&&0<ea&&1>V+ea)return!0;V=this.blx-L;W=this.bly-N;ea=V*V+W*W;ha=V*X+W*Y;W=V*m+W*E;G=1/(ea*q-ha*ha);V=(q*W-ha*B)*G;ea=(ea*B-ha*W)*G;return 0<=V&&0<ea&&1>V+ea};g.prototype.at=function(m,E){if(E)switch(m){case 0:return this.tlx;case 1:return this.trx;
case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(m){case 0:return this.tly;case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}};g.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4};g.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4};g.prototype.intersects_segment=function(m,E,L,N){if(this.contains_pt(m,E)||this.contains_pt(L,N))return!0;
var V;for(V=0;4>V;V++){var W=this.at(V,!0);var X=this.at(V,!1);var Y=this.at(V+1,!0);var ea=this.at(V+1,!1);if(cr.segments_intersect(m,E,L,N,W,X,Y,ea))return!0}return!1};g.prototype.intersects_quad=function(m){var E=m.midX(),L=m.midY();if(this.contains_pt(E,L))return!0;E=this.midX();L=this.midY();if(m.contains_pt(E,L))return!0;var N,V;for(N=0;4>N;N++)for(V=0;4>V;V++){E=this.at(N,!0);L=this.at(N,!1);var W=this.at(N+1,!0);var X=this.at(N+1,!1);var Y=m.at(V,!0);var ea=m.at(V,!1);var ha=m.at(V+1,!0);
var q=m.at(V+1,!1);if(cr.segments_intersect(E,L,W,X,Y,ea,ha,q))return!0}return!1};cr.quad=g;cr.RGB=function(m,E,L){return Math.max(Math.min(m,255),0)|Math.max(Math.min(E,255),0)<<8|Math.max(Math.min(L,255),0)<<16};cr.RGBAEx=function(m,E,L,N){m=cr.clamp(Math.floor(1024*m),-8192,8191);E=cr.clamp(Math.floor(1024*E),-8192,8191);L=cr.clamp(Math.floor(1024*L),-8192,8191);N=cr.clamp(Math.floor(1024*N),0,1024);0>m&&(m+=16384);0>E&&(E+=16384);0>L&&(L+=16384);return-(274877906944*m+16777216*E+1024*L+N)};cr.RGBEx=
function(m,E,L){return cr.RGBAEx(m,E,L,1)};cr.GetRValue=function(m){if(0<=m)return(m&255)/255;m=Math.floor(-m/274877906944);8191<m&&(m-=16384);return m/1024};cr.GetGValue=function(m){if(0<=m)return((m&65280)>>8)/255;m=Math.floor(-m%274877906944/16777216);8191<m&&(m-=16384);return m/1024};cr.GetBValue=function(m){if(0<=m)return((m&16711680)>>16)/255;m=Math.floor(-m%16777216/1024);8191<m&&(m-=16384);return m/1024};cr.GetAValue=function(m){return 0===m&&0>1/m?0:0<=m?1:Math.floor(-m%1024)/1024};cr.shallowCopy=
function(m,E,L){for(var N in E)E.hasOwnProperty(N)&&(m[N]=E[N]);return m};cr.arrayRemove=function(m,E){var L;E=cr.floor(E);if(!(0>E||E>=m.length)){for(L=m.length-1;E<L;E++)m[E]=m[E+1];cr.truncateArray(m,L)}};cr.truncateArray=function(m,E){m.length=E};cr.clearArray=function(m){cr.truncateArray(m,0)};cr.shallowAssignArray=function(m,E){cr.clearArray(m);var L;var N=0;for(L=E.length;N<L;++N)m[N]=E[N]};cr.appendArray=function(m,E){m.push.apply(m,E)};cr.fastIndexOf=function(m,E){var L;var N=0;for(L=m.length;N<
L;++N)if(m[N]===E)return N;return-1};cr.arrayFindRemove=function(m,E){E=cr.fastIndexOf(m,E);-1!==E&&cr.arrayRemove(m,E)};cr.clamp=function(m,E,L){return m<E?E:m>L?L:m};cr.to_radians=function(m){return m/(180/cr.PI)};cr.to_degrees=function(m){return 180/cr.PI*m};cr.clamp_angle_degrees=function(m){m%=360;0>m&&(m+=360);return m};cr.clamp_angle=function(m){m%=2*cr.PI;0>m&&(m+=2*cr.PI);return m};cr.to_clamped_degrees=function(m){return cr.clamp_angle_degrees(cr.to_degrees(m))};cr.to_clamped_radians=function(m){return cr.clamp_angle(cr.to_radians(m))};
cr.angleTo=function(m,E,L,N){return Math.atan2(N-E,L-m)};cr.angleDiff=function(m,E){if(m===E)return 0;m=Math.sin(m)*Math.sin(E)+Math.cos(m)*Math.cos(E);return 1<=m?0:-1>=m?cr.PI:Math.acos(m)};cr.angleRotate=function(m,E,L){var N=Math.sin(m),V=Math.cos(m),W=Math.sin(E),X=Math.cos(E);return Math.acos(N*W+V*X)>L?0<V*W-N*X?cr.clamp_angle(m+L):cr.clamp_angle(m-L):cr.clamp_angle(E)};cr.angleClockwise=function(m,E){return 0>=Math.cos(m)*Math.sin(E)-Math.sin(m)*Math.cos(E)};cr.rotatePtAround=function(m,E,
L,N,V,W){if(0===L)return W?m:E;var X=Math.sin(L);L=Math.cos(L);m-=N;E-=V;var Y=m*X;m=m*L-E*X;return W?m+N:E*L+Y+V};cr.distanceTo=function(m,E,L,N){m=L-m;E=N-E;return Math.sqrt(m*m+E*E)};cr.xor=function(m,E){return!m!==!E};cr.lerp=function(m,E,L){return m+(E-m)*L};cr.unlerp=function(m,E,L){return m===E?0:(L-m)/(E-m)};cr.anglelerp=function(m,E,L){var N=cr.angleDiff(m,E);return cr.angleClockwise(E,m)?m+N*L:m-N*L};cr.qarp=function(m,E,L,N){return cr.lerp(cr.lerp(m,E,N),cr.lerp(E,L,N),N)};cr.cubic=function(m,
E,L,N,V){return cr.lerp(cr.qarp(m,E,L,V),cr.qarp(E,L,N,V),V)};cr.cosp=function(m,E,L){return(m+E+(m-E)*Math.cos(L*Math.PI))/2};cr.hasAnyOwnProperty=function(m){for(var E in m)if(m.hasOwnProperty(E))return!0;return!1};cr.wipe=function(m){for(var E in m)m.hasOwnProperty(E)&&delete m[E]};var l=+new Date;cr.performance_now=function(){if("undefined"!==typeof window.performance){var m=window.performance;if("undefined"!==typeof m.now)return m.now();if("undefined"!==typeof m.webkitNow)return m.webkitNow();
if("undefined"!==typeof m.mozNow)return m.mozNow();if("undefined"!==typeof m.msNow)return m.msNow()}return Date.now()-l};var y=!1;"undefined"!==typeof window&&(y=/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent),!y&&/safari/i.test(navigator.userAgent),/(iphone|ipod|ipad)/i.test(navigator.userAgent));var z="undefined"!==typeof Set&&"undefined"!==typeof Set.prototype.forEach;t.prototype.contains=function(m){return this.isEmpty()?!1:z?this.s.has(m):this.items&&this.items.hasOwnProperty(m)};
t.prototype.add=function(m){if(z)this.s.has(m)||(this.s.add(m),this.cache_valid=!1);else{var E=m.toString(),L=this.items;L?L.hasOwnProperty(E)||(L[E]=m,this.item_count++,this.cache_valid=!1):(this.items={},this.items[E]=m,this.item_count=1,this.cache_valid=!1)}};t.prototype.remove=function(m){if(!this.isEmpty())if(z)this.s.has(m)&&(this.s["delete"](m),this.cache_valid=!1);else if(this.items){m=m.toString();var E=this.items;E.hasOwnProperty(m)&&(delete E[m],this.item_count--,this.cache_valid=!1)}};
t.prototype.clear=function(){this.isEmpty()||(z?this.s.clear():(this.items=null,this.item_count=0),cr.clearArray(this.values_cache),this.cache_valid=!0)};t.prototype.isEmpty=function(){return 0===this.count()};t.prototype.count=function(){return z?this.s.size:this.item_count};var O=null,Q=0;t.prototype.update_cache=function(){if(!this.cache_valid){if(z)cr.clearArray(this.values_cache),O=this.values_cache,Q=0,this.s.forEach(e),O=null,Q=0;else{var m=this.values_cache;cr.clearArray(m);var E,L=0,N=this.items;
if(N)for(E in N)N.hasOwnProperty(E)&&(m[L++]=N[E])}this.cache_valid=!0}};t.prototype.valuesRef=function(){this.update_cache();return this.values_cache};cr.ObjectSet=t;var I=new cr.ObjectSet;cr.removeArrayDuplicates=function(m){var E;var L=0;for(E=m.length;L<E;++L)I.add(m[L]);cr.shallowAssignArray(m,I.valuesRef());I.clear()};cr.arrayRemoveAllFromObjectSet=function(m,E){z?cr.arrayRemoveAll_set(m,E.s):cr.arrayRemoveAll_arr(m,E.valuesRef())};cr.arrayRemoveAll_set=function(m,E){var L,N;var V=L=0;for(N=
m.length;L<N;++L){var W=m[L];E.has(W)||(m[V++]=W)}cr.truncateArray(m,V)};cr.arrayRemoveAll_arr=function(m,E){var L,N;var V=L=0;for(N=m.length;L<N;++L){var W=m[L];-1===cr.fastIndexOf(E,W)&&(m[V++]=W)}cr.truncateArray(m,V)};c.prototype.add=function(m){this.y=m-this.c;this.t=this.sum+this.y;this.c=this.t-this.sum-this.y;this.sum=this.t};c.prototype.reset=function(){this.sum=this.t=this.y=this.c=0};cr.KahanAdder=c;cr.regexp_escape=function(m){return m.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};a.prototype.set_pts=
function(m){this.pts_array=m;this.pts_count=m.length/2;this.pts_cache.length=m.length;this.cache_height=this.cache_width=-1;this.cache_angle=0};a.prototype.is_empty=function(){return!this.pts_array.length};a.prototype.update_bbox=function(){for(var m=this.pts_cache,E=m[0],L=E,N=m[1],V=N,W,X,Y=1,ea=this.pts_count;Y<ea;++Y)X=2*Y,W=m[X],X=m[X+1],W<E&&(E=W),W>L&&(L=W),X<N&&(N=X),X>V&&(V=X);this.bboxLeft=E;this.bboxRight=L;this.bboxTop=N;this.bboxBottom=V};a.prototype.set_from_rect=function(m,E,L){this.pts_cache.length=
8;this.pts_count=4;var N=this.pts_cache;N[0]=m.left-E;N[1]=m.top-L;N[2]=m.right-E;N[3]=m.top-L;N[4]=m.right-E;N[5]=m.bottom-L;N[6]=m.left-E;N[7]=m.bottom-L;this.cache_width=m.right-m.left;this.cache_height=m.bottom-m.top;this.update_bbox()};a.prototype.set_from_quad=function(m,E,L,N,V){this.pts_cache.length=8;this.pts_count=4;var W=this.pts_cache;W[0]=m.tlx-E;W[1]=m.tly-L;W[2]=m.trx-E;W[3]=m.try_-L;W[4]=m.brx-E;W[5]=m.bry-L;W[6]=m.blx-E;W[7]=m.bly-L;this.cache_width=N;this.cache_height=V;this.update_bbox()};
a.prototype.set_from_poly=function(m){this.pts_count=m.pts_count;cr.shallowAssignArray(this.pts_cache,m.pts_cache);this.bboxLeft=m.bboxLeft;this.bboxTop-m.bboxTop;this.bboxRight=m.bboxRight;this.bboxBottom=m.bboxBottom};a.prototype.cache_poly=function(m,E,L){if(this.cache_width!==m||this.cache_height!==E||this.cache_angle!==L){this.cache_width=m;this.cache_height=E;this.cache_angle=L;var N,V=0,W=1,X=this.pts_array,Y=this.pts_cache;0!==L&&(V=Math.sin(L),W=Math.cos(L));L=0;for(N=this.pts_count;L<N;L++){var ea=
2*L;var ha=ea+1;var q=X[ea]*m;var B=X[ha]*E;Y[ea]=q*W-B*V;Y[ha]=B*W+q*V}this.update_bbox()}};a.prototype.contains_pt=function(m,E){var L=this.pts_cache;if(m===L[0]&&E===L[1])return!0;var N,V=this.pts_count,W=this.bboxLeft-110,X=this.bboxTop-101,Y=this.bboxRight+131,ea=this.bboxBottom+120,ha=0,q=0;for(N=0;N<V;N++){var B=2*N;var G=(N+1)%V*2;var J=L[B];B=L[B+1];var F=L[G];G=L[G+1];cr.segments_intersect(W,X,m,E,J,B,F,G)&&ha++;cr.segments_intersect(Y,ea,m,E,J,B,F,G)&&q++}return 1===ha%2||1===q%2};a.prototype.intersects_poly=
function(m,E,L){var N=m.pts_cache,V=this.pts_cache;if(this.contains_pt(N[0]+E,N[1]+L)||m.contains_pt(V[0]-E,V[1]-L))return!0;var W,X;var Y=0;for(W=this.pts_count;Y<W;Y++){var ea=2*Y;var ha=(Y+1)%W*2;var q=V[ea];ea=V[ea+1];var B=V[ha];var G=V[ha+1];ha=0;for(X=m.pts_count;ha<X;ha++){var J=2*ha;var F=(ha+1)%X*2;var M=N[J]+E;J=N[J+1]+L;var S=N[F]+E;F=N[F+1]+L;if(cr.segments_intersect(q,ea,B,G,M,J,S,F))return!0}}return!1};a.prototype.intersects_segment=function(m,E,L,N,V,W){var X=this.pts_cache;if(this.contains_pt(L-
m,N-E))return!0;var Y;var ea=0;for(Y=this.pts_count;ea<Y;ea++){var ha=2*ea;var q=(ea+1)%Y*2;var B=X[ha]+m;ha=X[ha+1]+E;var G=X[q]+m;q=X[q+1]+E;if(cr.segments_intersect(L,N,V,W,B,ha,G,q))return!0}return!1};a.prototype.mirror=function(m){var E;var L=0;for(E=this.pts_count;L<E;++L){var N=2*L;this.pts_cache[N]=2*m-this.pts_cache[N]}};a.prototype.flip=function(m){var E;var L=0;for(E=this.pts_count;L<E;++L){var N=2*L+1;this.pts_cache[N]=2*m-this.pts_cache[N]}};a.prototype.diag=function(){var m;var E=0;
for(m=this.pts_count;E<m;++E){var L=2*E;var N=L+1;var V=this.pts_cache[L];this.pts_cache[L]=this.pts_cache[N];this.pts_cache[N]=V}};a.prototype.is_enabled=function(){return this.enabled};cr.CollisionPoly=a;d.prototype.totalCellCount=0;d.prototype.getCell=function(m,E,L){var N=this.cells[m];return N?(N=N[E])?N:L?(N=u(this,m,E),this.cells[m][E]=N):null:L?(N=u(this,m,E),this.cells[m]={},this.cells[m][E]=N):null};d.prototype.XToCell=function(m){return cr.floor(m/this.cellwidth)};d.prototype.YToCell=function(m){return cr.floor(m/
this.cellheight)};d.prototype.update=function(m,E,L){var N,V,W;if(E){var X=E.left;for(N=E.right;X<=N;++X){var Y=E.top;for(V=E.bottom;Y<=V;++Y)if(!L||!L.contains_pt(X,Y))if(W=this.getCell(X,Y,!1))W.remove(m),W.isEmpty()&&(d.prototype.totalCellCount--,W.objects.clear(),1E3>k.length&&k.push(W),this.cells[X][Y]=null)}}if(L)for(X=L.left,N=L.right;X<=N;++X)for(Y=L.top,V=L.bottom;Y<=V;++Y)E&&E.contains_pt(X,Y)||this.getCell(X,Y,!0).insert(m)};d.prototype.queryRange=function(m,E){var L,N;var V=this.XToCell(m.left);
var W=this.YToCell(m.top);var X=this.XToCell(m.right);for(L=this.YToCell(m.bottom);V<=X;++V)for(m=W;m<=L;++m)(N=this.getCell(V,m,!1))&&N.dump(E)};cr.SparseGrid=d;h.prototype.totalCellCount=0;h.prototype.getCell=function(m,E,L){var N=this.cells[m];return N?(N=N[E])?N:L?(N=C(this,m,E),this.cells[m][E]=N):null:L?(N=C(this,m,E),this.cells[m]={},this.cells[m][E]=N):null};h.prototype.XToCell=function(m){return cr.floor(m/this.cellwidth)};h.prototype.YToCell=function(m){return cr.floor(m/this.cellheight)};
h.prototype.update=function(m,E,L){var N,V,W;if(E){var X=E.left;for(N=E.right;X<=N;++X){var Y=E.top;for(V=E.bottom;Y<=V;++Y)if(!L||!L.contains_pt(X,Y))if(W=this.getCell(X,Y,!1))W.remove(m),W.isEmpty()&&(h.prototype.totalCellCount--,W.reset(),1E3>p.length&&p.push(W),this.cells[X][Y]=null)}}if(L)for(X=L.left,N=L.right;X<=N;++X)for(Y=L.top,V=L.bottom;Y<=V;++Y)E&&E.contains_pt(X,Y)||this.getCell(X,Y,!0).insert(m)};h.prototype.queryRange=function(m,E,L,N,V){var W,X;m=this.XToCell(m);E=this.YToCell(E);
L=this.XToCell(L);for(W=this.YToCell(N);m<=L;++m)for(N=E;N<=W;++N)(X=this.getCell(m,N,!1))&&X.dump(V)};h.prototype.markRangeChanged=function(m){var E,L;var N=m.left;var V=m.top;var W=m.right;for(E=m.bottom;N<=W;++N)for(m=V;m<=E;++m)if(L=this.getCell(N,m,!1))L.is_sorted=!1};cr.RenderGrid=h;var k=[];v.prototype.isEmpty=function(){return this.objects.isEmpty()};v.prototype.insert=function(m){this.objects.add(m)};v.prototype.remove=function(m){this.objects.remove(m)};v.prototype.dump=function(m){cr.appendArray(m,
this.objects.valuesRef())};cr.GridCell=v;var p=[];w.prototype.isEmpty=function(){if(!this.objects.length)return!0;if(this.objects.length>this.pending_removal.count())return!1;this.flush_pending();return!0};w.prototype.insert=function(m){this.pending_removal.contains(m)?(this.pending_removal.remove(m),this.pending_removal.isEmpty()&&(this.any_pending_removal=!1)):this.objects.length?(this.objects[this.objects.length-1].get_zindex()>m.get_zindex()&&(this.is_sorted=!1),this.objects.push(m)):(this.objects.push(m),
this.is_sorted=!0)};w.prototype.remove=function(m){this.pending_removal.add(m);this.any_pending_removal=!0;30<=this.pending_removal.count()&&this.flush_pending()};w.prototype.flush_pending=function(){this.any_pending_removal&&(this.pending_removal.count()===this.objects.length?this.reset():(cr.arrayRemoveAllFromObjectSet(this.objects,this.pending_removal),this.pending_removal.clear(),this.any_pending_removal=!1))};w.prototype.ensure_sorted=function(){this.is_sorted||(this.objects.sort(r),this.is_sorted=
!0)};w.prototype.reset=function(){cr.clearArray(this.objects);this.is_sorted=!0;this.pending_removal.clear();this.any_pending_removal=!1};w.prototype.dump=function(m){this.flush_pending();this.ensure_sorted();this.objects.length&&m.push(this.objects)};cr.RenderCell=w;var H="lighter xor copy destination-over source-in destination-in source-out destination-out source-atop destination-atop".split(" ");cr.effectToCompositeOp=function(m){return 0>=m||11<=m?"source-over":H[m-1]};cr.setGLBlend=function(m,
E,L){if(L)switch(m.srcBlend=L.ONE,m.destBlend=L.ONE_MINUS_SRC_ALPHA,E){case 1:m.srcBlend=L.ONE;m.destBlend=L.ONE;break;case 3:m.srcBlend=L.ONE;m.destBlend=L.ZERO;break;case 4:m.srcBlend=L.ONE_MINUS_DST_ALPHA;m.destBlend=L.ONE;break;case 5:m.srcBlend=L.DST_ALPHA;m.destBlend=L.ZERO;break;case 6:m.srcBlend=L.ZERO;m.destBlend=L.SRC_ALPHA;break;case 7:m.srcBlend=L.ONE_MINUS_DST_ALPHA;m.destBlend=L.ZERO;break;case 8:m.srcBlend=L.ZERO;m.destBlend=L.ONE_MINUS_SRC_ALPHA;break;case 9:m.srcBlend=L.DST_ALPHA;
m.destBlend=L.ONE_MINUS_SRC_ALPHA;break;case 10:m.srcBlend=L.ONE_MINUS_DST_ALPHA,m.destBlend=L.SRC_ALPHA}};cr.round6dp=function(m){return Math.round(1E6*m)/1E6};cr.equals_nocase=function(m,E){return"string"!==typeof m||"string"!==typeof E||m.length!==E.length?!1:m===E?!0:m.toLowerCase()===E.toLowerCase()};cr.cssToCamelCase=function(m){var E="",L,N=!1;var V=0;for(L=m.length;V<L;++V){var W=m.charAt(V);"-"===W?N=!0:N?(E+=W.toUpperCase(),N=!1):E+=W}return E};cr.isCanvasInputEvent=function(m){m=m.target;
return!m||m===document||m===window||document&&document.body&&m===document.body||cr.equals_nocase(m.tagName,"canvas")?!0:!1}})();var MatrixArray="undefined"!==typeof Float32Array?Float32Array:Array,glMatrixArrayType=MatrixArray,vec3={},mat3={},mat4={},quat4={};vec3.create=function(b){var f=new MatrixArray(3);b&&(f[0]=b[0],f[1]=b[1],f[2]=b[2]);return f};vec3.set=function(b,f){f[0]=b[0];f[1]=b[1];f[2]=b[2];return f};
vec3.add=function(b,f,g){if(!g||b===g)return b[0]+=f[0],b[1]+=f[1],b[2]+=f[2],b;g[0]=b[0]+f[0];g[1]=b[1]+f[1];g[2]=b[2]+f[2];return g};vec3.subtract=function(b,f,g){if(!g||b===g)return b[0]-=f[0],b[1]-=f[1],b[2]-=f[2],b;g[0]=b[0]-f[0];g[1]=b[1]-f[1];g[2]=b[2]-f[2];return g};vec3.negate=function(b,f){f||(f=b);f[0]=-b[0];f[1]=-b[1];f[2]=-b[2];return f};vec3.scale=function(b,f,g){if(!g||b===g)return b[0]*=f,b[1]*=f,b[2]*=f,b;g[0]=b[0]*f;g[1]=b[1]*f;g[2]=b[2]*f;return g};
vec3.normalize=function(b,f){f||(f=b);var g=b[0],n=b[1];b=b[2];var t=Math.sqrt(g*g+n*n+b*b);if(t){if(1===t)return f[0]=g,f[1]=n,f[2]=b,f}else return f[0]=0,f[1]=0,f[2]=0,f;t=1/t;f[0]=g*t;f[1]=n*t;f[2]=b*t;return f};vec3.cross=function(b,f,g){g||(g=b);var n=b[0],t=b[1];b=b[2];var e=f[0],c=f[1];f=f[2];g[0]=t*f-b*c;g[1]=b*e-n*f;g[2]=n*c-t*e;return g};vec3.length=function(b){var f=b[0],g=b[1];b=b[2];return Math.sqrt(f*f+g*g+b*b)};vec3.dot=function(b,f){return b[0]*f[0]+b[1]*f[1]+b[2]*f[2]};
vec3.direction=function(b,f,g){g||(g=b);var n=b[0]-f[0],t=b[1]-f[1];b=b[2]-f[2];f=Math.sqrt(n*n+t*t+b*b);if(!f)return g[0]=0,g[1]=0,g[2]=0,g;f=1/f;g[0]=n*f;g[1]=t*f;g[2]=b*f;return g};vec3.lerp=function(b,f,g,n){n||(n=b);n[0]=b[0]+g*(f[0]-b[0]);n[1]=b[1]+g*(f[1]-b[1]);n[2]=b[2]+g*(f[2]-b[2]);return n};vec3.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+"]"};
mat3.create=function(b){var f=new MatrixArray(9);b&&(f[0]=b[0],f[1]=b[1],f[2]=b[2],f[3]=b[3],f[4]=b[4],f[5]=b[5],f[6]=b[6],f[7]=b[7],f[8]=b[8]);return f};mat3.set=function(b,f){f[0]=b[0];f[1]=b[1];f[2]=b[2];f[3]=b[3];f[4]=b[4];f[5]=b[5];f[6]=b[6];f[7]=b[7];f[8]=b[8];return f};mat3.identity=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};
mat3.transpose=function(b,f){if(!f||b===f){f=b[1];var g=b[2],n=b[5];b[1]=b[3];b[2]=b[6];b[3]=f;b[5]=b[7];b[6]=g;b[7]=n;return b}f[0]=b[0];f[1]=b[3];f[2]=b[6];f[3]=b[1];f[4]=b[4];f[5]=b[7];f[6]=b[2];f[7]=b[5];f[8]=b[8];return f};mat3.toMat4=function(b,f){f||(f=mat4.create());f[15]=1;f[14]=0;f[13]=0;f[12]=0;f[11]=0;f[10]=b[8];f[9]=b[7];f[8]=b[6];f[7]=0;f[6]=b[5];f[5]=b[4];f[4]=b[3];f[3]=0;f[2]=b[2];f[1]=b[1];f[0]=b[0];return f};
mat3.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+"]"};mat4.create=function(b){var f=new MatrixArray(16);b&&(f[0]=b[0],f[1]=b[1],f[2]=b[2],f[3]=b[3],f[4]=b[4],f[5]=b[5],f[6]=b[6],f[7]=b[7],f[8]=b[8],f[9]=b[9],f[10]=b[10],f[11]=b[11],f[12]=b[12],f[13]=b[13],f[14]=b[14],f[15]=b[15]);return f};
mat4.set=function(b,f){f[0]=b[0];f[1]=b[1];f[2]=b[2];f[3]=b[3];f[4]=b[4];f[5]=b[5];f[6]=b[6];f[7]=b[7];f[8]=b[8];f[9]=b[9];f[10]=b[10];f[11]=b[11];f[12]=b[12];f[13]=b[13];f[14]=b[14];f[15]=b[15];return f};mat4.identity=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
mat4.transpose=function(b,f){if(!f||b===f){f=b[1];var g=b[2],n=b[3],t=b[6],e=b[7],c=b[11];b[1]=b[4];b[2]=b[8];b[3]=b[12];b[4]=f;b[6]=b[9];b[7]=b[13];b[8]=g;b[9]=t;b[11]=b[14];b[12]=n;b[13]=e;b[14]=c;return b}f[0]=b[0];f[1]=b[4];f[2]=b[8];f[3]=b[12];f[4]=b[1];f[5]=b[5];f[6]=b[9];f[7]=b[13];f[8]=b[2];f[9]=b[6];f[10]=b[10];f[11]=b[14];f[12]=b[3];f[13]=b[7];f[14]=b[11];f[15]=b[15];return f};
mat4.determinant=function(b){var f=b[0],g=b[1],n=b[2],t=b[3],e=b[4],c=b[5],a=b[6],d=b[7],h=b[8],u=b[9],v=b[10],C=b[11],w=b[12],r=b[13],x=b[14];b=b[15];return w*u*a*t-h*r*a*t-w*c*v*t+e*r*v*t+h*c*x*t-e*u*x*t-w*u*n*d+h*r*n*d+w*g*v*d-f*r*v*d-h*g*x*d+f*u*x*d+w*c*n*C-e*r*n*C-w*g*a*C+f*r*a*C+e*g*x*C-f*c*x*C-h*c*n*b+e*u*n*b+h*g*a*b-f*u*a*b-e*g*v*b+f*c*v*b};
mat4.inverse=function(b,f){f||(f=b);var g=b[0],n=b[1],t=b[2],e=b[3],c=b[4],a=b[5],d=b[6],h=b[7],u=b[8],v=b[9],C=b[10],w=b[11],r=b[12],x=b[13],A=b[14];b=b[15];var l=g*a-n*c,y=g*d-t*c,z=g*h-e*c,O=n*d-t*a,Q=n*h-e*a,I=t*h-e*d,k=u*x-v*r,p=u*A-C*r,H=u*b-w*r,m=v*A-C*x,E=v*b-w*x,L=C*b-w*A,N=1/(l*L-y*E+z*m+O*H-Q*p+I*k);f[0]=(a*L-d*E+h*m)*N;f[1]=(-n*L+t*E-e*m)*N;f[2]=(x*I-A*Q+b*O)*N;f[3]=(-v*I+C*Q-w*O)*N;f[4]=(-c*L+d*H-h*p)*N;f[5]=(g*L-t*H+e*p)*N;f[6]=(-r*I+A*z-b*y)*N;f[7]=(u*I-C*z+w*y)*N;f[8]=(c*E-a*H+h*k)*
N;f[9]=(-g*E+n*H-e*k)*N;f[10]=(r*Q-x*z+b*l)*N;f[11]=(-u*Q+v*z-w*l)*N;f[12]=(-c*m+a*p-d*k)*N;f[13]=(g*m-n*p+t*k)*N;f[14]=(-r*O+x*y-A*l)*N;f[15]=(u*O-v*y+C*l)*N;return f};mat4.toRotationMat=function(b,f){f||(f=mat4.create());f[0]=b[0];f[1]=b[1];f[2]=b[2];f[3]=b[3];f[4]=b[4];f[5]=b[5];f[6]=b[6];f[7]=b[7];f[8]=b[8];f[9]=b[9];f[10]=b[10];f[11]=b[11];f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f};
mat4.toMat3=function(b,f){f||(f=mat3.create());f[0]=b[0];f[1]=b[1];f[2]=b[2];f[3]=b[4];f[4]=b[5];f[5]=b[6];f[6]=b[8];f[7]=b[9];f[8]=b[10];return f};mat4.toInverseMat3=function(b,f){var g=b[0],n=b[1],t=b[2],e=b[4],c=b[5],a=b[6],d=b[8],h=b[9];b=b[10];var u=b*c-a*h,v=-b*e+a*d,C=h*e-c*d,w=g*u+n*v+t*C;if(!w)return null;w=1/w;f||(f=mat3.create());f[0]=u*w;f[1]=(-b*n+t*h)*w;f[2]=(a*n-t*c)*w;f[3]=v*w;f[4]=(b*g-t*d)*w;f[5]=(-a*g+t*e)*w;f[6]=C*w;f[7]=(-h*g+n*d)*w;f[8]=(c*g-n*e)*w;return f};
mat4.multiply=function(b,f,g){g||(g=b);var n=b[0],t=b[1],e=b[2],c=b[3],a=b[4],d=b[5],h=b[6],u=b[7],v=b[8],C=b[9],w=b[10],r=b[11],x=b[12],A=b[13],l=b[14];b=b[15];var y=f[0],z=f[1],O=f[2],Q=f[3],I=f[4],k=f[5],p=f[6],H=f[7],m=f[8],E=f[9],L=f[10],N=f[11],V=f[12],W=f[13],X=f[14];f=f[15];g[0]=y*n+z*a+O*v+Q*x;g[1]=y*t+z*d+O*C+Q*A;g[2]=y*e+z*h+O*w+Q*l;g[3]=y*c+z*u+O*r+Q*b;g[4]=I*n+k*a+p*v+H*x;g[5]=I*t+k*d+p*C+H*A;g[6]=I*e+k*h+p*w+H*l;g[7]=I*c+k*u+p*r+H*b;g[8]=m*n+E*a+L*v+N*x;g[9]=m*t+E*d+L*C+N*A;g[10]=m*
e+E*h+L*w+N*l;g[11]=m*c+E*u+L*r+N*b;g[12]=V*n+W*a+X*v+f*x;g[13]=V*t+W*d+X*C+f*A;g[14]=V*e+W*h+X*w+f*l;g[15]=V*c+W*u+X*r+f*b;return g};mat4.multiplyVec3=function(b,f,g){g||(g=f);var n=f[0],t=f[1];f=f[2];g[0]=b[0]*n+b[4]*t+b[8]*f+b[12];g[1]=b[1]*n+b[5]*t+b[9]*f+b[13];g[2]=b[2]*n+b[6]*t+b[10]*f+b[14];return g};
mat4.multiplyVec4=function(b,f,g){g||(g=f);var n=f[0],t=f[1],e=f[2];f=f[3];g[0]=b[0]*n+b[4]*t+b[8]*e+b[12]*f;g[1]=b[1]*n+b[5]*t+b[9]*e+b[13]*f;g[2]=b[2]*n+b[6]*t+b[10]*e+b[14]*f;g[3]=b[3]*n+b[7]*t+b[11]*e+b[15]*f;return g};
mat4.translate=function(b,f,g){var n=f[0],t=f[1];f=f[2];if(!g||b===g)return b[12]=b[0]*n+b[4]*t+b[8]*f+b[12],b[13]=b[1]*n+b[5]*t+b[9]*f+b[13],b[14]=b[2]*n+b[6]*t+b[10]*f+b[14],b[15]=b[3]*n+b[7]*t+b[11]*f+b[15],b;var e=b[0];var c=b[1];var a=b[2];var d=b[3];var h=b[4];var u=b[5];var v=b[6];var C=b[7];var w=b[8];var r=b[9];var x=b[10];var A=b[11];g[0]=e;g[1]=c;g[2]=a;g[3]=d;g[4]=h;g[5]=u;g[6]=v;g[7]=C;g[8]=w;g[9]=r;g[10]=x;g[11]=A;g[12]=e*n+h*t+w*f+b[12];g[13]=c*n+u*t+r*f+b[13];g[14]=a*n+v*t+x*f+b[14];
g[15]=d*n+C*t+A*f+b[15];return g};mat4.scale=function(b,f,g){var n=f[0],t=f[1];f=f[2];if(!g||b===g)return b[0]*=n,b[1]*=n,b[2]*=n,b[3]*=n,b[4]*=t,b[5]*=t,b[6]*=t,b[7]*=t,b[8]*=f,b[9]*=f,b[10]*=f,b[11]*=f,b;g[0]=b[0]*n;g[1]=b[1]*n;g[2]=b[2]*n;g[3]=b[3]*n;g[4]=b[4]*t;g[5]=b[5]*t;g[6]=b[6]*t;g[7]=b[7]*t;g[8]=b[8]*f;g[9]=b[9]*f;g[10]=b[10]*f;g[11]=b[11]*f;g[12]=b[12];g[13]=b[13];g[14]=b[14];g[15]=b[15];return g};
mat4.rotate=function(b,f,g,n){var t=g[0],e=g[1];g=g[2];var c=Math.sqrt(t*t+e*e+g*g);if(!c)return null;1!==c&&(c=1/c,t*=c,e*=c,g*=c);var a=Math.sin(f);var d=Math.cos(f);var h=1-d;f=b[0];c=b[1];var u=b[2];var v=b[3];var C=b[4];var w=b[5];var r=b[6];var x=b[7];var A=b[8];var l=b[9];var y=b[10];var z=b[11];var O=t*t*h+d;var Q=e*t*h+g*a;var I=g*t*h-e*a;var k=t*e*h-g*a;var p=e*e*h+d;var H=g*e*h+t*a;var m=t*g*h+e*a;t=e*g*h-t*a;e=g*g*h+d;n?b!==n&&(n[12]=b[12],n[13]=b[13],n[14]=b[14],n[15]=b[15]):n=b;n[0]=
f*O+C*Q+A*I;n[1]=c*O+w*Q+l*I;n[2]=u*O+r*Q+y*I;n[3]=v*O+x*Q+z*I;n[4]=f*k+C*p+A*H;n[5]=c*k+w*p+l*H;n[6]=u*k+r*p+y*H;n[7]=v*k+x*p+z*H;n[8]=f*m+C*t+A*e;n[9]=c*m+w*t+l*e;n[10]=u*m+r*t+y*e;n[11]=v*m+x*t+z*e;return n};
mat4.rotateX=function(b,f,g){var n=Math.sin(f);f=Math.cos(f);var t=b[4],e=b[5],c=b[6],a=b[7],d=b[8],h=b[9],u=b[10],v=b[11];g?b!==g&&(g[0]=b[0],g[1]=b[1],g[2]=b[2],g[3]=b[3],g[12]=b[12],g[13]=b[13],g[14]=b[14],g[15]=b[15]):g=b;g[4]=t*f+d*n;g[5]=e*f+h*n;g[6]=c*f+u*n;g[7]=a*f+v*n;g[8]=t*-n+d*f;g[9]=e*-n+h*f;g[10]=c*-n+u*f;g[11]=a*-n+v*f;return g};
mat4.rotateY=function(b,f,g){var n=Math.sin(f);f=Math.cos(f);var t=b[0],e=b[1],c=b[2],a=b[3],d=b[8],h=b[9],u=b[10],v=b[11];g?b!==g&&(g[4]=b[4],g[5]=b[5],g[6]=b[6],g[7]=b[7],g[12]=b[12],g[13]=b[13],g[14]=b[14],g[15]=b[15]):g=b;g[0]=t*f+d*-n;g[1]=e*f+h*-n;g[2]=c*f+u*-n;g[3]=a*f+v*-n;g[8]=t*n+d*f;g[9]=e*n+h*f;g[10]=c*n+u*f;g[11]=a*n+v*f;return g};
mat4.rotateZ=function(b,f,g){var n=Math.sin(f);f=Math.cos(f);var t=b[0],e=b[1],c=b[2],a=b[3],d=b[4],h=b[5],u=b[6],v=b[7];g?b!==g&&(g[8]=b[8],g[9]=b[9],g[10]=b[10],g[11]=b[11],g[12]=b[12],g[13]=b[13],g[14]=b[14],g[15]=b[15]):g=b;g[0]=t*f+d*n;g[1]=e*f+h*n;g[2]=c*f+u*n;g[3]=a*f+v*n;g[4]=t*-n+d*f;g[5]=e*-n+h*f;g[6]=c*-n+u*f;g[7]=a*-n+v*f;return g};
mat4.frustum=function(b,f,g,n,t,e,c){c||(c=mat4.create());var a=f-b,d=n-g,h=e-t;c[0]=2*t/a;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=2*t/d;c[6]=0;c[7]=0;c[8]=(f+b)/a;c[9]=(n+g)/d;c[10]=-(e+t)/h;c[11]=-1;c[12]=0;c[13]=0;c[14]=-(e*t*2)/h;c[15]=0;return c};mat4.perspective=function(b,f,g,n,t){b=g*Math.tan(b*Math.PI/360);f*=b;return mat4.frustum(-f,f,-b,b,g,n,t)};
mat4.ortho=function(b,f,g,n,t,e,c){c||(c=mat4.create());var a=f-b,d=n-g,h=e-t;c[0]=2/a;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=2/d;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=-2/h;c[11]=0;c[12]=-(b+f)/a;c[13]=-(n+g)/d;c[14]=-(e+t)/h;c[15]=1;return c};
mat4.lookAt=function(b,f,g,n){n||(n=mat4.create());var t=b[0],e=b[1];b=b[2];var c=g[0];var a=g[1];var d=g[2];g=f[1];var h=f[2];if(t===f[0]&&e===g&&b===h)return mat4.identity(n);g=t-f[0];h=e-f[1];var u=b-f[2];var v=1/Math.sqrt(g*g+h*h+u*u);g*=v;h*=v;u*=v;f=a*u-d*h;d=d*g-c*u;c=c*h-a*g;(v=Math.sqrt(f*f+d*d+c*c))?(v=1/v,f*=v,d*=v,c*=v):c=d=f=0;a=h*c-u*d;var C=u*f-g*c;var w=g*d-h*f;(v=Math.sqrt(a*a+C*C+w*w))?(v=1/v,a*=v,C*=v,w*=v):w=C=a=0;n[0]=f;n[1]=a;n[2]=g;n[3]=0;n[4]=d;n[5]=C;n[6]=h;n[7]=0;n[8]=c;
n[9]=w;n[10]=u;n[11]=0;n[12]=-(f*t+d*e+c*b);n[13]=-(a*t+C*e+w*b);n[14]=-(g*t+h*e+u*b);n[15]=1;return n};mat4.fromRotationTranslation=function(b,f,g){g||(g=mat4.create());var n=b[0],t=b[1],e=b[2],c=b[3],a=n+n,d=t+t,h=e+e;b=n*a;var u=n*d;n*=h;var v=t*d;t*=h;e*=h;a*=c;d*=c;c*=h;g[0]=1-(v+e);g[1]=u+c;g[2]=n-d;g[3]=0;g[4]=u-c;g[5]=1-(b+e);g[6]=t+a;g[7]=0;g[8]=n+d;g[9]=t-a;g[10]=1-(b+v);g[11]=0;g[12]=f[0];g[13]=f[1];g[14]=f[2];g[15]=1;return g};
mat4.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+", "+b[9]+", "+b[10]+", "+b[11]+", "+b[12]+", "+b[13]+", "+b[14]+", "+b[15]+"]"};quat4.create=function(b){var f=new MatrixArray(4);b&&(f[0]=b[0],f[1]=b[1],f[2]=b[2],f[3]=b[3]);return f};quat4.set=function(b,f){f[0]=b[0];f[1]=b[1];f[2]=b[2];f[3]=b[3];return f};
quat4.calculateW=function(b,f){var g=b[0],n=b[1],t=b[2];if(!f||b===f)return b[3]=-Math.sqrt(Math.abs(1-g*g-n*n-t*t)),b;f[0]=g;f[1]=n;f[2]=t;f[3]=-Math.sqrt(Math.abs(1-g*g-n*n-t*t));return f};quat4.inverse=function(b,f){if(!f||b===f)return b[0]*=-1,b[1]*=-1,b[2]*=-1,b;f[0]=-b[0];f[1]=-b[1];f[2]=-b[2];f[3]=b[3];return f};quat4.length=function(b){var f=b[0],g=b[1],n=b[2];b=b[3];return Math.sqrt(f*f+g*g+n*n+b*b)};
quat4.normalize=function(b,f){f||(f=b);var g=b[0],n=b[1],t=b[2];b=b[3];var e=Math.sqrt(g*g+n*n+t*t+b*b);if(0===e)return f[0]=0,f[1]=0,f[2]=0,f[3]=0,f;e=1/e;f[0]=g*e;f[1]=n*e;f[2]=t*e;f[3]=b*e;return f};quat4.multiply=function(b,f,g){g||(g=b);var n=b[0],t=b[1],e=b[2];b=b[3];var c=f[0],a=f[1],d=f[2];f=f[3];g[0]=n*f+b*c+t*d-e*a;g[1]=t*f+b*a+e*c-n*d;g[2]=e*f+b*d+n*a-t*c;g[3]=b*f-n*c-t*a-e*d;return g};
quat4.multiplyVec3=function(b,f,g){g||(g=f);var n=f[0],t=f[1],e=f[2];f=b[0];var c=b[1],a=b[2];b=b[3];var d=b*n+c*e-a*t,h=b*t+a*n-f*e,u=b*e+f*t-c*n;n=-f*n-c*t-a*e;g[0]=d*b+n*-f+h*-a-u*-c;g[1]=h*b+n*-c+u*-f-d*-a;g[2]=u*b+n*-a+d*-c-h*-f;return g};quat4.toMat3=function(b,f){f||(f=mat3.create());var g=b[0],n=b[1],t=b[2];b=b[3];var e=g+g,c=n+n,a=t+t,d=g*e,h=g*c;g*=a;var u=n*c;n*=a;t*=a;e*=b;c*=b;b*=a;f[0]=1-(u+t);f[1]=h+b;f[2]=g-c;f[3]=h-b;f[4]=1-(d+t);f[5]=n+e;f[6]=g+c;f[7]=n-e;f[8]=1-(d+u);return f};
quat4.toMat4=function(b,f){f||(f=mat4.create());var g=b[0],n=b[1],t=b[2];b=b[3];var e=g+g,c=n+n,a=t+t,d=g*e,h=g*c;g*=a;var u=n*c;n*=a;t*=a;e*=b;c*=b;b*=a;f[0]=1-(u+t);f[1]=h+b;f[2]=g-c;f[3]=0;f[4]=h-b;f[5]=1-(d+t);f[6]=n+e;f[7]=0;f[8]=g+c;f[9]=n-e;f[10]=1-(d+u);f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f};
quat4.slerp=function(b,f,g,n){n||(n=b);var t=b[0]*f[0]+b[1]*f[1]+b[2]*f[2]+b[3]*f[3];if(1<=Math.abs(t))return n!==b&&(n[0]=b[0],n[1]=b[1],n[2]=b[2],n[3]=b[3]),n;var e=Math.acos(t);var c=Math.sqrt(1-t*t);if(.001>Math.abs(c))return n[0]=.5*b[0]+.5*f[0],n[1]=.5*b[1]+.5*f[1],n[2]=.5*b[2]+.5*f[2],n[3]=.5*b[3]+.5*f[3],n;t=Math.sin((1-g)*e)/c;g=Math.sin(g*e)/c;n[0]=b[0]*t+f[0]*g;n[1]=b[1]*t+f[1]*g;n[2]=b[2]*t+f[2]*g;n[3]=b[3]*t+f[3]*g;return n};
quat4.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"};
(function(){function b(a,d,h){this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent);this.height=this.width=0;this.enableFrontToBack=!!h;this.isBatchInEarlyZPass=this.isEarlyZPass=!1;this.currentZ=0;this.zNear=1;this.zFar=1E3;this.zIncrement=(this.zFar-this.zNear)/32768;this.zA=this.zFar/(this.zFar-this.zNear);this.zB=this.zFar*this.zNear/(this.zNear-this.zFar);this.kzA=65536*this.zA;this.kzB=65536*this.zB;this.cam=vec3.create([0,0,100]);this.look=vec3.create([0,0,0]);this.up=
vec3.create([0,1,0]);this.worldScale=vec3.create([1,1,1]);this.enable_mipmaps=!0;this.matP=mat4.create();this.matMV=mat4.create();this.lastMV=mat4.create();this.currentMV=mat4.create();this.gl=a;this.version=0===this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2")?2:1;this.timerExt=null;this.isTiming=!1;this.timerExt=2===this.version?this.gl.getExtension("EXT_disjoint_timer_query_webgl2")||this.gl.getExtension("EXT_disjoint_timer_query"):this.gl.getExtension("EXT_disjoint_timer_query");this.frameNumber=
0;this.timerResults=[];this.initState()}function f(a,d,h){this.gl=a;this.shaderProgram=d;this.name=h;this.locAPos=a.getAttribLocation(d,"aPos");this.locATex=a.getAttribLocation(d,"aTex");this.locMatP=a.getUniformLocation(d,"matP");this.locMatMV=a.getUniformLocation(d,"matMV");this.locOpacity=a.getUniformLocation(d,"opacity");this.locColorFill=a.getUniformLocation(d,"colorFill");this.locSamplerFront=a.getUniformLocation(d,"samplerFront");this.locSamplerBack=a.getUniformLocation(d,"samplerBack");this.locSrcStart=
a.getUniformLocation(d,"srcStart");this.locSrcEnd=a.getUniformLocation(d,"srcEnd");this.locSrcOriginStart=a.getUniformLocation(d,"srcOriginStart");this.locSrcOriginEnd=a.getUniformLocation(d,"srcOriginEnd");this.locLayoutStart=a.getUniformLocation(d,"layoutStart");this.locLayoutEnd=a.getUniformLocation(d,"layoutEnd");this.locDestStart=a.getUniformLocation(d,"destStart");this.locDestEnd=a.getUniformLocation(d,"destEnd");this.locSeconds=a.getUniformLocation(d,"seconds");this.locPixelSize=a.getUniformLocation(d,
"pixelSize");this.locLayerScale=a.getUniformLocation(d,"layerScale");this.locLayerAngle=a.getUniformLocation(d,"layerAngle");this.hasAnyOptionalUniforms=!!(this.locPixelSize||this.locSeconds||this.locSamplerBack||this.locSrcStart||this.locSrcEnd||this.locSrcOriginStart||this.locSrcOriginEnd||this.locLayoutStart||this.locLayoutEnd||this.locDestStart||this.locDestEnd||this.locLayerScale||this.locLayerAngle);this.lpPixelHeight=this.lpPixelWidth=-999;this.lpOpacity=1;this.lpDestStartY=this.lpDestStartX=
this.lpLayoutEndY=this.lpLayoutEndX=this.lpLayoutStartY=this.lpLayoutStartX=this.lpSrcOriginEndY=this.lpSrcOriginEndX=this.lpSrcOriginStartY=this.lpSrcOriginStartX=this.lpSrcEndY=this.lpSrcEndX=this.lpSrcStartY=this.lpSrcStartX=0;this.lpLayerScale=this.lpDestEndY=this.lpDestEndX=1;this.lpSeconds=this.lpLayerAngle=0;this.lastCustomParams=[];this.lpMatMV=mat4.create();this.locOpacity&&a.uniform1f(this.locOpacity,1);this.locColorFill&&a.uniform4f(this.locColorFill,1,1,1,1);this.locSamplerFront&&a.uniform1i(this.locSamplerFront,
0);this.locSamplerBack&&a.uniform1i(this.locSamplerBack,1);this.locSrcStart&&a.uniform2f(this.locSrcStart,0,0);this.locSrcEnd&&a.uniform2f(this.locSrcEnd,1,1);this.locSrcOriginStart&&a.uniform2f(this.locSrcOriginStart,0,0);this.locSrcOriginEnd&&a.uniform2f(this.locSrcOriginEnd,0,0);this.locLayoutStart&&a.uniform2f(this.locLayoutStart,0,0);this.locLayoutEnd&&a.uniform2f(this.locLayoutEnd,0,0);this.locDestStart&&a.uniform2f(this.locDestStart,0,0);this.locDestEnd&&a.uniform2f(this.locDestEnd,1,1);this.locLayerScale&&
a.uniform1f(this.locLayerScale,1);this.locLayerAngle&&a.uniform1f(this.locLayerAngle,0);this.locSeconds&&a.uniform1f(this.locSeconds,0);this.hasCurrentMatMV=!1}function g(a,d){return a[0]===d[0]&&a[1]===d[1]&&a[2]===d[2]&&a[3]===d[3]&&a[4]===d[4]&&a[5]===d[5]&&a[6]===d[6]&&a[7]===d[7]&&a[8]===d[8]&&a[9]===d[9]&&a[10]===d[10]&&a[11]===d[11]&&a[12]===d[12]&&a[13]===d[13]&&a[14]===d[14]&&a[15]===d[15]}function n(a,d){this.type=a;this.glwrap=d;this.gl=d.gl;this.indexCount=this.startIndex=this.opacityParam=
0;this.mat4param=this.texParam=null;this.layoutRect=quat4.create();this.srcOriginRect=quat4.create();this.shaderParams=[];cr.seal(this)}var t=mat4.create();b.prototype.initState=function(){var a=this.gl,d;this.lastOpacity=1;this.lastTexture1=this.lastTexture0=null;this.currentOpacity=1;a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);a.disable(a.CULL_FACE);a.disable(a.STENCIL_TEST);a.disable(a.DITHER);this.enableFrontToBack?(a.enable(a.DEPTH_TEST),
a.depthFunc(a.LEQUAL)):a.disable(a.DEPTH_TEST);this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE);this.lastSrcBlend=a.ONE;this.lastDestBlend=a.ONE_MINUS_SRC_ALPHA;this.vertexData=new Float32Array(8E3*(this.enableFrontToBack?3:2));this.texcoordData=new Float32Array(16E3);this.pointData=new Float32Array(32E3);this.pointBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer);a.bufferData(a.ARRAY_BUFFER,this.pointData.byteLength,a.DYNAMIC_DRAW);this.vertexBuffers=Array(4);this.texcoordBuffers=
Array(4);for(d=0;4>d;d++)this.vertexBuffers[d]=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffers[d]),a.bufferData(a.ARRAY_BUFFER,this.vertexData.byteLength,a.DYNAMIC_DRAW),this.texcoordBuffers[d]=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.texcoordBuffers[d]),a.bufferData(a.ARRAY_BUFFER,this.texcoordData.byteLength,a.DYNAMIC_DRAW);this.curBuffer=0;this.indexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);for(var h=new Uint16Array(12E3),u=d=0;12E3>
d;)h[d++]=u,h[d++]=u+1,h[d++]=u+2,h[d++]=u,h[d++]=u+2,h[d++]=u+3,u+=4;a.bufferData(a.ELEMENT_ARRAY_BUFFER,h,a.STATIC_DRAW);this.pointPtr=this.texPtr=this.vertexPtr=0;this.shaderPrograms=[];d=this.enableFrontToBack?"attribute highp vec3 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, aPos.z, 1.0);\n\tvTex = aTex;\n}":"attribute highp vec2 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tvTex = aTex;\n}";
h=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp float opacity;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, vTex);\n\tgl_FragColor *= opacity;\n}"},d,"<default>");this.shaderPrograms.push(h);h=this.createShaderProgram({src:"uniform mediump sampler2D samplerFront;\nvarying lowp float opacity;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, gl_PointCoord);\n\tgl_FragColor *= opacity;\n}"},"attribute vec4 aPos;\nvarying float opacity;\nuniform mat4 matP;\nuniform mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tgl_PointSize = aPos.z;\n\topacity = aPos.w;\n}",
"<point>");this.shaderPrograms.push(h);h=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tif (texture2D(samplerFront, vTex).a < 1.0)\n\t\tdiscard;\n}"},d,"<earlyz>");this.shaderPrograms.push(h);h=this.createShaderProgram({src:"uniform lowp vec4 colorFill;\nvoid main(void) {\n\tgl_FragColor = colorFill;\n}"},d,"<fill>");this.shaderPrograms.push(h);for(var v in cr.shaders)cr.shaders.hasOwnProperty(v)&&this.shaderPrograms.push(this.createShaderProgram(cr.shaders[v],
d,v));a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,null);this.batch=[];this.batchPtr=0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.currentProgram=this.lastProgram=-1;this.currentShader=null;this.fbo=a.createFramebuffer();this.depthBuffer=this.renderToTex=null;this.attachedDepthBuffer=!1;this.enableFrontToBack&&(this.depthBuffer=a.createRenderbuffer());this.tmpVec3=vec3.create([0,0,0]);a=a.getParameter(a.ALIASED_POINT_SIZE_RANGE);this.minPointSize=a[0];this.maxPointSize=a[1];2048<
this.maxPointSize&&(this.maxPointSize=2048);this.switchProgram(0);cr.seal(this)};f.prototype.updateMatMV=function(a){g(this.lpMatMV,a)||(mat4.set(a,this.lpMatMV),this.gl.uniformMatrix4fv(this.locMatMV,!1,a))};b.prototype.createShaderProgram=function(a,d,h){var u=this.gl,v=u.createShader(u.FRAGMENT_SHADER);u.shaderSource(v,a.src);u.compileShader(v);if(!u.getShaderParameter(v,u.COMPILE_STATUS))throw a=u.getShaderInfoLog(v),u.deleteShader(v),Error("error compiling fragment shader: "+a);var C=u.createShader(u.VERTEX_SHADER);
u.shaderSource(C,d);u.compileShader(C);if(!u.getShaderParameter(C,u.COMPILE_STATUS))throw a=u.getShaderInfoLog(C),u.deleteShader(v),u.deleteShader(C),Error("error compiling vertex shader: "+a);d=u.createProgram();u.attachShader(d,v);u.attachShader(d,C);u.linkProgram(d);if(!u.getProgramParameter(d,u.LINK_STATUS))throw a=u.getProgramInfoLog(d),u.deleteShader(v),u.deleteShader(C),u.deleteProgram(d),Error("error linking shader program: "+a);u.useProgram(d);u.deleteShader(v);u.deleteShader(C);v=new f(u,
d,h);v.extendBoxHorizontal=a.extendBoxHorizontal||0;v.extendBoxVertical=a.extendBoxVertical||0;v.crossSampling=!!a.crossSampling;v.preservesOpaqueness=!!a.preservesOpaqueness;v.animated=!!a.animated;v.parameters=a.parameters||[];a=0;for(C=v.parameters.length;a<C;a++)v.parameters[a][1]=u.getUniformLocation(d,v.parameters[a][0]),v.lastCustomParams.push(0);cr.seal(v);return v};b.prototype.getShaderIndex=function(a){var d;var h=0;for(d=this.shaderPrograms.length;h<d;h++)if(this.shaderPrograms[h].name===
a)return h;return-1};b.prototype.project=function(a,d,h){var u=this.matMV,v=this.matP,C=[0,0,0,0,0,0,0,0];C[0]=u[0]*a+u[4]*d+u[12];C[1]=u[1]*a+u[5]*d+u[13];C[2]=u[2]*a+u[6]*d+u[14];C[3]=u[3]*a+u[7]*d+u[15];C[4]=v[0]*C[0]+v[4]*C[1]+v[8]*C[2]+v[12]*C[3];C[5]=v[1]*C[0]+v[5]*C[1]+v[9]*C[2]+v[13]*C[3];C[6]=v[2]*C[0]+v[6]*C[1]+v[10]*C[2]+v[14]*C[3];C[7]=-C[2];0!==C[7]&&(C[7]=1/C[7],C[4]*=C[7],C[5]*=C[7],C[6]*=C[7],h[0]=(.5*C[4]+.5)*this.width,h[1]=(.5*C[5]+.5)*this.height)};b.prototype.setSize=function(a,
d,h){if(this.width!==a||this.height!==d||h){this.endBatch();h=this.gl;this.width=a;this.height=d;h.viewport(0,0,a,d);mat4.lookAt(this.cam,this.look,this.up,this.matMV);this.enableFrontToBack?(mat4.ortho(-a/2,a/2,d/2,-d/2,this.zNear,this.zFar,this.matP),this.worldScale[0]=1,this.worldScale[1]=1):(mat4.perspective(45,a/d,this.zNear,this.zFar,this.matP),a=[0,0],d=[0,0],this.project(0,0,a),this.project(1,1,d),this.worldScale[0]=1/(d[0]-a[0]),this.worldScale[1]=-1/(d[1]-a[1]));a=0;for(d=this.shaderPrograms.length;a<
d;a++){var u=this.shaderPrograms[a];u.hasCurrentMatMV=!1;u.locMatP&&(h.useProgram(u.shaderProgram),h.uniformMatrix4fv(u.locMatP,!1,this.matP))}h.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram);h.bindTexture(h.TEXTURE_2D,null);h.activeTexture(h.TEXTURE1);h.bindTexture(h.TEXTURE_2D,null);h.activeTexture(h.TEXTURE0);this.lastTexture1=this.lastTexture0=null;this.depthBuffer&&(h.bindFramebuffer(h.FRAMEBUFFER,this.fbo),h.bindRenderbuffer(h.RENDERBUFFER,this.depthBuffer),h.renderbufferStorage(h.RENDERBUFFER,
h.DEPTH_COMPONENT16,this.width,this.height),this.attachedDepthBuffer||(h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,this.depthBuffer),this.attachedDepthBuffer=!0),h.bindRenderbuffer(h.RENDERBUFFER,null),h.bindFramebuffer(h.FRAMEBUFFER,null),this.renderToTex=null)}};b.prototype.resetModelView=function(){mat4.lookAt(this.cam,this.look,this.up,this.matMV);mat4.scale(this.matMV,this.worldScale)};b.prototype.translate=function(a,d){if(0!==a||0!==d)this.tmpVec3[0]=a,this.tmpVec3[1]=
d,this.tmpVec3[2]=0,mat4.translate(this.matMV,this.tmpVec3)};b.prototype.scale=function(a,d){if(1!==a||1!==d)this.tmpVec3[0]=a,this.tmpVec3[1]=d,this.tmpVec3[2]=1,mat4.scale(this.matMV,this.tmpVec3)};b.prototype.rotateZ=function(a){0!==a&&mat4.rotateZ(this.matMV,a)};b.prototype.updateModelView=function(){if(!g(this.lastMV,this.matMV)){var a=this.pushBatch();a.type=5;a.mat4param?mat4.set(this.matMV,a.mat4param):a.mat4param=mat4.create(this.matMV);mat4.set(this.matMV,this.lastMV);this.hasPointBatchTop=
this.hasQuadBatchTop=!1}};b.prototype.setEarlyZIndex=function(a){this.enableFrontToBack&&(32760<a&&(a=32760),this.currentZ=this.cam[2]-this.zNear-a*this.zIncrement)};n.prototype.doSetEarlyZPass=function(){var a=this.gl,d=this.glwrap;0!==this.startIndex?(a.depthMask(!0),a.colorMask(!1,!1,!1,!1),a.disable(a.BLEND),a.bindFramebuffer(a.FRAMEBUFFER,d.fbo),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0),a.clear(a.DEPTH_BUFFER_BIT),a.bindFramebuffer(a.FRAMEBUFFER,null),d.isBatchInEarlyZPass=
!0):(a.depthMask(!1),a.colorMask(!0,!0,!0,!0),a.enable(a.BLEND),d.isBatchInEarlyZPass=!1)};n.prototype.doSetTexture=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texParam)};n.prototype.doSetTexture1=function(){var a=this.gl;a.activeTexture(a.TEXTURE1);a.bindTexture(a.TEXTURE_2D,this.texParam);a.activeTexture(a.TEXTURE0)};n.prototype.doSetOpacity=function(){var a=this.opacityParam,d=this.glwrap;d.currentOpacity=a;d=d.currentShader;d.locOpacity&&d.lpOpacity!==a&&(d.lpOpacity=a,this.gl.uniform1f(d.locOpacity,
a))};n.prototype.doQuad=function(){this.gl.drawElements(this.gl.TRIANGLES,this.indexCount,this.gl.UNSIGNED_SHORT,this.startIndex)};n.prototype.doSetBlend=function(){this.gl.blendFunc(this.startIndex,this.indexCount)};n.prototype.doUpdateModelView=function(){var a,d=this.glwrap.shaderPrograms,h=this.glwrap.currentProgram;var u=0;for(a=d.length;u<a;u++){var v=d[u];u===h&&v.locMatMV?(v.updateMatMV(this.mat4param),v.hasCurrentMatMV=!0):v.hasCurrentMatMV=!1}mat4.set(this.mat4param,this.glwrap.currentMV)};
n.prototype.doRenderToTexture=function(){var a=this.gl,d=this.glwrap;this.texParam?(d.lastTexture1===this.texParam&&(a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,null),d.lastTexture1=null,a.activeTexture(a.TEXTURE0)),a.bindFramebuffer(a.FRAMEBUFFER,d.fbo),d.isBatchInEarlyZPass||a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texParam,0)):(d.enableFrontToBack||a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0),a.bindFramebuffer(a.FRAMEBUFFER,
null))};n.prototype.doClear=function(){var a=this.gl,d=this.startIndex;0===d?(a.clearColor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),a.clear(a.COLOR_BUFFER_BIT)):1===d?(a.enable(a.SCISSOR_TEST),a.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.disable(a.SCISSOR_TEST)):a.clear(a.DEPTH_BUFFER_BIT)};n.prototype.doSetDepthTestEnabled=function(){var a=this.gl;0!==this.startIndex?a.enable(a.DEPTH_TEST):
a.disable(a.DEPTH_TEST)};n.prototype.doPoints=function(){var a=this.gl,d=this.glwrap;d.enableFrontToBack&&a.disable(a.DEPTH_TEST);var h=d.shaderPrograms[1];a.useProgram(h.shaderProgram);!h.hasCurrentMatMV&&h.locMatMV&&(h.updateMatMV(d.currentMV),h.hasCurrentMatMV=!0);a.enableVertexAttribArray(h.locAPos);a.bindBuffer(a.ARRAY_BUFFER,d.pointBuffer);a.vertexAttribPointer(h.locAPos,4,a.FLOAT,!1,0,0);a.drawArrays(a.POINTS,this.startIndex/4,this.indexCount);h=d.currentShader;a.useProgram(h.shaderProgram);
0<=h.locAPos&&(a.enableVertexAttribArray(h.locAPos),a.bindBuffer(a.ARRAY_BUFFER,d.vertexBuffers[d.curBuffer]),a.vertexAttribPointer(h.locAPos,d.enableFrontToBack?3:2,a.FLOAT,!1,0,0));0<=h.locATex&&(a.enableVertexAttribArray(h.locATex),a.bindBuffer(a.ARRAY_BUFFER,d.texcoordBuffers[d.curBuffer]),a.vertexAttribPointer(h.locATex,2,a.FLOAT,!1,0,0));d.enableFrontToBack&&a.enable(a.DEPTH_TEST)};n.prototype.doSetProgram=function(){var a=this.gl,d=this.glwrap,h=d.shaderPrograms[this.startIndex];d.currentProgram=
this.startIndex;d.currentShader=h;a.useProgram(h.shaderProgram);!h.hasCurrentMatMV&&h.locMatMV&&(h.updateMatMV(d.currentMV),h.hasCurrentMatMV=!0);h.locOpacity&&h.lpOpacity!==d.currentOpacity&&(h.lpOpacity=d.currentOpacity,a.uniform1f(h.locOpacity,d.currentOpacity));0<=h.locAPos&&(a.enableVertexAttribArray(h.locAPos),a.bindBuffer(a.ARRAY_BUFFER,d.vertexBuffers[d.curBuffer]),a.vertexAttribPointer(h.locAPos,d.enableFrontToBack?3:2,a.FLOAT,!1,0,0));0<=h.locATex&&(a.enableVertexAttribArray(h.locATex),
a.bindBuffer(a.ARRAY_BUFFER,d.texcoordBuffers[d.curBuffer]),a.vertexAttribPointer(h.locATex,2,a.FLOAT,!1,0,0))};n.prototype.doSetColor=function(){var a=this.mat4param;this.gl.uniform4f(this.glwrap.currentShader.locColorFill,a[0],a[1],a[2],a[3])};n.prototype.doSetProgramParameters=function(){var a=this.glwrap.currentShader,d=this.gl;var h=this.mat4param;var u=this.layoutRect;var v=this.srcOriginRect;a.locSamplerBack&&this.glwrap.lastTexture1!==this.texParam&&(d.activeTexture(d.TEXTURE1),d.bindTexture(d.TEXTURE_2D,
this.texParam),this.glwrap.lastTexture1=this.texParam,d.activeTexture(d.TEXTURE0));var C=h[0],w=h[1];!a.locPixelSize||C===a.lpPixelWidth&&w===a.lpPixelHeight||(a.lpPixelWidth=C,a.lpPixelHeight=w,d.uniform2f(a.locPixelSize,C,w));C=h[2];w=h[3];!a.locDestStart||C===a.lpDestStartX&&w===a.lpDestStartY||(a.lpDestStartX=C,a.lpDestStartY=w,d.uniform2f(a.locDestStart,C,w));C=h[4];w=h[5];!a.locDestEnd||C===a.lpDestEndX&&w===a.lpDestEndY||(a.lpDestEndX=C,a.lpDestEndY=w,d.uniform2f(a.locDestEnd,C,w));C=h[6];
a.locLayerScale&&C!==a.lpLayerScale&&(a.lpLayerScale=C,d.uniform1f(a.locLayerScale,C));C=h[7];a.locLayerAngle&&C!==a.lpLayerAngle&&(a.lpLayerAngle=C,d.uniform1f(a.locLayerAngle,C));C=h[12];w=h[13];!a.locSrcStart||C===a.lpSrcStartX&&w===a.lpSrcStartY||(a.lpSrcStartX=C,a.lpSrcStartY=w,d.uniform2f(a.locSrcStart,C,w));C=h[14];w=h[15];!a.locSrcEnd||C===a.lpSrcEndX&&w===a.lpSrcEndY||(a.lpSrcEndX=C,a.lpSrcEndY=w,d.uniform2f(a.locSrcEnd,C,w));C=v[0];w=v[1];!a.locSrcOriginStart||C===a.lpSrcOriginStartX&&w===
a.lpSrcOriginStartY||(a.lpSrcOriginStartX=C,a.lpSrcOriginStartY=w,d.uniform2f(a.locSrcOriginStart,C,w));C=v[2];w=v[3];!a.locSrcOriginEnd||C===a.lpSrcOriginEndX&&w===a.lpSrcOriginEndY||(a.lpSrcOriginEndX=C,a.lpSrcOriginEndY=w,d.uniform2f(a.locSrcOriginEnd,C,w));C=u[0];w=u[1];!a.locLayoutStart||C===a.lpLayoutStartX&&w===a.lpLayoutStartY||(a.lpLayoutStartX=C,a.lpLayoutStartY=w,d.uniform2f(a.locLayoutStart,C,w));C=u[2];w=u[3];!a.locLayoutEnd||C===a.lpLayoutEndX&&w===a.lpLayoutEndY||(a.lpLayoutEndX=C,
a.lpLayoutEndY=w,d.uniform2f(a.locLayoutEnd,C,w));C=this.startIndex;a.locSeconds&&C!==a.lpSeconds&&(a.lpSeconds=C,d.uniform1f(a.locSeconds,C));if(a.parameters.length)for(h=0,u=a.parameters.length;h<u;h++)C=this.shaderParams[h],Array.isArray(C)?d.uniform3fv(a.parameters[h][1],C):C!==a.lastCustomParams[h]&&(a.lastCustomParams[h]=C,d.uniform1f(a.parameters[h][1],C))};b.prototype.pushBatch=function(){this.batchPtr===this.batch.length&&this.batch.push(new n(0,this));return this.batch[this.batchPtr++]};
b.prototype.endBatch=function(){if(0!==this.batchPtr&&!this.gl.isContextLost()){this.maybeStartTiming();var a=this.gl;0<this.pointPtr&&(a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,this.pointData.subarray(0,this.pointPtr)),d&&0<=d.locAPos&&"<point>"===d.name&&a.vertexAttribPointer(d.locAPos,4,a.FLOAT,!1,0,0));if(0<this.vertexPtr){var d=this.currentShader;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffers[this.curBuffer]);a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexData.subarray(0,
this.vertexPtr));d&&0<=d.locAPos&&"<point>"!==d.name&&a.vertexAttribPointer(d.locAPos,this.enableFrontToBack?3:2,a.FLOAT,!1,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.texcoordBuffers[this.curBuffer]);a.bufferSubData(a.ARRAY_BUFFER,0,this.texcoordData.subarray(0,this.texPtr));d&&0<=d.locATex&&"<point>"!==d.name&&a.vertexAttribPointer(d.locATex,2,a.FLOAT,!1,0,0)}a=0;for(d=this.batchPtr;a<d;a++){var h=this.batch[a];switch(h.type){case 1:h.doQuad();break;case 2:h.doSetTexture();break;case 3:h.doSetOpacity();
break;case 4:h.doSetBlend();break;case 5:h.doUpdateModelView();break;case 6:h.doRenderToTexture();break;case 7:h.doClear();break;case 8:h.doPoints();break;case 9:h.doSetProgram();break;case 10:h.doSetProgramParameters();break;case 11:h.doSetTexture1();break;case 12:h.doSetColor();break;case 13:h.doSetDepthTestEnabled();break;case 14:h.doSetEarlyZPass()}}this.pointPtr=this.texPtr=this.vertexPtr=this.batchPtr=0;this.isBatchInEarlyZPass=this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.curBuffer++;
4<=this.curBuffer&&(this.curBuffer=0)}};b.prototype.maybeStartTiming=function(){if(!this.isTiming&&this.timerExt){this.isTiming=!0;var a={frameNumber:this.frameNumber,query:null,result:0};2===this.version?(a.query=this.gl.createQuery(),this.gl.beginQuery(this.timerExt.TIME_ELAPSED_EXT,a.query)):(a.query=this.timerExt.createQueryEXT(),this.timerExt.beginQueryEXT(this.timerExt.TIME_ELAPSED_EXT,a.query));this.timerResults.push(a);1E3<this.timerResults.length&&(a=this.timerResults.shift(),a.query&&(2===
this.version?this.gl.deleteQuery(a.query):this.timerExt.deleteQueryEXT(a.query)))}};b.prototype.maybeFinishTiming=function(){this.isTiming&&this.timerResults.length&&(2===this.version?this.gl.endQuery(this.timerExt.TIME_ELAPSED_EXT):this.timerExt.endQueryEXT(this.timerExt.TIME_ELAPSED_EXT),this.isTiming=!1)};b.prototype.checkForTimerResults=function(a){var d;var h=0;for(d=this.timerResults.length;h<d;++h){var u=this.timerResults[h];if(u.frameNumber>=a)break;if(u.query){var v=2===this.version?this.gl.getQueryParameter(u.query,
this.gl.QUERY_RESULT_AVAILABLE):this.timerExt.getQueryObjectEXT(u.query,this.timerExt.QUERY_RESULT_AVAILABLE_EXT);var C=this.gl.getParameter(this.timerExt.GPU_DISJOINT_EXT);v&&!C&&(u.result=2===this.version?this.gl.getQueryParameter(u.query,this.gl.QUERY_RESULT):this.timerExt.getQueryObjectEXT(u.query,this.timerExt.QUERY_RESULT_EXT),u.result/=1E9);if(v||C)2===this.version?this.gl.deleteQuery(u.query):this.timerExt.deleteQueryEXT(u.query),u.query=null}}};b.prototype.getFrameRangeTimerResults=function(a,
d){if(d<=a)return-1;var h,u=0,v=0;var C=0;for(h=this.timerResults.length;C<h;++C){var w=this.timerResults[C];if(w.frameNumber>=d)break;if(w.frameNumber>=a){if(w.query)return-1;u+=w.result;v++}}return v<d-a?-1:u};b.prototype.deleteTimerResultsToFrame=function(a){var d;var h=0;for(d=this.timerResults.length;h<d;++h){var u=this.timerResults[h];if(u.frameNumber>=a){0<h&&this.timerResults.splice(0,h);break}}};b.prototype.setOpacity=function(a){if(a!==this.lastOpacity&&!this.isEarlyZPass){var d=this.pushBatch();
d.type=3;this.lastOpacity=d.opacityParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.setTexture=function(a){if(a!==this.lastTexture0){var d=this.pushBatch();d.type=2;this.lastTexture0=d.texParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.setBlend=function(a,d){if((a!==this.lastSrcBlend||d!==this.lastDestBlend)&&!this.isEarlyZPass){var h=this.pushBatch();h.type=4;h.startIndex=a;h.indexCount=d;this.lastSrcBlend=a;this.lastDestBlend=d;this.hasPointBatchTop=this.hasQuadBatchTop=
!1}};b.prototype.isPremultipliedAlphaBlend=function(){return this.lastSrcBlend===this.gl.ONE&&this.lastDestBlend===this.gl.ONE_MINUS_SRC_ALPHA};b.prototype.setAlphaBlend=function(){this.setBlend(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)};b.prototype.setNoPremultiplyAlphaBlend=function(){this.setBlend(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};b.prototype.quad=function(a,d,h,u,v,C,w,r){15992<=this.vertexPtr&&this.endBatch();var x=this.vertexPtr,A=this.texPtr,l=this.vertexData,y=this.texcoordData,
z=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var O=this.pushBatch();O.type=1;O.startIndex=this.enableFrontToBack?x:x/2*3;O.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(l[x++]=a,l[x++]=d,l[x++]=z,l[x++]=h,l[x++]=u,l[x++]=z,l[x++]=v,l[x++]=C,l[x++]=z,l[x++]=w,l[x++]=r,l[x++]=z):(l[x++]=a,l[x++]=d,l[x++]=h,l[x++]=u,l[x++]=v,l[x++]=C,l[x++]=w,l[x++]=r);y[A++]=0;y[A++]=0;y[A++]=1;y[A++]=0;y[A++]=1;y[A++]=1;y[A++]=0;y[A++]=
1;this.vertexPtr=x;this.texPtr=A};b.prototype.quadTex=function(a,d,h,u,v,C,w,r,x){15992<=this.vertexPtr&&this.endBatch();var A=this.vertexPtr,l=this.texPtr,y=this.vertexData,z=this.texcoordData,O=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var Q=this.pushBatch();Q.type=1;Q.startIndex=this.enableFrontToBack?A:A/2*3;Q.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}Q=x.left;var I=x.top,k=x.right;x=x.bottom;this.enableFrontToBack?(y[A++]=a,y[A++]=
d,y[A++]=O,y[A++]=h,y[A++]=u,y[A++]=O,y[A++]=v,y[A++]=C,y[A++]=O,y[A++]=w,y[A++]=r,y[A++]=O):(y[A++]=a,y[A++]=d,y[A++]=h,y[A++]=u,y[A++]=v,y[A++]=C,y[A++]=w,y[A++]=r);z[l++]=Q;z[l++]=I;z[l++]=k;z[l++]=I;z[l++]=k;z[l++]=x;z[l++]=Q;z[l++]=x;this.vertexPtr=A;this.texPtr=l};b.prototype.quadTexUV=function(a,d,h,u,v,C,w,r,x,A,l,y,z,O,Q,I){15992<=this.vertexPtr&&this.endBatch();var k=this.vertexPtr,p=this.texPtr,H=this.vertexData,m=this.texcoordData,E=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-
1].indexCount+=6;else{var L=this.pushBatch();L.type=1;L.startIndex=this.enableFrontToBack?k:k/2*3;L.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(H[k++]=a,H[k++]=d,H[k++]=E,H[k++]=h,H[k++]=u,H[k++]=E,H[k++]=v,H[k++]=C,H[k++]=E,H[k++]=w,H[k++]=r,H[k++]=E):(H[k++]=a,H[k++]=d,H[k++]=h,H[k++]=u,H[k++]=v,H[k++]=C,H[k++]=w,H[k++]=r);m[p++]=x;m[p++]=A;m[p++]=l;m[p++]=y;m[p++]=z;m[p++]=O;m[p++]=Q;m[p++]=I;this.vertexPtr=k;this.texPtr=p};b.prototype.convexPoly=function(a){var d=
a.length/2-2,h=d-1,u=a[0],v=a[1],C;for(C=0;C<d;C+=2){var w=2*C;var r=a[w+2];var x=a[w+3];var A=a[w+4];var l=a[w+5];if(C===h)this.quad(u,v,r,x,A,l,A,l);else{var y=a[w+6];w=a[w+7];this.quad(u,v,r,x,A,l,y,w)}}};b.prototype.point=function(a,d,h,u){7996<=this.pointPtr&&this.endBatch();var v=this.pointPtr,C=this.pointData;if(this.hasPointBatchTop)this.batch[this.batchPtr-1].indexCount++;else{var w=this.pushBatch();w.type=8;w.startIndex=v;w.indexCount=1;this.hasPointBatchTop=!0;this.hasQuadBatchTop=!1}C[v++]=
a;C[v++]=d;C[v++]=h;C[v++]=u;this.pointPtr=v};b.prototype.switchProgram=function(a){if(this.lastProgram!==a){if(!this.shaderPrograms[a]){if(0===this.lastProgram)return;a=0}var d=this.pushBatch();d.type=9;this.lastProgram=d.startIndex=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.programUsesDest=function(a){a=this.shaderPrograms[a];return!(!a.locDestStart&&!a.locDestEnd)};b.prototype.programUsesCrossSampling=function(a){a=this.shaderPrograms[a];return!!(a.locDestStart||a.locDestEnd||
a.crossSampling)};b.prototype.programPreservesOpaqueness=function(a){return this.shaderPrograms[a].preservesOpaqueness};b.prototype.programExtendsBox=function(a){a=this.shaderPrograms[a];return 0!==a.extendBoxHorizontal||0!==a.extendBoxVertical};b.prototype.getProgramBoxExtendHorizontal=function(a){return this.shaderPrograms[a].extendBoxHorizontal};b.prototype.getProgramBoxExtendVertical=function(a){return this.shaderPrograms[a].extendBoxVertical};b.prototype.getProgramParameterType=function(a,d){return this.shaderPrograms[a].parameters[d][2]};
b.prototype.programIsAnimated=function(a){return this.shaderPrograms[a].animated};b.prototype.setProgramParameters=function(a,d,h,u,v,C,w,r,x,A,l,y,z,O,Q,I,k,p,H,m,E,L,N){var V=this.shaderPrograms[this.lastProgram];if(V.hasAnyOptionalUniforms||N.length){var W=this.pushBatch();W.type=10;W.mat4param?mat4.set(this.matMV,W.mat4param):W.mat4param=mat4.create();var X=W.mat4param;X[0]=d;X[1]=h;X[2]=I;X[3]=k;X[4]=p;X[5]=H;X[6]=m;X[7]=E;X[12]=u;X[13]=v;X[14]=C;X[15]=w;d=W.srcOriginRect;d[0]=r;d[1]=x;d[2]=
A;d[3]=l;r=W.layoutRect;r[0]=y;r[1]=Q;r[2]=O;r[3]=z;W.startIndex=L;W.texParam=V.locSamplerBack?a:null;if(N.length)for(z=W.shaderParams,z.length=N.length,a=0,y=N.length;a<y;a++)z[a]=N[a];this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.clear=function(a,d,h,u){var v=this.pushBatch();v.type=7;v.startIndex=0;v.mat4param||(v.mat4param=mat4.create());v.mat4param[0]=a;v.mat4param[1]=d;v.mat4param[2]=h;v.mat4param[3]=u;this.hasPointBatchTop=this.hasQuadBatchTop=!1};b.prototype.clearRect=function(a,
d,h,u){if(!(0>h||0>u)){var v=this.pushBatch();v.type=7;v.startIndex=1;v.mat4param||(v.mat4param=mat4.create());v.mat4param[0]=a;v.mat4param[1]=d;v.mat4param[2]=h;v.mat4param[3]=u;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.clearDepth=function(){var a=this.pushBatch();a.type=7;a.startIndex=2;this.hasPointBatchTop=this.hasQuadBatchTop=!1};b.prototype.setEarlyZPass=function(a){if(this.enableFrontToBack&&(a=!!a,this.isEarlyZPass!==a)){var d=this.pushBatch();d.type=14;d.startIndex=a?1:
0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.isEarlyZPass=a;this.renderToTex=null;this.isEarlyZPass?this.switchProgram(2):this.switchProgram(0)}};b.prototype.setDepthTestEnabled=function(a){if(this.enableFrontToBack){var d=this.pushBatch();d.type=13;d.startIndex=a?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.fullscreenQuad=function(){mat4.set(this.lastMV,t);this.resetModelView();this.updateModelView();var a=this.width/2,d=this.height/2;this.quad(-a,d,a,d,a,-d,-a,-d);mat4.set(t,
this.matMV);this.updateModelView()};b.prototype.setColorFillMode=function(a,d,h,u){this.switchProgram(3);var v=this.pushBatch();v.type=12;v.mat4param||(v.mat4param=mat4.create());v.mat4param[0]=a;v.mat4param[1]=d;v.mat4param[2]=h;v.mat4param[3]=u;this.hasPointBatchTop=this.hasQuadBatchTop=!1};b.prototype.setTextureFillMode=function(){this.switchProgram(0)};b.prototype.restoreEarlyZMode=function(){this.switchProgram(2)};b.prototype.getFrameNumber=function(){return this.frameNumber};b.prototype.present=
function(){this.endBatch();this.maybeFinishTiming();this.gl.flush();this.checkForTimerResults(this.frameNumber);this.frameNumber++};b.prototype.supportsGpuProfiling=function(){return!!this.timerExt};var e=[],c={};b.prototype.contextLost=function(){cr.clearArray(e);c={}};b.prototype.loadTexture=function(a,d,h,u,v,C){d=!!d;h=!!h;var w=a.src+","+d+","+h+(d?","+v:"");if("undefined"!==typeof a.src&&c.hasOwnProperty(w)){var r=c[w];r.c2refcount++;return r}this.endBatch();var x=this.gl,A=cr.isPOT(a.width)&&
cr.isPOT(a.height);r=x.createTexture();x.bindTexture(x.TEXTURE_2D,r);x.pixelStorei(x.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var l=x.RGBA,y=x.RGBA,z=x.UNSIGNED_BYTE;if(u&&!this.isIE)switch(u){case 1:y=l=x.RGB;break;case 2:z=x.UNSIGNED_SHORT_4_4_4_4;break;case 3:z=x.UNSIGNED_SHORT_5_5_5_1;break;case 4:y=l=x.RGB,z=x.UNSIGNED_SHORT_5_6_5}if(1===this.version&&!A&&d){u=document.createElement("canvas");u.width=cr.nextHighestPowerOfTwo(a.width);u.height=cr.nextHighestPowerOfTwo(a.height);var O=u.getContext("2d");
O.imageSmoothingEnabled=h;O.drawImage(a,0,0,a.width,a.height,0,0,u.width,u.height);x.texImage2D(x.TEXTURE_2D,0,l,y,z,u)}else x.texImage2D(x.TEXTURE_2D,0,l,y,z,a);d?"repeat-x"===v?(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.REPEAT),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE)):("repeat-y"===v?x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE):x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.REPEAT),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.REPEAT)):(x.texParameteri(x.TEXTURE_2D,
x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE));h?(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR),(A||2<=this.version)&&this.enable_mipmaps&&!C?(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR_MIPMAP_LINEAR),x.generateMipmap(x.TEXTURE_2D)):x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR)):(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.NEAREST));x.bindTexture(x.TEXTURE_2D,
null);this.lastTexture0=null;r.c2width=a.width;r.c2height=a.height;r.c2refcount=1;r.c2texkey=w;e.push(r);return c[w]=r};b.prototype.createEmptyTexture=function(a,d,h,u,v){this.endBatch();var C=this.gl;this.isIE&&(u=!1);var w=C.createTexture();C.bindTexture(C.TEXTURE_2D,w);C.texImage2D(C.TEXTURE_2D,0,C.RGBA,a,d,0,C.RGBA,u?C.UNSIGNED_SHORT_4_4_4_4:C.UNSIGNED_BYTE,null);v?(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,C.REPEAT),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.REPEAT)):(C.texParameteri(C.TEXTURE_2D,
C.TEXTURE_WRAP_S,C.CLAMP_TO_EDGE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.CLAMP_TO_EDGE));C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,h?C.LINEAR:C.NEAREST);C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,h?C.LINEAR:C.NEAREST);C.bindTexture(C.TEXTURE_2D,null);this.lastTexture0=null;w.c2width=a;w.c2height=d;e.push(w);return w};b.prototype.videoToTexture=function(a,d,h){this.endBatch();var u=this.gl;this.isIE&&(h=!1);u.bindTexture(u.TEXTURE_2D,d);u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
!0);try{u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,h?u.UNSIGNED_SHORT_4_4_4_4:u.UNSIGNED_BYTE,a)}catch(v){console&&console.error&&console.error("Error updating WebGL texture: ",v)}u.bindTexture(u.TEXTURE_2D,null);this.lastTexture0=null};b.prototype.deleteTexture=function(a){a&&("undefined"!==typeof a.c2refcount&&1<a.c2refcount?a.c2refcount--:(this.endBatch(),a===this.lastTexture0&&(this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.lastTexture0=null),a===this.lastTexture1&&(this.gl.activeTexture(this.gl.TEXTURE1),
this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture1=null),cr.arrayFindRemove(e,a),"undefined"!==typeof a.c2texkey&&delete c[a.c2texkey],this.gl.deleteTexture(a)))};b.prototype.estimateVRAM=function(){var a=this.width*this.height*8,d;var h=0;for(d=e.length;h<d;h++){var u=e[h];a+=u.c2width*u.c2height*4}return a};b.prototype.textureCount=function(){return e.length};b.prototype.setRenderingToTexture=function(a){if(a!==this.renderToTex){var d=this.pushBatch();
d.type=6;this.renderToTex=d.texParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};cr.GLWrap=b})();
(function(){function b(q){var B=q.canvas,G=q.projectDataUrl;B||(B=document.createElement("canvas"),document.body.appendChild(B));if(B&&B.getContext){window.c3runtime=this;window.c3canvas=B;var J=this;this.exportType=q.exportType;this.isPreview="preview"===this.exportType;this.isRemotePreview=!!q.isRemotePreview;this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!("undefined"===typeof window.c2isCrosswalk||!window.c2isCrosswalk);this.isPhoneGap=this.isCordova=
"cordova"===this.exportType;this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent);this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge;this.isTizen=/tizen/i.test(navigator.userAgent);this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge;this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;
this.isiPad=/ipad/i.test(navigator.userAgent);this.isiOS=this.isiPhone||this.isiPad;this.isChrome=(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent);this.isFirefox=/firefox/i.test(navigator.userAgent);this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&!this.isIE&&!this.isMicrosoftEdge;this.isWindows=/windows/i.test(navigator.userAgent);this.isNodeWebkit=
this.isNWjs="nwjs"===this.exportType||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent);this.isArcade="scirra-arcade"===this.exportType;this.isWindows8App=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.isWindowsPhone8=!("undefined"===typeof window.c2isWindowsPhone8||!window.c2isWindowsPhone8);this.isWindowsPhone81=!("undefined"===typeof window.c2isWindowsPhone81||!window.c2isWindowsPhone81);this.isWindows10="windows-uwp"===this.exportType;this.isWinJS=
this.isWindows8App||this.isWindowsPhone81||this.isWindows10;this.isBlackberry10=!("undefined"===typeof window.c2isBlackberry10||!window.c2isBlackberry10);this.isAndroidStockBrowser=this.isAndroid&&!this.isChrome&&!this.isCrosswalk&&!this.isFirefox&&!this.isAmazonWebApp;this.devicePixelRatio=1;this.isMobile=this.isCordova||this.isCrosswalk||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen;this.isMobile||(this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent));
this.isWKWebView=!(!this.isiOS||!this.isCordova);this.isPreview&&!this.isNWjs&&("?nw"===window.location.search||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent))&&(this.isNWjs=!0);this.isDebug=this.isPreview&&-1<window.location.search.indexOf("debug");this.useFbInstant="undefined"!==typeof FBInstant&&!this.isPreview&&!this.isCordova;this.hasInitialized=!1;this.canvas=B;this.glwrap=this.gl=null;this.glUnmaskedRenderer="(unavailable)";this.enableFrontToBack=!1;this.earlyz_index=
0;this.ctx=null;this.firstInFullscreen=!1;this.oldHeight=this.oldWidth=0;this.canvas.oncontextmenu=function(F){F.preventDefault&&F.preventDefault();return!1};this.canvas.onselectstart=function(F){F.preventDefault&&F.preventDefault();return!1};this.canvas.ontouchstart=function(F){F.preventDefault&&F.preventDefault();return!1};this.isNWjs&&(window.ondragover=function(F){F.preventDefault();return!1},window.ondrop=function(F){F.preventDefault();return!1},window.nwgui&&window.nwgui.App.clearCache&&window.nwgui.App.clearCache());
if(this.isCordova&&this.isiOS){function F(){var M=document.activeElement;if(!M)return!1;var S=M.tagName.toLowerCase(),T="email number password search tel text url".split(" ");if("textarea"===S)return!0;if("input"===S)return-1<T.indexOf(M.type.toLowerCase()||"text");a:{do{if(M.parentNode&&M.hasAttribute("contenteditable")){M=!0;break a}M=M.parentNode}while(M);M=!1}return M}window.addEventListener("focusout",function(){F()||(document.scrollingElement.scrollTop=0)})}this.projectDataUrl=G||"";this.width=
B.width;this.height=B.height;this.draw_width=this.width;this.draw_height=this.height;this.cssWidth=this.width;this.cssHeight=this.height;this.lastWindowWidth=window.innerWidth;this.lastWindowHeight=window.innerHeight;this.forceCanvasAlpha=!1;this.redraw=!0;this.isSuspended=!1;Date.now||(Date.now=function(){return+new Date});this.plugins=[];this.types={};this.types_lowercase={};this.types_by_index=[];this.behaviors=[];this.layouts={};this.layouts_by_index=[];this.eventsheets={};this.eventsheets_by_index=
[];this.wait_for_textures=[];this.triggers_to_postinit=[];this.all_global_vars=[];this.all_local_vars=[];this.shadowcasterBehavior=this.jumpthruBehavior=this.solidBehavior=null;this.deathRow={};this.isInClearDeathRow=this.hasPendingInstances=!1;this.isInOnDestroy=0;this.isEndingLayout=this.isRunningEvents=!1;this.createRow=[];this.isLoadingState=!1;this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null;this.lastSaveJson="";this.suspendDrawing=this.signalledContinuousPreview=!1;this.fireOnCreateAfterLoad=
[];this.dt1=this.dt=0;this.minimumFramerate=30;this.cpuutilisation=this.logictime=0;this.timescale=1;this.kahanTime=new cr.KahanAdder;this.wallTime=new cr.KahanAdder;this.gpuTimeEndFrame=this.gpuTimeStartFrame=this.objectcount=this.framecount=this.execcount=this.tickcount_nosave=this.tickcount=this.last_fps_time=this.fps=this.last_tick_time=0;this.gpuCurUtilisation=-1;this.gpuLastUtilisation=0;this.changelayout=null;this.destroycallbacks=[];this.event_stack=[];this.event_stack_index=-1;this.localvar_stack=
[[]];this.trigger_depth=this.localvar_stack_index=0;this.pushEventStack(null);this.loop_stack=[];this.loop_stack_index=-1;this.next_puid=this.next_uid=0;this.layout_first_tick=!0;this.family_count=0;this.suspend_events=[];this.timeout_id=this.raf_id=-1;this.isloading=!0;this.stackLocalCount=this.loadingprogress=0;this.audioInstance=null;this.isInUserInputEvent=this.had_a_click=!1;this.objects_to_pretick=new cr.ObjectSet;this.objects_to_tick=new cr.ObjectSet;this.objects_to_tick2=new cr.ObjectSet;
this.registered_collisions=[];this.temp_poly=new cr.CollisionPoly([]);this.temp_poly2=new cr.CollisionPoly([]);this.allGroups=[];this.groups_by_name={};this.cndsBySid={};this.actsBySid={};this.varsBySid={};this.blocksBySid={};this.layout_ctx=this.layout_canvas=this.layout_tex=this.layer_tex=this.layer_ctx=this.layer_canvas=this.running_layout=null;this.uses_background_blending=this.is_WebGL_context_lost=!1;this.fx_tex=[null,null];this.fullscreen_scaling=0;this.files_subfolder="";this.objectsByUid=
{};this.webFontNames=this.loaderlogos=null;this.enhancedAccelerationPrecision=!0;this.snapshotCanvas=null;this.snapshotData="";this.objectRefTable=[];"html5"===this.exportType&&"file"===location.protocol.substr(0,4)&&alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)");this.useFbInstant?(FBInstant.initializeAsync().then(function(){J.requestProjectData()}).catch(function(F){console.warn("[Instant Games] Unable to load: ",
F);J.requestProjectData()}),window.setTimeout(function(){J.hasInitialized||(console.warn("[Instant Games] Initialization timed out after 4 seconds. Continuing with Instant Games disabled."),J.useFbInstant=!1,J.requestProjectData())},4E3)):this.requestProjectData()}}function f(){var q=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;"object"!==typeof q&&Promise.reject("Permission API is not loaded");return Promise.resolve(q)}function g(q){return f().then(function(B){return new Promise(function(G,
J){B.requestPermission(B[q],function(F){G(F.hasPermission)},J)})})}function n(q){return f().then(function(B){return new Promise(function(G,J){B.checkPermission(B[q],function(F){G(F.hasPermission)},J)})})}function t(){try{return!!window.indexedDB}catch(q){return!1}}function e(q){q.target.result.createObjectStore("saves",{keyPath:"slot"})}function c(q,B,G,J){try{var F=indexedDB.open("_C2SaveStates");F.onupgradeneeded=e;F.onerror=J;F.onsuccess=function(M){M=M.target.result;M.onerror=J;M.transaction(["saves"],
"readwrite").objectStore("saves").put({slot:q,data:B}).onsuccess=G}}catch(M){J(M)}}function a(q,B,G){try{var J=indexedDB.open("_C2SaveStates");J.onupgradeneeded=e;J.onerror=G;J.onsuccess=function(F){F=F.target.result;F.onerror=G;var M=F.transaction(["saves"]).objectStore("saves").get(q);M.onsuccess=function(S){M.result?B(M.result.data):B(null)}}}catch(F){G(F)}}function d(){cr.logexport("Reloading for continuous preview");-1<window.location.search.indexOf("continuous")?window.location.reload(!0):window.location+=
"?continuous"}function h(q){var B,G={};for(B in q)!q.hasOwnProperty(B)||q[B]instanceof cr.ObjectSet||q[B]&&"undefined"!==typeof q[B].c2userdata||"spriteCreatedDestroyCallback"!==B&&(G[B]=q[B]);return G}var u=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,v=new Audio,C={"audio/webm; codecs=opus":!!v.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!v.canPlayType("audio/ogg; codecs=opus"),
"audio/webm; codecs=vorbis":!!v.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!v.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!v.canPlayType("audio/mp4"),"audio/mpeg":!!v.canPlayType("audio/mpeg")};v=null;b.prototype.requestProjectData=function(){if(!this.hasInitialized){this.hasInitialized=!0;var q=this;if(this.isWKWebView)this.fetchLocalFileViaCordovaAsText("data.js",function(F){q.loadProject(JSON.parse(F))},function(F){alert("Error fetching data.js")});else{var B=
this.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;var G=this.projectDataUrl||"data.js";if(this.isWindows8App||this.isWindowsPhone8||this.isWindowsPhone81||this.isWindows10)G="data.json";B.open("GET",G,!0);var J=!1;if("response"in B&&"responseType"in B)try{B.responseType="json",J="json"===B.responseType}catch(F){J=!1}if(!J&&"responseType"in B)try{B.responseType="text"}catch(F){}if("overrideMimeType"in B)try{B.overrideMimeType("application/json; charset=utf-8")}catch(F){}this.isWindowsPhone8?
B.onreadystatechange=function(){4===B.readyState&&q.loadProject(JSON.parse(B.responseText))}:(B.onload=function(){J?q.loadProject(B.response):q.loadProject(JSON.parse(B.responseText))},B.onerror=function(F){cr.logerror("Error requesting "+G+":");cr.logerror(F)});B.send()}}};b.prototype.initRendererAndLoader=function(){var q=this,B,G;this.isRetina=this.useHighDpi&&!this.isAndroidStockBrowser;0===this.fullscreen_mode&&this.isiOS&&(this.isRetina=!1);var J=window.devicePixelRatio||window.webkitDevicePixelRatio||
window.mozDevicePixelRatio||window.msDevicePixelRatio||1;this.devicePixelRatio=this.isRetina?J:1;"object"===typeof window.StatusBar&&window.StatusBar.hide();"object"===typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode();this.ClearDeathRow();0<this.fullscreen_mode&&this.setSize(window.innerWidth,window.innerHeight,!0);try{if(this.enableWebGL){var F={alpha:!0,depth:!1,antialias:!1,failIfMajorPerformanceCaveat:!0};this.isAndroid||(this.gl=this.canvas.getContext("webgl2",F));this.gl||
(this.gl=this.canvas.getContext("webgl",F)||this.canvas.getContext("experimental-webgl",F))}}catch(ba){}if(this.gl){this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2");if(J=this.gl.getExtension("WEBGL_debug_renderer_info"))F=this.gl.getParameter(J.UNMASKED_VENDOR_WEBGL),this.glUnmaskedRenderer=this.gl.getParameter(J.UNMASKED_RENDERER_WEBGL)+" ["+F+"]";this.enableFrontToBack&&(this.glUnmaskedRenderer+=" [front-to-back enabled]");this.overlay_canvas=document.createElement("canvas");this.canvas.parentNode.appendChild(this.overlay_canvas);
this.overlay_canvas.oncontextmenu=function(ba){return!1};this.overlay_canvas.onselectstart=function(ba){return!1};this.overlay_canvas.width=Math.round(this.cssWidth*this.devicePixelRatio);this.overlay_canvas.height=Math.round(this.cssHeight*this.devicePixelRatio);this.overlay_canvas.style.width=this.cssWidth+"px";this.overlay_canvas.style.height=this.cssHeight+"px";this.overlay_canvas.style.position="absolute";this.overlay_ctx=this.overlay_canvas.getContext("2d");this.glwrap=new cr.GLWrap(this.gl,
this.isMobile,this.enableFrontToBack);this.glwrap.setSize(this.canvas.width,this.canvas.height);this.glwrap.enable_mipmaps=0!==this.downscalingQuality;this.ctx=null;this.canvas.addEventListener("webglcontextlost",function(ba){ba.preventDefault();q.onContextLost();cr.logexport("[Construct 2] WebGL context lost");window.cr_setSuspended(!0)},!1);this.canvas.addEventListener("webglcontextrestored",function(ba){q.glwrap.initState();q.glwrap.setSize(q.glwrap.width,q.glwrap.height,!0);q.layer_tex=null;q.layout_tex=
null;q.fx_tex[0]=null;q.fx_tex[1]=null;q.onContextRestored();q.redraw=!0;cr.logexport("[Construct 2] WebGL context restored");window.cr_setSuspended(!1)},!1);this.glwrap.supportsGpuProfiling()||(this.gpuLastUtilisation=NaN);J=0;for(F=this.types_by_index.length;J<F;J++){var M=this.types_by_index[J];var S=0;for(B=M.effect_types.length;S<B;S++){var T=M.effect_types[S];T.shaderindex=this.glwrap.getShaderIndex(T.id);T.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(T.shaderindex);this.uses_background_blending=
this.uses_background_blending||this.glwrap.programUsesDest(T.shaderindex)}}J=0;for(F=this.layouts_by_index.length;J<F;J++){var U=this.layouts_by_index[J];S=0;for(B=U.effect_types.length;S<B;S++)T=U.effect_types[S],T.shaderindex=this.glwrap.getShaderIndex(T.id),T.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(T.shaderindex);U.updateActiveEffects();S=0;for(B=U.layers.length;S<B;S++){var fa=U.layers[S];M=0;for(G=fa.effect_types.length;M<G;M++)T=fa.effect_types[M],T.shaderindex=this.glwrap.getShaderIndex(T.id),
T.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(T.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(T.shaderindex);fa.updateActiveEffects()}}}else F={alpha:!0},this.ctx=this.canvas.getContext("2d",F),this.ctx.imageSmoothingEnabled=this.linearSampling,this.overlay_ctx=this.overlay_canvas=null,this.gpuLastUtilisation=NaN,this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=!0;this.tickFunc=function(ba){q.tick(!1,ba)};window==
window.top||this.isWinJS||this.isWindowsPhone8||(document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0));this.isPreview&&(-1<window.location.search.indexOf("continuous")&&(cr.logexport("Reloading for continuous preview"),this.loadFromSlot="__c2_continuouspreview",this.suspendDrawing=!0),this.pauseOnBlur&&!this.isMobile&&(window.addEventListener("focus",function(){q.setSuspended(!1)}),window.addEventListener("blur",
function(){var ba=window.parent;ba&&ba.document.hasFocus()||q.setSuspended(!0)})));window.addEventListener("blur",function(){q.onWindowBlur()});J=function(ba){"mousedown"===ba.type&&1===ba.button&&ba.preventDefault();if(cr.isCanvasInputEvent(ba)&&document.activeElement&&document.activeElement!==document.getElementsByTagName("body")[0]&&document.activeElement.blur)try{document.activeElement.blur()}catch(Z){}};"undefined"!==typeof PointerEvent?document.addEventListener("pointerdown",J):window.navigator.msPointerEnabled?
document.addEventListener("MSPointerDown",J):document.addEventListener("touchstart",J);document.addEventListener("mousedown",J);0===this.fullscreen_mode&&this.isRetina&&1<this.devicePixelRatio?this.setSize(this.original_width,this.original_height,!0):this.setSize(window.innerWidth,window.innerHeight,!0);this.tryLockOrientation();this.getready();this.go();this.extra={};cr.seal(this)};b.prototype.setSize=function(q,B,G){var J=0,F=0;if(this.lastWindowWidth!==q||this.lastWindowHeight!==B||G){if(this.isiPhone&&
this.isCordova&&window.screen){var M=document.documentElement.style;var S=document.body.style;var T=window.innerWidth<window.innerHeight;var U=T?window.screen.height:window.screen.width;T=T?window.screen.width:window.screen.height;U&&T&&(S.height=M.height=U+"px",S.width=M.width=T+"px")}this.lastWindowWidth=q;this.lastWindowHeight=B;M=this.fullscreen_mode;if((S=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen)&&!this.isCordova)||0!==this.fullscreen_mode||
G)S&&(M=this.fullscreen_scaling),G=this.devicePixelRatio,4<=M?(5===M&&1!==G&&(q+=1,B+=1),S=this.original_width/this.original_height,q/B>S?(S*=B,5===M?(J=S*G/this.original_width,1<J?J=Math.floor(J):1>J&&(J=1/Math.ceil(1/J)),S=this.original_width*J/G,U=this.original_height*J/G,J=(q-S)/2,F=(B-U)/2,q=S,B=U):(J=(q-S)/2,q=S)):(U=q/S,5===M?(J=U*G/this.original_height,1<J?J=Math.floor(J):1>J&&(J=1/Math.ceil(1/J)),S=this.original_width*J/G,U=this.original_height*J/G,J=(q-S)/2,F=(B-U)/2,q=S):F=(B-U)/2,B=U)):
S&&0===M&&(J=Math.floor((q-this.original_width)/2),F=Math.floor((B-this.original_height)/2),q=this.original_width,B=this.original_height),2>M&&(this.aspect_scale=G),this.cssWidth=Math.round(q),this.cssHeight=Math.round(B),this.width=Math.round(q*G),this.height=Math.round(B*G),this.redraw=!0,this.wantFullscreenScalingQuality?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):this.width<this.original_width&&this.height<this.original_height||1===M?(this.draw_width=
this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===M?(S=this.original_width/this.original_height,M=this.lastWindowWidth/this.lastWindowHeight,M<S?this.draw_width=this.draw_height*M:M>S&&(this.draw_height=this.draw_width/M)):3===M&&(S=this.original_width/this.original_height,M=this.lastWindowWidth/this.lastWindowHeight,M>S?this.draw_width=this.draw_height*M:M<S&&(this.draw_height=
this.draw_width/M))),this.canvas&&(this.canvas.width=Math.round(q*G),this.canvas.height=Math.round(B*G),this.isRetina&&(this.canvas.style.width=Math.round(q)+"px",this.canvas.style.height=Math.round(B)+"px"),this.canvas.style.marginLeft=Math.floor(J)+"px",this.canvas.style.marginTop=Math.floor(F)+"px"),this.overlay_canvas&&(this.overlay_canvas.width=Math.round(q*G),this.overlay_canvas.height=Math.round(B*G),this.overlay_canvas.style.width=this.cssWidth+"px",this.overlay_canvas.style.height=this.cssHeight+
"px",this.overlay_canvas.style.left=Math.floor(J)+"px",this.overlay_canvas.style.top=Math.floor(F)+"px"),this.glwrap&&this.glwrap.setSize(Math.round(q*G),Math.round(B*G)),this.ctx&&(this.ctx.imageSmoothingEnabled=this.linearSampling),this.tryLockOrientation(),this.isiPhone&&!this.isCordova&&window.scrollTo(0,0)}};b.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var q="portrait";2===this.orientations&&(q="landscape");try{screen.orientation&&screen.orientation.lock?
screen.orientation.lock(q).catch(function(){}):screen.lockOrientation?screen.lockOrientation(q):screen.webkitLockOrientation?screen.webkitLockOrientation(q):screen.mozLockOrientation?screen.mozLockOrientation(q):screen.msLockOrientation&&screen.msLockOrientation(q)}catch(B){console&&console.warn&&console.warn("Failed to lock orientation: ",B)}}};b.prototype.onContextLost=function(){this.glwrap.contextLost();this.is_WebGL_context_lost=!0;var q;var B=0;for(q=this.types_by_index.length;B<q;B++){var G=
this.types_by_index[B];if(G.onLostWebGLContext)G.onLostWebGLContext()}};b.prototype.onContextRestored=function(){this.is_WebGL_context_lost=!1;var q;var B=0;for(q=this.types_by_index.length;B<q;B++){var G=this.types_by_index[B];if(G.onRestoreWebGLContext)G.onRestoreWebGLContext()}};var w=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;b.prototype.setSuspended=function(q){var B;if(q&&!this.isSuspended)for(cr.logexport("[Construct 2] Suspending"),
this.isSuspended=!0,-1!==this.raf_id&&w(this.raf_id),-1!==this.timeout_id&&clearTimeout(this.timeout_id),q=0,B=this.suspend_events.length;q<B;q++)this.suspend_events[q](!0);else if(!q&&this.isSuspended){cr.logexport("[Construct 2] Resuming");this.isSuspended=!1;this.last_tick_time=cr.performance_now();this.last_fps_time=cr.performance_now();q=this.logictime=this.framecount=0;for(B=this.suspend_events.length;q<B;q++)this.suspend_events[q](!1);this.tick(!1)}};b.prototype.addSuspendCallback=function(q){this.suspend_events.push(q)};
b.prototype.GetObjectReference=function(q){return this.objectRefTable[q]};b.prototype.loadProject=function(q){q&&q.project||cr.logerror("Project model unavailable");q=q.project;this.name=q[0];this.first_layout=q[1];this.fullscreen_mode=q[12];this.fullscreen_mode_set=q[12];this.original_width=q[10];this.original_height=q[11];this.parallax_x_origin=this.original_width/2;this.parallax_y_origin=this.original_height/2;this.uses_loader_layout=q[18];this.loaderstyle=q[19];this.iconsFolder=q[28];this.webFontNames=
q[29].map(function(ka){return ka[0]});if(0===this.loaderstyle){var B=new Image;B.crossOrigin="anonymous";var G=this.loaderlogos={logo:B};B.addEventListener("error",function(){G.logo=null});var J=q[39];J=this.isPreview?this.getProjectFileUrl(J):this.iconsFolder+J;this.setImageSrc(B,J)}else if(4===this.loaderstyle){B=new Image;B.src="splash-images/splash-logo.svg";J=new Image;J.src="splash-images/splash-poweredby-512.png";var F=new Image;F.src="splash-images/splash-poweredby-256.png";var M=new Image;
M.src="splash-images/splash-poweredby-128.png";var S=new Image;S.src="splash-images/splash-website-512.png";var T=new Image;T.src="splash-images/splash-website-256.png";var U=new Image;U.src="splash-images/splash-website-128.png";this.loaderlogos={logo:B,powered:[J,F,M],website:[S,T,U]}}this.next_uid=q[21];this.objectRefTable=cr.getObjectRefTable();this.system=new cr.system_object(this);B=0;for(J=q[2].length;B<J;B++){U=q[2][B];F=this.GetObjectReference(U[0]);cr.add_common_aces(U,F.prototype);var fa=
new F(this);fa.singleglobal=U[1];fa.is_world=U[2];fa.is_rotatable=U[5];fa.must_predraw=U[9];if(fa.onCreate)fa.onCreate();cr.seal(fa);this.plugins.push(fa)}this.objectRefTable=cr.getObjectRefTable();B=0;for(J=q[3].length;B<J;B++){U=q[3][B];S=this.GetObjectReference(U[1]);fa=null;F=0;for(M=this.plugins.length;F<M;F++)if(this.plugins[F]instanceof S){fa=this.plugins[F];break}var ba=new fa.Type(fa);ba.name=U[0];ba.is_family=U[2];ba.instvar_sids=U[3].slice(0);ba.vars_count=U[3].length;ba.behs_count=U[4];
ba.fx_count=U[5];ba.sid=U[11];ba.is_family?(ba.members=[],ba.family_index=this.family_count++,ba.families=null):(ba.members=null,ba.family_index=-1,ba.families=[]);ba.family_var_map=null;ba.family_beh_map=null;ba.family_fx_map=null;ba.is_contained=!1;ba.container=null;U[6]?(ba.texture_file=U[6][0],ba.texture_filesize=U[6][1],ba.texture_pixelformat=U[6][2],ba.texture_data=U[6]):(ba.texture_file=null,ba.texture_filesize=0,ba.texture_pixelformat=0,ba.texture_data=null);ba.animations=U[7]?U[7]:null;ba.index=
B;ba.instances=[];ba.deadCache=[];ba.solstack=[new cr.selection(ba)];ba.cur_sol=0;ba.default_instance=null;ba.default_layerindex=0;ba.stale_iids=!0;ba.updateIIDs=cr.type_updateIIDs;ba.getFirstPicked=cr.type_getFirstPicked;ba.getPairedInstance=cr.type_getPairedInstance;ba.getCurrentSol=cr.type_getCurrentSol;ba.pushCleanSol=cr.type_pushCleanSol;ba.pushCopySol=cr.type_pushCopySol;ba.popSol=cr.type_popSol;ba.getBehaviorByName=cr.type_getBehaviorByName;ba.getBehaviorIndexByName=cr.type_getBehaviorIndexByName;
ba.getEffectIndexByName=cr.type_getEffectIndexByName;ba.applySolToContainer=cr.type_applySolToContainer;ba.getInstanceByIID=cr.type_getInstanceByIID;ba.collision_grid=new cr.SparseGrid(this.original_width,this.original_height);ba.any_cell_changed=!0;ba.any_instance_parallaxed=!1;ba.extra={};ba.toString=cr.type_toString;ba.behaviors=[];F=0;for(M=U[8].length;F<M;F++){var Z=U[8][F];var da=this.GetObjectReference(Z[1]),ia=null;S=0;for(T=this.behaviors.length;S<T;S++)if(this.behaviors[S]instanceof da){ia=
this.behaviors[S];break}if(!ia){ia=new da(this);ia.my_types=[];ia.my_instances=new cr.ObjectSet;if(ia.onCreate)ia.onCreate();cr.seal(ia);this.behaviors.push(ia);cr.behaviors.solid&&ia instanceof cr.behaviors.solid&&(this.solidBehavior=ia);cr.behaviors.jumpthru&&ia instanceof cr.behaviors.jumpthru&&(this.jumpthruBehavior=ia);cr.behaviors.shadowcaster&&ia instanceof cr.behaviors.shadowcaster&&(this.shadowcasterBehavior=ia)}-1===ia.my_types.indexOf(ba)&&ia.my_types.push(ba);S=new ia.Type(ia,ba);S.name=
Z[0];S.sid=Z[2];S.onCreate();cr.seal(S);ba.behaviors.push(S)}ba.global=U[9];ba.isOnLoaderLayout=U[10];ba.effect_types=[];F=0;for(M=U[12].length;F<M;F++)ba.effect_types.push({id:U[12][F][0],name:U[12][F][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:F});F=U[13];ba.tile_poly_data=F?F[0]:null;if(!this.uses_loader_layout||ba.is_family||ba.isOnLoaderLayout||!fa.is_world)ba.onCreate(),cr.seal(ba);ba.name&&(this.types[ba.name]=ba,this.types_lowercase[ba.name.toLowerCase()]=ba);this.types_by_index.push(ba);
fa.singleglobal&&(F=new fa.Instance(ba),F.uid=this.next_uid++,F.puid=this.next_puid++,F.iid=0,F.get_iid=cr.inst_get_iid,F.toString=cr.inst_toString,F.properties=U[16],F.onCreate(),cr.seal(F),ba.instances.push(F),this.objectsByUid[F.uid.toString()]=F)}B=0;for(J=q[4].length;B<J;B++)for(S=q[4][B],T=this.types_by_index[S[0]],F=1,M=S.length;F<M;F++)U=this.types_by_index[S[F]],U.families.push(T),T.members.push(U);B=0;for(J=q[27].length;B<J;B++){S=q[27][B];T=[];F=0;for(M=S.length;F<M;F++)T.push(this.types_by_index[S[F]]);
F=0;for(M=T.length;F<M;F++)T[F].is_contained=!0,T[F].container=T}if(0<this.family_count)for(B=0,J=this.types_by_index.length;B<J;B++)if(U=this.types_by_index[B],!U.is_family&&U.families.length){U.family_var_map=Array(this.family_count);U.family_beh_map=Array(this.family_count);U.family_fx_map=Array(this.family_count);ba=[];F=ia=da=Z=0;for(M=U.families.length;F<M;F++)for(fa=U.families[F],U.family_var_map[fa.family_index]=Z,Z+=fa.vars_count,U.family_beh_map[fa.family_index]=da,da+=fa.behs_count,U.family_fx_map[fa.family_index]=
ia,ia+=fa.fx_count,S=0,T=fa.effect_types.length;S<T;S++)ba.push(cr.shallowCopy({},fa.effect_types[S]));U.effect_types=ba.concat(U.effect_types);F=0;for(M=U.effect_types.length;F<M;F++)U.effect_types[F].index=F}B=0;for(J=q[5].length;B<J;B++)U=q[5][B],F=new cr.layout(this,U),cr.seal(F),this.layouts[F.name]=F,this.layouts_by_index.push(F);B=0;for(J=q[6].length;B<J;B++)U=q[6][B],F=new cr.eventsheet(this,U),cr.seal(F),this.eventsheets[F.name]=F,this.eventsheets_by_index.push(F);B=0;for(J=this.eventsheets_by_index.length;B<
J;B++)this.eventsheets_by_index[B].postInit();B=0;for(J=this.eventsheets_by_index.length;B<J;B++)this.eventsheets_by_index[B].updateDeepIncludes();B=0;for(J=this.triggers_to_postinit.length;B<J;B++)this.triggers_to_postinit[B].postInit();cr.clearArray(this.triggers_to_postinit);this.audio_files_info=q[7];this.audio_files_map={};B=0;for(J=this.audio_files_info.length;B<J;++B)F=this.audio_files_info[B],this.audio_files_map[F[0]]=F[1];this.files_subfolder=q[8];this.pixel_rounding=q[9];this.aspect_scale=
1;this.enableWebGL=q[13];this.linearSampling=q[14];this.clearBackground=q[15];this.versionstr=q[16];this.useHighDpi=q[17];this.orientations=q[20];this.autoLockOrientation=0<this.orientations;this.pauseOnBlur=q[22];this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=q[23];this.downscalingQuality=q[24];this.preloadSounds=q[25];this.enableFrontToBack=q[26]&&!this.isIE;this.enhancedAccelerationPrecision=q[30];this.start_time=Date.now();cr.clearArray(this.objectRefTable);this.preloadSounds||
C["audio/webm; codecs=opus"]||!window.OpusDecoder||window.OpusDecoder.Initialise();this.initRendererAndLoader()};var r=!1;b.prototype.waitForImageLoad=function(q,B){window.cr_remotePreviewImageFiles&&B&&"blob:"!==B.substr(0,5)&&(B=window.cr_remotePreviewImageFiles[B]);q.onerror=function(G){r=q.c2error=!0;console&&console.error&&console.error("Error loading image '"+q.src+"': ",G)};q.src||("undefined"!==typeof XAPKReader?XAPKReader.get(B,function(G){q.src=G},function(G){r=q.c2error=!0;console&&console.error&&
console.error("Error extracting image '"+B+"' from expansion file: ",G)}):(q.crossOrigin="anonymous",this.setImageSrc(q,B)));this.wait_for_textures.push(q)};b.prototype.findWaitingTexture=function(q){var B;var G=0;for(B=this.wait_for_textures.length;G<B;G++)if(this.wait_for_textures[G].cr_src===q)return this.wait_for_textures[G];return null};var x=0,A=!1;b.prototype.getready=function(){if(this.audioInstance&&this.preloadSounds){var q=[],B;var G=0;for(B=this.audio_files_info.length;G<B;++G){var J=
this.audio_files_info[G];var F=J[0];var M=J[2];(J=this.getPreferredAudioFile(F))&&!M&&q.push({filename:F+J[1],size:J[2],type:J[0]})}x=this.audioInstance.setPreloadList(q)}};b.prototype.areAllTexturesAndSoundsLoaded=function(){var q=x,B=0,G=!0,J;var F=0;for(J=this.wait_for_textures.length;F<J;F++){var M=this.wait_for_textures[F];var S=M.cr_filesize;if(!S||0>=S)S=5E4;q+=S;M.src&&M.complete&&!M.c2error?B+=S:G=!1}G&&this.preloadSounds&&this.audioInstance&&(A||(this.audioInstance.startPreloads(),A=!0),
F=this.audioInstance.getPreloadedSize(),B+=F,F<x&&(G=!1));this.progress=0==q?1:B/q;return G};var l=!1;b.prototype.go=function(){if(this.ctx||this.glwrap){var q=this.ctx||this.overlay_ctx;if(0<this.fullscreen_mode){var B=window.innerWidth,G=window.innerHeight;this.lastWindowWidth===B&&this.lastWindowHeight===G||this.setSize(B,G)}this.progress=0;this.last_progress=-1;var J=this;if(this.areAllTexturesAndSoundsLoaded()&&(4!==this.loaderstyle||l))this.useFbInstant?FBInstant.startGameAsync().then(function(){J.go_loading_finished()}):
this.go_loading_finished();else{this.useFbInstant&&FBInstant.setLoadingProgress(100*this.progress);G=Date.now()-this.start_time;if(q){var F=this.width,M=this.height;B=this.devicePixelRatio;if(3>this.loaderstyle&&500<=G&&this.last_progress!=this.progress){q.clearRect(0,0,F,M);G=F/2;M/=2;F=0===this.loaderstyle&&this.loaderlogos.logo&&this.loaderlogos.logo.complete;var S=40*B,T=0,U=80*B;if(F){var fa=this.loaderlogos.logo;U=fa.width*B;var ba=fa.height*B;S=U/2;T=ba/2;q.drawImage(fa,cr.floor(G-S),cr.floor(M-
T),U,ba)}1>=this.loaderstyle?(M+=T+(F?12*B:0),G=cr.floor(G-S)+.5,M=cr.floor(M)+.5,q.fillStyle=r?"red":"DodgerBlue",q.fillRect(G,M,Math.floor(U*this.progress),6*B),q.strokeStyle="black",q.strokeRect(G,M,U,6*B),q.strokeStyle="white",q.strokeRect(G-1*B,M-1*B,U+2*B,8*B)):2===this.loaderstyle&&(q.font="12pt Arial",q.fillStyle=r?"#f00":"#999",q.textBaseLine="middle",B=Math.round(100*this.progress)+"%",F=q.measureText?q.measureText(B):null,q.fillText(B,G-(F?F.width:0)/2,M));this.last_progress=this.progress}else if(4===
this.loaderstyle){this.draw_c3_splash_loader(q);u?u(function(){J.go()}):setTimeout(function(){J.go()},16);return}}setTimeout(function(){J.go()},100)}}};var y=-1,z=!0,O=!1,Q=0,I=0,k=null,p=null,H=0;b.prototype.draw_c3_splash_loader=function(q){if(!l){var B=this.isPreview||this.useFbInstant,G=B?0:200,J=B?0:3E3,F=Math.ceil(this.width),M=Math.ceil(this.height),S=this.loaderlogos.logo,T=this.loaderlogos.powered,U=this.loaderlogos.website;if(S.complete){for(var fa=0;3>fa;++fa)if(!T[fa].complete||!U[fa].complete)return;
0===H&&(y=Date.now());fa=Date.now();var ba=!1,Z=q;z||O?(q.clearRect(0,0,F,M),k&&k.width===F&&k.height===M||(k=document.createElement("canvas"),k.width=F,k.height=M,p=k.getContext("2d")),Z=p,ba=!0,z&&1===H&&(y=Date.now())):q.globalAlpha=1;Z.fillStyle="#3B4045";Z.fillRect(0,0,F,M);try{if(256<this.cssHeight){var da=1.5*cr.clamp(.22*M,105,.6*F);var ia=da/8;Z.drawImage(128>=da?T[2]:256>=da?T[1]:T[0],.5*F-da/2,.2*M-ia/2,da,ia);ia=da=Math.min(.395*M,.95*F);Z.drawImage(S,.5*F-da/2,.485*M-ia/2,da,ia);da=1.5*
cr.clamp(.22*M,105,.6*F);ia=da/8;Z.drawImage(128>=da?U[2]:256>=da?U[1]:U[0],.5*F-da/2,.868*M-ia/2,da,ia);Z.fillStyle="#4D565D";da=F;ia=Math.max(.005*M,2);Z.fillRect(0,.8*M-ia/2,da,ia);Z.fillStyle=r?"red":"#29F3D0";da=F*this.progress;Z.fillRect(.5*F-da/2,.8*M-ia/2,da,ia)}else ia=da=.55*M,Z.drawImage(S,.5*F-da/2,.45*M-ia/2,da,ia),Z.fillStyle="#4D565D",da=F,ia=Math.max(.005*M,2),Z.fillRect(0,.85*M-ia/2,da,ia),Z.fillStyle=r?"red":"#29F3D0",da=F*this.progress,Z.fillRect(.5*F-da/2,.85*M-ia/2,da,ia);ba&&
(z?q.globalAlpha=0===H?0:Math.min((fa-y)/300,1):O&&(q.globalAlpha=Math.max(1-(fa-I)/300,0)),q.drawImage(k,0,0,F,M))}catch(ka){}z&&300<=fa-y&&2<=H&&(z=!1,Q=fa);!z&&fa-Q>=J&&!O&&1<=this.progress&&(O=!0,I=fa);if(O&&fa-I>=300+G||B&&1<=this.progress&&500>Date.now()-y)l=!0,O=z=!1,this.loaderlogos=p=k=null;++H}}};b.prototype.go_loading_finished=function(){if(this.webFontNames.length&&document.fonts&&document.fonts.load){var q=this;Promise.all(this.webFontNames.map(function(B){return document.fonts.load("1em '"+
B+"'")})).then(function(){q.start_first_layout()})}else this.start_first_layout()};b.prototype.start_first_layout=function(){this.overlay_canvas&&(this.canvas.parentNode.removeChild(this.overlay_canvas),this.overlay_canvas=this.overlay_ctx=null);this.start_time=Date.now();this.last_fps_time=cr.performance_now();var q;if(this.uses_loader_layout){var B=0;for(q=this.types_by_index.length;B<q;B++){var G=this.types_by_index[B];G.is_family||G.isOnLoaderLayout||!G.plugin.is_world||(G.onCreate(),cr.seal(G))}}else this.isloading=
!1;B=0;for(q=this.layouts_by_index.length;B<q;B++)this.layouts_by_index[B].createGlobalNonWorlds();2<=this.fullscreen_mode&&(B=this.original_width/this.original_height,q=this.width/this.height,this.aspect_scale=2!==this.fullscreen_mode&&q>B||2===this.fullscreen_mode&&q<B?this.height/this.original_height:this.width/this.original_width);B=0;for(q=this.types_by_index.length;B<q;B++)if(G=this.types_by_index[B],G.onBeforeAppBegin)G.onBeforeAppBegin();this.first_layout?this.layouts[this.first_layout].startRunning():
this.layouts_by_index[0].startRunning();this.uses_loader_layout||(this.loadingprogress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C3_RegisterSW&&window.C3_RegisterSW());navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide();B=0;for(q=this.types_by_index.length;B<q;B++)if(G=this.types_by_index[B],G.onAppBegin)G.onAppBegin();B=function(){document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):
window.cr_setSuspended(!1)};document.addEventListener("visibilitychange",B,!1);document.addEventListener("mozvisibilitychange",B,!1);document.addEventListener("webkitvisibilitychange",B,!1);document.addEventListener("msvisibilitychange",B,!1);this.isCordova&&(document.addEventListener("pause",function(){window.cr_setSuspended(!0)}),document.addEventListener("resume",function(){window.cr_setSuspended(!1)}));document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):
this.tick(!1)};b.prototype.tick=function(q,B,G){if(this.running_layout){var J=cr.performance_now();if(G||!this.isSuspended||q){q||(u?this.raf_id=u(this.tickFunc):this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16));B=B||J;var F=this.fullscreen_mode;(G=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova)&&0<this.fullscreen_scaling&&(F=this.fullscreen_scaling);if(0<F){F=window.innerWidth;var M=window.innerHeight;this.lastWindowWidth===
F&&this.lastWindowHeight===M||this.setSize(F,M)}G?this.firstInFullscreen||(this.firstInFullscreen=!0):this.firstInFullscreen?(this.firstInFullscreen=!1,0===this.fullscreen_mode&&this.setSize(Math.round(this.oldWidth/this.devicePixelRatio),Math.round(this.oldHeight/this.devicePixelRatio),!0)):(this.oldWidth=this.width,this.oldHeight=this.height);this.isloading&&(G=this.areAllTexturesAndSoundsLoaded(),this.loadingprogress=this.progress,G&&(this.isloading=!1,this.progress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,
null),window.C3_RegisterSW&&window.C3_RegisterSW()));this.logic(B);!this.redraw||this.is_WebGL_context_lost||this.suspendDrawing||q||(this.redraw=!1,this.glwrap?this.drawGL():this.draw(),this.snapshotCanvas&&(this.canvas&&this.canvas.toDataURL&&(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),window.cr_onSnapshot&&window.cr_onSnapshot(this.snapshotData),this.trigger(cr.system_object.prototype.cnds.OnCanvasSnapshot,null)),this.snapshotCanvas=null));this.hit_breakpoint||
(this.tickcount++,this.tickcount_nosave++,this.execcount++,this.framecount++);this.logictime+=cr.performance_now()-J}}};b.prototype.logic=function(q){var B;1E3<=q-this.last_fps_time&&(this.last_fps_time+=1E3,1E3<=q-this.last_fps_time&&(this.last_fps_time=q),this.fps=this.framecount,this.framecount=0,this.cpuutilisation=Math.min(this.logictime,1E3),this.logictime=0,this.glwrap&&0===this.gpuTimeEndFrame&&(this.gpuTimeEndFrame=this.glwrap.getFrameNumber(),this.gpuCurUtilisation=-1));this.glwrap&&-1===
this.gpuCurUtilisation&&this.glwrap.supportsGpuProfiling()&&(this.gpuCurUtilisation=this.glwrap.getFrameRangeTimerResults(this.gpuTimeStartFrame,this.gpuTimeEndFrame),-1!==this.gpuCurUtilisation&&(this.glwrap.deleteTimerResultsToFrame(this.gpuTimeEndFrame),this.gpuLastUtilisation=Math.min(this.gpuCurUtilisation,1),this.gpuTimeStartFrame=this.gpuTimeEndFrame,this.gpuTimeEndFrame=0));if(0!==this.last_tick_time){var G=q-this.last_tick_time;0>G&&(G=0);this.dt1=G/1E3;.5<this.dt1?this.dt1=0:this.dt1>1/
this.minimumFramerate&&(this.dt1=1/this.minimumFramerate)}this.last_tick_time=q;this.dt=this.dt1*this.timescale;this.kahanTime.add(this.dt);this.wallTime.add(this.dt1);q=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova;if(2<=this.fullscreen_mode||q&&0<this.fullscreen_scaling){G=this.original_width/this.original_height;var J=this.width/this.height;var F=this.fullscreen_mode;q&&0<this.fullscreen_scaling&&(F=this.fullscreen_scaling);
this.aspect_scale=2!==F&&J>G||2===F&&J<G?this.height/this.original_height:this.width/this.original_width;this.running_layout&&(this.running_layout.scrollToX(this.running_layout.scrollX),this.running_layout.scrollToY(this.running_layout.scrollY))}else this.aspect_scale=this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow();this.isInOnDestroy++;this.system.runWaits();this.isInOnDestroy--;this.ClearDeathRow();this.isInOnDestroy++;J=this.objects_to_pretick.valuesRef();q=0;for(G=J.length;q<G;q++)J[q].pretick();
q=0;for(G=this.types_by_index.length;q<G;q++){var M=this.types_by_index[q];if(!M.is_family&&(M.behaviors.length||M.families.length))for(J=0,F=M.instances.length;J<F;J++){var S=M.instances[J];var T=0;for(B=S.behavior_insts.length;T<B;T++)S.behavior_insts[T].tick()}}q=0;for(G=this.types_by_index.length;q<G;q++)if(M=this.types_by_index[q],!M.is_family&&(M.behaviors.length||M.families.length))for(J=0,F=M.instances.length;J<F;J++)for(S=M.instances[J],T=0,B=S.behavior_insts.length;T<B;T++){var U=S.behavior_insts[T];
U.posttick&&U.posttick()}J=this.objects_to_tick.valuesRef();q=0;for(G=J.length;q<G;q++)J[q].tick();this.isInOnDestroy--;this.handleSaveLoad();for(q=0;this.changelayout&&10>q++;)this.doChangeLayout(this.changelayout);q=0;for(G=this.eventsheets_by_index.length;q<G;q++)this.eventsheets_by_index[q].hasRun=!1;this.running_layout.event_sheet&&this.running_layout.event_sheet.run();cr.clearArray(this.registered_collisions);this.layout_first_tick=!1;this.isInOnDestroy++;q=0;for(G=this.types_by_index.length;q<
G;q++)if(M=this.types_by_index[q],!M.is_family&&(M.behaviors.length||M.families.length))for(J=0,F=M.instances.length;J<F;J++)for(S=M.instances[J],T=0,B=S.behavior_insts.length;T<B;T++)U=S.behavior_insts[T],U.tick2&&U.tick2();J=this.objects_to_tick2.valuesRef();q=0;for(G=J.length;q<G;q++)J[q].tick2();this.isInOnDestroy--};b.prototype.onWindowBlur=function(){var q,B,G;var J=0;for(q=this.types_by_index.length;J<q;J++){var F=this.types_by_index[J];if(!F.is_family){var M=0;for(B=F.instances.length;M<B;M++){var S=
F.instances[M];if(S.onWindowBlur)S.onWindowBlur();if(S.behavior_insts){var T=0;for(G=S.behavior_insts.length;T<G;T++){var U=S.behavior_insts[T];if(U.onWindowBlur)U.onWindowBlur()}}}}}};b.prototype.doChangeLayout=function(q){var B=this.running_layout;this.running_layout.stopRunning();var G;if(this.glwrap){var J=0;for(G=this.types_by_index.length;J<G;J++){var F=this.types_by_index[J];F.is_family||!F.unloadTextures||F.global&&0!==F.instances.length||-1!==q.initial_types.indexOf(F)||F.unloadTextures()}}B==
q&&cr.clearArray(this.system.waits);cr.clearArray(this.registered_collisions);this.runLayoutChangeMethods(!0);q.startRunning();this.runLayoutChangeMethods(!1);this.layout_first_tick=this.redraw=!0;this.ClearDeathRow()};b.prototype.runLayoutChangeMethods=function(q){var B,G,J;var F=0;for(B=this.behaviors.length;F<B;F++){var M=this.behaviors[F];if(q){if(M.onBeforeLayoutChange)M.onBeforeLayoutChange()}else if(M.onLayoutChange)M.onLayoutChange()}F=0;for(B=this.types_by_index.length;F<B;F++)if(M=this.types_by_index[F],
M.global||M.plugin.singleglobal){var S=0;for(G=M.instances.length;S<G;S++){var T=M.instances[S];if(q){if(T.onBeforeLayoutChange)T.onBeforeLayoutChange()}else if(T.onLayoutChange)T.onLayoutChange();if(T.behavior_insts){var U=0;for(J=T.behavior_insts.length;U<J;U++){var fa=T.behavior_insts[U];if(q){if(fa.onBeforeLayoutChange)fa.onBeforeLayoutChange()}else if(fa.onLayoutChange)fa.onLayoutChange()}}}}};b.prototype.pretickMe=function(q){this.objects_to_pretick.add(q)};b.prototype.unpretickMe=function(q){this.objects_to_pretick.remove(q)};
b.prototype.tickMe=function(q){this.objects_to_tick.add(q)};b.prototype.untickMe=function(q){this.objects_to_tick.remove(q)};b.prototype.tick2Me=function(q){this.objects_to_tick2.add(q)};b.prototype.untick2Me=function(q){this.objects_to_tick2.remove(q)};b.prototype.getDt=function(q){return q&&-1!==q.my_timescale?this.dt1*q.my_timescale:this.dt};b.prototype.draw=function(){this.running_layout.draw(this.ctx)};b.prototype.drawGL=function(){this.enableFrontToBack&&(this.earlyz_index=1,this.running_layout.drawGL_earlyZPass(this.glwrap));
this.running_layout.drawGL(this.glwrap);this.glwrap.present()};b.prototype.addDestroyCallback=function(q){q&&this.destroycallbacks.push(q)};b.prototype.removeDestroyCallback=function(q){cr.arrayFindRemove(this.destroycallbacks,q)};b.prototype.getObjectByUID=function(q){q=q.toString();return this.objectsByUid.hasOwnProperty(q)?this.objectsByUid[q]:null};var m=[];b.prototype.DestroyInstance=function(q){var B;var G=q.type.name;if(this.deathRow.hasOwnProperty(G)){var J=this.deathRow[G];if(J.contains(q))return}else J=
m.length?m.pop():new cr.ObjectSet,this.deathRow[G]=J;q.isDestroyed=!0;J.add(q);this.hasPendingInstances=!0;if(q.is_contained)for(G=0,B=q.siblings.length;G<B;G++)this.DestroyInstance(q.siblings[G]);this.isInClearDeathRow&&J.values_cache.push(q);this.isEndingLayout||(this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(q.type.plugin).cnds.OnDestroyed,q),this.isInOnDestroy--)};b.prototype.ClearDeathRow=function(){if(this.hasPendingInstances){var q,B;this.isInClearDeathRow=!0;var G=0;for(q=this.createRow.length;G<
q;++G){var J=this.createRow[G];var F=J.type;F.instances.push(J);var M=0;for(B=F.families.length;M<B;++M)F.families[M].instances.push(J),F.families[M].stale_iids=!0}cr.clearArray(this.createRow);this.IterateDeathRow();cr.wipe(this.deathRow);this.hasPendingInstances=this.isInClearDeathRow=!1}};b.prototype.IterateDeathRow=function(){for(var q in this.deathRow)this.deathRow.hasOwnProperty(q)&&this.ClearDeathRowForType(this.deathRow[q])};b.prototype.ClearDeathRowForType=function(q){var B=q.valuesRef(),
G=B[0].type,J,F;cr.arrayRemoveAllFromObjectSet(G.instances,q);G.stale_iids=!0;0===G.instances.length&&(G.any_instance_parallaxed=!1);var M=0;for(J=G.families.length;M<J;++M){var S=G.families[M];cr.arrayRemoveAllFromObjectSet(S.instances,q);S.stale_iids=!0}M=0;for(J=this.system.waits.length;M<J;++M){var T=this.system.waits[M];T.sols.hasOwnProperty(G.index)&&cr.arrayRemoveAllFromObjectSet(T.sols[G.index].insts,q);if(!G.is_family){var U=0;for(F=G.families.length;U<F;++U)S=G.families[U],T.sols.hasOwnProperty(S.index)&&
cr.arrayRemoveAllFromObjectSet(T.sols[S.index].insts,q)}}if(T=B[0].layer){if(T.useRenderCells)for(U=T.instances,M=0,J=U.length;M<J;++M)F=U[M],q.contains(F)&&(F.update_bbox(),T.render_grid.update(F,F.rendercells,null),F.rendercells.set(0,0,-1,-1));cr.arrayRemoveAllFromObjectSet(T.instances,q);T.setZIndicesStaleFrom(0)}for(M=0;M<B.length;++M)this.ClearDeathRowForSingleInstance(B[M],G);q.clear();m.push(q);this.redraw=!0};b.prototype.ClearDeathRowForSingleInstance=function(q,B){var G;var J=0;for(G=this.destroycallbacks.length;J<
G;++J)this.destroycallbacks[J](q);q.collcells&&B.collision_grid.update(q,q.collcells,null);(J=q.layer)&&J.removeFromInstanceList(q,!0);if(q.behavior_insts)for(J=0,G=q.behavior_insts.length;J<G;++J){var F=q.behavior_insts[J];if(F.onDestroy)F.onDestroy();F.behavior.my_instances.remove(q)}this.objects_to_pretick.remove(q);this.objects_to_tick.remove(q);this.objects_to_tick2.remove(q);if(q.onDestroy)q.onDestroy();this.objectsByUid.hasOwnProperty(q.uid.toString())&&delete this.objectsByUid[q.uid.toString()];
this.objectcount--;100>B.deadCache.length&&B.deadCache.push(q)};b.prototype.createInstance=function(q,B,G,J){if(q.is_family){var F=cr.floor(Math.random()*q.members.length);return this.createInstance(q.members[F],B,G,J)}return q.default_instance?this.createInstanceFromInit(q.default_instance,B,!1,G,J,!1):null};var E=[];b.prototype.createInstanceFromInit=function(q,B,G,J,F,M){var S,T;if(!q)return null;var U=this.types_by_index[q[1]],fa=U.plugin.is_world;if(this.isloading&&fa&&!U.isOnLoaderLayout||fa&&
!this.glwrap&&11===q[0][11])return null;var ba=B;fa||(B=null);if(U.deadCache.length){var Z=U.deadCache.pop();Z.recycled=!0;U.plugin.Instance.call(Z,U)}else Z=new U.plugin.Instance(U),Z.recycled=!1;!G||M||this.objectsByUid.hasOwnProperty(q[2].toString())?Z.uid=this.next_uid++:Z.uid=q[2];this.objectsByUid[Z.uid.toString()]=Z;Z.puid=this.next_puid++;Z.iid=U.instances.length;var da=0;for(S=this.createRow.length;da<S;++da)this.createRow[da].type===U&&Z.iid++;Z.get_iid=cr.inst_get_iid;Z.toString=cr.inst_toString;
Z.isDestroyed=!1;var ia=q[3];if(Z.recycled)cr.wipe(Z.extra);else{Z.extra={};if(this.isPreview)for(Z.instance_var_names=[],Z.instance_var_names.length=ia.length,da=0,S=ia.length;da<S;da++)Z.instance_var_names[da]=ia[da][1];Z.instance_vars=[];Z.instance_vars.length=ia.length}da=0;for(S=ia.length;da<S;da++)Z.instance_vars[da]=ia[da][0];if(fa){var ka=q[0];Z.x=cr.is_undefined(J)?ka[0]:J;Z.y=cr.is_undefined(F)?ka[1]:F;Z.z=ka[2];Z.width=ka[3];Z.height=ka[4];Z.depth=ka[5];Z.angle=ka[6];Z.opacity=ka[7];Z.hotspotX=
ka[8];Z.hotspotY=ka[9];Z.blend_mode=ka[10];da=ka[11];!this.glwrap&&U.effect_types.length&&(Z.blend_mode=da);Z.compositeOp=cr.effectToCompositeOp(Z.blend_mode);this.gl&&cr.setGLBlend(Z,Z.blend_mode,this.gl);if(Z.recycled){da=0;for(S=ka[12].length;da<S;da++)for(ia=0,T=ka[12][da].length;ia<T;ia++)Z.effect_params[da][ia]=ka[12][da][ia],Array.isArray(Z.effect_params[da][ia])&&(Z.effect_params[da][ia]=Z.effect_params[da][ia].slice(0));Z.bbox.set(0,0,0,0);Z.collcells.set(0,0,-1,-1);Z.rendercells.set(0,0,
-1,-1);Z.bquad.set_from_rect(Z.bbox);cr.clearArray(Z.bbox_changed_callbacks)}else{Z.effect_params=ka[12].slice(0);da=0;for(S=Z.effect_params.length;da<S;da++)for(Z.effect_params[da]=ka[12][da].slice(0),ia=0,T=Z.effect_params[da].length;ia<T;++ia)Array.isArray(Z.effect_params[da][ia])&&(Z.effect_params[da][ia]=Z.effect_params[da][ia].slice(0));Z.active_effect_types=[];Z.active_effect_flags=[];Z.active_effect_flags.length=U.effect_types.length;Z.bbox=new cr.rect(0,0,0,0);Z.collcells=new cr.rect(0,0,
-1,-1);Z.rendercells=new cr.rect(0,0,-1,-1);Z.bquad=new cr.quad;Z.bbox_changed_callbacks=[];Z.set_bbox_changed=cr.set_bbox_changed;Z.add_bbox_changed_callback=cr.add_bbox_changed_callback;Z.contains_pt=cr.inst_contains_pt;Z.update_bbox=cr.update_bbox;Z.update_render_cell=cr.update_render_cell;Z.update_collision_cell=cr.update_collision_cell;Z.get_zindex=cr.inst_get_zindex}Z.tilemap_exists=!1;Z.tilemap_width=0;Z.tilemap_height=0;Z.tilemap_data=null;ka[13]&&(Z.tilemap_exists=!0,Z.tilemap_width=ka[13][0],
Z.tilemap_height=ka[13][1],Z.tilemap_data=ka[13][2]);da=0;for(S=U.effect_types.length;da<S;da++)Z.active_effect_flags[da]=!0;Z.shaders_preserve_opaqueness=!0;Z.updateActiveEffects=cr.inst_updateActiveEffects;Z.updateActiveEffects();Z.uses_shaders=!!Z.active_effect_types.length;Z.bbox_changed=!0;Z.cell_changed=!0;U.any_cell_changed=!0;Z.visible=!0;Z.my_timescale=-1;Z.layer=B;Z.zindex=B.instances.length;Z.earlyz_index=0;"undefined"===typeof Z.collision_poly&&(Z.collision_poly=null);this.redraw=Z.collisionsEnabled=
!0}cr.clearArray(E);da=0;for(S=U.families.length;da<S;da++)E.push.apply(E,U.families[da].behaviors);E.push.apply(E,U.behaviors);if(Z.recycled)for(da=0,S=E.length;da<S;da++){var ta=E[da];var qa=Z.behavior_insts[da];qa.recycled=!0;ta.behavior.Instance.call(qa,ta,Z);ka=q[4][da];ia=0;for(T=ka.length;ia<T;ia++)qa.properties[ia]=ka[ia];qa.onCreate();ta.behavior.my_instances.add(Z)}else for(Z.behavior_insts=[],da=0,S=E.length;da<S;da++)ta=E[da],qa=new ta.behavior.Instance(ta,Z),qa.recycled=!1,qa.properties=
q[4][da].slice(0),qa.onCreate(),cr.seal(qa),Z.behavior_insts.push(qa),ta.behavior.my_instances.add(Z);ka=q[5];if(Z.recycled)for(da=0,S=ka.length;da<S;da++)Z.properties[da]=ka[da];else Z.properties=ka.slice(0);this.createRow.push(Z);this.hasPendingInstances=!0;B&&(B.appendToInstanceList(Z,!0),1!==B.parallaxX||1!==B.parallaxY)&&(U.any_instance_parallaxed=!0);this.objectcount++;if(U.is_contained){if(Z.is_contained=!0,Z.recycled?cr.clearArray(Z.siblings):Z.siblings=[],!G&&!M){da=0;for(S=U.container.length;da<
S;da++)if(U.container[da]!==U){if(!U.container[da].default_instance)return null;Z.siblings.push(this.createInstanceFromInit(U.container[da].default_instance,ba,!1,fa?Z.x:J,fa?Z.y:F,!0))}da=0;for(S=Z.siblings.length;da<S;da++)for(Z.siblings[da].siblings.push(Z),ia=0;ia<S;ia++)da!==ia&&Z.siblings[da].siblings.push(Z.siblings[ia])}}else Z.is_contained=!1,Z.siblings=null;Z.onCreate();Z.recycled||cr.seal(Z);da=0;for(S=Z.behavior_insts.length;da<S;da++)Z.behavior_insts[da].postCreate&&Z.behavior_insts[da].postCreate();
return Z};b.prototype.getLayerByName=function(q){var B;var G=0;for(B=this.running_layout.layers.length;G<B;G++){var J=this.running_layout.layers[G];if(cr.equals_nocase(J.name,q))return J}return null};b.prototype.getLayerByNumber=function(q){q=cr.floor(q);0>q&&(q=0);q>=this.running_layout.layers.length&&(q=this.running_layout.layers.length-1);return this.running_layout.layers[q]};b.prototype.getLayer=function(q){return cr.is_number(q)?this.getLayerByNumber(q):this.getLayerByName(q.toString())};b.prototype.clearSol=
function(q){var B;var G=0;for(B=q.length;G<B;G++)q[G].getCurrentSol().select_all=!0};b.prototype.pushCleanSol=function(q){var B;var G=0;for(B=q.length;G<B;G++)q[G].pushCleanSol()};b.prototype.pushCopySol=function(q){var B;var G=0;for(B=q.length;G<B;G++)q[G].pushCopySol()};b.prototype.popSol=function(q){var B;var G=0;for(B=q.length;G<B;G++)q[G].popSol()};b.prototype.updateAllCells=function(q){if(q.any_cell_changed){var B,G=q.instances;var J=0;for(B=G.length;J<B;++J)G[J].update_collision_cell();G=this.createRow;
J=0;for(B=G.length;J<B;++J)G[J].type===q&&G[J].update_collision_cell();q.any_cell_changed=!1}};b.prototype.getCollisionCandidates=function(q,B,G,J){var F,M=q?1!==q.parallaxX||1!==q.parallaxY:!1;if(B.is_family)for(q=0,F=B.members.length;q<F;++q){var S=B.members[q];M||S.any_instance_parallaxed?cr.appendArray(J,S.instances):(this.updateAllCells(S),S.collision_grid.queryRange(G,J))}else M||B.any_instance_parallaxed?cr.appendArray(J,B.instances):(this.updateAllCells(B),B.collision_grid.queryRange(G,J))};
b.prototype.getTypesCollisionCandidates=function(q,B,G,J){var F;var M=0;for(F=B.length;M<F;++M)this.getCollisionCandidates(q,B[M],G,J)};b.prototype.getSolidCollisionCandidates=function(q,B,G){var J=this.getSolidBehavior();if(!J)return null;this.getTypesCollisionCandidates(q,J.my_types,B,G)};b.prototype.getJumpthruCollisionCandidates=function(q,B,G){var J=this.getJumpthruBehavior();if(!J)return null;this.getTypesCollisionCandidates(q,J.my_types,B,G)};b.prototype.testAndSelectCanvasPointOverlap=function(q,
B,G,J){var F=q.getCurrentSol(),M,S=this.getCurrentEventStack().current_event.orblock;if(F.select_all){J||(F.select_all=!1,cr.clearArray(F.instances));var T=0;for(M=q.instances.length;T<M;T++){var U=q.instances[T];U.update_bbox();var fa=U.layer.canvasToLayer(B,G,!0);var ba=U.layer.canvasToLayer(B,G,!1);if(U.contains_pt(fa,ba)){if(J)return!1;F.instances.push(U)}else S&&F.else_instances.push(U)}}else{var Z=0;var da=S?F.else_instances:F.instances;T=0;for(M=da.length;T<M;T++)if(U=da[T],U.update_bbox(),
fa=U.layer.canvasToLayer(B,G,!0),ba=U.layer.canvasToLayer(B,G,!1),U.contains_pt(fa,ba)){if(J)return!1;S?F.instances.push(U):(F.instances[Z]=F.instances[T],Z++)}J||(da.length=Z)}q.applySolToContainer();return J?!0:F.hasObjects()};b.prototype.testOverlap=function(q,B){if(!(q&&B&&q!==B&&q.collisionsEnabled&&B.collisionsEnabled))return!1;q.update_bbox();B.update_bbox();var G=q.layer,J=B.layer,F;if(G===J||G.parallaxX===J.parallaxX&&J.parallaxY===J.parallaxY&&G.scale===J.scale&&G.angle===J.angle&&G.zoomRate===
J.zoomRate){if(!q.bbox.intersects_rect(B.bbox)||!q.bquad.intersects_quad(B.bquad)||q.tilemap_exists&&B.tilemap_exists)return!1;if(q.tilemap_exists)return this.testTilemapOverlap(q,B);if(B.tilemap_exists)return this.testTilemapOverlap(B,q);var M=q.collision_poly&&!q.collision_poly.is_empty();var S=B.collision_poly&&!B.collision_poly.is_empty();if(!M&&!S)return!0;M?(q.collision_poly.cache_poly(q.width,q.height,q.angle),M=q.collision_poly):(this.temp_poly.set_from_quad(q.bquad,q.x,q.y,q.width,q.height),
M=this.temp_poly);if(S){B.collision_poly.cache_poly(B.width,B.height,B.angle);var T=B.collision_poly}else this.temp_poly.set_from_quad(B.bquad,B.x,B.y,B.width,B.height),T=this.temp_poly;return M.intersects_poly(T,B.x-q.x,B.y-q.y)}M=q.collision_poly&&!q.collision_poly.is_empty();S=B.collision_poly&&!B.collision_poly.is_empty();M?(q.collision_poly.cache_poly(q.width,q.height,q.angle),this.temp_poly.set_from_poly(q.collision_poly)):this.temp_poly.set_from_quad(q.bquad,q.x,q.y,q.width,q.height);M=this.temp_poly;
S?(B.collision_poly.cache_poly(B.width,B.height,B.angle),this.temp_poly2.set_from_poly(B.collision_poly)):this.temp_poly2.set_from_quad(B.bquad,B.x,B.y,B.width,B.height);T=this.temp_poly2;S=0;for(F=M.pts_count;S<F;S++){var U=2*S;var fa=U+1;var ba=M.pts_cache[U];var Z=M.pts_cache[fa];M.pts_cache[U]=G.layerToCanvas(ba+q.x,Z+q.y,!0);M.pts_cache[fa]=G.layerToCanvas(ba+q.x,Z+q.y,!1)}M.update_bbox();S=0;for(F=T.pts_count;S<F;S++)U=2*S,fa=U+1,ba=T.pts_cache[U],Z=T.pts_cache[fa],T.pts_cache[U]=J.layerToCanvas(ba+
B.x,Z+B.y,!0),T.pts_cache[fa]=J.layerToCanvas(ba+B.x,Z+B.y,!1);T.update_bbox();return M.intersects_poly(T,0,0)};var L=new cr.quad,N=new cr.rect(0,0,0,0),V=[];b.prototype.testTilemapOverlap=function(q,B){var G,J=B.bbox,F=q.x,M=q.y;q.getCollisionRectCandidates(J,V);var S=B.collision_poly&&!B.collision_poly.is_empty();q=0;for(G=V.length;q<G;++q){var T=V[q];var U=T.rc;if(J.intersects_rect_off(U,F,M)&&(L.set_from_rect(U),L.offset(F,M),L.intersects_quad(B.bquad)))if(S)if(B.collision_poly.cache_poly(B.width,
B.height,B.angle),T.poly){if(T.poly.intersects_poly(B.collision_poly,B.x-(F+U.left),B.y-(M+U.top)))return cr.clearArray(V),!0}else{if(this.temp_poly.set_from_quad(L,0,0,U.right-U.left,U.bottom-U.top),this.temp_poly.intersects_poly(B.collision_poly,B.x,B.y))return cr.clearArray(V),!0}else if(T.poly){if(this.temp_poly.set_from_quad(B.bquad,0,0,B.width,B.height),T.poly.intersects_poly(this.temp_poly,-(F+U.left),-(M+U.top)))return cr.clearArray(V),!0}else return cr.clearArray(V),!0}cr.clearArray(V);return!1};
b.prototype.testRectOverlap=function(q,B){if(!B||!B.collisionsEnabled)return!1;B.update_bbox();if(!B.bbox.intersects_rect(q))return!1;if(B.tilemap_exists){B.getCollisionRectCandidates(q,V);var G,J=B.x,F=B.y;B=0;for(G=V.length;B<G;++B){var M=V[B];var S=M.rc;if(q.intersects_rect_off(S,J,F))if(M.poly){if(this.temp_poly.set_from_rect(q,0,0),M.poly.intersects_poly(this.temp_poly,-(J+S.left),-(F+S.top)))return cr.clearArray(V),!0}else return cr.clearArray(V),!0}cr.clearArray(V);return!1}L.set_from_rect(q);
if(!B.bquad.intersects_quad(L))return!1;if(!B.collision_poly||B.collision_poly.is_empty())return!0;B.collision_poly.cache_poly(B.width,B.height,B.angle);L.offset(-q.left,-q.top);this.temp_poly.set_from_quad(L,0,0,1,1);return B.collision_poly.intersects_poly(this.temp_poly,q.left-B.x,q.top-B.y)};b.prototype.testSegmentOverlap=function(q,B,G,J,F){if(!F||!F.collisionsEnabled)return!1;F.update_bbox();N.set(cr.min(q,G),cr.min(B,J),cr.max(q,G),cr.max(B,J));if(!F.bbox.intersects_rect(N))return!1;if(F.tilemap_exists){F.getCollisionRectCandidates(N,
V);var M,S=F.x,T=F.y;F=0;for(M=V.length;F<M;++F){var U=V[F];var fa=U.rc;if(N.intersects_rect_off(fa,S,T)&&(L.set_from_rect(fa),L.offset(S,T),L.intersects_segment(q,B,G,J)))if(U.poly){if(U.poly.intersects_segment(S+fa.left,T+fa.top,q,B,G,J))return cr.clearArray(V),!0}else return cr.clearArray(V),!0}cr.clearArray(V);return!1}if(!F.bquad.intersects_segment(q,B,G,J))return!1;if(!F.collision_poly||F.collision_poly.is_empty())return!0;F.collision_poly.cache_poly(F.width,F.height,F.angle);return F.collision_poly.intersects_segment(F.x,
F.y,q,B,G,J)};b.prototype.typeHasBehavior=function(q,B){if(!B)return!1;var G,J;var F=0;for(G=q.behaviors.length;F<G;F++)if(q.behaviors[F].behavior instanceof B)return!0;if(!q.is_family)for(F=0,G=q.families.length;F<G;F++){var M=q.families[F];var S=0;for(J=M.behaviors.length;S<J;S++)if(M.behaviors[S].behavior instanceof B)return!0}return!1};b.prototype.typeHasNoSaveBehavior=function(q){return this.typeHasBehavior(q,cr.behaviors.NoSave)};b.prototype.typeHasPersistBehavior=function(q){return this.typeHasBehavior(q,
cr.behaviors.Persist)};b.prototype.getSolidBehavior=function(){return this.solidBehavior};b.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var W=[];b.prototype.testOverlapSolid=function(q){var B;q.update_bbox();this.getSolidCollisionCandidates(q.layer,q.bbox,W);var G=0;for(B=W.length;G<B;++G){var J=W[G];if(J.extra.solidEnabled&&this.testOverlap(q,J))return cr.clearArray(W),J}cr.clearArray(W);return null};b.prototype.testRectOverlapSolid=function(q){var B;this.getSolidCollisionCandidates(null,
q,W);var G=0;for(B=W.length;G<B;++G){var J=W[G];if(J.extra.solidEnabled&&this.testRectOverlap(q,J))return cr.clearArray(W),J}cr.clearArray(W);return null};var X=[];b.prototype.testOverlapJumpThru=function(q,B){var G=null;B&&(G=X,cr.clearArray(G));q.update_bbox();this.getJumpthruCollisionCandidates(q.layer,q.bbox,W);var J;var F=0;for(J=W.length;F<J;++F){var M=W[F];if(M.extra.jumpthruEnabled&&this.testOverlap(q,M))if(B)G.push(M);else return cr.clearArray(W),M}cr.clearArray(W);return G};b.prototype.pushOutSolid=
function(q,B,G,J,F,M){J=J||50;var S=q.x,T=q.y,U,fa=null,ba=null;for(U=0;U<J;U++)if(q.x=S+B*U,q.y=T+G*U,q.set_bbox_changed(),!this.testOverlap(q,fa)&&((fa=this.testOverlapSolid(q))&&(ba=fa),!fa&&(F&&(fa=M?this.testOverlap(q,M)?M:null:this.testOverlapJumpThru(q))&&(ba=fa),!fa)))return ba&&this.pushInFractional(q,B,G,ba,16),!0;q.x=S;q.y=T;q.set_bbox_changed();return!1};b.prototype.pushOutSolidAxis=function(q,B,G,J){J=J||50;var F=q.x,M=q.y,S=null,T=null,U,fa;for(U=0;U<J;++U)for(fa=0;2>fa;++fa){var ba=
2*fa-1;q.x=F+B*U*ba;q.y=M+G*U*ba;q.set_bbox_changed();if(!this.testOverlap(q,S))if(S=this.testOverlapSolid(q))T=S;else return T&&this.pushInFractional(q,B*ba,G*ba,T,16),!0}q.x=F;q.y=M;q.set_bbox_changed();return!1};b.prototype.pushOut=function(q,B,G,J,F){J=J||50;var M=q.x,S=q.y,T;for(T=0;T<J;T++)if(q.x=M+B*T,q.y=S+G*T,q.set_bbox_changed(),!this.testOverlap(q,F))return!0;q.x=M;q.y=S;q.set_bbox_changed();return!1};b.prototype.pushInFractional=function(q,B,G,J,F){var M=2,S=!1;var T=!1;for(var U=q.x,
fa=q.y;M<=F;)T=1/M,M*=2,q.x+=B*T*(S?1:-1),q.y+=G*T*(S?1:-1),q.set_bbox_changed(),this.testOverlap(q,J)?T=S=!0:(T=S=!1,U=q.x,fa=q.y);T&&(q.x=U,q.y=fa,q.set_bbox_changed())};b.prototype.pushOutSolidNearest=function(q,B){B=cr.is_undefined(B)?100:B;var G=0,J=q.x,F=q.y,M=0,S=0,T=0,U=this.testOverlapSolid(q);if(!U)return!0;for(;G<=B;){switch(M){case 0:S=0;T=-1;G++;break;case 1:S=1;T=-1;break;case 2:S=1;T=0;break;case 3:T=S=1;break;case 4:S=0;T=1;break;case 5:S=-1;T=1;break;case 6:S=-1;T=0;break;case 7:T=
S=-1}M=(M+1)%8;q.x=cr.floor(J+S*G);q.y=cr.floor(F+T*G);q.set_bbox_changed();if(!this.testOverlap(q,U)&&(U=this.testOverlapSolid(q),!U))return!0}q.x=J;q.y=F;q.set_bbox_changed();return!1};b.prototype.registerCollision=function(q,B){q.collisionsEnabled&&B.collisionsEnabled&&this.registered_collisions.push([q,B])};b.prototype.addRegisteredCollisionCandidates=function(q,B,G){var J;var F=0;for(J=this.registered_collisions.length;F<J;++F){var M=this.registered_collisions[F];if(M[0]===q)M=M[1];else if(M[1]===
q)M=M[0];else continue;if(B.is_family){if(-1===B.members.indexOf(B))continue}else if(M.type!==B)continue;-1===G.indexOf(M)&&G.push(M)}};b.prototype.checkRegisteredCollision=function(q,B){var G;var J=0;for(G=this.registered_collisions.length;J<G;J++){var F=this.registered_collisions[J];if(F[0]===q&&F[1]===B||F[0]===B&&F[1]===q)return!0}return!1};b.prototype.calculateSolidBounceAngle=function(q,B,G,J){var F=q.x,M=q.y,S=cr.max(10,cr.distanceTo(B,G,F,M)),T=cr.angleTo(B,G,F,M),U=J||this.testOverlapSolid(q);
if(!U)return cr.clamp_angle(T+cr.PI);var fa=U,ba,Z=cr.to_radians(5);for(ba=1;36>ba;ba++){var da=T-ba*Z;q.x=B+Math.cos(da)*S;q.y=G+Math.sin(da)*S;q.set_bbox_changed();if(!this.testOverlap(q,fa)&&(fa=J?null:this.testOverlapSolid(q),!fa)){var ia=da;break}}36===ba&&(ia=cr.clamp_angle(T+cr.PI));fa=U;for(ba=1;36>ba;ba++)if(da=T+ba*Z,q.x=B+Math.cos(da)*S,q.y=G+Math.sin(da)*S,q.set_bbox_changed(),!this.testOverlap(q,fa)&&(fa=J?null:this.testOverlapSolid(q),!fa)){var ka=da;break}36===ba&&(ka=cr.clamp_angle(T+
cr.PI));q.x=F;q.y=M;q.set_bbox_changed();if(ka===ia)return ka;q=cr.angleDiff(ka,ia)/2;q=cr.angleClockwise(ka,ia)?cr.clamp_angle(ia+q+cr.PI):cr.clamp_angle(ka+q);ia=Math.cos(T);T=Math.sin(T);ka=Math.cos(q);q=Math.sin(q);B=ia*ka+T*q;return cr.angleTo(0,0,ia-2*B*ka,T-2*B*q)};var Y=-1;b.prototype.trigger=function(q,B,G){if(!this.running_layout)return!1;var J=this.running_layout.event_sheet;if(!J)return!1;var F=!1,M;Y++;var S=J.deep_includes;var T=0;for(M=S.length;T<M;++T){var U=this.triggerOnSheet(q,
B,S[T],G);F=F||U}U=this.triggerOnSheet(q,B,J,G);Y--;return F||U};b.prototype.triggerOnSheet=function(q,B,G,J){var F=!1,M;if(B){var S=this.triggerOnSheetForTypeName(q,B,B.type.name,G,J);F=F||S;var T=B.type.families;var U=0;for(M=T.length;U<M;++U)S=this.triggerOnSheetForTypeName(q,B,T[U].name,G,J),F=F||S}else S=this.triggerOnSheetForTypeName(q,B,"system",G,J),F=F||S;return F};b.prototype.triggerOnSheetForTypeName=function(q,B,G,J,F){var M,S=!1;var T="undefined"!==typeof F;var U=(T?J.fasttriggers:J.triggers)[G];
if(!U)return S;var fa=null;J=0;for(M=U.length;J<M;++J)if(U[J].method==q){fa=U[J].evs;break}if(!fa)return S;q=T?fa[F]:fa;if(!q)return null;J=0;for(M=q.length;J<M;J++)F=q[J][0],T=q[J][1],F=this.executeSingleTrigger(B,G,F,T),S=S||F;return S};b.prototype.executeSingleTrigger=function(q,B,G,J){var F,M=!1;this.trigger_depth++;var S=this.getCurrentEventStack().current_event;S&&this.pushCleanSol(S.solModifiersIncludingParents);var T=1<this.trigger_depth;this.pushCleanSol(G.solModifiersIncludingParents);T&&
this.pushLocalVarStack();var U=this.pushEventStack(G);U.current_event=G;if(q){var fa=this.types[B].getCurrentSol();fa.select_all=!1;cr.clearArray(fa.instances);fa.instances[0]=q;this.types[B].applySolToContainer()}q=!0;if(G.parent){B=U.temp_parents_arr;for(fa=G.parent;fa;)B.push(fa),fa=fa.parent;B.reverse();fa=0;for(F=B.length;fa<F;fa++)if(!B[fa].run_pretrigger()){q=!1;break}}q&&(this.execcount++,G.orblock?G.run_orblocktrigger(J):G.run(),M=M||U.last_event_true);this.popEventStack();T&&this.popLocalVarStack();
this.popSol(G.solModifiersIncludingParents);S&&this.popSol(S.solModifiersIncludingParents);this.hasPendingInstances&&0===this.isInOnDestroy&&0===Y&&!this.isRunningEvents&&this.ClearDeathRow();this.trigger_depth--;return M};b.prototype.getCurrentCondition=function(){var q=this.getCurrentEventStack();return q.current_event.conditions[q.cndindex]};b.prototype.getCurrentConditionObjectType=function(){return this.getCurrentCondition().type};b.prototype.isCurrentConditionFirst=function(){return 0===this.getCurrentEventStack().cndindex};
b.prototype.getCurrentAction=function(){var q=this.getCurrentEventStack();return q.current_event.actions[q.actindex]};b.prototype.pushLocalVarStack=function(){this.localvar_stack_index++;this.localvar_stack_index>=this.localvar_stack.length&&this.localvar_stack.push([])};b.prototype.popLocalVarStack=function(){this.localvar_stack_index--};b.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]};b.prototype.pushEventStack=function(q){this.event_stack_index++;
this.event_stack_index>=this.event_stack.length&&this.event_stack.push(new cr.eventStackFrame);var B=this.getCurrentEventStack();B.reset(q);return B};b.prototype.popEventStack=function(){this.event_stack_index--};b.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]};b.prototype.pushLoopStack=function(q){this.loop_stack_index++;this.loop_stack_index>=this.loop_stack.length&&this.loop_stack.push(cr.seal({name:q,index:0,stopped:!1}));var B=this.getCurrentLoop();
B.name=q;B.index=0;B.stopped=!1;return B};b.prototype.popLoopStack=function(){this.loop_stack_index--};b.prototype.getCurrentLoop=function(){return this.loop_stack[this.loop_stack_index]};b.prototype.getEventVariableByName=function(q,B){for(var G,J,F,M,S;B;){G=0;for(J=B.subevents.length;G<J;G++)if(S=B.subevents[G],S instanceof cr.eventvariable&&cr.equals_nocase(q,S.name))return S;B=B.parent}G=0;for(J=this.eventsheets_by_index.length;G<J;G++)for(M=this.eventsheets_by_index[G],B=0,F=M.events.length;B<
F;B++)if(S=M.events[B],S instanceof cr.eventvariable&&cr.equals_nocase(q,S.name))return S;return null};b.prototype.getLayoutBySid=function(q){var B;var G=0;for(B=this.layouts_by_index.length;G<B;G++)if(this.layouts_by_index[G].sid===q)return this.layouts_by_index[G];return null};b.prototype.getObjectTypeBySid=function(q){var B;var G=0;for(B=this.types_by_index.length;G<B;G++)if(this.types_by_index[G].sid===q)return this.types_by_index[G];return null};b.prototype.getGroupBySid=function(q){var B;var G=
0;for(B=this.allGroups.length;G<B;G++)if(this.allGroups[G].sid===q)return this.allGroups[G];return null};b.prototype.requirePermissions=function(q){return this.getPermissions(q).then(function(B){if(!1===B)return Promise.reject("Permission not granted")})};b.prototype.getPermissions=function(q){return this.isCordova&&this.isAndroid?q.reduce(function(B,G){return B.then(function(J){return!1===J?!1:n(G).then(function(F){return F?!0:g(G)})})},Promise.resolve(!0)):Promise.resolve(!0)};b.prototype.doCanvasSnapshot=
function(q,B){this.snapshotCanvas=[q,B];this.redraw=!0};b.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0};b.prototype.handleSaveLoad=function(){var q=this,B=this.saveToSlot,G=this.lastSaveJson,J=this.loadFromSlot,F=!1;this.signalledContinuousPreview&&(F=!0,B="__c2_continuouspreview",this.signalledContinuousPreview=!1);if(B.length){this.ClearDeathRow();G=this.saveToJSONString();if(t())c(B,G,function(){cr.logexport("Saved state to IndexedDB storage ("+G.length+" bytes)");
q.lastSaveJson=G;q.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null);G=q.lastSaveJson="";F&&d()},function(M){try{localStorage.setItem("__c2save_"+B,G),cr.logexport("Saved state to WebStorage ("+G.length+" bytes)"),q.lastSaveJson=G,q.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),G=q.lastSaveJson="",F&&d()}catch(S){cr.logexport("Failed to save game state: "+M+"; "+S),q.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}});else try{localStorage.setItem("__c2save_"+B,
G),cr.logexport("Saved state to WebStorage ("+G.length+" bytes)"),q.lastSaveJson=G,this.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),G=q.lastSaveJson="",F&&d()}catch(M){cr.logexport("Error saving to WebStorage: "+M),q.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null}if(J.length){if(t())a(J,function(M){M?(q.loadFromJson=M,cr.logexport("Loaded state from IndexedDB storage ("+q.loadFromJson.length+" bytes)")):(q.loadFromJson=
localStorage.getItem("__c2save_"+J)||"",cr.logexport("Loaded state from WebStorage ("+q.loadFromJson.length+" bytes)"));q.suspendDrawing=!1;q.loadFromJson||(q.loadFromJson=null,q.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))},function(M){q.loadFromJson=localStorage.getItem("__c2save_"+J)||"";cr.logexport("Loaded state from WebStorage ("+q.loadFromJson.length+" bytes)");q.suspendDrawing=!1;q.loadFromJson||(q.loadFromJson=null,q.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))});
else{try{this.loadFromJson=localStorage.getItem("__c2save_"+J)||"",cr.logexport("Loaded state from WebStorage ("+this.loadFromJson.length+" bytes)")}catch(M){this.loadFromJson=null}this.suspendDrawing=!1;q.loadFromJson||(q.loadFromJson=null,q.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))}this.saveToSlot=this.loadFromSlot=""}null!==this.loadFromJson&&(this.ClearDeathRow(),this.loadFromJSONString(this.loadFromJson)?(this.lastSaveJson=this.loadFromJson,this.trigger(cr.system_object.prototype.cnds.OnLoadComplete,
null),this.lastSaveJson=""):q.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null),this.loadFromJson=null)};b.prototype.saveToJSONString=function(){var q,B,G,J={c2save:!0,version:1,rt:{time:this.kahanTime.sum,walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};var F=0;for(q=
this.types_by_index.length;F<q;F++){var M=this.types_by_index[F];if(!M.is_family&&!this.typeHasNoSaveBehavior(M)){var S={instances:[]};cr.hasAnyOwnProperty(M.extra)&&(S.ex=h(M.extra));var T=0;for(B=M.instances.length;T<B;T++)S.instances.push(this.saveInstanceToJSON(M.instances[T]));J.types[M.sid.toString()]=S}}F=0;for(q=this.layouts_by_index.length;F<q;F++)T=this.layouts_by_index[F],J.layouts[T.sid.toString()]=T.saveToJSON();B=J.events.groups;F=0;for(q=this.allGroups.length;F<q;F++)T=this.allGroups[F],
B[T.sid.toString()]=this.groups_by_name[T.group_name].group_active;q=J.events.cnds;for(G in this.cndsBySid)this.cndsBySid.hasOwnProperty(G)&&(F=this.cndsBySid[G],cr.hasAnyOwnProperty(F.extra)&&(q[G]={ex:h(F.extra)}));q=J.events.acts;for(G in this.actsBySid)this.actsBySid.hasOwnProperty(G)&&(F=this.actsBySid[G],cr.hasAnyOwnProperty(F.extra)&&(q[G]={ex:h(F.extra)}));q=J.events.vars;for(G in this.varsBySid)this.varsBySid.hasOwnProperty(G)&&(F=this.varsBySid[G],F.is_constant||F.parent&&!F.is_static||
(q[G]=F.data));J.system=this.system.saveToJSON();return JSON.stringify(J)};b.prototype.refreshUidMap=function(){var q,B;this.objectsByUid={};var G=0;for(q=this.types_by_index.length;G<q;G++){var J=this.types_by_index[G];if(!J.is_family){var F=0;for(B=J.instances.length;F<B;F++){var M=J.instances[F];this.objectsByUid[M.uid.toString()]=M}}}};b.prototype.loadFromJSONString=function(q){try{var B=JSON.parse(q)}catch(ba){return!1}if(!B.c2save||1<B.version)return!1;this.isLoadingState=!0;q=B.rt;this.kahanTime.reset();
this.kahanTime.sum=q.time;this.wallTime.reset();this.wallTime.sum=q.walltime||0;this.timescale=q.timescale;this.tickcount=q.tickcount;this.execcount=q.execcount;this.start_time=Date.now()-q.start_time_offset;var G=q.running_layout;if(G!==this.running_layout.sid)if(G=this.getLayoutBySid(G))this.doChangeLayout(G);else return;var J,F,M;var S=B.types;for(F in S)if(S.hasOwnProperty(F)&&(M=this.getObjectTypeBySid(parseInt(F,10)))&&!M.is_family&&!this.typeHasNoSaveBehavior(M)){S[F].ex?M.extra=S[F].ex:cr.wipe(M.extra);
var T=M.instances;var U=S[F].instances;G=0;for(J=cr.min(T.length,U.length);G<J;G++)this.loadInstanceFromJSON(T[G],U[G]);G=U.length;for(J=T.length;G<J;G++)this.DestroyInstance(T[G]);G=T.length;for(J=U.length;G<J;G++){T=null;if(M.plugin.is_world&&(T=this.running_layout.getLayerBySid(U[G].w.l),!T))continue;T=this.createInstanceFromInit(M.default_instance,T,!1,0,0,!0);this.loadInstanceFromJSON(T,U[G])}M.stale_iids=!0}this.ClearDeathRow();this.refreshUidMap();J=B.layouts;for(F in J)J.hasOwnProperty(F)&&
(G=this.getLayoutBySid(parseInt(F,10)))&&G.loadFromJSON(J[F]);J=B.events.groups;for(F in J)J.hasOwnProperty(F)&&(G=this.getGroupBySid(parseInt(F,10)))&&this.groups_by_name[G.group_name]&&this.groups_by_name[G.group_name].setGroupActive(J[F]);G=B.events.cnds;for(F in this.cndsBySid)this.cndsBySid.hasOwnProperty(F)&&(G.hasOwnProperty(F)?this.cndsBySid[F].extra=G[F].ex:this.cndsBySid[F].extra={});G=B.events.acts;for(F in this.actsBySid)this.actsBySid.hasOwnProperty(F)&&(G.hasOwnProperty(F)?this.actsBySid[F].extra=
G[F].ex:this.actsBySid[F].extra={});G=B.events.vars;for(F in G)G.hasOwnProperty(F)&&this.varsBySid.hasOwnProperty(F)&&(this.varsBySid[F].data=G[F]);this.next_uid=q.next_uid;this.isLoadingState=!1;G=0;for(J=this.fireOnCreateAfterLoad.length;G<J;++G)T=this.fireOnCreateAfterLoad[G],this.trigger(Object.getPrototypeOf(T.type.plugin).cnds.OnCreated,T);cr.clearArray(this.fireOnCreateAfterLoad);this.system.loadFromJSON(B.system);G=0;for(J=this.types_by_index.length;G<J;G++)if(M=this.types_by_index[G],!M.is_family&&
!this.typeHasNoSaveBehavior(M))for(B=0,F=M.instances.length;B<F;B++){T=M.instances[B];if(M.is_contained)for(S=T.get_iid(),cr.clearArray(T.siblings),q=0,U=M.container.length;q<U;q++){var fa=M.container[q];M!==fa&&T.siblings.push(fa.instances[S])}T.afterLoad&&T.afterLoad();if(T.behavior_insts)for(q=0,U=T.behavior_insts.length;q<U;q++)S=T.behavior_insts[q],S.afterLoad&&S.afterLoad()}return this.redraw=!0};b.prototype.saveInstanceToJSON=function(q,B){var G;var J=q.type;var F=J.plugin;var M={};B?M.c2=
!0:M.uid=q.uid;cr.hasAnyOwnProperty(q.extra)&&(M.ex=h(q.extra));if(q.instance_vars&&q.instance_vars.length)for(M.ivs={},B=0,G=q.instance_vars.length;B<G;B++)M.ivs[q.type.instvar_sids[B].toString()]=q.instance_vars[B];if(F.is_world){F={x:q.x,y:q.y,w:q.width,h:q.height,l:q.layer.sid,zi:q.get_zindex()};0!==q.angle&&(F.a=q.angle);1!==q.opacity&&(F.o=q.opacity);.5!==q.hotspotX&&(F.hX=q.hotspotX);.5!==q.hotspotY&&(F.hY=q.hotspotY);0!==q.blend_mode&&(F.bm=q.blend_mode);q.visible||(F.v=q.visible);q.collisionsEnabled||
(F.ce=q.collisionsEnabled);-1!==q.my_timescale&&(F.mts=q.my_timescale);if(J.effect_types.length)for(F.fx=[],B=0,G=J.effect_types.length;B<G;B++){var S=J.effect_types[B];F.fx.push({name:S.name,active:q.active_effect_flags[S.index],params:q.effect_params[S.index]})}M.w=F}if(q.behavior_insts&&q.behavior_insts.length)for(M.behs={},B=0,G=q.behavior_insts.length;B<G;B++)J=q.behavior_insts[B],J.saveToJSON&&(M.behs[J.type.sid.toString()]=J.saveToJSON());q.saveToJSON&&(M.data=q.saveToJSON());return M};b.prototype.getInstanceVarIndexBySid=
function(q,B){var G;var J=0;for(G=q.instvar_sids.length;J<G;J++)if(q.instvar_sids[J]===B)return J;return-1};b.prototype.getBehaviorIndexBySid=function(q,B){var G;var J=0;for(G=q.behavior_insts.length;J<G;J++)if(q.behavior_insts[J].type.sid===B)return J;return-1};b.prototype.loadInstanceFromJSON=function(q,B,G){var J,F;var M=q.type;var S=M.plugin;if(G){if(!B.c2)return}else q.uid=B.uid;B.ex?q.extra=B.ex:cr.wipe(q.extra);if(F=B.ivs)for(J in F)if(F.hasOwnProperty(J)){var T=this.getInstanceVarIndexBySid(M,
parseInt(J,10));if(!(0>T||T>=q.instance_vars.length)){var U=F[J];null===U&&(U=NaN);q.instance_vars[T]=U}}if(S.is_world){T=B.w;q.layer.sid!==T.l&&(F=q.layer,q.layer=this.running_layout.getLayerBySid(T.l),q.layer?(F.removeFromInstanceList(q,!0),q.layer.appendToInstanceList(q,!0),q.set_bbox_changed(),q.layer.setZIndicesStaleFrom(0)):(q.layer=F,G||this.DestroyInstance(q)));q.x=T.x;q.y=T.y;q.width=T.w;q.height=T.h;q.zindex=T.zi;q.angle=T.hasOwnProperty("a")?T.a:0;q.opacity=T.hasOwnProperty("o")?T.o:1;
q.hotspotX=T.hasOwnProperty("hX")?T.hX:.5;q.hotspotY=T.hasOwnProperty("hY")?T.hY:.5;q.visible=T.hasOwnProperty("v")?T.v:!0;q.collisionsEnabled=T.hasOwnProperty("ce")?T.ce:!0;q.my_timescale=T.hasOwnProperty("mts")?T.mts:-1;q.blend_mode=T.hasOwnProperty("bm")?T.bm:0;q.compositeOp=cr.effectToCompositeOp(q.blend_mode);this.gl&&cr.setGLBlend(q,q.blend_mode,this.gl);q.set_bbox_changed();if(T.hasOwnProperty("fx"))for(G=0,F=T.fx.length;G<F;G++)U=M.getEffectIndexByName(T.fx[G].name),0>U||(q.active_effect_flags[U]=
T.fx[G].active,q.effect_params[U]=T.fx[G].params);q.updateActiveEffects()}if(M=B.behs)for(J in M)M.hasOwnProperty(J)&&(G=this.getBehaviorIndexBySid(q,parseInt(J,10)),0>G||q.behavior_insts[G].loadFromJSON(M[J]));B.data&&q.loadFromJSON(B.data)};b.prototype.getProjectFileUrl=function(q){return this.isPreview?window.cr_previewProjectFiles.hasOwnProperty(q.toLowerCase())?window.cr_previewProjectFiles[q.toLowerCase()]:q:this.files_subfolder+q};b.prototype.getProjectFileBlob=function(q){return this.isPreview?
window.cr_previewProjectFileBlobs&&window.cr_previewProjectFiles.hasOwnProperty(q.toLowerCase())?window.cr_previewProjectFileBlobs[q.toLowerCase()]:null:null};b.prototype.getLocalFileUrl=function(q){return this.isPreview?window.cr_previewProjectFiles.hasOwnProperty(q.toLowerCase())?window.cr_previewProjectFiles[q.toLowerCase()]:q:q};b.prototype.fetchLocalFileViaCordova=function(q,B,G){window.resolveLocalFileSystemURL(window.cordova.file.applicationDirectory+"www/"+q,function(J){J.file(B,G)},G)};b.prototype.fetchLocalFileViaCordovaAsText=
function(q,B,G){this.fetchLocalFileViaCordova(q,function(J){var F=new FileReader;F.onload=function(M){B(M.target.result)};F.onerror=G;F.readAsText(J)},G)};var ea=[],ha=0;b.prototype.maybeStartNextArrayBufferRead=function(){if(ea.length&&!(8<=ha)){ha++;var q=ea.shift();this.doFetchLocalFileViaCordovaAsArrayBuffer(q.filename,q.successCallback,q.errorCallback)}};b.prototype.fetchLocalFileViaCordovaAsArrayBuffer=function(q,B,G){var J=this;ea.push({filename:q,successCallback:function(F){ha--;J.maybeStartNextArrayBufferRead();
B(F)},errorCallback:function(F){ha--;J.maybeStartNextArrayBufferRead();G(F)}});this.maybeStartNextArrayBufferRead()};b.prototype.doFetchLocalFileViaCordovaAsArrayBuffer=function(q,B,G){this.fetchLocalFileViaCordova(q,function(J){var F=new FileReader;F.onload=function(M){B(M.target.result)};F.readAsArrayBuffer(J)},G)};b.prototype.fetchLocalFileViaCordovaAsURL=function(q,B,G){var J="",F=q.toLowerCase(),M=F.substr(F.length-4);F=F.substr(F.length-5);".mp4"===M?J="video/mp4":".webm"===F?J="video/webm":
".m4a"===M?J="audio/mp4":".mp3"===M&&(J="audio/mpeg");this.fetchLocalFileViaCordovaAsArrayBuffer(q,function(S){S=new Blob([S],{type:J});S=URL.createObjectURL(S);B(S)},G)};b.prototype.isAbsoluteUrl=function(q){return/^(?:[a-z]+:)?\/\//.test(q)||"data:"===q.substr(0,5)||"blob:"===q.substr(0,5)};b.prototype.setImageSrc=function(q,B){this.isWKWebView&&!this.isAbsoluteUrl(B)?this.fetchLocalFileViaCordovaAsURL(B,function(G){q.src=G},function(G){alert("Failed to load image: "+G)}):this.isPreview&&!this.isAbsoluteUrl(B)?
q.src=this.getLocalFileUrl(B):(this.isAbsoluteUrl(B)||(B=B.toLowerCase()),q.src=B)};b.prototype.getPreferredAudioFile=function(q){q=q.toLowerCase();if(!this.audio_files_map.hasOwnProperty(q))return null;q=this.audio_files_map[q];var B=null,G;var J=0;for(G=q.length;J<G;++J){var F=q[J];var M=F[0];B||"audio/webm; codecs=opus"!==M||(B=F);if(C[M])return F}return B};b.prototype.getProjectAudioFileUrl=function(q){var B=q.toLowerCase();return(q=this.getPreferredAudioFile(q))?{url:this.getProjectFileUrl(B+
q[1]),type:q[0]}:null};b.prototype.getStatusInfo=function(){return{fps:this.fps,cpu:this.cpuutilisation/1E3,gpu:this.gpuLastUtilisation,layout:this.running_layout?this.running_layout.name:"",renderer:this.glUnmaskedRenderer}};b.prototype.accelerate=function(q,B,G,J,F){return this.enhancedAccelerationPrecision?cr.clamp(q*F+.5*J*F*F,B*F,G*F):q*F};cr.runtime=b;cr.createRuntime=function(q){return new b(q)};window.cr_createRuntime=cr.createRuntime})();
window.cr_getSnapshot=function(b,f){var g=window.c3runtime;g&&g.doCanvasSnapshot(b,f)};window.cr_sizeCanvas=function(b,f){if(0!==b&&0!==f){var g=window.c3runtime;g&&g.setSize(b,f)}};window.cr_setSuspended=function(b){var f=window.c3runtime;f&&f.setSuspended(b)};
(function(){function b(a,d){return a.zindex-d.zindex}function f(a,d){this.layout=a;this.runtime=a.runtime;this.instances=[];this.scale=1;this.angle=0;this.disableAngle=!1;this.tmprect=new cr.rect(0,0,0,0);this.tmpquad=new cr.quad;this.viewBottom=this.viewTop=this.viewRight=this.viewLeft=0;this.zindices_stale=!1;this.zindices_stale_from=-1;this.clear_earlyz_index=0;this.name=d[0];this.index=d[1];this.sid=d[2];this.visible=d[3];this.background_color=d[4];this.transparent=d[5];this.parallaxX=d[6];this.parallaxY=
d[7];this.opacity=d[8];this.forceOwnTexture=d[9];this.useRenderCells=d[10];this.zoomRate=d[11];this.blend_mode=d[12];this.effect_fallback=d[13];this.compositeOp="source-over";this.destBlend=this.srcBlend=0;this.render_grid=null;this.last_render_list=g();this.render_list_stale=!0;this.last_render_cells=new cr.rect(0,0,-1,-1);this.cur_render_cells=new cr.rect(0,0,-1,-1);this.useRenderCells&&(this.render_grid=new cr.RenderGrid(this.runtime.original_width,this.runtime.original_height));this.render_offscreen=
!1;a=d[14];var h;this.startup_initial_instances=[];this.initial_instances=[];this.created_globals=[];var u=0;for(h=a.length;u<h;u++){var v=a[u],C=this.runtime.types_by_index[v[1]];C.default_instance||(C.default_instance=v,C.default_layerindex=this.index);this.initial_instances.push(v);-1===this.layout.initial_types.indexOf(C)&&this.layout.initial_types.push(C)}cr.shallowAssignArray(this.startup_initial_instances,this.initial_instances);this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=
!0;this.effect_params=[];u=0;for(h=d[15].length;u<h;u++)this.effect_types.push({id:d[15][u][0],name:d[15][u][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:u}),this.effect_params.push(d[15][u][2].slice(0));this.updateActiveEffects();this.rcTexBounce=new cr.rect(0,0,1,1);this.rcTexDest=new cr.rect(0,0,1,1);this.rcTexOrigin=new cr.rect(0,0,1,1)}function g(){return t.length?t.pop():[]}function n(a){cr.clearArray(a);t.push(a)}f.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);
this.shaders_preserve_opaqueness=!0;var a;var d=0;for(a=this.effect_types.length;d<a;d++){var h=this.effect_types[d];h.active&&(this.active_effect_types.push(h),h.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};f.prototype.getEffectByName=function(a){var d;var h=0;for(d=this.effect_types.length;h<d;h++){var u=this.effect_types[h];if(u.name===a)return u}return null};f.prototype.createInitialInstances=function(a){var d,h;var u=d=0;for(h=this.initial_instances.length;d<h;d++){var v=this.initial_instances[d];
var C=this.runtime.types_by_index[v[1]];var w=this.runtime.typeHasPersistBehavior(C);C=!0;if(!w||this.layout.first_visit){v=this.runtime.createInstanceFromInit(v,this,!0);if(!v)continue;a.push(v);v.type.global&&(C=!1,this.created_globals.push(v.uid))}C&&(this.initial_instances[u]=this.initial_instances[d],u++)}this.initial_instances.length=u;this.runtime.ClearDeathRow();!this.runtime.glwrap&&this.effect_types.length&&(this.blend_mode=this.effect_fallback);this.compositeOp=cr.effectToCompositeOp(this.blend_mode);
this.runtime.gl&&cr.setGLBlend(this,this.blend_mode,this.runtime.gl);this.render_list_stale=!0};f.prototype.recreateInitialObjects=function(a,d){var h,u=this.runtime.types_by_index,v=a.is_family,C=a.members;var w=0;for(h=this.initial_instances.length;w<h;++w){var r=this.initial_instances[w];var x=r[0];var A=x[0];x=x[1];if(d.contains_pt(A,x)){A=u[r[1]];if(A!==a)if(v){if(0>C.indexOf(A))continue}else continue;r=this.runtime.createInstanceFromInit(r,this,!1);this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(A.plugin).cnds.OnCreated,
r);if(r.is_contained)for(A=0,x=r.siblings.length;A<x;A++){var l=r.siblings[w];this.runtime.trigger(Object.getPrototypeOf(l.type.plugin).cnds.OnCreated,l)}this.runtime.isInOnDestroy--}}};f.prototype.removeFromInstanceList=function(a,d){var h=cr.fastIndexOf(this.instances,a);0>h||(d&&this.useRenderCells&&a.rendercells&&a.rendercells.right>=a.rendercells.left&&(a.update_bbox(),this.render_grid.update(a,a.rendercells,null),a.rendercells.set(0,0,-1,-1)),h===this.instances.length-1?this.instances.pop():
(cr.arrayRemove(this.instances,h),this.setZIndicesStaleFrom(h)),this.render_list_stale=!0)};f.prototype.appendToInstanceList=function(a,d){a.zindex=this.instances.length;this.instances.push(a);d&&this.useRenderCells&&a.rendercells&&a.set_bbox_changed();this.render_list_stale=!0};f.prototype.prependToInstanceList=function(a,d){this.instances.unshift(a);this.setZIndicesStaleFrom(0);d&&this.useRenderCells&&a.rendercells&&a.set_bbox_changed()};f.prototype.moveInstanceAdjacent=function(a,d,h){var u=a.get_zindex();
d=d.get_zindex();cr.arrayRemove(this.instances,u);u<d&&d--;h&&d++;d===this.instances.length?this.instances.push(a):this.instances.splice(d,0,a);this.setZIndicesStaleFrom(u<d?u:d)};f.prototype.setZIndicesStaleFrom=function(a){-1===this.zindices_stale_from?this.zindices_stale_from=a:a<this.zindices_stale_from&&(this.zindices_stale_from=a);this.render_list_stale=this.zindices_stale=!0};f.prototype.updateZIndices=function(){if(this.zindices_stale){-1===this.zindices_stale_from&&(this.zindices_stale_from=
0);var a;if(this.useRenderCells){var d=this.zindices_stale_from;for(a=this.instances.length;d<a;++d){var h=this.instances[d];h.zindex=d;this.render_grid.markRangeChanged(h.rendercells)}}else for(d=this.zindices_stale_from,a=this.instances.length;d<a;++d)this.instances[d].zindex=d;this.zindices_stale=!1;this.zindices_stale_from=-1}};f.prototype.getScale=function(a){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||a?this.runtime.aspect_scale:1)};f.prototype.getNormalScale=function(){return(this.scale*
this.layout.scale-1)*this.zoomRate+1};f.prototype.getAngle=function(){return this.disableAngle?0:cr.clamp_angle(this.layout.angle+this.angle)};var t=[],e=[],c=[];f.prototype.getRenderCellInstancesToDraw=function(){this.updateZIndices();this.render_grid.queryRange(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,c);if(!c.length)return g();if(1===c.length){var a=g();cr.shallowAssignArray(a,c[0]);cr.clearArray(c);return a}for(var d=!0;1<c.length;){var h;a=c;var u=d;var v=0;for(h=a.length;v<
h-1;v+=2){var C=a[v];var w=a[v+1];d=g();var r=C,x=w,A=d,l=0,y=0,z=0,O=r.length,Q=x.length;for(A.length=O+Q;l<O&&y<Q;++z){var I=r[l];var k=x[y];I.zindex<k.zindex?(A[z]=I,++l):(A[z]=k,++y)}for(;l<O;++l,++z)A[z]=r[l];for(;y<Q;++y,++z)A[z]=x[y];u||(n(C),n(w));e.push(d)}1===h%2&&(u?(C=g(),cr.shallowAssignArray(C,a[h-1]),e.push(C)):e.push(a[h-1]));cr.shallowAssignArray(a,e);cr.clearArray(e);d=!1}a=c[0];cr.clearArray(c);return a};f.prototype.draw=function(a){this.render_offscreen=this.forceOwnTexture||1!==
this.opacity||0!==this.blend_mode;var d=this.runtime.canvas,h=a,u=!1;this.render_offscreen&&(this.runtime.layer_canvas||(this.runtime.layer_canvas=document.createElement("canvas"),d=this.runtime.layer_canvas,d.width=this.runtime.draw_width,d.height=this.runtime.draw_height,this.runtime.layer_ctx=d.getContext("2d"),u=!0),d=this.runtime.layer_canvas,h=this.runtime.layer_ctx,d.width!==this.runtime.draw_width&&(d.width=this.runtime.draw_width,u=!0),d.height!==this.runtime.draw_height&&(d.height=this.runtime.draw_height,
u=!0),u&&(h.imageSmoothingEnabled=this.runtime.linearSampling),this.transparent&&h.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height));h.globalAlpha=1;h.globalCompositeOperation="source-over";this.transparent||(h.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",h.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height));h.save();this.disableAngle=!0;u=this.canvasToLayer(0,0,!0,!0);var v=this.canvasToLayer(0,0,!1,!0);this.disableAngle=
!1;this.runtime.pixel_rounding&&(u=Math.round(u),v=Math.round(v));this.rotateViewport(u,v,h);var C=this.getScale();h.scale(C,C);h.translate(-u,-v);this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?
(n(this.last_render_list),u=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):u=this.last_render_list):u=this.instances;var w=null;v=0;for(C=u.length;v<C;++v){var r=u[v];r!==w&&(this.drawInstance(r,h),w=r)}this.useRenderCells&&(this.last_render_list=u);h.restore();this.render_offscreen&&(a.globalCompositeOperation=this.compositeOp,a.globalAlpha=this.opacity,a.drawImage(d,0,0))};f.prototype.drawInstance=function(a,d){if(a.visible&&0!==
a.width&&0!==a.height){a.update_bbox();var h=a.bbox;h.right<this.viewLeft||h.bottom<this.viewTop||h.left>this.viewRight||h.top>this.viewBottom||(d.globalCompositeOperation=a.compositeOp,a.draw(d))}};f.prototype.updateViewport=function(a){this.disableAngle=!0;var d=this.canvasToLayer(0,0,!0,!0),h=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(d=Math.round(d),h=Math.round(h));this.rotateViewport(d,h,a)};f.prototype.rotateViewport=function(a,d,h){var u=this.getScale();
this.viewLeft=a;this.viewTop=d;this.viewRight=a+1/u*this.runtime.draw_width;this.viewBottom=d+1/u*this.runtime.draw_height;a=this.getAngle();0!==a&&(h&&(h.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),h.rotate(-a),h.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2)),this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,
a),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom)};f.prototype.drawGL_earlyZPass=function(a){if(this.render_offscreen=this.forceOwnTexture){this.runtime.layer_tex||(this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));
if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layer_tex)}this.disableAngle=!0;var d=this.canvasToLayer(0,0,!0,!0),h=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(d=Math.round(d),h=Math.round(h));
this.rotateViewport(d,h,null);d=this.getScale();a.resetModelView();a.scale(d,d);a.rotateZ(-this.getAngle());a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);a.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),
this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(n(this.last_render_list),d=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):d=this.last_render_list):d=this.instances;var u=null;for(h=d.length-1;0<=h;--h){var v=d[h];v!==u&&(this.drawInstanceGL_earlyZPass(d[h],a),u=v)}this.useRenderCells&&(this.last_render_list=d);this.transparent||(this.clear_earlyz_index=this.runtime.earlyz_index++,a.setEarlyZIndex(this.clear_earlyz_index),
a.setColorFillMode(1,1,1,1),a.fullscreenQuad(),a.restoreEarlyZMode())};f.prototype.drawGL=function(a){if(this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0<this.active_effect_types.length||0!==this.blend_mode){this.runtime.layer_tex||(this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layer_tex),
this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layer_tex);this.transparent&&a.clear(0,0,0,0)}this.transparent||(this.runtime.enableFrontToBack?(a.setEarlyZIndex(this.clear_earlyz_index),a.setColorFillMode(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),a.fullscreenQuad(),a.setTextureFillMode()):a.clear(this.background_color[0]/255,this.background_color[1]/
255,this.background_color[2]/255,1));this.disableAngle=!0;var d=this.canvasToLayer(0,0,!0,!0);var h=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(d=Math.round(d),h=Math.round(h));this.rotateViewport(d,h,null);d=this.getScale();a.resetModelView();a.scale(d,d);a.rotateZ(-this.getAngle());a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);a.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),
this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(n(this.last_render_list),h=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):h=this.last_render_list):h=this.instances;var u,v=null;if(2.220446049250313E-16<
this.getNormalScale()){var C=0;for(u=h.length;C<u;++C){var w=h[C];w!==v&&(this.drawInstanceGL(h[C],a),v=w)}}this.useRenderCells&&(this.last_render_list=h);this.render_offscreen&&(h=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,C=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!a.programUsesCrossSampling(h)&&1===this.opacity?(1===this.active_effect_types.length?(a.switchProgram(h),
a.setProgramParameters(this.layout.getRenderTarget(),1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,0,0,1,1,d,this.getAngle(),this.runtime.kahanTime.sum,this.effect_params[C]),a.programIsAnimated(h)&&(this.runtime.redraw=!0)):a.switchProgram(0),a.setRenderingToTexture(this.layout.getRenderTarget()),a.setOpacity(this.opacity),a.setTexture(this.runtime.layer_tex),a.setBlend(this.srcBlend,this.destBlend),a.resetModelView(),
a.updateModelView(),d=this.runtime.draw_width/2,h=this.runtime.draw_height/2,a.quad(-d,h,d,h,d,-h,-d,-h),a.setTexture(null)):this.layout.renderEffectChain(a,this,null,this.layout.getRenderTarget()))};f.prototype.drawInstanceGL=function(a,d){if(a.visible&&0!==a.width&&0!==a.height){a.update_bbox();var h=a.bbox;h.right<this.viewLeft||h.bottom<this.viewTop||h.left>this.viewRight||h.top>this.viewBottom||(d.setEarlyZIndex(a.earlyz_index),a.uses_shaders?this.drawInstanceWithShadersGL(a,d):(d.switchProgram(0),
d.setBlend(a.srcBlend,a.destBlend),a.drawGL(d)))}};f.prototype.drawInstanceGL_earlyZPass=function(a,d){if(a.visible&&0!==a.width&&0!==a.height){a.update_bbox();var h=a.bbox;h.right<this.viewLeft||h.bottom<this.viewTop||h.left>this.viewRight||h.top>this.viewBottom||(a.earlyz_index=this.runtime.earlyz_index++,0===a.blend_mode&&1===a.opacity&&a.shaders_preserve_opaqueness&&a.drawGL_earlyZPass&&(d.setEarlyZIndex(a.earlyz_index),a.drawGL_earlyZPass(d)))}};f.prototype.drawInstanceWithShadersGL=function(a,
d){var h=a.active_effect_types[0].shaderindex,u=a.active_effect_types[0].index,v=this.getScale(),C=this.runtime.draw_width,w=this.runtime.draw_height;if(1!==a.active_effect_types.length||d.programUsesCrossSampling(h)||d.programExtendsBox(h)||(a.angle||a.layer.getAngle())&&d.programUsesDest(h)||1!==a.opacity||a.type.plugin.must_predraw)this.layout.renderEffectChain(d,this,a,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),d.resetModelView(),d.scale(v,v),d.rotateZ(-this.getAngle()),
d.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),d.updateModelView();else{d.switchProgram(h);d.setBlend(a.srcBlend,a.destBlend);d.programIsAnimated(h)&&(this.runtime.redraw=!0);var r=0,x=0,A=0,l=0;d.programUsesDest(h)&&(l=a.bbox,r=this.layerToCanvas(l.left,l.top,!0,!0),x=this.layerToCanvas(l.left,l.top,!1,!0),A=this.layerToCanvas(l.right,l.bottom,!0,!0),l=this.layerToCanvas(l.right,l.bottom,!1,!0),r/=C,x=1-x/w,A/=C,l=1-l/w);w=C=0;var y=h=1,z=1/a.width,O=1/a.height;
a.curFrame&&a.curFrame.sheetTex&&(C=a.curFrame.sheetTex.left,w=a.curFrame.sheetTex.top,h=a.curFrame.sheetTex.right,y=a.curFrame.sheetTex.bottom,a.curFrame.texture_img&&(z=1/a.curFrame.texture_img.width,O=1/a.curFrame.texture_img.height));d.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),z,O,C,w,h,y,C,w,h,y,a.bbox.left,a.bbox.top,a.bbox.right,a.bbox.bottom,r,x,A,l,v,this.getAngle(),this.runtime.kahanTime.sum,a.effect_params[u]);a.drawGL(d)}};f.prototype.canvasToLayer=
function(a,d,h,u){var v=this.runtime.devicePixelRatio;this.runtime.isRetina&&(a*=v,d*=v);v=this.runtime.parallax_x_origin;var C=this.runtime.parallax_y_origin;v=(this.layout.scrollX-v)*this.parallaxX+v;C=(this.layout.scrollY-C)*this.parallaxY+C;var w=v,r=C,x=1/this.getScale(!u);u?(w-=this.runtime.draw_width*x/2,r-=this.runtime.draw_height*x/2):(w-=this.runtime.width*x/2,r-=this.runtime.height*x/2);w+=a*x;r+=d*x;d=this.getAngle();0!==d&&(w-=v,r-=C,a=Math.cos(d),d=Math.sin(d),u=w*a-r*d,r=r*a+w*d,w=
u+v,r+=C);return h?w:r};f.prototype.layerToCanvas=function(a,d,h,u){var v=this.runtime.parallax_x_origin,C=this.runtime.parallax_y_origin,w=(this.layout.scrollX-v)*this.parallaxX+v,r=(this.layout.scrollY-C)*this.parallaxY+C;C=w;v=r;var x=this.getAngle();if(0!==x){a-=w;d-=r;var A=Math.cos(-x);x=Math.sin(-x);var l=a*A-d*x;d=d*A+a*x;a=l+w;d+=r}w=1/this.getScale(!u);u?(C-=this.runtime.draw_width*w/2,v-=this.runtime.draw_height*w/2):(C-=this.runtime.width*w/2,v-=this.runtime.height*w/2);C=(a-C)/w;v=(d-
v)/w;a=this.runtime.devicePixelRatio;this.runtime.isRetina&&!u&&(C/=a,v/=a);return h?C:v};f.prototype.rotatePt=function(a,d,h){if(0===this.getAngle())return h?a:d;var u=this.layerToCanvas(a,d,!0);d=this.layerToCanvas(a,d,!1);this.disableAngle=!0;a=this.canvasToLayer(u,d,!0);u=this.canvasToLayer(u,d,!0);this.disableAngle=!1;return h?a:u};f.prototype.saveToJSON=function(){var a,d={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,
t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],cg:this.created_globals,instances:[]};var h=0;for(a=this.effect_types.length;h<a;h++){var u=this.effect_types[h];d.fx.push({name:u.name,active:u.active,params:this.effect_params[u.index]})}return d};f.prototype.loadFromJSON=function(a){var d;this.scale=a.s;this.angle=a.a;this.viewLeft=a.vl;this.viewTop=a.vt;this.viewRight=a.vr;this.viewBottom=a.vb;this.visible=a.v;this.background_color=a.bc;this.transparent=
a.t;this.parallaxX=a.px;this.parallaxY=a.py;this.opacity=a.o;this.zoomRate=a.zr;this.created_globals=a.cg||[];cr.shallowAssignArray(this.initial_instances,this.startup_initial_instances);var h=new cr.ObjectSet;var u=0;for(d=this.created_globals.length;u<d;++u)h.add(this.created_globals[u]);var v=u=0;for(d=this.initial_instances.length;u<d;++u)h.contains(this.initial_instances[u][2])||(this.initial_instances[v]=this.initial_instances[u],++v);cr.truncateArray(this.initial_instances,v);v=a.fx;u=0;for(d=
v.length;u<d;u++)if(a=this.getEffectByName(v[u].name))a.active=v[u].active,this.effect_params[a.index]=v[u].params;this.updateActiveEffects();this.instances.sort(b);this.zindices_stale=!0};cr.layer=f})();
(function(){function b(c,a){this.runtime=c;this.event_sheet=null;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;this.scale=1;this.angle=0;this.first_visit=!0;this.name=a[0];this.originalWidth=a[1];this.originalHeight=a[2];this.width=a[1];this.height=a[2];this.unbounded_scrolling=a[3];this.sheetname=a[4];this.sid=a[5];var d=a[6],h;this.layers=[];this.initial_types=[];c=0;for(h=d.length;c<h;c++){var u=new cr.layer(this,d[c]);u.number=c;cr.seal(u);this.layers.push(u)}d=
a[7];this.initial_nonworld=[];c=0;for(h=d.length;c<h;c++){u=d[c];var v=this.runtime.types_by_index[u[1]];v.default_instance||(v.default_instance=u);this.initial_nonworld.push(u);-1===this.initial_types.indexOf(v)&&this.initial_types.push(v)}this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];c=0;for(h=a[8].length;c<h;c++)this.effect_types.push({id:a[8][c][0],name:a[8][c][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:c}),this.effect_params.push(a[8][c][2].slice(0));
this.updateActiveEffects();this.rcTexBounce=new cr.rect(0,0,1,1);this.rcTexDest=new cr.rect(0,0,1,1);this.rcTexOrigin=new cr.rect(0,0,1,1);this.viewRect=new cr.rect(0,0,0,0);this.persist_data={}}function f(c,a){return c.zindex-a.zindex}function g(c){return c.some(function(a){return a.plugin.is_world})}b.prototype.saveObjectToPersist=function(c){var a=c.type.sid.toString();this.persist_data.hasOwnProperty(a)||(this.persist_data[a]=[]);this.persist_data[a].push(this.runtime.saveInstanceToJSON(c))};
b.prototype.hasOpaqueBottomLayer=function(){var c=this.layers[0];return!c.transparent&&1===c.opacity&&!c.forceOwnTexture&&c.visible};b.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var c;var a=0;for(c=this.effect_types.length;a<c;a++){var d=this.effect_types[a];d.active&&(this.active_effect_types.push(d),d.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};b.prototype.getEffectByName=function(c){var a;var d=0;for(a=
this.effect_types.length;d<a;d++){var h=this.effect_types[d];if(h.name===c)return h}return null};var n=[],t=!0;b.prototype.startRunning=function(){this.sheetname&&(this.event_sheet=this.runtime.eventsheets[this.sheetname],this.event_sheet.updateDeepIncludes());this.runtime.running_layout=this;this.width=this.originalWidth;this.height=this.originalHeight;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;var c,a;var d=0;for(c=this.runtime.types_by_index.length;d<
c;d++){var h=this.runtime.types_by_index[d];if(!h.is_family){var u=h.instances;h=0;for(a=u.length;h<a;h++){var v=u[h];if(v.layer){var C=v.layer.number;C>=this.layers.length&&(C=this.layers.length-1);v.layer=this.layers[C];-1===v.layer.instances.indexOf(v)&&v.layer.instances.push(v);v.layer.zindices_stale=!0}}}}if(!t)for(d=0,c=this.layers.length;d<c;++d)this.layers[d].instances.sort(f);cr.clearArray(n);this.boundScrolling();d=0;for(c=this.layers.length;d<c;d++)v=this.layers[d],v.createInitialInstances(n),
v.updateViewport(null);u=!1;if(!this.first_visit){for(w in this.persist_data)if(this.persist_data.hasOwnProperty(w)&&(h=this.runtime.getObjectTypeBySid(parseInt(w,10)))&&!h.is_family&&this.runtime.typeHasPersistBehavior(h)){a=this.persist_data[w];d=0;for(c=a.length;d<c;d++){v=null;if(h.plugin.is_world&&(v=this.getLayerBySid(a[d].w.l),!v))continue;v=this.runtime.createInstanceFromInit(h.default_instance,v,!1,0,0,!0);this.runtime.loadInstanceFromJSON(v,a[d]);u=!0;n.push(v)}cr.clearArray(a)}d=0;for(c=
this.layers.length;d<c;d++)this.layers[d].instances.sort(f),this.layers[d].zindices_stale=!0}u&&(this.runtime.ClearDeathRow(),this.runtime.refreshUidMap());this.createAndLinkContainerInstances(n);d=0;for(c=this.initial_nonworld.length;d<c;d++){var w=this.initial_nonworld[d];h=this.runtime.types_by_index[w[1]];h.is_contained||this.runtime.createInstanceFromInit(this.initial_nonworld[d],null,!0)}this.runtime.changelayout=null;this.runtime.ClearDeathRow();if(this.runtime.ctx)for(d=0,c=this.runtime.types_by_index.length;d<
c;d++)w=this.runtime.types_by_index[d],!w.is_family&&w.instances.length&&w.preloadCanvas2D&&w.preloadCanvas2D(this.runtime.ctx);if(this.runtime.isLoadingState)cr.shallowAssignArray(this.runtime.fireOnCreateAfterLoad,n);else for(d=0,c=n.length;d<c;d++)v=n[d],this.runtime.trigger(Object.getPrototypeOf(v.type.plugin).cnds.OnCreated,v);cr.clearArray(n);this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutStart,null);this.first_visit=!1};b.prototype.createAndLinkContainerInstances=
function(c){var a,d;for(a=0;a<c.length;a++){var h=c[a];if(h.type.is_contained){var u=h.get_iid();var v=0;for(d=h.type.container.length;v<d;v++){var C=h.type.container[v];if(h.type!==C)if(C.instances.length>u)h.siblings.push(C.instances[u]);else if(C.default_instance){var w=this.runtime.createInstanceFromInit(C.default_instance,h.layer,!0,h.x,h.y,!0);this.runtime.ClearDeathRow();C.updateIIDs();h.siblings.push(w);c.push(w)}}}}};b.prototype.createGlobalNonWorlds=function(){var c,a,d=[];var h=c=0;for(a=
this.initial_nonworld.length;c<a;c++){var u=this.initial_nonworld[c];var v=this.runtime.types_by_index[u[1]];v.global?v.is_contained&&g(v.container)||d.push(this.runtime.createInstanceFromInit(u,null,!0)):(this.initial_nonworld[h]=u,h++)}cr.truncateArray(this.initial_nonworld,h);this.runtime.ClearDeathRow();this.createAndLinkContainerInstances(d)};b.prototype.stopRunning=function(){this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutEnd,null);this.runtime.isEndingLayout=
!0;cr.clearArray(this.runtime.system.waits);var c,a;if(!this.first_visit){var d=0;for(c=this.layers.length;d<c;d++){this.layers[d].updateZIndices();var h=this.layers[d].instances;var u=0;for(a=h.length;u<a;u++){var v=h[u];v.type.global||this.runtime.typeHasPersistBehavior(v.type)&&this.saveObjectToPersist(v)}}}d=0;for(c=this.layers.length;d<c;d++){h=this.layers[d].instances;u=0;for(a=h.length;u<a;u++)v=h[u],v.type.global||this.runtime.DestroyInstance(v);this.runtime.ClearDeathRow();cr.clearArray(h);
this.layers[d].zindices_stale=!0}d=0;for(c=this.runtime.types_by_index.length;d<c;d++)if(h=this.runtime.types_by_index[d],!(h.global||h.plugin.is_world||h.plugin.singleglobal||h.is_family)){u=0;for(a=h.instances.length;u<a;u++)this.runtime.DestroyInstance(h.instances[u]);this.runtime.ClearDeathRow()}t=!1;this.runtime.isEndingLayout=!1};var e=new cr.rect(0,0,0,0);b.prototype.recreateInitialObjects=function(c,a,d,h,u){e.set(a,d,h,u);a=0;for(d=this.layers.length;a<d;a++)this.layers[a].recreateInitialObjects(c,
e)};b.prototype.draw=function(c){var a=c,d=!1,h=!this.runtime.fullscreenScalingQuality;if(h){if(!this.runtime.layout_canvas){this.runtime.layout_canvas=document.createElement("canvas");var u=this.runtime.layout_canvas;u.width=this.runtime.draw_width;u.height=this.runtime.draw_height;this.runtime.layout_ctx=u.getContext("2d");d=!0}u=this.runtime.layout_canvas;a=this.runtime.layout_ctx;u.width!==this.runtime.draw_width&&(u.width=this.runtime.draw_width,d=!0);u.height!==this.runtime.draw_height&&(u.height=
this.runtime.draw_height,d=!0);d&&(a.imageSmoothingEnabled=this.runtime.linearSampling)}a.globalAlpha=1;a.globalCompositeOperation="source-over";this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&a.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height);var v;d=0;for(v=this.layers.length;d<v;d++){var C=this.layers[d];C.visible&&0<C.opacity&&11!==C.blend_mode&&(C.instances.length||!C.transparent)?C.draw(a):C.updateViewport(null)}h&&c.drawImage(u,0,0,this.runtime.width,this.runtime.height)};
b.prototype.drawGL_earlyZPass=function(c){c.setEarlyZPass(!0);this.runtime.layout_tex||(this.runtime.layout_tex=c.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)c.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=c.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);c.setRenderingToTexture(this.runtime.layout_tex);
this.runtime.fullscreenScalingQuality||c.setSize(this.runtime.draw_width,this.runtime.draw_height);var a;for(a=this.layers.length-1;0<=a;--a){var d=this.layers[a];d.visible&&1===d.opacity&&d.shaders_preserve_opaqueness&&0===d.blend_mode&&(d.instances.length||!d.transparent)?d.drawGL_earlyZPass(c):d.updateViewport(null)}c.setEarlyZPass(!1)};b.prototype.drawGL=function(c){var a=0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack;
if(a){this.runtime.layout_tex||(this.runtime.layout_tex=c.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)c.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=c.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);c.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||
c.setSize(this.runtime.draw_width,this.runtime.draw_height)}else this.runtime.layout_tex&&(c.setRenderingToTexture(null),c.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null);this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&c.clear(0,0,0,0);var d;var h=0;for(d=this.layers.length;h<d;h++){var u=this.layers[h];u.visible&&0<u.opacity&&(u.instances.length||!u.transparent)?u.drawGL(c):u.updateViewport(null)}a&&(0===this.active_effect_types.length||1===this.active_effect_types.length&&
this.runtime.fullscreenScalingQuality?(1===this.active_effect_types.length?(a=this.active_effect_types[0].index,h=this.calculateViewRect(),c.switchProgram(this.active_effect_types[0].shaderindex),c.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,h.left,h.top,h.right,h.bottom,0,0,1,1,this.scale,this.angle,this.runtime.kahanTime.sum,this.effect_params[a]),c.programIsAnimated(this.active_effect_types[0].shaderindex)&&(this.runtime.redraw=!0)):c.switchProgram(0),
this.runtime.fullscreenScalingQuality||c.setSize(this.runtime.width,this.runtime.height),c.setRenderingToTexture(null),c.setDepthTestEnabled(!1),c.setOpacity(1),c.setTexture(this.runtime.layout_tex),c.setAlphaBlend(),c.resetModelView(),c.updateModelView(),a=this.runtime.width/2,h=this.runtime.height/2,c.quad(-a,h,a,h,a,-h,-a,-h),c.setTexture(null),c.setDepthTestEnabled(!0)):this.renderEffectChain(c,null,null,null))};b.prototype.getRenderTarget=function(){return 0<this.active_effect_types.length||
this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack?this.runtime.layout_tex:null};b.prototype.getMinLayerScale=function(){var c=this.layers[0].getScale(),a;var d=1;for(a=this.layers.length;d<a;d++){var h=this.layers[d];(0!==h.parallaxX||0!==h.parallaxY)&&h.getScale()<c&&(c=h.getScale())}return c};b.prototype.scrollToX=function(c){if(!this.unbounded_scrolling){var a=this.runtime.draw_width*(1/this.getMinLayerScale())/2;c>this.width-a&&(c=this.width-
a);c<a&&(c=a)}this.scrollX!==c&&(this.scrollX=c,this.runtime.redraw=!0)};b.prototype.scrollToY=function(c){if(!this.unbounded_scrolling){var a=this.runtime.draw_height*(1/this.getMinLayerScale())/2;c>this.height-a&&(c=this.height-a);c<a&&(c=a)}this.scrollY!==c&&(this.scrollY=c,this.runtime.redraw=!0)};b.prototype.boundScrolling=function(){this.scrollToX(this.scrollX);this.scrollToY(this.scrollY)};b.prototype.calculateViewRect=function(){var c=this.scrollX,a=this.scrollY,d=1/(this.scale*this.runtime.aspect_scale);
c-=this.runtime.width*d/2;a-=this.runtime.height*d/2;this.viewRect.set(c,a,c+this.runtime.draw_width*d,a+this.runtime.draw_height*d);return this.viewRect};b.prototype.renderEffectChain=function(c,a,d,h){var u=d?d.active_effect_types:a?a.active_effect_types:this.active_effect_types;if(d){var v=d.layer.getScale();var C=d.layer.getAngle();var w=d.layer.viewLeft;var r=d.layer.viewTop;var x=d.layer.viewRight;var A=d.layer.viewBottom}else a?(v=a.getScale(),C=a.getAngle(),w=a.viewLeft,r=a.viewTop,x=a.viewRight,
A=a.viewBottom):(v=this.scale,C=this.angle,A=this.calculateViewRect(),w=A.left,r=A.top,x=A.right,A=A.bottom);var l=this.runtime.fx_tex,y,z,O=0,Q=1,I=this.runtime.draw_width,k=this.runtime.draw_height,p=I/2,H=k/2,m=a?a.rcTexBounce:this.rcTexBounce,E=a?a.rcTexDest:this.rcTexDest,L=a?a.rcTexOrigin:this.rcTexOrigin,N=0,V=0,W=0,X=0,Y=I,ea=I,ha=k,q=k,B=z=0,G=d?d.layer.getAngle():0;if(d){var J=0;for(y=u.length;J<y;J++)z+=c.getProgramBoxExtendHorizontal(u[J].shaderindex),B+=c.getProgramBoxExtendVertical(u[J].shaderindex);
X=d.bbox;N=a.layerToCanvas(X.left,X.top,!0,!0);W=a.layerToCanvas(X.left,X.top,!1,!0);Y=a.layerToCanvas(X.right,X.bottom,!0,!0);ha=a.layerToCanvas(X.right,X.bottom,!1,!0);if(0!==G){J=a.layerToCanvas(X.right,X.top,!0,!0);y=a.layerToCanvas(X.right,X.top,!1,!0);V=a.layerToCanvas(X.left,X.bottom,!0,!0);X=a.layerToCanvas(X.left,X.bottom,!1,!0);var F=Math.min(N,Y,J,V);Y=Math.max(N,Y,J,V);N=F;F=Math.min(W,ha,y,X);ha=Math.max(W,ha,y,X);W=F}L.left=N/I;L.top=1-W/k;L.right=Y/I;L.bottom=1-ha/k;N-=z;W-=B;Y+=z;
ha+=B;E.left=N/I;E.top=1-W/k;E.right=Y/I;E.bottom=1-ha/k;V=N=cr.floor(N);X=W=cr.floor(W);ea=Y=cr.ceil(Y);q=ha=cr.ceil(ha);V-=z;X-=B;ea+=z;q+=B;0>N&&(N=0);0>W&&(W=0);Y>I&&(Y=I);ha>k&&(ha=k);0>V&&(V=0);0>X&&(X=0);ea>I&&(ea=I);q>k&&(q=k);m.left=N/I;m.top=1-W/k;m.right=Y/I;m.bottom=1-ha/k}else m.left=E.left=L.left=0,m.top=E.top=L.top=0,m.right=E.right=L.right=1,m.bottom=E.bottom=1;B=d&&(c.programUsesDest(u[0].shaderindex)||0!==z||0!==B||1!==d.opacity||d.type.plugin.must_predraw)||a&&!d&&1!==a.opacity;
c.setAlphaBlend();if(B){l[O]||(l[O]=c.createEmptyTexture(I,k,this.runtime.linearSampling));if(l[O].c2width!==I||l[O].c2height!==k)c.deleteTexture(l[O]),l[O]=c.createEmptyTexture(I,k,this.runtime.linearSampling);c.switchProgram(0);c.setRenderingToTexture(l[O]);var M=q-X;c.clearRect(V,k-X-M,ea-V,M);d?d.drawGL(c):(c.setTexture(this.runtime.layer_tex),c.setOpacity(a.opacity),c.resetModelView(),c.translate(-p,-H),c.updateModelView(),c.quadTex(N,ha,Y,ha,Y,W,N,W,m));E.left=E.top=0;E.right=E.bottom=1;d&&
(F=m.top,m.top=m.bottom,m.bottom=F);O=1;Q=0}c.setOpacity(1);z=u.length-1;G=c.programUsesCrossSampling(u[z].shaderindex)||!a&&!d&&!this.runtime.fullscreenScalingQuality;J=0;for(y=u.length;J<y;J++){l[O]||(l[O]=c.createEmptyTexture(I,k,this.runtime.linearSampling));if(l[O].c2width!==I||l[O].c2height!==k)c.deleteTexture(l[O]),l[O]=c.createEmptyTexture(I,k,this.runtime.linearSampling);c.switchProgram(u[J].shaderindex);F=u[J].index;c.programIsAnimated(u[J].shaderindex)&&(this.runtime.redraw=!0);if(0!=J||
B){c.setProgramParameters(h,1/I,1/k,0,0,1,1,L.left,L.top,L.right,L.bottom,w,r,x,A,E.left,E.top,E.right,E.bottom,v,C,this.runtime.kahanTime.sum,d?d.effect_params[F]:a?a.effect_params[F]:this.effect_params[F]);c.setTexture(null);if(J!==z||G){c.setRenderingToTexture(l[O]);M=q-X;var S=k-X-M;c.clearRect(V,S,ea-V,M)}else d?c.setBlend(d.srcBlend,d.destBlend):a&&c.setBlend(a.srcBlend,a.destBlend),c.setRenderingToTexture(h);c.setTexture(l[Q]);c.resetModelView();c.translate(-p,-H);c.updateModelView();c.quadTex(N,
ha,Y,ha,Y,W,N,W,m);J!==z||G||c.setTexture(null)}else{c.setRenderingToTexture(l[O]);M=q-X;S=k-X-M;c.clearRect(V,S,ea-V,M);if(d){S=Q=0;var T=M=1,U=1/d.width,fa=1/d.height;d.curFrame&&d.curFrame.sheetTex&&(Q=d.curFrame.sheetTex.left,S=d.curFrame.sheetTex.top,M=d.curFrame.sheetTex.right,T=d.curFrame.sheetTex.bottom,d.curFrame.texture_img&&(U=1/d.curFrame.texture_img.width,fa=1/d.curFrame.texture_img.height));c.setProgramParameters(h,U,fa,Q,S,M,T,Q,S,M,T,d.bbox.left,d.bbox.top,d.bbox.right,d.bbox.bottom,
E.left,E.top,E.right,E.bottom,v,C,this.runtime.kahanTime.sum,d.effect_params[F]);d.drawGL(c)}else c.setProgramParameters(h,1/I,1/k,0,0,1,1,0,0,1,1,w,r,x,A,0,0,1,1,v,C,this.runtime.kahanTime.sum,a?a.effect_params[F]:this.effect_params[F]),c.setTexture(a?this.runtime.layer_tex:this.runtime.layout_tex),c.resetModelView(),c.translate(-p,-H),c.updateModelView(),c.quadTex(N,ha,Y,ha,Y,W,N,W,m);E.left=E.top=0;E.right=E.bottom=1;d&&!G&&(F=ha,ha=W,W=F)}O=0===O?1:0;Q=0===O?1:0}G&&(c.switchProgram(0),d?c.setBlend(d.srcBlend,
d.destBlend):a?c.setBlend(a.srcBlend,a.destBlend):this.runtime.fullscreenScalingQuality||(c.setSize(this.runtime.width,this.runtime.height),p=this.runtime.width/2,H=this.runtime.height/2,W=N=0,Y=this.runtime.width,ha=this.runtime.height),c.setRenderingToTexture(h),c.setTexture(l[Q]),c.resetModelView(),c.translate(-p,-H),c.updateModelView(),d&&1===u.length&&!B?c.quadTex(N,W,Y,W,Y,ha,N,ha,m):c.quadTex(N,ha,Y,ha,Y,W,N,W,m),c.setTexture(null))};b.prototype.getLayerBySid=function(c){var a;var d=0;for(a=
this.layers.length;d<a;d++)if(this.layers[d].sid===c)return this.layers[d];return null};b.prototype.saveToJSON=function(){var c,a={sx:this.scrollX,sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};var d=0;for(c=this.effect_types.length;d<c;d++){var h=this.effect_types[d];a.fx.push({name:h.name,active:h.active,params:this.effect_params[h.index]})}d=0;for(c=this.layers.length;d<c;d++)h=this.layers[d],a.layers[h.sid.toString()]=
h.saveToJSON();return a};b.prototype.loadFromJSON=function(c){var a,d,h;this.scrollX=c.sx;this.scrollY=c.sy;this.scale=c.s;this.angle=c.a;this.width=c.w;this.height=c.h;this.persist_data=c.persist;"undefined"!==typeof c.fv&&(this.first_visit=c.fv);var u=c.fx;var v=0;for(a=u.length;v<a;v++)if(d=this.getEffectByName(u[v].name))d.active=u[v].active,this.effect_params[d.index]=u[v].params;this.updateActiveEffects();v=c.layers;for(h in v)v.hasOwnProperty(h)&&(c=this.getLayerBySid(parseInt(h,10)))&&c.loadFromJSON(v[h])};
cr.layout=b})();
(function(){function b(l,y){var z,O=l.length;switch(O){case 0:return!0;case 1:return l[0]===y[0];case 2:return l[0]===y[0]&&l[1]===y[1];default:for(z=0;z<O;z++)if(l[z]!==y[z])return!1;return!0}}function f(l,y){return l.index-y.index}function g(l){var y;if(2===l.length){if(l[0].index>l[1].index){var z=l[0];l[0]=l[1];l[1]=z}}else 2<l.length&&l.sort(f);l.length>=r.length&&(r.length=l.length+1);r[l.length]||(r[l.length]=[]);var O=r[l.length];z=0;for(y=O.length;z<y;z++){var Q=O[z];if(b(l,Q))return Q}O.push(l);
return l}function n(l,y){this.runtime=l;this.triggers={};this.fasttriggers={};this.hasRun=!1;this.includes=new cr.ObjectSet;this.deep_includes=[];this.already_included_sheets=[];this.name=y[0];l=y[1];this.events=[];var z;y=0;for(z=l.length;y<z;y++)this.init_event(l[y],null,this.events)}function t(l){this.type=l;this.instances=[];this.else_instances=[];this.select_all=!0}function e(l,y,z){this.sheet=l;this.parent=y;this.runtime=l.runtime;this.solModifiers=[];this.solModifiersIncludingParents=[];this.has_else_block=
this.toplevelgroup=this.toplevelevent=this.initially_activated=this.group=this.solWriterAfterCnds=!1;this.conditions=[];this.actions=[];this.subevents=[];this.group_name="";this.group_active=this.initially_activated=this.group=!1;this.contained_includes=null;3===z[0]&&(this.group_name=z[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!z[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this),this.runtime.groups_by_name[this.group_name]=
this);this.orblock=z[2];this.sid=z[4];this.group||(this.runtime.blocksBySid[this.sid.toString()]=this);var O=z[6];l=0;for(y=O.length;l<y;l++){var Q=new cr.condition(this,O[l]);Q.index=l;cr.seal(Q);this.conditions.push(Q);this.addSolModifier(Q.type)}O=z[7];l=0;for(y=O.length;l<y;l++)Q=new cr.action(this,O[l]),Q.index=l,cr.seal(Q),this.actions.push(Q);if(9===z.length)for(z=z[8],l=0,y=z.length;l<y;l++)this.sheet.init_event(z[l],this,this.subevents);this.is_else_block=!1;this.conditions.length&&(this.is_else_block=
null==this.conditions[0].type&&this.conditions[0].func==cr.system_object.prototype.cnds.Else)}function c(l,y){var z;if(l&&(-1===y.indexOf(l)&&y.push(l),l.is_contained)){var O=0;for(z=l.container.length;O<z;O++){var Q=l.container[O];l!==Q&&-1===y.indexOf(Q)&&y.push(Q)}}}function a(l,y){this.block=l;this.sheet=l.sheet;this.runtime=l.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(y[1]);this.trigger=0<
y[3];this.fasttrigger=2===y[3];this.looping=y[4];this.inverted=y[5];this.isstatic=y[6];this.sid=y[7];this.runtime.cndsBySid[this.sid.toString()]=this;-1===y[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[y[0]],this.run=this.isstatic?this.run_static:this.run_object,y[2]?(this.behaviortype=this.type.getBehaviorByName(y[2]),this.beh_index=this.type.getBehaviorIndexByName(y[2])):(this.behaviortype=null,this.beh_index=-1),this.block.parent&&
this.block.parent.setSolWriterAfterCnds());this.fasttrigger&&(this.run=this.run_true);if(10===y.length){var z=y[9];l=0;for(y=z.length;l<y;l++){var O=new cr.parameter(this,z[l]);cr.seal(O);this.parameters.push(O)}this.results.length=z.length}}function d(l,y){this.block=l;this.sheet=l.sheet;this.runtime=l.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(y[1]);-1===y[0]?(this.type=null,this.run=this.run_system,
this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[y[0]],this.run=this.run_object,y[2]?(this.behaviortype=this.type.getBehaviorByName(y[2]),this.beh_index=this.type.getBehaviorIndexByName(y[2])):(this.behaviortype=null,this.beh_index=-1));this.sid=y[3];this.runtime.actsBySid[this.sid.toString()]=this;if(7===y.length){var z=y[6];l=0;for(y=z.length;l<y;l++){var O=new cr.parameter(this,z[l]);cr.seal(O);this.parameters.push(O)}this.results.length=z.length}}function h(){A++;
x.length===A&&x.push(new cr.expvalue);return x[A]}function u(l,y){this.owner=l;this.block=l.block;this.sheet=l.sheet;this.runtime=l.runtime;this.type=y[0];this.expression=null;this.solindex=0;this.get=null;this.combosel=0;this.layout=null;this.key=0;this.object=null;this.index=0;this.variadicret=this.subparams=this.fileinfo=this.eventvar=this.varname=null;this.variesPerInstance=!1;var z;switch(this.type){case 0:case 7:this.expression=new cr.expNode(this,y[1]);this.solindex=0;this.get=this.get_exp;
break;case 1:case 14:this.expression=new cr.expNode(this,y[1]);this.solindex=0;this.get=this.get_exp_str;14===this.type&&(this.block.setAllSolModifiers(),this.owner instanceof cr.action&&this.block.setSolWriterAfterCnds());break;case 5:this.expression=new cr.expNode(this,y[1]);this.solindex=0;this.get=this.get_layer;break;case 3:case 8:this.combosel=y[1];this.get=this.get_combosel;break;case 16:this.combosel=y[1]?1:0;this.get=this.get_boolean;break;case 6:this.layout=this.runtime.layouts[y[1]];this.get=
this.get_layout;break;case 9:this.key=y[1];this.get=this.get_key;break;case 4:this.object=this.runtime.types_by_index[y[1]];this.get=this.get_object;this.block.addSolModifier(this.object);this.owner instanceof cr.action?this.block.setSolWriterAfterCnds():this.block.parent&&this.block.parent.setSolWriterAfterCnds();break;case 10:this.index=y[1];l.type&&l.type.is_family?(this.get=this.get_familyvar,this.variesPerInstance=!0):this.get=this.get_instvar;break;case 11:this.varname=y[1];this.eventvar=null;
this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=y[1];this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],l=1,z=y.length;l<z;l++){var O=new cr.parameter(this.owner,y[l]);cr.seal(O);this.subparams.push(O);this.variadicret.push(0)}}}function v(l,y,z){this.sheet=l;this.parent=y;this.runtime=l.runtime;this.solModifiers=[];this.name=z[1];this.vartype=z[2];this.initial=z[3];this.is_static=!!z[4];this.is_constant=!!z[5];this.sid=z[6];
this.runtime.varsBySid[this.sid.toString()]=this;this.data=this.initial;this.parent?(this.localIndex=this.is_static||this.is_constant?-1:this.runtime.stackLocalCount++,this.runtime.all_local_vars.push(this)):(this.localIndex=-1,this.runtime.all_global_vars.push(this))}function C(l,y,z){this.sheet=l;this.parent=y;this.runtime=l.runtime;this.solModifiers=[];this.include_sheet=null;this.include_sheet_name=z[1];this.active=!0}function w(){this.temp_parents_arr=[];this.reset(null);cr.seal(this)}var r=
[];n.prototype.toString=function(){return this.name};n.prototype.init_event=function(l,y,z){switch(l[0]){case 0:case 3:l=new cr.eventblock(this,y,l);cr.seal(l);if(l.orblock)for(z.push(l),z=0,y=l.conditions.length;z<y;z++)l.conditions[z].trigger&&this.init_trigger(l,z);else l.is_trigger()?this.init_trigger(l,0):z.push(l);break;case 1:l=new cr.eventvariable(this,y,l);cr.seal(l);z.push(l);break;case 2:l=new cr.eventinclude(this,y,l),cr.seal(l),z.push(l)}};n.prototype.postInit=function(){var l;var y=
0;for(l=this.events.length;y<l;y++)this.events[y].postInit(y<l-1&&this.events[y+1].is_else_block)};n.prototype.updateDeepIncludes=function(){cr.clearArray(this.deep_includes);cr.clearArray(this.already_included_sheets);this.addDeepIncludes(this);cr.clearArray(this.already_included_sheets)};n.prototype.addDeepIncludes=function(l){var y,z=l.deep_includes,O=l.already_included_sheets,Q=this.includes.valuesRef();var I=0;for(y=Q.length;I<y;++I){var k=Q[I];var p=k.include_sheet;!k.isActive()||l===p||-1<
O.indexOf(p)||(O.push(p),p.addDeepIncludes(l),z.push(p))}};n.prototype.run=function(l){this.runtime.resuming_breakpoint||(this.hasRun=!0,l||(this.runtime.isRunningEvents=!0));var y;var z=0;for(y=this.events.length;z<y;z++){var O=this.events[z];O.run();this.runtime.clearSol(O.solModifiers);this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()}l||(this.runtime.isRunningEvents=!1)};n.prototype.init_trigger=function(l,y){l.orblock||this.runtime.triggers_to_postinit.push(l);var z,O,Q=l.conditions[y];
var I=Q.type?Q.type.name:"system";var k=(z=Q.fasttrigger)?this.fasttriggers:this.triggers;k[I]||(k[I]=[]);I=k[I];k=Q.func;if(z){if(Q.parameters.length&&(Q=Q.parameters[0],1===Q.type&&2===Q.expression.type)){Q=Q.expression.value.toLowerCase();z=0;for(O=I.length;z<O;z++)if(I[z].method==k){z=I[z].evs;z[Q]?z[Q].push([l,y]):z[Q]=[[l,y]];return}z={};z[Q]=[[l,y]];I.push({method:k,evs:z})}}else{z=0;for(O=I.length;z<O;z++)if(I[z].method==k){I[z].evs.push([l,y]);return}Q=cr.plugins_.Sprite&&k===cr.plugins_.Sprite.prototype.cnds.OnFrameChanged?
!0:!1;Q?I.unshift({method:k,evs:[[l,y]]}):I.push({method:k,evs:[[l,y]]})}};cr.eventsheet=n;t.prototype.hasObjects=function(){return this.select_all?this.type.instances.length:this.instances.length};t.prototype.getObjects=function(){return this.select_all?this.type.instances:this.instances};t.prototype.pick_one=function(l){l&&(l.runtime.getCurrentEventStack().current_event.orblock?(this.select_all&&(cr.clearArray(this.instances),cr.shallowAssignArray(this.else_instances,l.type.instances),this.select_all=
!1),l=this.else_instances.indexOf(l),-1!==l&&(this.instances.push(this.else_instances[l]),this.else_instances.splice(l,1))):(this.select_all=!1,cr.clearArray(this.instances),this.instances[0]=l))};cr.selection=t;e.prototype.postInit=function(l){var y,z=this.parent;if(this.group)for(this.toplevelgroup=!0;z;){if(!z.group){this.toplevelgroup=!1;break}z=z.parent}this.toplevelevent=!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup);this.has_else_block=!!l;z=this.runtime.types_by_index;
if(this.solModifiers===z)this.solModifiersIncludingParents=z;else{this.solModifiersIncludingParents=this.solModifiers.slice(0);for(z=this.parent;z;){l=0;for(y=z.solModifiers.length;l<y;l++)this.addParentSolModifier(z.solModifiers[l]);z=z.parent}this.solModifiers=g(this.solModifiers);this.solModifiersIncludingParents=g(this.solModifiersIncludingParents)}l=0;for(y=this.conditions.length;l<y;l++)this.conditions[l].postInit();l=0;for(y=this.actions.length;l<y;l++)this.actions[l].postInit();l=0;for(y=
this.subevents.length;l<y;l++)this.subevents[l].postInit(l<y-1&&this.subevents[l+1].is_else_block)};e.prototype.setGroupActive=function(l){if(this.group_active!==!!l){this.group_active=!!l;var y;l=0;for(y=this.contained_includes.length;l<y;++l)this.contained_includes[l].updateActive();0<y&&this.runtime.running_layout.event_sheet&&this.runtime.running_layout.event_sheet.updateDeepIncludes()}};e.prototype.addSolModifier=function(l){c(l,this.solModifiers)};e.prototype.addParentSolModifier=function(l){c(l,
this.solModifiersIncludingParents)};e.prototype.setAllSolModifiers=function(){this.solModifiers=this.runtime.types_by_index};e.prototype.setSolWriterAfterCnds=function(){this.solWriterAfterCnds=!0;this.parent&&this.parent.setSolWriterAfterCnds()};e.prototype.is_trigger=function(){return this.conditions.length?this.conditions[0].trigger:!1};e.prototype.run=function(){var l,y=!1,z=this.runtime,O=this.runtime.getCurrentEventStack();O.current_event=this;var Q=this.conditions;this.is_else_block||(O.else_branch_ran=
!1);if(this.orblock){0===Q.length&&(y=!0);O.cndindex=0;for(l=Q.length;O.cndindex<l;O.cndindex++){var I=Q[O.cndindex];I.trigger||(I=I.run())&&(y=!0)}(O.last_event_true=y)&&this.run_actions_and_subevents()}else{O.cndindex=0;for(l=Q.length;O.cndindex<l;O.cndindex++)if(I=Q[O.cndindex].run(),!I){O.last_event_true=!1;this.toplevelevent&&z.hasPendingInstances&&z.ClearDeathRow();return}O.last_event_true=!0;this.run_actions_and_subevents()}this.end_run(O)};e.prototype.end_run=function(l){l.last_event_true&&
this.has_else_block&&(l.else_branch_ran=!0);this.toplevelevent&&this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()};e.prototype.run_orblocktrigger=function(l){this.runtime.getCurrentEventStack().current_event=this;this.conditions[l].run()&&(this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0)};e.prototype.run_actions_and_subevents=function(){var l=this.runtime.getCurrentEventStack(),y;l.actindex=0;for(y=this.actions.length;l.actindex<y;l.actindex++)if(this.actions[l.actindex].run())return;
this.run_subevents()};e.prototype.resume_actions_and_subevents=function(){var l=this.runtime.getCurrentEventStack(),y;for(y=this.actions.length;l.actindex<y;l.actindex++)if(this.actions[l.actindex].run())return;this.run_subevents()};e.prototype.run_subevents=function(){if(this.subevents.length){var l,y,z=this.subevents.length-1;this.runtime.pushEventStack(this);if(this.solWriterAfterCnds){var O=0;for(l=this.subevents.length;O<l;O++){var Q=this.subevents[O];(y=!this.toplevelgroup||!this.group&&O<z)&&
this.runtime.pushCopySol(Q.solModifiers);Q.run();y?this.runtime.popSol(Q.solModifiers):this.runtime.clearSol(Q.solModifiers)}}else for(O=0,l=this.subevents.length;O<l;O++)this.subevents[O].run();this.runtime.popEventStack()}};e.prototype.run_pretrigger=function(){var l=this.runtime.getCurrentEventStack();l.current_event=this;var y=!1,z;l.cndindex=0;for(z=this.conditions.length;l.cndindex<z;l.cndindex++)if(this.conditions[l.cndindex].run())y=!0;else if(!this.orblock)return!1;return this.orblock?y:
!0};e.prototype.retrigger=function(){this.runtime.execcount++;var l=this.runtime.getCurrentEventStack().cndindex,y=this.runtime.pushEventStack(this);if(!this.orblock)for(y.cndindex=l+1,l=this.conditions.length;y.cndindex<l;y.cndindex++)if(!this.conditions[y.cndindex].run())return this.runtime.popEventStack(),!1;this.run_actions_and_subevents();this.runtime.popEventStack();return!0};e.prototype.isFirstConditionOfType=function(l){var y=l.index;if(0===y)return!0;for(--y;0<=y;--y)if(this.conditions[y].type===
l.type)return!1;return!0};cr.eventblock=e;a.prototype.postInit=function(){var l;var y=0;for(l=this.parameters.length;y<l;y++){var z=this.parameters[y];z.postInit();z.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};a.prototype.run_true=function(){return!0};a.prototype.run_system=function(){var l;var y=0;for(l=this.parameters.length;y<l;y++)this.results[y]=this.parameters[y].get();return cr.xor(this.func.apply(this.runtime.system,this.results),this.inverted)};a.prototype.run_static=function(){var l;
var y=0;for(l=this.parameters.length;y<l;y++)this.results[y]=this.parameters[y].get();y=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);this.type.applySolToContainer();return y};a.prototype.run_object=function(){var l,y,z,O=this.type,Q=O.getCurrentSol(),I=this.block.orblock&&!this.trigger,k=O.is_contained,p=O.is_family,H=O.family_index,m=this.beh_index,E=-1<m,L=this.anyParamVariesPerInstance,N=this.parameters,V=this.results,W=this.inverted,X=this.func;if(L){var Y=0;for(y=
N.length;Y<y;++Y){var ea=N[Y];ea.variesPerInstance||(V[Y]=ea.get(0))}}else for(Y=0,y=N.length;Y<y;++Y)V[Y]=N[Y].get(0);if(Q.select_all){cr.clearArray(Q.instances);cr.clearArray(Q.else_instances);var ha=O.instances;var q=0;for(l=ha.length;q<l;++q){var B=ha[q];if(L)for(Y=0,y=N.length;Y<y;++Y)ea=N[Y],ea.variesPerInstance&&(V[Y]=ea.get(q));E?(Y=0,p&&(Y=B.type.family_beh_map[H]),Y=X.apply(B.behavior_insts[m+Y],V)):Y=X.apply(B,V);(z=cr.xor(Y,W))?Q.instances.push(B):I&&Q.else_instances.push(B)}O.finish&&
O.finish(!0);Q.select_all=!1;O.applySolToContainer();return Q.hasObjects()}var G=0;ha=(z=I&&!this.block.isFirstConditionOfType(this))?Q.else_instances:Q.instances;var J=!1;q=0;for(l=ha.length;q<l;++q){B=ha[q];if(L)for(Y=0,y=N.length;Y<y;++Y)ea=N[Y],ea.variesPerInstance&&(V[Y]=ea.get(q));E?(Y=0,p&&(Y=B.type.family_beh_map[H]),Y=X.apply(B.behavior_insts[m+Y],V)):Y=X.apply(B,V);if(cr.xor(Y,W))if(J=!0,z){if(Q.instances.push(B),k)for(Y=0,y=B.siblings.length;Y<y;Y++)ea=B.siblings[Y],ea.type.getCurrentSol().instances.push(ea)}else{ha[G]=
B;if(k)for(Y=0,y=B.siblings.length;Y<y;Y++)ea=B.siblings[Y],ea.type.getCurrentSol().instances[G]=ea;G++}else if(z){ha[G]=B;if(k)for(Y=0,y=B.siblings.length;Y<y;Y++)ea=B.siblings[Y],ea.type.getCurrentSol().else_instances[G]=ea;G++}else if(I&&(Q.else_instances.push(B),k))for(Y=0,y=B.siblings.length;Y<y;Y++)ea=B.siblings[Y],ea.type.getCurrentSol().else_instances.push(ea)}cr.truncateArray(ha,G);if(k)for(p=O.container,q=0,l=p.length;q<l;q++)B=p[q].getCurrentSol(),z?cr.truncateArray(B.else_instances,G):
cr.truncateArray(B.instances,G);G=J;if(z&&!J)for(q=0,l=Q.instances.length;q<l;q++){B=Q.instances[q];if(L)for(Y=0,y=N.length;Y<y;Y++)ea=N[Y],ea.variesPerInstance&&(V[Y]=ea.get(q));Y=E?X.apply(B.behavior_insts[m],V):X.apply(B,V);if(cr.xor(Y,W)){J=!0;break}}O.finish&&O.finish(G||I);return I?J:Q.hasObjects()};cr.condition=a;d.prototype.postInit=function(){var l;var y=0;for(l=this.parameters.length;y<l;y++){var z=this.parameters[y];z.postInit();z.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};
d.prototype.run_system=function(){var l=this.runtime,y,z=this.parameters,O=this.results;var Q=0;for(y=z.length;Q<y;++Q)O[Q]=z[Q].get();return this.func.apply(l.system,O)};d.prototype.run_object=function(){var l=this.type,y=this.beh_index,z=l.family_index,O=this.anyParamVariesPerInstance,Q=this.parameters,I=this.results,k=this.func,p=l.getCurrentSol().getObjects();l=l.is_family;var H=-1<y,m,E;if(O){var L=0;for(E=Q.length;L<E;++L){var N=Q[L];N.variesPerInstance||(I[L]=N.get(0))}}else for(L=0,E=Q.length;L<
E;++L)I[L]=Q[L].get(0);var V=0;for(m=p.length;V<m;++V){var W=p[V];if(O)for(L=0,E=Q.length;L<E;++L)N=Q[L],N.variesPerInstance&&(I[L]=N.get(V));H?(L=0,l&&(L=W.type.family_beh_map[z]),k.apply(W.behavior_insts[y+L],I)):k.apply(W,I)}return!1};cr.action=d;var x=[],A=-1;u.prototype.postInit=function(){var l;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent);else if(13===this.type){var y=0;for(l=this.subparams.length;y<l;y++)this.subparams[y].postInit()}this.expression&&
this.expression.postInit()};u.prototype.maybeVaryForType=function(l){this.variesPerInstance||!l||l.plugin.singleglobal||(this.variesPerInstance=!0)};u.prototype.setVaries=function(){this.variesPerInstance=!0};u.prototype.get_exp=function(l){this.solindex=l||0;l=h();this.expression.get(l);A--;return l.data};u.prototype.get_exp_str=function(l){this.solindex=l||0;l=h();this.expression.get(l);A--;return cr.is_string(l.data)?l.data:""};u.prototype.get_object=function(){return this.object};u.prototype.get_combosel=
function(){return this.combosel};u.prototype.get_boolean=function(){return!!this.combosel};u.prototype.get_layer=function(l){this.solindex=l||0;l=h();this.expression.get(l);A--;return l.is_number()?this.runtime.getLayerByNumber(l.data):this.runtime.getLayerByName(l.data)};u.prototype.get_layout=function(){return this.layout};u.prototype.get_key=function(){return this.key};u.prototype.get_instvar=function(){return this.index};u.prototype.get_familyvar=function(l){var y=l||0;l=this.owner.type;var z=
l.getCurrentSol(),O=z.getObjects();if(O.length)y=O[y%O.length].type;else if(z.else_instances.length)y=z.else_instances[y%z.else_instances.length].type;else if(l.instances.length)y=l.instances[y%l.instances.length].type;else return 0;return this.index+y.family_var_map[l.family_index]};u.prototype.get_eventvar=function(){return this.eventvar};u.prototype.get_audiofile=function(){return this.fileinfo};u.prototype.get_variadic=function(){var l;var y=0;for(l=this.subparams.length;y<l;y++)this.variadicret[y]=
this.subparams[y].get();return this.variadicret};cr.parameter=u;v.prototype.postInit=function(){this.solModifiers=g(this.solModifiers)};v.prototype.setValue=function(l){var y=this.runtime.getCurrentLocalVarStack();this.parent&&!this.is_static&&y?(this.localIndex>=y.length&&(y.length=this.localIndex+1),y[this.localIndex]=l):this.data=l};v.prototype.getValue=function(){var l=this.runtime.getCurrentLocalVarStack();return!this.parent||this.is_static||!l||this.is_constant?this.data:this.localIndex>=l.length||
"undefined"===typeof l[this.localIndex]?this.initial:l[this.localIndex]};v.prototype.run=function(){!this.parent||this.is_static||this.is_constant||this.setValue(this.initial)};cr.eventvariable=v;C.prototype.toString=function(){return"include:"+this.include_sheet.toString()};C.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name];this.sheet.includes.add(this);this.solModifiers=g(this.solModifiers);for(var l=this.parent;l;)l.group&&l.contained_includes.push(this),
l=l.parent;this.updateActive()};C.prototype.run=function(){this.parent&&this.runtime.pushCleanSol(this.runtime.types_by_index);this.include_sheet.hasRun||this.include_sheet.run(!0);this.parent&&this.runtime.popSol(this.runtime.types_by_index)};C.prototype.updateActive=function(){for(var l=this.parent;l;){if(l.group&&!l.group_active){this.active=!1;return}l=l.parent}this.active=!0};C.prototype.isActive=function(){return this.active};cr.eventinclude=C;w.prototype.reset=function(l){this.current_event=
l;this.actindex=this.cndindex=0;cr.clearArray(this.temp_parents_arr);this.any_true_state=this.else_branch_ran=this.last_event_true=!1};w.prototype.isModifierAfterCnds=function(){return this.current_event.solWriterAfterCnds?!0:this.cndindex<this.current_event.conditions.length-1?!!this.current_event.solModifiers.length:!1};cr.eventStackFrame=w})();
(function(){function b(c,a){this.owner=c;this.runtime=c.runtime;this.type=a[0];this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_exp,this.eval_instvar_exp,this.eval_behavior_exp,
this.eval_eventvar_exp][this.type];var d=null;this.object_type=this.parameters=this.results=this.func=this.third=this.second=this.first=this.value=null;this.beh_index=-1;this.instance_expr=null;this.varindex=-1;this.eventvar=this.varname=this.behavior_type=null;this.return_string=!1;switch(this.type){case 0:case 1:case 2:this.value=a[1];break;case 3:this.first=new cr.expNode(c,a[1]);break;case 18:this.first=new cr.expNode(c,a[1]);this.second=new cr.expNode(c,a[2]);this.third=new cr.expNode(c,a[3]);
break;case 19:this.func=this.runtime.GetObjectReference(a[1]);this.func!==cr.system_object.prototype.exps.random&&this.func!==cr.system_object.prototype.exps.choose||this.owner.setVaries();this.results=[];this.parameters=[];3===a.length?(d=a[2],this.results.length=d.length+1):this.results.length=1;break;case 20:this.object_type=this.runtime.types_by_index[a[1]];this.beh_index=-1;this.func=this.runtime.GetObjectReference(a[2]);this.return_string=a[3];cr.plugins_.Function&&this.func===cr.plugins_.Function.prototype.exps.Call&&
this.owner.setVaries();this.instance_expr=a[4]?new cr.expNode(c,a[4]):null;this.results=[];this.parameters=[];6===a.length?(d=a[5],this.results.length=d.length+1):this.results.length=1;break;case 21:this.object_type=this.runtime.types_by_index[a[1]];this.return_string=a[2];this.instance_expr=a[3]?new cr.expNode(c,a[3]):null;this.varindex=a[4];break;case 22:this.object_type=this.runtime.types_by_index[a[1]];this.behavior_type=this.object_type.getBehaviorByName(a[2]);this.beh_index=this.object_type.getBehaviorIndexByName(a[2]);
this.func=this.runtime.GetObjectReference(a[3]);this.return_string=a[4];this.instance_expr=a[5]?new cr.expNode(c,a[5]):null;this.results=[];this.parameters=[];7===a.length?(d=a[6],this.results.length=d.length+1):this.results.length=1;break;case 23:this.varname=a[1],this.eventvar=null}this.owner.maybeVaryForType(this.object_type);4<=this.type&&17>=this.type&&(this.first=new cr.expNode(c,a[1]),this.second=new cr.expNode(c,a[2]));if(d){var h;a=0;for(h=d.length;a<h;a++)this.parameters.push(new cr.expNode(c,
d[a]))}cr.seal(this)}function f(){++e;t.length===e&&t.push(new cr.expvalue);return t[e]}function g(c,a,d){var h;var u=0;for(h=c.length;u<h;++u)c[u].get(d),a[u+1]=d.data}function n(c,a){this.type=c||cr.exptype.Integer;this.data=a||0;this.object_class=null;this.type==cr.exptype.Integer&&(this.data=Math.floor(this.data));cr.seal(this)}b.prototype.postInit=function(){23===this.type&&(this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent));this.first&&this.first.postInit();
this.second&&this.second.postInit();this.third&&this.third.postInit();this.instance_expr&&this.instance_expr.postInit();if(this.parameters){var c;var a=0;for(c=this.parameters.length;a<c;a++)this.parameters[a].postInit()}};var t=[],e=-1;b.prototype.eval_system_exp=function(c){var a=this.parameters,d=this.results;d[0]=c;c=f();g(a,d,c);--e;this.func.apply(this.runtime.system,d)};b.prototype.eval_object_exp=function(c){var a=this.object_type,d=this.results,h=this.parameters,u=this.instance_expr,v=this.func,
C=this.owner.solindex,w=a.getCurrentSol(),r=w.getObjects();if(!r.length)if(w.else_instances.length)r=w.else_instances;else{this.return_string?c.set_string(""):c.set_int(0);return}d[0]=c;c.object_class=a;c=f();g(h,d,c);u&&(u.get(c),c.is_number()&&(C=c.data,r=a.instances));--e;a=r.length;if(C>=a||C<=-a)C%=a;0>C&&(C+=a);v.apply(r[C],d)};b.prototype.eval_behavior_exp=function(c){var a=this.object_type,d=this.results,h=this.parameters,u=this.instance_expr,v=this.beh_index,C=this.func,w=this.owner.solindex,
r=a.getCurrentSol(),x=r.getObjects();if(!x.length)if(r.else_instances.length)x=r.else_instances;else{this.return_string?c.set_string(""):c.set_int(0);return}d[0]=c;c.object_class=a;c=f();g(h,d,c);u&&(u.get(c),c.is_number()&&(w=c.data,x=a.instances));--e;h=x.length;if(w>=h||w<=-h)w%=h;0>w&&(w+=h);w=x[w];x=0;a.is_family&&(x=w.type.family_beh_map[a.family_index]);C.apply(w.behavior_insts[v+x],d)};b.prototype.eval_instvar_exp=function(c){var a=this.instance_expr,d=this.object_type,h=this.varindex,u=this.owner.solindex,
v=d.getCurrentSol(),C=v.getObjects();if(!C.length)if(v.else_instances.length)C=v.else_instances;else{this.return_string?c.set_string(""):c.set_int(0);return}if(a){v=f();a.get(v);if(v.is_number()){u=v.data;C=d.instances;0!==C.length&&(u%=C.length,0>u&&(u+=C.length));u=d.getInstanceByIID(u);d=u.instance_vars[h];cr.is_string(d)?c.set_string(d):c.set_float(d);--e;return}--e}a=C.length;if(u>=a||u<=-a)u%=a;0>u&&(u+=a);u=C[u];C=0;d.is_family&&(C=u.type.family_var_map[d.family_index]);d=u.instance_vars[h+
C];cr.is_string(d)?c.set_string(d):c.set_float(d)};b.prototype.eval_int=function(c){c.type=cr.exptype.Integer;c.data=this.value};b.prototype.eval_float=function(c){c.type=cr.exptype.Float;c.data=this.value};b.prototype.eval_string=function(c){c.type=cr.exptype.String;c.data=this.value};b.prototype.eval_unaryminus=function(c){this.first.get(c);c.is_number()&&(c.data=-c.data)};b.prototype.eval_add=function(c){this.first.get(c);var a=f();this.second.get(a);c.is_number()&&a.is_number()&&(c.data+=a.data,
a.is_float()&&c.make_float());--e};b.prototype.eval_subtract=function(c){this.first.get(c);var a=f();this.second.get(a);c.is_number()&&a.is_number()&&(c.data-=a.data,a.is_float()&&c.make_float());--e};b.prototype.eval_multiply=function(c){this.first.get(c);var a=f();this.second.get(a);c.is_number()&&a.is_number()&&(c.data*=a.data,a.is_float()&&c.make_float());--e};b.prototype.eval_divide=function(c){this.first.get(c);var a=f();this.second.get(a);c.is_number()&&a.is_number()&&(c.data/=a.data,c.make_float());
--e};b.prototype.eval_mod=function(c){this.first.get(c);var a=f();this.second.get(a);c.is_number()&&a.is_number()&&(c.data%=a.data,a.is_float()&&c.make_float());--e};b.prototype.eval_power=function(c){this.first.get(c);var a=f();this.second.get(a);c.is_number()&&a.is_number()&&(c.data=Math.pow(c.data,a.data),a.is_float()&&c.make_float());--e};b.prototype.eval_and=function(c){this.first.get(c);var a=f();this.second.get(a);a.is_string()||c.is_string()?this.eval_and_stringconcat(c,a):this.eval_and_logical(c,
a);--e};b.prototype.eval_and_stringconcat=function(c,a){c.is_string()&&a.is_string()?this.eval_and_stringconcat_str_str(c,a):this.eval_and_stringconcat_num(c,a)};b.prototype.eval_and_stringconcat_str_str=function(c,a){c.data+=a.data};b.prototype.eval_and_stringconcat_num=function(c,a){c.is_string()?c.data+=(Math.round(1E10*a.data)/1E10).toString():c.set_string(c.data.toString()+a.data)};b.prototype.eval_and_logical=function(c,a){c.set_int(c.data&&a.data?1:0)};b.prototype.eval_or=function(c){this.first.get(c);
var a=f();this.second.get(a);c.is_number()&&a.is_number()&&(c.data||a.data?c.set_int(1):c.set_int(0));--e};b.prototype.eval_conditional=function(c){this.first.get(c);c.data?this.second.get(c):this.third.get(c)};b.prototype.eval_equal=function(c){this.first.get(c);var a=f();this.second.get(a);c.set_int(c.data===a.data?1:0);--e};b.prototype.eval_notequal=function(c){this.first.get(c);var a=f();this.second.get(a);c.set_int(c.data!==a.data?1:0);--e};b.prototype.eval_less=function(c){this.first.get(c);
var a=f();this.second.get(a);c.set_int(c.data<a.data?1:0);--e};b.prototype.eval_lessequal=function(c){this.first.get(c);var a=f();this.second.get(a);c.set_int(c.data<=a.data?1:0);--e};b.prototype.eval_greater=function(c){this.first.get(c);var a=f();this.second.get(a);c.set_int(c.data>a.data?1:0);--e};b.prototype.eval_greaterequal=function(c){this.first.get(c);var a=f();this.second.get(a);c.set_int(c.data>=a.data?1:0);--e};b.prototype.eval_eventvar_exp=function(c){var a=this.eventvar.getValue();"number"===
typeof a?c.set_float(a):"boolean"===typeof a?c.set_int(a?1:0):c.set_string(a)};cr.expNode=b;n.prototype.is_int=function(){return this.type===cr.exptype.Integer};n.prototype.is_float=function(){return this.type===cr.exptype.Float};n.prototype.is_number=function(){return this.type===cr.exptype.Integer||this.type===cr.exptype.Float};n.prototype.is_string=function(){return this.type===cr.exptype.String};n.prototype.make_int=function(){this.is_int()||(this.is_float()?this.data=Math.floor(this.data):this.is_string()&&
(this.data=parseInt(this.data,10)),this.type=cr.exptype.Integer)};n.prototype.make_float=function(){this.is_float()||(this.is_string()&&(this.data=parseFloat(this.data)),this.type=cr.exptype.Float)};n.prototype.make_string=function(){this.is_string()||(this.data=this.data.toString(),this.type=cr.exptype.String)};n.prototype.set_int=function(c){this.type=cr.exptype.Integer;this.data=Math.floor(c)};n.prototype.set_float=function(c){this.type=cr.exptype.Float;this.data=c};n.prototype.set_string=function(c){this.type=
cr.exptype.String;this.data=c};n.prototype.set_any=function(c){cr.is_number(c)?(this.type=cr.exptype.Float,this.data=c):cr.is_string(c)?(this.type=cr.exptype.String,this.data=c.toString()):(this.type=cr.exptype.Integer,this.data=0)};cr.expvalue=n;cr.exptype={Integer:0,Float:1,String:2}})();cr.system_object=function(b){this.runtime=b;this.waits=[]};
cr.system_object.prototype.saveToJSON=function(){var b={},f,g,n;b.waits=[];var t=b.waits;var e=0;for(f=this.waits.length;e<f;e++){var c=this.waits[e];var a={t:c.time,st:c.signaltag,s:c.signalled,ev:c.ev.sid,sm:[],sols:{}};c.ev.actions[c.actindex]&&(a.act=c.ev.actions[c.actindex].sid);var d=0;for(g=c.solModifiers.length;d<g;d++)a.sm.push(c.solModifiers[d].sid);for(n in c.sols)if(c.sols.hasOwnProperty(n)){var h=this.runtime.types_by_index[parseInt(n,10)];var u={sa:c.sols[n].sa,insts:[]};d=0;for(g=c.sols[n].insts.length;d<
g;d++)u.insts.push(c.sols[n].insts[d].uid);a.sols[h.sid.toString()]=u}t.push(a)}return b};
cr.system_object.prototype.loadFromJSON=function(b){b=b.waits;var f,g,n,t,e;cr.clearArray(this.waits);var c=0;for(f=b.length;c<f;c++){var a=b[c];if(t=this.runtime.blocksBySid[a.ev.toString()]){var d=-1;var h=0;for(g=t.actions.length;h<g;h++)if(t.actions[h].sid===a.act){d=h;break}if(-1!==d){var u={sols:{},solModifiers:[],deleteme:!1};u.time=a.t;u.signaltag=a.st||"";u.signalled=!!a.s;u.ev=t;u.actindex=d;h=0;for(g=a.sm.length;h<g;h++)(t=this.runtime.getObjectTypeBySid(a.sm[h]))&&u.solModifiers.push(t);
for(n in a.sols)if(a.sols.hasOwnProperty(n)&&(t=this.runtime.getObjectTypeBySid(parseInt(n,10)))){d=a.sols[n];var v={sa:d.sa,insts:[]};h=0;for(g=d.insts.length;h<g;h++)(e=this.runtime.getObjectByUID(d.insts[h]))&&v.insts.push(e);u.sols[t.index.toString()]=v}this.waits.push(u)}}}};
(function(){function b(){}function f(k,p){k=k.extra.c2_feo_val;p=p.extra.c2_feo_val;if(cr.is_number(k)&&cr.is_number(p))return k-p;k=""+k;p=""+p;return k<p?-1:k>p?1:0}function g(k,p){w&&k===r&&p===x||(w=new RegExp(k,p),r=k,x=p);w.lastIndex=0;return w}function n(){}function t(){var k=l.length?l.pop():{sols:{},solModifiers:[]};k.deleteme=!1;return k}function e(){var k=y.length?y.pop():{insts:[]};k.sa=!1;return k}function c(k,p){var H=k[0]-p[0];return 0!==H?H:k[1]-p[1]}function a(k,p){return k[1]-p[1]}
function d(){}function h(k,p,H){if(k!==O||p!==Q||H!==I){var m=g(p,H);z=k.match(m);O=k;Q=p;I=H}}var u=cr.system_object.prototype;b.prototype.EveryTick=function(){return!0};b.prototype.OnLayoutStart=function(){return!0};b.prototype.OnLayoutEnd=function(){return!0};b.prototype.Compare=function(k,p,H){return cr.do_cmp(k,p,H)};b.prototype.CompareTime=function(k,p){var H=this.runtime.kahanTime.sum;return 0===k?(k=this.runtime.getCurrentCondition(),!k.extra.CompareTime_executed&&H>=p?k.extra.CompareTime_executed=
!0:!1):cr.do_cmp(H,k,p)};b.prototype.LayerVisible=function(k){return k?k.visible:!1};b.prototype.LayerEmpty=function(k){return k?!k.instances.length:!1};b.prototype.LayerCmpOpacity=function(k,p,H){return k?cr.do_cmp(100*k.opacity,p,H):!1};b.prototype.Repeat=function(k){var p=this.runtime.getCurrentEventStack(),H=p.current_event,m=p.isModifierAfterCnds();p=this.runtime.pushLoopStack();if(m)for(m=0;m<k&&!p.stopped;m++)this.runtime.pushCopySol(H.solModifiers),p.index=m,H.retrigger(),this.runtime.popSol(H.solModifiers);
else for(m=0;m<k&&!p.stopped;m++)p.index=m,H.retrigger();this.runtime.popLoopStack();return!1};b.prototype.While=function(k){var p=this.runtime.getCurrentEventStack();k=p.current_event;var H=p.isModifierAfterCnds();p=this.runtime.pushLoopStack();if(H)for(H=0;!p.stopped;H++)this.runtime.pushCopySol(k.solModifiers),p.index=H,k.retrigger()||(p.stopped=!0),this.runtime.popSol(k.solModifiers);else for(H=0;!p.stopped;H++)p.index=H,k.retrigger()||(p.stopped=!0);this.runtime.popLoopStack();return!1};b.prototype.For=
function(k,p,H){var m=this.runtime.getCurrentEventStack(),E=m.current_event;m=m.isModifierAfterCnds();k=this.runtime.pushLoopStack(k);if(H<p)if(m)for(;p>=H&&!k.stopped;--p)this.runtime.pushCopySol(E.solModifiers),k.index=p,E.retrigger(),this.runtime.popSol(E.solModifiers);else for(;p>=H&&!k.stopped;--p)k.index=p,E.retrigger();else if(m)for(;p<=H&&!k.stopped;++p)this.runtime.pushCopySol(E.solModifiers),k.index=p,E.retrigger(),this.runtime.popSol(E.solModifiers);else for(;p<=H&&!k.stopped;++p)k.index=
p,E.retrigger();this.runtime.popLoopStack();return!1};var v=[],C=-1;b.prototype.ForEach=function(k){var p=k.getCurrentSol();C++;v.length===C&&v.push([]);var H=v[C];cr.shallowAssignArray(H,p.getObjects());var m=this.runtime.getCurrentEventStack(),E=m.current_event,L=m.isModifierAfterCnds();m=this.runtime.pushLoopStack();var N,V,W=k.is_contained;if(L)for(L=0,N=H.length;L<N&&!m.stopped;L++){this.runtime.pushCopySol(E.solModifiers);var X=H[L];p=k.getCurrentSol();p.select_all=!1;cr.clearArray(p.instances);
p.instances[0]=X;if(W){var Y=0;for(V=X.siblings.length;Y<V;Y++){var ea=X.siblings[Y];var ha=ea.type.getCurrentSol();ha.select_all=!1;cr.clearArray(ha.instances);ha.instances[0]=ea}}m.index=L;E.retrigger();this.runtime.popSol(E.solModifiers)}else for(p.select_all=!1,cr.clearArray(p.instances),L=0,N=H.length;L<N&&!m.stopped;L++){X=H[L];p.instances[0]=X;if(W)for(Y=0,V=X.siblings.length;Y<V;Y++)ea=X.siblings[Y],ha=ea.type.getCurrentSol(),ha.select_all=!1,cr.clearArray(ha.instances),ha.instances[0]=ea;
m.index=L;E.retrigger()}cr.clearArray(H);this.runtime.popLoopStack();C--;return!1};b.prototype.ForEachOrdered=function(k,p,H){p=k.getCurrentSol();C++;v.length===C&&v.push([]);var m=v[C];cr.shallowAssignArray(m,p.getObjects());var E=this.runtime.getCurrentEventStack(),L=E.current_event,N=this.runtime.getCurrentCondition(),V=E.isModifierAfterCnds();E=this.runtime.pushLoopStack();var W;var X=0;for(W=m.length;X<W;X++)m[X].extra.c2_feo_val=N.parameters[1].get(X);m.sort(f);1===H&&m.reverse();H=k.is_contained;
if(V)for(X=0,W=m.length;X<W&&!E.stopped;X++){this.runtime.pushCopySol(L.solModifiers);var Y=m[X];p=k.getCurrentSol();p.select_all=!1;cr.clearArray(p.instances);p.instances[0]=Y;if(H)for(N=0,V=Y.siblings.length;N<V;N++){var ea=Y.siblings[N];var ha=ea.type.getCurrentSol();ha.select_all=!1;cr.clearArray(ha.instances);ha.instances[0]=ea}E.index=X;L.retrigger();this.runtime.popSol(L.solModifiers)}else for(p.select_all=!1,cr.clearArray(p.instances),X=0,W=m.length;X<W&&!E.stopped;X++){Y=m[X];p.instances[0]=
Y;if(H)for(N=0,V=Y.siblings.length;N<V;N++)ea=Y.siblings[N],ha=ea.type.getCurrentSol(),ha.select_all=!1,cr.clearArray(ha.instances),ha.instances[0]=ea;E.index=X;L.retrigger()}cr.clearArray(m);this.runtime.popLoopStack();C--;return!1};b.prototype.PickByComparison=function(k,p,H,m){var E,L;if(k){C++;v.length===C&&v.push([]);var N=v[C],V=k.getCurrentSol();cr.shallowAssignArray(N,V.getObjects());V.select_all&&cr.clearArray(V.else_instances);var W=this.runtime.getCurrentCondition();var X=E=0;for(L=N.length;E<
L;E++){var Y=N[E];N[X]=Y;p=W.parameters[1].get(E);m=W.parameters[3].get(E);cr.do_cmp(p,H,m)?X++:V.else_instances.push(Y)}cr.truncateArray(N,X);V.select_all=!1;cr.shallowAssignArray(V.instances,N);cr.clearArray(N);C--;k.applySolToContainer();return!!V.instances.length}};b.prototype.PickByEvaluate=function(k,p){var H,m;if(k){C++;v.length===C&&v.push([]);var E=v[C],L=k.getCurrentSol();cr.shallowAssignArray(E,L.getObjects());L.select_all&&cr.clearArray(L.else_instances);var N=this.runtime.getCurrentCondition();
var V=H=0;for(m=E.length;H<m;H++){var W=E[H];E[V]=W;(p=N.parameters[1].get(H))?V++:L.else_instances.push(W)}cr.truncateArray(E,V);L.select_all=!1;cr.shallowAssignArray(L.instances,E);cr.clearArray(E);C--;k.applySolToContainer();return!!L.instances.length}};b.prototype.TriggerOnce=function(){var k=this.runtime.getCurrentCondition().extra;"undefined"===typeof k.TriggerOnce_lastTick&&(k.TriggerOnce_lastTick=-1);var p=k.TriggerOnce_lastTick,H=this.runtime.tickcount;k.TriggerOnce_lastTick=H;return this.runtime.layout_first_tick||
p!==H-1};b.prototype.Every=function(k){var p=this.runtime.getCurrentCondition(),H=p.extra.Every_lastTime||0,m=this.runtime.kahanTime.sum;"undefined"===typeof p.extra.Every_seconds&&(p.extra.Every_seconds=k);var E=p.extra.Every_seconds;if(m>=H+E)return p.extra.Every_lastTime=H+E,m>=p.extra.Every_lastTime+.04&&(p.extra.Every_lastTime=m),p.extra.Every_seconds=k,!0;m<H-.1&&(p.extra.Every_lastTime=m);return!1};b.prototype.PickNth=function(k,p){if(!k)return!1;var H=k.getCurrentSol(),m=H.getObjects();p=
cr.floor(p);if(0>p||p>=m.length)return!1;H.pick_one(m[p]);k.applySolToContainer();return!0};b.prototype.PickRandom=function(k){if(!k)return!1;var p=k.getCurrentSol(),H=p.getObjects(),m=cr.floor(Math.random()*H.length);if(m>=H.length)return!1;p.pick_one(H[m]);k.applySolToContainer();return!0};b.prototype.CompareVar=function(k,p,H){return cr.do_cmp(k.getValue(),p,H)};b.prototype.CompareBoolVar=function(k){return k.getValue()};b.prototype.IsGroupActive=function(k){return(k=this.runtime.groups_by_name[k.toLowerCase()])&&
k.group_active};b.prototype.IsPreview=function(){return this.runtime.isPreview};b.prototype.PickAll=function(k){if(!k||!k.instances.length)return!1;k.getCurrentSol().select_all=!0;k.applySolToContainer();return!0};b.prototype.IsMobile=function(){return this.runtime.isMobile};b.prototype.CompareBetween=function(k,p,H){return k>=p&&k<=H};b.prototype.Else=function(){var k=this.runtime.getCurrentEventStack();return k.else_branch_ran?!1:!k.last_event_true};b.prototype.OnLoadFinished=function(){return!0};
b.prototype.OnCanvasSnapshot=function(){return!0};b.prototype.EffectsSupported=function(){return!!this.runtime.glwrap};b.prototype.OnSaveComplete=function(){return!0};b.prototype.OnSaveFailed=function(){return!0};b.prototype.OnLoadComplete=function(){return!0};b.prototype.OnLoadFailed=function(){return!0};b.prototype.ObjectUIDExists=function(k){return!!this.runtime.getObjectByUID(k)};b.prototype.IsOnPlatform=function(k){var p=this.runtime;switch(k){case 0:return!p.isNodeWebkit&&!p.isCordova&&!p.isWinJS&&
!p.isWindowsPhone8&&!p.isBlackberry10&&!p.isAmazonWebApp;case 1:return p.isiOS;case 2:return p.isAndroid;case 3:return p.isWindows8App;case 4:return p.isWindowsPhone8;case 5:return p.isBlackberry10;case 6:return p.isTizen;case 7:return!1;case 8:return p.isCordova;case 9:return p.isArcade;case 10:return p.isNodeWebkit;case 11:return p.isCrosswalk;case 12:return p.isAmazonWebApp;case 13:return p.isWindows10;default:return!1}};var w=null,r="",x="";b.prototype.RegexTest=function(k,p,H){return g(p,H).test(k)};
var A=[];b.prototype.PickOverlappingPoint=function(k,p,H){if(!k)return!1;var m=k.getCurrentSol(),E=m.getObjects(),L=this.runtime.getCurrentEventStack().current_event.orblock,N=this.runtime.getCurrentCondition(),V;m.select_all?(cr.shallowAssignArray(A,E),cr.clearArray(m.else_instances),m.select_all=!1,cr.clearArray(m.instances)):L?(cr.shallowAssignArray(A,m.else_instances),cr.clearArray(m.else_instances)):(cr.shallowAssignArray(A,E),cr.clearArray(m.instances));E=0;for(L=A.length;E<L;++E){var W=A[E];
W.update_bbox();(V=cr.xor(W.contains_pt(p,H),N.inverted))?m.instances.push(W):m.else_instances.push(W)}k.applySolToContainer();return cr.xor(!!m.instances.length,N.inverted)};b.prototype.PickLastCreated=function(k){if(!k)return!1;var p=this.runtime.createRow,H,m=null,E=k.is_family;for(H=p.length-1;0<=H;--H){var L=p[H];if(E){if(0<=L.type.families.indexOf(k)){m=L;break}}else if(L.type===k){m=L;break}}!m&&k.instances.length&&(m=k.instances[k.instances.length-1]);if(!m)return!1;k.getCurrentSol().pick_one(m);
k.applySolToContainer();return!0};b.prototype.IsNaN=function(k){return!!isNaN(k)};b.prototype.AngleWithin=function(k,p,H){return cr.angleDiff(cr.to_radians(k),cr.to_radians(H))<=cr.to_radians(p)};b.prototype.IsClockwiseFrom=function(k,p){return cr.angleClockwise(cr.to_radians(k),cr.to_radians(p))};b.prototype.IsBetweenAngles=function(k,p,H){k=cr.to_clamped_radians(k);p=cr.to_clamped_radians(p);H=cr.to_clamped_radians(H);return cr.angleClockwise(H,p)?cr.angleClockwise(k,p)&&!cr.angleClockwise(k,H):
!(!cr.angleClockwise(k,p)&&cr.angleClockwise(k,H))};b.prototype.IsValueType=function(k,p){return"number"===typeof k?0===p:1===p};u.cnds=new b;n.prototype.GoToLayout=function(k){this.runtime.isloading||this.runtime.changelayout||(this.runtime.changelayout=k)};n.prototype.NextPrevLayout=function(k){if(!this.runtime.isloading&&!this.runtime.changelayout){var p=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);if(!k||0!==p)if(k||p!==this.runtime.layouts_by_index.length-1)this.runtime.changelayout=
this.runtime.layouts_by_index[p+(k?-1:1)]}};n.prototype.CreateObject=function(k,p,H,m){if(p&&k&&(p=this.runtime.createInstance(k,p,H,m))){this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(k.plugin).cnds.OnCreated,p);if(p.is_contained)for(H=0,m=p.siblings.length;H<m;H++){var E=p.siblings[H];this.runtime.trigger(Object.getPrototypeOf(E.type.plugin).cnds.OnCreated,E)}this.runtime.isInOnDestroy--;k=k.getCurrentSol();k.select_all=!1;cr.clearArray(k.instances);k.instances[0]=p;if(p.is_contained)for(H=
0,m=p.siblings.length;H<m;H++)E=p.siblings[H],k=E.type.getCurrentSol(),k.select_all=!1,cr.clearArray(k.instances),k.instances[0]=E}};n.prototype.CreateObjectByName=function(k,p,H,m){p&&k&&(k=this.runtime.types_lowercase[k.toLowerCase()])&&n.prototype.CreateObject.call(this,k,p,H,m)};n.prototype.SetLayerVisible=function(k,p){k&&k.visible!==p&&(k.visible=p,this.runtime.redraw=!0)};n.prototype.SetLayerOpacity=function(k,p){k&&(p=cr.clamp(p/100,0,1),k.opacity!==p&&(k.opacity=p,this.runtime.redraw=!0))};
n.prototype.SetLayerScaleRate=function(k,p){k&&k.zoomRate!==p&&(k.zoomRate=p,this.runtime.redraw=!0)};n.prototype.SetLayerForceOwnTexture=function(k,p){k&&(p=!!p,k.forceOwnTexture!==p&&(k.forceOwnTexture=p,this.runtime.redraw=!0))};n.prototype.SetLayoutScale=function(k){this.runtime.running_layout&&this.runtime.running_layout.scale!==k&&(this.runtime.running_layout.scale=k,this.runtime.running_layout.boundScrolling(),this.runtime.redraw=!0)};n.prototype.ScrollX=function(k){this.runtime.running_layout.scrollToX(k)};
n.prototype.ScrollY=function(k){this.runtime.running_layout.scrollToY(k)};n.prototype.Scroll=function(k,p){this.runtime.running_layout.scrollToX(k);this.runtime.running_layout.scrollToY(p)};n.prototype.ScrollToObject=function(k){if(k=k.getFirstPicked())this.runtime.running_layout.scrollToX(k.x),this.runtime.running_layout.scrollToY(k.y)};n.prototype.SetVar=function(k,p){0===k.vartype?cr.is_number(p)?k.setValue(p):k.setValue(parseFloat(p)):1===k.vartype&&k.setValue(p.toString())};n.prototype.AddVar=
function(k,p){0===k.vartype?cr.is_number(p)?k.setValue(k.getValue()+p):k.setValue(k.getValue()+parseFloat(p)):1===k.vartype&&k.setValue(k.getValue()+p.toString())};n.prototype.SubVar=function(k,p){0===k.vartype&&(cr.is_number(p)?k.setValue(k.getValue()-p):k.setValue(k.getValue()-parseFloat(p)))};n.prototype.SetBoolVar=function(k,p){k.setValue(0!==p)};n.prototype.ToggleBoolVar=function(k){k.setValue(!k.getValue())};n.prototype.SetGroupActive=function(k,p){if(k=this.runtime.groups_by_name[k.toLowerCase()])switch(p){case 0:k.setGroupActive(!1);
break;case 1:k.setGroupActive(!0);break;case 2:k.setGroupActive(!k.group_active)}};n.prototype.SetTimescale=function(k){0>k&&(k=0);this.runtime.timescale=k};n.prototype.SetObjectTimescale=function(k,p){0>p&&(p=0);if(k){k=k.getCurrentSol().getObjects();var H;var m=0;for(H=k.length;m<H;m++)k[m].my_timescale=p}};n.prototype.RestoreObjectTimescale=function(k){if(!k)return!1;k=k.getCurrentSol().getObjects();var p;var H=0;for(p=k.length;H<p;H++)k[H].my_timescale=-1};var l=[],y=[];n.prototype.Wait=function(k){if(!(0>
k)){var p,H=this.runtime.getCurrentEventStack(),m=t();m.time=this.runtime.kahanTime.sum+k;m.signaltag="";m.signalled=!1;m.ev=H.current_event;m.actindex=H.actindex+1;k=0;for(p=this.runtime.types_by_index.length;k<p;k++){var E=this.runtime.types_by_index[k];var L=E.getCurrentSol();L.select_all&&-1===H.current_event.solModifiers.indexOf(E)||(m.solModifiers.push(E),E=e(),E.sa=L.select_all,cr.shallowAssignArray(E.insts,L.instances),m.sols[k.toString()]=E)}this.waits.push(m);return!0}};n.prototype.WaitForSignal=
function(k){var p,H=this.runtime.getCurrentEventStack(),m=t();m.time=-1;m.signaltag=k.toLowerCase();m.signalled=!1;m.ev=H.current_event;m.actindex=H.actindex+1;k=0;for(p=this.runtime.types_by_index.length;k<p;k++){var E=this.runtime.types_by_index[k];var L=E.getCurrentSol();L.select_all&&-1===H.current_event.solModifiers.indexOf(E)||(m.solModifiers.push(E),E=e(),E.sa=L.select_all,cr.shallowAssignArray(E.insts,L.instances),m.sols[k.toString()]=E)}this.waits.push(m);return!0};n.prototype.Signal=function(k){k=
k.toLowerCase();var p;var H=0;for(p=this.waits.length;H<p;++H){var m=this.waits[H];-1===m.time&&m.signaltag===k&&(m.signalled=!0)}};n.prototype.SetLayerScale=function(k,p){k&&k.scale!==p&&(k.scale=p,this.runtime.redraw=!0)};n.prototype.ResetGlobals=function(){var k;var p=0;for(k=this.runtime.all_global_vars.length;p<k;p++){var H=this.runtime.all_global_vars[p];H.data=H.initial}};n.prototype.SetLayoutAngle=function(k){k=cr.to_radians(k);k=cr.clamp_angle(k);this.runtime.running_layout&&this.runtime.running_layout.angle!==
k&&(this.runtime.running_layout.angle=k,this.runtime.redraw=!0)};n.prototype.SetLayerAngle=function(k,p){k&&(p=cr.to_radians(p),p=cr.clamp_angle(p),k.angle!==p&&(k.angle=p,this.runtime.redraw=!0))};n.prototype.SetLayerParallax=function(k,p,H){if(k&&(k.parallaxX!==p/100||k.parallaxY!==H/100)){k.parallaxX=p/100;k.parallaxY=H/100;if(1!==k.parallaxX||1!==k.parallaxY)for(H=k.instances,k=0,p=H.length;k<p;++k)H[k].type.any_instance_parallaxed=!0;this.runtime.redraw=!0}};n.prototype.SetLayerBackground=function(k,
p){if(k){var H=cr.clamp(Math.floor(255*cr.GetRValue(p)),0,255),m=cr.clamp(Math.floor(255*cr.GetGValue(p)),0,255);p=cr.clamp(Math.floor(255*cr.GetBValue(p)),0,255);if(k.background_color[0]!==H||k.background_color[1]!==m||k.background_color[2]!==p)k.background_color[0]=H,k.background_color[1]=m,k.background_color[2]=p,this.runtime.redraw=!0}};n.prototype.SetLayerTransparent=function(k,p){k&&!!p!==!!k.transparent&&(k.transparent=!!p,this.runtime.redraw=!0)};n.prototype.SetLayerBlendMode=function(k,p){k&&
k.blend_mode!==p&&(k.blend_mode=p,k.compositeOp=cr.effectToCompositeOp(k.blend_mode),this.runtime.gl&&cr.setGLBlend(k,k.blend_mode,this.runtime.gl),this.runtime.redraw=!0)};n.prototype.StopLoop=function(){0>this.runtime.loop_stack_index||(this.runtime.getCurrentLoop().stopped=!0)};n.prototype.GoToLayoutByName=function(k){if(!this.runtime.isloading&&!this.runtime.changelayout)for(var p in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(p)&&cr.equals_nocase(p,k)){this.runtime.changelayout=
this.runtime.layouts[p];break}};n.prototype.RestartLayout=function(k){if(!this.runtime.isloading&&!this.runtime.changelayout&&this.runtime.running_layout){this.runtime.changelayout=this.runtime.running_layout;var p;k=0;for(p=this.runtime.allGroups.length;k<p;k++){var H=this.runtime.allGroups[k];H.setGroupActive(H.initially_activated)}}};n.prototype.SnapshotCanvas=function(k,p){this.runtime.doCanvasSnapshot(0===k?"image/png":"image/jpeg",p/100)};n.prototype.SetCanvasSize=function(k,p){if(!(0>=k||0>=
p)){var H=this.runtime.fullscreen_mode;(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen)&&0<this.runtime.fullscreen_scaling&&(H=this.runtime.fullscreen_scaling);0===H?this.runtime.setSize(k,p,!0):(this.runtime.original_width=k,this.runtime.original_height=p,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))}};n.prototype.SetLayoutEffectEnabled=function(k,p){this.runtime.running_layout&&this.runtime.glwrap&&(p=
this.runtime.running_layout.getEffectByName(p))&&(k=1===k,p.active!=k&&(p.active=k,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0))};n.prototype.SetLayerEffectEnabled=function(k,p,H){k&&this.runtime.glwrap&&(H=k.getEffectByName(H))&&(p=1===p,H.active!=p&&(H.active=p,k.updateActiveEffects(),this.runtime.redraw=!0))};n.prototype.SetLayoutEffectParam=function(k,p,H){if(this.runtime.running_layout&&this.runtime.glwrap&&(k=this.runtime.running_layout.getEffectByName(k))){var m=
this.runtime.running_layout.effect_params[k.index];p=Math.floor(p);if(!(0>p||p>=m.length)){var E=this.runtime.glwrap.getProgramParameterType(k.shaderindex,p);1===E?H/=100:2===E&&(H=[cr.GetRValue(H),cr.GetGValue(H),cr.GetBValue(H)]);m[p]!==H&&(m[p]=H,k.active&&(this.runtime.redraw=!0))}}};n.prototype.SetLayerEffectParam=function(k,p,H,m){if(k&&this.runtime.glwrap&&(p=k.getEffectByName(p))&&(k=k.effect_params[p.index],H=Math.floor(H),!(0>H||H>=k.length))){var E=this.runtime.glwrap.getProgramParameterType(p.shaderindex,
H);1===E?m/=100:2===E&&(m=[cr.GetRValue(m),cr.GetGValue(m),cr.GetBValue(m)]);k[H]!==m&&(k[H]=m,p.active&&(this.runtime.redraw=!0))}};n.prototype.SaveState=function(k){this.runtime.saveToSlot=k};n.prototype.LoadState=function(k){this.runtime.loadFromSlot=k};n.prototype.LoadStateJSON=function(k){this.runtime.loadFromJson=k};n.prototype.SetHalfFramerateMode=function(k){this.runtime.halfFramerateMode=0!==k};n.prototype.SetFullscreenQuality=function(k){if(document.mozFullScreen||document.webkitIsFullScreen||
document.msFullscreenElement||document.fullScreen||0!==this.runtime.fullscreen_mode)this.runtime.wantFullscreenScalingQuality=0!==k,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0)};n.prototype.ResetPersisted=function(){var k;var p=0;for(k=this.runtime.layouts_by_index.length;p<k;++p)this.runtime.layouts_by_index[p].persist_data={},this.runtime.layouts_by_index[p].first_visit=!0};n.prototype.RecreateInitialObjects=function(k,p,H,m,E){k&&this.runtime.running_layout.recreateInitialObjects(k,
p,H,m,E)};n.prototype.SetPixelRounding=function(k){this.runtime.pixel_rounding=0!==k;this.runtime.redraw=!0};n.prototype.SetMinimumFramerate=function(k){1>k&&(k=1);120<k&&(k=120);this.runtime.minimumFramerate=k};n.prototype.SortZOrderByInstVar=function(k,p){if(k){var H;var m=k.getCurrentSol().getObjects();var E=[],L=[],N=this.runtime.running_layout,V=k.is_family,W=k.family_index,X=!1;k=0;for(H=m.length;k<H;++k){var Y=m[k];if(Y.layer){var ea=V?Y.instance_vars[p+Y.type.family_var_map[W]]:Y.instance_vars[p];
E.push([Y.layer.index,Y.get_zindex()]);L.push([Y,ea])}}if(E.length){E.sort(c);L.sort(a);k=0;for(H=E.length;k<H;++k)Y=L[k][0],p=N.layers[E[k][0]],m=E[k][1],p.instances[m]!==Y&&(p.instances[m]=Y,Y.layer=p,p.setZIndicesStaleFrom(m),X=!0);X&&(this.runtime.redraw=!0)}}};u.acts=new n;d.prototype.int=function(k,p){cr.is_string(p)?(k.set_int(parseInt(p,10)),isNaN(k.data)&&(k.data=0)):k.set_int(p)};d.prototype.float=function(k,p){cr.is_string(p)?(k.set_float(parseFloat(p)),isNaN(k.data)&&(k.data=0)):k.set_float(p)};
d.prototype.str=function(k,p){cr.is_string(p)?k.set_string(p):k.set_string(p.toString())};d.prototype.len=function(k,p){k.set_int(p.length||0)};d.prototype.random=function(k,p,H){void 0===H?k.set_float(Math.random()*p):k.set_float(Math.random()*(H-p)+p)};d.prototype.sqrt=function(k,p){k.set_float(Math.sqrt(p))};d.prototype.abs=function(k,p){k.set_float(Math.abs(p))};d.prototype.round=function(k,p){k.set_int(Math.round(p))};d.prototype.floor=function(k,p){k.set_int(Math.floor(p))};d.prototype.ceil=
function(k,p){k.set_int(Math.ceil(p))};d.prototype.sign=function(k,p){k.set_float(Math.sign(p))};d.prototype.sin=function(k,p){k.set_float(Math.sin(cr.to_radians(p)))};d.prototype.cos=function(k,p){k.set_float(Math.cos(cr.to_radians(p)))};d.prototype.tan=function(k,p){k.set_float(Math.tan(cr.to_radians(p)))};d.prototype.asin=function(k,p){k.set_float(cr.to_degrees(Math.asin(p)))};d.prototype.acos=function(k,p){k.set_float(cr.to_degrees(Math.acos(p)))};d.prototype.atan=function(k,p){k.set_float(cr.to_degrees(Math.atan(p)))};
d.prototype.exp=function(k,p){k.set_float(Math.exp(p))};d.prototype.ln=function(k,p){k.set_float(Math.log(p))};d.prototype.log10=function(k,p){k.set_float(Math.log(p)/Math.LN10)};d.prototype.max=function(k){var p=arguments[1];"number"!==typeof p&&(p=0);var H;var m=2;for(H=arguments.length;m<H;m++){var E=arguments[m];"number"===typeof E&&p<E&&(p=E)}k.set_float(p)};d.prototype.min=function(k){var p=arguments[1];"number"!==typeof p&&(p=0);var H;var m=2;for(H=arguments.length;m<H;m++){var E=arguments[m];
"number"===typeof E&&p>E&&(p=E)}k.set_float(p)};d.prototype.dt=function(k){k.set_float(this.runtime.dt)};d.prototype.timescale=function(k){k.set_float(this.runtime.timescale)};d.prototype.wallclocktime=function(k){k.set_float((Date.now()-this.runtime.start_time)/1E3)};d.prototype.unixtime=function(k){k.set_float(Date.now())};d.prototype.time=function(k){k.set_float(this.runtime.kahanTime.sum)};d.prototype.tickcount=function(k){k.set_int(this.runtime.tickcount)};d.prototype.objectcount=function(k){k.set_int(this.runtime.objectcount)};
d.prototype.fps=function(k){k.set_int(this.runtime.fps)};d.prototype.loopindex=function(k,p){var H;if(this.runtime.loop_stack.length)if(p){for(H=this.runtime.loop_stack_index;0<=H;--H){var m=this.runtime.loop_stack[H];if(m.name===p){k.set_int(m.index);return}}k.set_int(0)}else m=this.runtime.getCurrentLoop(),k.set_int(m?m.index:-1);else k.set_int(0)};d.prototype.distance=function(k,p,H,m,E){k.set_float(cr.distanceTo(p,H,m,E))};d.prototype.angle=function(k,p,H,m,E){k.set_float(cr.to_degrees(cr.angleTo(p,
H,m,E)))};d.prototype.scrollx=function(k){k.set_float(this.runtime.running_layout.scrollX)};d.prototype.scrolly=function(k){k.set_float(this.runtime.running_layout.scrollY)};d.prototype.newline=function(k){k.set_string("\n")};d.prototype.lerp=function(k,p,H,m){k.set_float(cr.lerp(p,H,m))};d.prototype.qarp=function(k,p,H,m,E){k.set_float(cr.qarp(p,H,m,E))};d.prototype.cubic=function(k,p,H,m,E,L){k.set_float(cr.cubic(p,H,m,E,L))};d.prototype.cosp=function(k,p,H,m){k.set_float(cr.cosp(p,H,m))};d.prototype.windowwidth=
function(k){k.set_int(this.runtime.width)};d.prototype.windowheight=function(k){k.set_int(this.runtime.height)};d.prototype.uppercase=function(k,p){k.set_string(cr.is_string(p)?p.toUpperCase():"")};d.prototype.lowercase=function(k,p){k.set_string(cr.is_string(p)?p.toLowerCase():"")};d.prototype.clamp=function(k,p,H,m){p<H?k.set_float(H):p>m?k.set_float(m):k.set_float(p)};d.prototype.layerscale=function(k,p){(p=this.runtime.getLayer(p))?k.set_float(p.scale):k.set_float(0)};d.prototype.layeropacity=
function(k,p){(p=this.runtime.getLayer(p))?k.set_float(100*p.opacity):k.set_float(0)};d.prototype.layerscalerate=function(k,p){(p=this.runtime.getLayer(p))?k.set_float(p.zoomRate):k.set_float(0)};d.prototype.layerparallaxx=function(k,p){(p=this.runtime.getLayer(p))?k.set_float(100*p.parallaxX):k.set_float(0)};d.prototype.layerparallaxy=function(k,p){(p=this.runtime.getLayer(p))?k.set_float(100*p.parallaxY):k.set_float(0)};d.prototype.layerindex=function(k,p){(p=this.runtime.getLayer(p))?k.set_int(p.index):
k.set_int(-1)};d.prototype.layoutscale=function(k){this.runtime.running_layout?k.set_float(this.runtime.running_layout.scale):k.set_float(0)};d.prototype.layoutangle=function(k){k.set_float(cr.to_degrees(this.runtime.running_layout.angle))};d.prototype.layerangle=function(k,p){(p=this.runtime.getLayer(p))?k.set_float(cr.to_degrees(p.angle)):k.set_float(0)};d.prototype.layoutwidth=function(k){k.set_int(this.runtime.running_layout.width)};d.prototype.layoutheight=function(k){k.set_int(this.runtime.running_layout.height)};
d.prototype.find=function(k,p,H){cr.is_string(p)&&cr.is_string(H)?k.set_int(p.search(new RegExp(cr.regexp_escape(H),"i"))):k.set_int(-1)};d.prototype.findcase=function(k,p,H){cr.is_string(p)&&cr.is_string(H)?k.set_int(p.search(new RegExp(cr.regexp_escape(H),""))):k.set_int(-1)};d.prototype.left=function(k,p,H){k.set_string(cr.is_string(p)?p.substr(0,H):"")};d.prototype.right=function(k,p,H){k.set_string(cr.is_string(p)?p.substr(p.length-H):"")};d.prototype.mid=function(k,p,H,m){k.set_string(cr.is_string(p)?
p.substr(H,m):"")};d.prototype.tokenat=function(k,p,H,m){cr.is_string(p)&&cr.is_string(m)?(p=p.split(m),H=cr.floor(H),0>H||H>=p.length?k.set_string(""):k.set_string(p[H])):k.set_string("")};d.prototype.tokencount=function(k,p,H){cr.is_string(p)&&p.length?k.set_int(p.split(H).length):k.set_int(0)};d.prototype.replace=function(k,p,H,m){cr.is_string(p)&&cr.is_string(H)&&cr.is_string(m)?k.set_string(p.replace(new RegExp(cr.regexp_escape(H),"gi"),m)):k.set_string(cr.is_string(p)?p:"")};d.prototype.trim=
function(k,p){k.set_string(cr.is_string(p)?p.trim():"")};d.prototype.pi=function(k){k.set_float(cr.PI)};d.prototype.layoutname=function(k){this.runtime.running_layout?k.set_string(this.runtime.running_layout.name):k.set_string("")};d.prototype.renderer=function(k){k.set_string(this.runtime.gl?"webgl":"canvas2d")};d.prototype.rendererdetail=function(k){k.set_string(this.runtime.glUnmaskedRenderer)};d.prototype.anglediff=function(k,p,H){k.set_float(cr.to_degrees(cr.angleDiff(cr.to_radians(p),cr.to_radians(H))))};
d.prototype.choose=function(k){var p=cr.floor(Math.random()*(arguments.length-1));k.set_any(arguments[p+1])};d.prototype.rgb=function(k,p,H,m){k.set_int(cr.RGB(p,H,m))};d.prototype.rgbex=function(k,p,H,m){k.set_float(cr.RGBEx(p/100,H/100,m/100))};d.prototype.projectversion=function(k){k.set_string(this.runtime.versionstr)};d.prototype.projectname=function(k){k.set_string(this.runtime.name)};d.prototype.anglelerp=function(k,p,H,m){p=cr.to_radians(p);H=cr.to_radians(H);var E=cr.angleDiff(p,H);cr.angleClockwise(H,
p)?k.set_float(cr.to_clamped_degrees(p+E*m)):k.set_float(cr.to_clamped_degrees(p-E*m))};d.prototype.anglerotate=function(k,p,H,m){p=cr.to_radians(p);H=cr.to_radians(H);m=cr.to_radians(m);k.set_float(cr.to_clamped_degrees(cr.angleRotate(p,H,m)))};d.prototype.zeropad=function(k,p,H){var m=0>p?"-":"";0>p&&(p=-p);H-=p.toString().length;for(var E=0;E<H;E++)m+="0";k.set_string(m+p.toString())};d.prototype.cpuutilisation=function(k){k.set_float(this.runtime.cpuutilisation/1E3)};d.prototype.gpuutilisation=
function(k){k.set_float(this.runtime.gpuLastUtilisation)};d.prototype.viewportleft=function(k,p){p=this.runtime.getLayer(p);k.set_float(p?p.viewLeft:0)};d.prototype.viewporttop=function(k,p){p=this.runtime.getLayer(p);k.set_float(p?p.viewTop:0)};d.prototype.viewportright=function(k,p){p=this.runtime.getLayer(p);k.set_float(p?p.viewRight:0)};d.prototype.viewportbottom=function(k,p){p=this.runtime.getLayer(p);k.set_float(p?p.viewBottom:0)};d.prototype.loadingprogress=function(k){k.set_float(this.runtime.loadingprogress)};
d.prototype.unlerp=function(k,p,H,m){k.set_float(cr.unlerp(p,H,m))};d.prototype.canvassnapshot=function(k){k.set_string(this.runtime.snapshotData)};d.prototype.urlencode=function(k,p){k.set_string(encodeURIComponent(p))};d.prototype.urldecode=function(k,p){k.set_string(decodeURIComponent(p))};d.prototype.canvastolayerx=function(k,p,H,m){p=this.runtime.getLayer(p);k.set_float(p?p.canvasToLayer(H,m,!0):0)};d.prototype.canvastolayery=function(k,p,H,m){p=this.runtime.getLayer(p);k.set_float(p?p.canvasToLayer(H,
m,!1):0)};d.prototype.layertocanvasx=function(k,p,H,m){p=this.runtime.getLayer(p);k.set_float(p?p.layerToCanvas(H,m,!0):0)};d.prototype.layertocanvasy=function(k,p,H,m){p=this.runtime.getLayer(p);k.set_float(p?p.layerToCanvas(H,m,!1):0)};d.prototype.savestatejson=function(k){k.set_string(this.runtime.lastSaveJson)};d.prototype.imagememoryusage=function(k){this.runtime.glwrap?k.set_float(Math.round(100*this.runtime.glwrap.estimateVRAM()/1048576)/100):k.set_float(0)};d.prototype.regexsearch=function(k,
p,H,m){H=g(H,m);k.set_int(p?p.search(H):-1)};d.prototype.regexreplace=function(k,p,H,m,E){H=g(H,m);k.set_string(p?p.replace(H,E):"")};var z=[],O="",Q="",I="";d.prototype.regexmatchcount=function(k,p,H,m){g(H,m);h(p.toString(),H,m);k.set_int(z?z.length:0)};d.prototype.regexmatchat=function(k,p,H,m,E){E=Math.floor(E);g(H,m);h(p.toString(),H,m);!z||0>E||E>=z.length?k.set_string(""):k.set_string(z[E])};d.prototype.infinity=function(k){k.set_float(Infinity)};d.prototype.setbit=function(k,p,H,m){H|=0;k.set_int((p|
0)&~(1<<H)|(0!==m?1:0)<<H)};d.prototype.togglebit=function(k,p,H){k.set_int((p|0)^1<<(H|0))};d.prototype.getbit=function(k,p,H){k.set_int((p|0)&1<<(H|0)?1:0)};d.prototype.originalwindowwidth=function(k){k.set_int(this.runtime.original_width)};d.prototype.originalwindowheight=function(k){k.set_int(this.runtime.original_height)};d.prototype.originalviewportwidth=function(k){k.set_int(this.runtime.original_width)};d.prototype.originalviewportheight=function(k){k.set_int(this.runtime.original_height)};
u.exps=new d;u.runWaits=function(){var k,p=this.runtime.getCurrentEventStack();var H=0;for(k=this.waits.length;H<k;H++){var m=this.waits[H];if(-1===m.time){if(!m.signalled)continue}else if(m.time>this.runtime.kahanTime.sum)continue;p.current_event=m.ev;p.actindex=m.actindex;p.cndindex=0;for(N in m.sols)if(m.sols.hasOwnProperty(N)){var E=this.runtime.types_by_index[parseInt(N,10)].getCurrentSol();var L=m.sols[N];E.select_all=L.sa;cr.shallowAssignArray(E.instances,L.insts);E=L;cr.clearArray(E.insts);
y.push(E)}m.ev.resume_actions_and_subevents();this.runtime.clearSol(m.solModifiers);m.deleteme=!0}var N=H=0;for(k=this.waits.length;H<k;H++)m=this.waits[H],this.waits[N]=m,m.deleteme?(cr.wipe(m.sols),cr.clearArray(m.solModifiers),l.push(m)):N++;cr.truncateArray(this.waits,N)}})();
(function(){cr.add_common_aces=function(f,g){var n=f[1],t=f[3],e=f[4],c=f[5],a=f[6],d=f[7],h=f[8],u=f[10],v=f[11];f=f[12];g.cnds||(g.cnds={});g.acts||(g.acts={});g.exps||(g.exps={});var C=g.cnds,w=g.acts;g=g.exps;t&&(C.CompareX=function(r,x){return cr.do_cmp(this.x,r,x)},C.CompareY=function(r,x){return cr.do_cmp(this.y,r,x)},C.IsOnScreen=function(){var r=this.layer;this.update_bbox();var x=this.bbox;return!(x.right<r.viewLeft||x.bottom<r.viewTop||x.left>r.viewRight||x.top>r.viewBottom)},C.IsOutsideLayout=
function(){this.update_bbox();var r=this.bbox,x=this.runtime.running_layout;return 0>r.right||0>r.bottom||r.left>x.width||r.top>x.height},C.PickDistance=function(r,x,A){var l=this.getCurrentSol(),y=l.getObjects();if(!y.length)return!1;var z=y[0],O=z,Q=cr.distanceTo(z.x,z.y,x,A),I;var k=1;for(I=y.length;k<I;k++){z=y[k];var p=cr.distanceTo(z.x,z.y,x,A);if(0===r&&p<Q||1===r&&p>Q)Q=p,O=z}l.pick_one(O);return!0},w.SetX=function(r){this.x!==r&&(this.x=r,this.set_bbox_changed())},w.SetY=function(r){this.y!==
r&&(this.y=r,this.set_bbox_changed())},w.SetPos=function(r,x){if(this.x!==r||this.y!==x)this.x=r,this.y=x,this.set_bbox_changed()},w.SetPosToObject=function(r,x){var A=r.getPairedInstance(this);A&&(A.getImagePoint?(r=A.getImagePoint(x,!0),x=A.getImagePoint(x,!1)):(r=A.x,x=A.y),this.x!==r||this.y!==x)&&(this.x=r,this.y=x,this.set_bbox_changed())},w.MoveForward=function(r){0!==r&&(this.x+=Math.cos(this.angle)*r,this.y+=Math.sin(this.angle)*r,this.set_bbox_changed())},w.MoveAtAngle=function(r,x){0!==
x&&(this.x+=Math.cos(cr.to_radians(r))*x,this.y+=Math.sin(cr.to_radians(r))*x,this.set_bbox_changed())},g.X=function(r){r.set_float(this.x)},g.Y=function(r){r.set_float(this.y)},g.dt=function(r){r.set_float(this.runtime.getDt(this))});e&&(C.CompareWidth=function(r,x){return cr.do_cmp(this.width,r,x)},C.CompareHeight=function(r,x){return cr.do_cmp(this.height,r,x)},w.SetWidth=function(r){this.width!==r&&(this.width=r,this.set_bbox_changed())},w.SetHeight=function(r){this.height!==r&&(this.height=r,
this.set_bbox_changed())},w.SetSize=function(r,x){if(this.width!==r||this.height!==x)this.width=r,this.height=x,this.set_bbox_changed()},g.Width=function(r){r.set_float(this.width)},g.Height=function(r){r.set_float(this.height)},g.BBoxLeft=function(r){this.update_bbox();r.set_float(this.bbox.left)},g.BBoxTop=function(r){this.update_bbox();r.set_float(this.bbox.top)},g.BBoxRight=function(r){this.update_bbox();r.set_float(this.bbox.right)},g.BBoxBottom=function(r){this.update_bbox();r.set_float(this.bbox.bottom)});
c&&(C.AngleWithin=function(r,x){return cr.angleDiff(this.angle,cr.to_radians(x))<=cr.to_radians(r)},C.IsClockwiseFrom=function(r){return cr.angleClockwise(this.angle,cr.to_radians(r))},C.IsBetweenAngles=function(r,x){r=cr.to_clamped_radians(r);x=cr.to_clamped_radians(x);var A=cr.clamp_angle(this.angle);return cr.angleClockwise(x,r)?cr.angleClockwise(A,r)&&!cr.angleClockwise(A,x):!(!cr.angleClockwise(A,r)&&cr.angleClockwise(A,x))},w.SetAngle=function(r){r=cr.to_radians(cr.clamp_angle_degrees(r));isNaN(r)||
this.angle===r||(this.angle=r,this.set_bbox_changed())},w.RotateClockwise=function(r){0===r||isNaN(r)||(this.angle+=cr.to_radians(r),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},w.RotateCounterclockwise=function(r){0===r||isNaN(r)||(this.angle-=cr.to_radians(r),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},w.RotateTowardAngle=function(r,x){r=cr.angleRotate(this.angle,cr.to_radians(x),cr.to_radians(r));isNaN(r)||this.angle===r||(this.angle=r,this.set_bbox_changed())},
w.RotateTowardPosition=function(r,x,A){r=cr.angleRotate(this.angle,Math.atan2(A-this.y,x-this.x),cr.to_radians(r));isNaN(r)||this.angle===r||(this.angle=r,this.set_bbox_changed())},w.SetTowardPosition=function(r,x){r=Math.atan2(x-this.y,r-this.x);isNaN(r)||this.angle===r||(this.angle=r,this.set_bbox_changed())},g.Angle=function(r){r.set_float(cr.to_clamped_degrees(this.angle))});n||(C.CompareInstanceVar=function(r,x,A){return cr.do_cmp(this.instance_vars[r],x,A)},C.IsBoolInstanceVarSet=function(r){return this.instance_vars[r]},
C.PickInstVarHiLow=function(r,x){var A=this.getCurrentSol(),l=A.getObjects();if(!l.length)return!1;var y=l[0],z=y,O=y.instance_vars[x],Q;var I=1;for(Q=l.length;I<Q;I++){y=l[I];var k=y.instance_vars[x];if(0===r&&k<O||1===r&&k>O)O=k,z=y}A.pick_one(z);return!0},C.PickByUID=function(r){var x;if(this.runtime.getCurrentCondition().inverted){var A=this.getCurrentSol();if(A.select_all){A.select_all=!1;cr.clearArray(A.instances);cr.clearArray(A.else_instances);var l=this.instances;var y=0;for(x=l.length;y<
x;y++){var z=l[y];z.uid===r?A.else_instances.push(z):A.instances.push(z)}}else{l=y=0;for(x=A.instances.length;y<x;y++)z=A.instances[y],A.instances[l]=z,z.uid===r?A.else_instances.push(z):l++;cr.truncateArray(A.instances,l)}this.applySolToContainer();return!!A.instances.length}z=this.runtime.getObjectByUID(r);if(!z)return!1;A=this.getCurrentSol();if(!A.select_all&&-1===A.instances.indexOf(z))return!1;if(this.is_family)for(r=z.type.families,y=0,x=r.length;y<x;y++){if(r[y]===this)return A.pick_one(z),
this.applySolToContainer(),!0}else if(z.type===this)return A.pick_one(z),this.applySolToContainer(),!0;return!1},C.OnCreated=function(){return!0},C.OnDestroyed=function(){return!0},w.SetInstanceVar=function(r,x){var A=this.instance_vars;cr.is_number(A[r])?cr.is_number(x)?A[r]=x:A[r]=parseFloat(x):cr.is_string(A[r])&&(cr.is_string(x)?A[r]=x:A[r]=x.toString())},w.AddInstanceVar=function(r,x){var A=this.instance_vars;cr.is_number(A[r])?cr.is_number(x)?A[r]+=x:A[r]+=parseFloat(x):cr.is_string(A[r])&&
(cr.is_string(x)?A[r]+=x:A[r]+=x.toString())},w.SubInstanceVar=function(r,x){var A=this.instance_vars;cr.is_number(A[r])&&(cr.is_number(x)?A[r]-=x:A[r]-=parseFloat(x))},w.SetBoolInstanceVar=function(r,x){this.instance_vars[r]=x?1:0},w.ToggleBoolInstanceVar=function(r){this.instance_vars[r]=1-this.instance_vars[r]},w.Destroy=function(){this.runtime.DestroyInstance(this)},w.LoadFromJsonString||(w.LoadFromJsonString=function(r){try{var x=JSON.parse(r)}catch(l){return}this.runtime.loadInstanceFromJSON(this,
x,!0);this.afterLoad&&this.afterLoad();if(this.behavior_insts)for(r=0,x=this.behavior_insts.length;r<x;++r){var A=this.behavior_insts[r];A.afterLoad&&A.afterLoad()}}),g.Count=function(r){var x=r.object_class.instances.length,A;var l=0;for(A=this.runtime.createRow.length;l<A;l++){var y=this.runtime.createRow[l];r.object_class.is_family?0<=y.type.families.indexOf(r.object_class)&&x++:y.type===r.object_class&&x++}r.set_int(x)},g.PickedCount=function(r){r.set_int(r.object_class.getCurrentSol().getObjects().length)},
g.UID=function(r){r.set_int(this.uid)},g.IID=function(r){r.set_int(this.get_iid())},g.AsJSON||(g.AsJSON=function(r){r.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))}));a&&(C.IsVisible=function(){return this.visible},w.SetVisible=function(r){r=2===r?!this.visible:0!==r;r!==this.visible&&(this.visible=r,this.runtime.redraw=!0)},C.CompareOpacity=function(r,x){return cr.do_cmp(cr.round6dp(100*this.opacity),r,x)},w.SetOpacity=function(r){r/=100;0>r?r=0:1<r&&(r=1);r!==this.opacity&&
(this.opacity=r,this.runtime.redraw=!0)},g.Opacity=function(r){r.set_float(cr.round6dp(100*this.opacity))});d&&(C.IsOnLayer=function(r){return r?this.layer===r:!1},C.PickTopBottom=function(r){var x=this.getCurrentSol(),A=x.getObjects();if(!A.length)return!1;var l=A[0],y=l,z;var O=1;for(z=A.length;O<z;O++)if(l=A[O],0===r){if(l.layer.index>y.layer.index||l.layer.index===y.layer.index&&l.get_zindex()>y.get_zindex())y=l}else if(l.layer.index<y.layer.index||l.layer.index===y.layer.index&&l.get_zindex()<
y.get_zindex())y=l;x.pick_one(y);return!0},w.MoveToTop=function(){var r=this.layer,x=r.instances;x.length&&x[x.length-1]===this||(r.removeFromInstanceList(this,!1),r.appendToInstanceList(this,!1),this.runtime.redraw=!0)},w.MoveToBottom=function(){var r=this.layer,x=r.instances;x.length&&x[0]===this||(r.removeFromInstanceList(this,!1),r.prependToInstanceList(this,!1),this.runtime.redraw=!0)},w.MoveToLayer=function(r){r&&r!=this.layer&&(this.layer.removeFromInstanceList(this,!0),this.layer=r,r.appendToInstanceList(this,
!0),this.runtime.redraw=!0)},w.ZMoveToObject=function(r,x){r=0===r;x&&(x=x.getFirstPicked(this))&&x.uid!==this.uid&&(this.layer.index!==x.layer.index&&(this.layer.removeFromInstanceList(this,!0),this.layer=x.layer,x.layer.appendToInstanceList(this,!0)),this.layer.moveInstanceAdjacent(this,x,r),this.runtime.redraw=!0)},g.LayerNumber=function(r){r.set_int(this.layer.number)},g.LayerName=function(r){r.set_string(this.layer.name)},g.ZIndex=function(r){r.set_int(this.get_zindex())});h&&(w.SetEffectEnabled=
function(r,x){this.runtime.glwrap&&(x=this.type.getEffectIndexByName(x),0>x||(r=1===r,this.active_effect_flags[x]!==r&&(this.active_effect_flags[x]=r,this.updateActiveEffects(),this.runtime.redraw=!0)))},w.SetEffectParam=function(r,x,A){if(this.runtime.glwrap){var l=this.type.getEffectIndexByName(r);if(!(0>l||(r=this.type.effect_types[l],l=this.effect_params[l],x=Math.floor(x),0>x||x>=l.length))){var y=this.runtime.glwrap.getProgramParameterType(r.shaderindex,x);1===y&&(A/=100);if(2===y){y=cr.GetRValue(A);
var z=cr.GetGValue(A);A=cr.GetBValue(A);x=l[x];if(x[0]===y&&x[1]===z&&x[2]===A)return;x[0]=y;x[1]=z;x[2]=A}else{if(l[x]===A)return;l[x]=A}r.active&&(this.runtime.redraw=!0)}}});u&&(w.SetVisible=function(r){this.visible=0!==r},w.SetCSSStyle=function(r,x){this.elem.style[cr.cssToCamelCase(r)]=x});v&&(w.SetFocus=function(){(this.inputElem||this.elem).focus()},w.SetBlur=function(){(this.inputElem||this.elem).blur()});f&&(w.SetEnabled=function(r){(this.inputElem||this.elem).disabled=0===r})};cr.set_bbox_changed=
function(){this.cell_changed=this.bbox_changed=!0;this.type.any_cell_changed=!0;this.runtime.redraw=!0;var f,g=this.bbox_changed_callbacks;var n=0;for(f=g.length;n<f;++n)g[n](this);this.layer.useRenderCells&&this.update_bbox()};cr.add_bbox_changed_callback=function(f){f&&this.bbox_changed_callbacks.push(f)};cr.update_bbox=function(){if(this.bbox_changed){var f=this.bbox,g=this.bquad;f.set(this.x,this.y,this.x+this.width,this.y+this.height);f.offset(-this.hotspotX*this.width,-this.hotspotY*this.height);
this.angle?(f.offset(-this.x,-this.y),g.set_from_rotated_rect(f,this.angle),g.offset(this.x,this.y),g.bounding_box(f)):g.set_from_rect(f);f.normalize();this.bbox_changed=!1;this.update_render_cell()}};var b=new cr.rect(0,0,0,0);cr.update_render_cell=function(){if(this.layer.useRenderCells){var f=this.layer.render_grid,g=this.bbox;b.set(f.XToCell(g.left),f.YToCell(g.top),f.XToCell(g.right),f.YToCell(g.bottom));this.rendercells.equals(b)||(this.rendercells.right<this.rendercells.left?f.update(this,
null,b):f.update(this,this.rendercells,b),this.rendercells.copy(b),this.layer.render_list_stale=!0)}};cr.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var f=this.type.collision_grid,g=this.bbox;b.set(f.XToCell(g.left),f.YToCell(g.top),f.XToCell(g.right),f.YToCell(g.bottom));this.collcells.equals(b)||(this.collcells.right<this.collcells.left?f.update(this,null,b):f.update(this,this.collcells,b),this.collcells.copy(b),this.cell_changed=!1)}};cr.inst_contains_pt=
function(f,g){return this.bbox.contains_pt(f,g)&&this.bquad.contains_pt(f,g)?this.tilemap_exists?this.testPointOverlapTile(f,g):this.collision_poly&&!this.collision_poly.is_empty()?(this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(f-this.x,g-this.y)):!0:!1};cr.inst_get_iid=function(){this.type.updateIIDs();return this.iid};cr.inst_get_zindex=function(){this.layer.updateZIndices();return this.zindex};cr.inst_updateActiveEffects=function(){cr.clearArray(this.active_effect_types);
var f,g=!0;var n=0;for(f=this.active_effect_flags.length;n<f;n++)if(this.active_effect_flags[n]){var t=this.type.effect_types[n];this.active_effect_types.push(t);t.preservesOpaqueness||(g=!1)}this.uses_shaders=!!this.active_effect_types.length;this.shaders_preserve_opaqueness=g};cr.inst_toString=function(){return"Inst"+this.puid};cr.type_getFirstPicked=function(f){if(f&&f.is_contained&&f.type!=this){var g;var n=0;for(g=f.siblings.length;n<g;n++){var t=f.siblings[n];if(t.type==this)return t}}f=this.getCurrentSol().getObjects();
return f.length?f[0]:null};cr.type_getPairedInstance=function(f){var g=this.getCurrentSol().getObjects();return g.length?g[f.get_iid()%g.length]:null};cr.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var f;var g=0;for(f=this.instances.length;g<f;g++)this.instances[g].iid=g;var n=g,t=this.runtime.createRow;g=0;for(f=t.length;g<f;++g)t[g].type===this&&(t[g].iid=n++);this.stale_iids=!1}};cr.type_getInstanceByIID=function(f){if(f<this.instances.length)return this.instances[f];f-=this.instances.length;
var g=this.runtime.createRow,n;var t=0;for(n=g.length;t<n;++t)if(g[t].type===this){if(0===f)return g[t];--f}return null};cr.type_getCurrentSol=function(){return this.solstack[this.cur_sol]};cr.type_pushCleanSol=function(){this.cur_sol++;this.cur_sol===this.solstack.length?this.solstack.push(new cr.selection(this)):(this.solstack[this.cur_sol].select_all=!0,cr.clearArray(this.solstack[this.cur_sol].else_instances))};cr.type_pushCopySol=function(){this.cur_sol++;this.cur_sol===this.solstack.length&&
this.solstack.push(new cr.selection(this));var f=this.solstack[this.cur_sol],g=this.solstack[this.cur_sol-1];g.select_all?f.select_all=!0:(f.select_all=!1,cr.shallowAssignArray(f.instances,g.instances));cr.clearArray(f.else_instances)};cr.type_popSol=function(){this.cur_sol--};cr.type_getBehaviorByName=function(f){var g,n,t=0;if(!this.is_family){var e=0;for(g=this.families.length;e<g;e++){var c=this.families[e];var a=0;for(n=c.behaviors.length;a<n;a++){if(f===c.behaviors[a].name)return this.extra.lastBehIndex=
t,c.behaviors[a];t++}}}e=0;for(g=this.behaviors.length;e<g;e++){if(f===this.behaviors[e].name)return this.extra.lastBehIndex=t,this.behaviors[e];t++}return null};cr.type_getBehaviorIndexByName=function(f){return this.getBehaviorByName(f)?this.extra.lastBehIndex:-1};cr.type_getEffectIndexByName=function(f){var g;var n=0;for(g=this.effect_types.length;n<g;n++)if(this.effect_types[n].name===f)return n;return-1};cr.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var f,g,n;this.updateIIDs();
var t=this.getCurrentSol();var e=t.select_all,c=(f=this.runtime.getCurrentEventStack())&&f.current_event&&f.current_event.orblock;f=0;for(g=this.container.length;f<g;f++){var a=this.container[f];if(a!==this){a.updateIIDs();var d=a.getCurrentSol();d.select_all=e;if(!e){cr.clearArray(d.instances);var h=0;for(n=t.instances.length;h<n;++h)d.instances[h]=a.getInstanceByIID(t.instances[h].iid);if(c)for(cr.clearArray(d.else_instances),h=0,n=t.else_instances.length;h<n;++h)d.else_instances[h]=a.getInstanceByIID(t.else_instances[h].iid)}}}}};
cr.type_toString=function(){return"Type"+this.sid};cr.do_cmp=function(f,g,n){if("undefined"===typeof f||"undefined"===typeof n)return!1;switch(g){case 0:return f===n;case 1:return f!==n;case 2:return f<n;case 3:return f<=n;case 4:return f>n;case 5:return f>=n;default:return!1}}})();cr.shaders={};
cr.shaders.hsladjust={src:"varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nprecision mediump float;\nuniform float huerotate;\nuniform float satadjust;\nuniform float lumadjust;\nvec3 rgb_to_hsl(vec3 color)\n{\nvec3 hsl = vec3(0.0, 0.0, 0.0);\nfloat fmin = min(min(color.r, color.g), color.b);\nfloat fmax = max(max(color.r, color.g), color.b);\nfloat delta = fmax - fmin;\nhsl.z = (fmax + fmin) / 2.0;\nif (delta == 0.0)\n{\nhsl.x = 0.0;\nhsl.y = 0.0;\n}\nelse\n{\nif (hsl.z < 0.5)\nhsl.y = delta / (fmax + fmin);\nelse\nhsl.y = delta / (2.0 - fmax - fmin);\nfloat dR = (((fmax - color.r) / 6.0) + (delta / 2.0)) / delta;\nfloat dG = (((fmax - color.g) / 6.0) + (delta / 2.0)) / delta;\nfloat dB = (((fmax - color.b) / 6.0) + (delta / 2.0)) / delta;\nif (color.r == fmax)\nhsl.x = dB - dG;\nelse if (color.g == fmax)\nhsl.x = (1.0 / 3.0) + dR - dB;\nelse if (color.b == fmax)\nhsl.x = (2.0 / 3.0) + dG - dR;\nif (hsl.x < 0.0)\nhsl.x += 1.0;\nelse if (hsl.x > 1.0)\nhsl.x -= 1.0;\n}\nreturn hsl;\n}\nfloat hue_to_rgb(float f1, float f2, float hue)\n{\nif (hue < 0.0)\nhue += 1.0;\nelse if (hue > 1.0)\nhue -= 1.0;\nfloat ret;\nif ((6.0 * hue) < 1.0)\nret = f1 + (f2 - f1) * 6.0 * hue;\nelse if ((2.0 * hue) < 1.0)\nret = f2;\nelse if ((3.0 * hue) < 2.0)\nret = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;\nelse\nret = f1;\nreturn ret;\n}\nvec3 hsl_to_rgb(vec3 hsl)\n{\nvec3 rgb = vec3(hsl.z);\nif (hsl.y != 0.0)\n{\nfloat f2;\nif (hsl.z < 0.5)\nf2 = hsl.z * (1.0 + hsl.y);\nelse\nf2 = (hsl.z + hsl.y) - (hsl.y * hsl.z);\nfloat f1 = 2.0 * hsl.z - f2;\nrgb.r = hue_to_rgb(f1, f2, hsl.x + (1.0 / 3.0));\nrgb.g = hue_to_rgb(f1, f2, hsl.x);\nrgb.b = hue_to_rgb(f1, f2, hsl.x - (1.0 / 3.0));\n}\nreturn rgb;\n}\nvoid main(void)\n{\nvec4 front = texture2D(samplerFront, vTex);\nvec3 rgb = rgb_to_hsl(front.rgb) + vec3((huerotate > 0.5 ? huerotate - 1.0 : huerotate), 0, (lumadjust - 1.0) * front.a);\nrgb.y *= satadjust;\nrgb = hsl_to_rgb(rgb);\ngl_FragColor = vec4(rgb, front.a);\n}",extendBoxHorizontal:0,
extendBoxVertical:0,crossSampling:!1,mustPreDraw:!1,preservesOpaqueness:!0,animated:!1,parameters:[["huerotate",0,1],["satadjust",0,1],["lumadjust",0,1]]};
cr.shaders.brightness={src:"varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nuniform lowp float brightness;\nvoid main(void)\n{\nlowp vec4 front = texture2D(samplerFront, vTex);\nlowp float a = front.a;\nif (a != 0.0)\nfront.rgb /= front.a;\nfront.rgb += (brightness - 1.0);\nfront.rgb *= a;\ngl_FragColor = front;\n}",extendBoxHorizontal:0,extendBoxVertical:0,crossSampling:!1,mustPreDraw:!1,preservesOpaqueness:!0,animated:!1,parameters:[["brightness",0,1]]};
cr.plugins_.Sprite=function(b){this.runtime=b};
(function(){function b(){if(0===this.datauri.length){var I=document.createElement("canvas");I.width=this.width;I.height=this.height;var k=I.getContext("2d");this.spritesheeted?k.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height):k.drawImage(this.texture_img,0,0,this.width,this.height);this.datauri=I.toDataURL("image/png")}return this.datauri}function f(){}function g(I){I[0]=0;I[1]=0;I[2]=0;r.push(I)}function n(I,k){return I<k?""+I+","+k:""+k+","+I}function t(I,
k,p,H){k=k.uid;p=p.uid;var m=n(k,p);if(I.hasOwnProperty(m))I[m][2]=H;else{var E=r.length?r.pop():[0,0,0];E[0]=k;E[1]=p;E[2]=H;I[m]=E}}function e(I,k,p){k=n(k.uid,p.uid);I.hasOwnProperty(k)&&(g(I[k]),delete I[k])}function c(I,k,p){k=n(k.uid,p.uid);if(I.hasOwnProperty(k))return x=I[k][2],!0;x=-2;return!1}function a(I,k,p){if(!I)return!1;var H=0!==k||0!==p,m=!1,E=this.runtime.getCurrentCondition(),L=E.type;E=E.inverted;var N=I.getCurrentSol();var V=this.runtime.getCurrentEventStack().current_event.orblock;
N.select_all?(this.update_bbox(),Q.copy(this.bbox),Q.offset(k,p),this.runtime.getCollisionCandidates(this.layer,I,Q,O),N=O):N=V?this.runtime.isCurrentConditionFirst()&&!N.else_instances.length&&N.instances.length?N.instances:N.else_instances:N.instances;l=I;z=L!==I&&!E;if(H){var W=this.x;var X=this.y;this.x+=k;this.y+=p;this.set_bbox_changed()}k=0;for(p=N.length;k<p;k++)if(V=N[k],this.runtime.testOverlap(this,V)){m=!0;if(E)break;L!==I&&y.add(V)}H&&(this.x=W,this.y=X,this.set_bbox_changed());cr.clearArray(O);
return m}function d(){}function h(){}var u=cr.plugins_.Sprite.prototype;u.Type=function(I){this.plugin=I;this.runtime=I.runtime};var v=u.Type.prototype;v.onCreate=function(){if(!this.is_family){var I,k;this.all_frames=[];this.has_loaded_textures=!1;var p=0;for(I=this.animations.length;p<I;p++){var H=this.animations[p];var m={};m.name=H[0];m.speed=H[1];m.loop=H[2];m.repeatcount=H[3];m.repeatto=H[4];m.pingpong=H[5];m.sid=H[6];m.frames=[];var E=0;for(k=H[7].length;E<k;E++){var L=H[7][E];var N={};N.texture_file=
L[0];N.texture_filesize=L[1];N.offx=L[2];N.offy=L[3];N.width=L[4];N.height=L[5];N.duration=L[6];N.hotspotX=L[7];N.hotspotY=L[8];N.image_points=L[9];N.poly_pts=L[10];N.pixelformat=L[11];N.spritesheeted=0!==N.width;N.datauri="";N.getDataUri=b;var V={left:0,top:0,right:1,bottom:1};N.sheetTex=V;N.webGL_texture=null;(V=this.runtime.findWaitingTexture(L[0]))?N.texture_img=V:(N.texture_img=new Image,N.texture_img.cr_src=L[0],N.texture_img.cr_filesize=L[1],N.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(N.texture_img,
L[0]));cr.seal(N);m.frames.push(N);this.all_frames.push(N)}cr.seal(m);this.animations[p]=m}}};v.updateAllCurrentTexture=function(){var I;var k=0;for(I=this.instances.length;k<I;k++){var p=this.instances[k];p.curWebGLTexture=p.curFrame.webGL_texture}};v.onLostWebGLContext=function(){if(!this.is_family){var I;var k=0;for(I=this.all_frames.length;k<I;++k){var p=this.all_frames[k];p.texture_img.c2webGL_texture=null;p.webGL_texture=null}this.has_loaded_textures=!1;this.updateAllCurrentTexture()}};v.onRestoreWebGLContext=
function(){if(!this.is_family&&this.instances.length){var I;var k=0;for(I=this.all_frames.length;k<I;++k){var p=this.all_frames[k];p.webGL_texture=this.runtime.glwrap.loadTexture(p.texture_img,!1,this.runtime.linearSampling,p.pixelformat)}this.updateAllCurrentTexture()}};v.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var I;var k=0;for(I=this.all_frames.length;k<I;++k){var p=this.all_frames[k];p.webGL_texture=this.runtime.glwrap.loadTexture(p.texture_img,
!1,this.runtime.linearSampling,p.pixelformat)}this.has_loaded_textures=!0}};v.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var I;var k=0;for(I=this.all_frames.length;k<I;++k){var p=this.all_frames[k];this.runtime.glwrap.deleteTexture(p.webGL_texture);p.webGL_texture=null}this.has_loaded_textures=!1}};var C=[];v.preloadCanvas2D=function(I){var k;cr.clearArray(C);var p=0;for(k=this.all_frames.length;p<k;++p){var H=this.all_frames[p].texture_img;-1===
C.indexOf(H)&&(I.drawImage(H,0,0),C.push(H))}};u.Instance=function(I){this.type=I;this.runtime=I.runtime;I=this.type.animations[0].frames[0].poly_pts;this.recycled?this.collision_poly.set_pts(I):this.collision_poly=new cr.CollisionPoly(I)};var w=u.Instance.prototype;w.onCreate=function(){this.visible=this.properties[0];this.inAnimTrigger=this.isTicking=!1;this.collisionsEnabled=this.properties[3];this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0];this.cur_frame=
this.properties[2];0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);var I=this.cur_animation.frames[this.cur_frame];this.collision_poly.set_pts(I.poly_pts);this.hotspotX=I.hotspotX;this.hotspotY=I.hotspotY;this.animForwards=0<=this.cur_animation.speed;this.cur_anim_speed=Math.abs(this.cur_animation.speed);this.cur_anim_repeatto=this.cur_animation.repeatto;1===this.type.animations.length&&1===this.type.animations[0].frames.length||
0===this.cur_anim_speed||(this.runtime.tickMe(this),this.isTicking=!0);this.recycled?this.animTimer.reset():this.animTimer=new cr.KahanAdder;this.frameStart=this.getNowTime();this.animPlaying=!0;this.animRepeats=0;this.changeAnimName=this.animTriggerName="";this.changeAnimFrom=0;this.changeAnimFrame=-1;this.type.loadTextures();var k,p;I=0;for(k=this.type.animations.length;I<k;I++){var H=this.type.animations[I];var m=0;for(p=H.frames.length;m<p;m++){var E=H.frames[m];0===E.width&&(E.width=E.texture_img.width,
E.height=E.texture_img.height);if(E.spritesheeted){var L=E.texture_img;var N=E.sheetTex;N.left=E.offx/L.width;N.top=E.offy/L.height;N.right=(E.offx+E.width)/L.width;N.bottom=(E.offy+E.height)/L.height;0===E.offx&&0===E.offy&&E.width===L.width&&E.height===L.height&&(E.spritesheeted=!1)}}}this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture};w.saveToJSON=function(){var I={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,
ar:this.animRepeats,at:this.animTimer.sum,rt:this.cur_anim_repeatto};this.animPlaying||(I.ap=this.animPlaying);this.animForwards||(I.af=this.animForwards);return I};w.loadFromJSON=function(I){var k=this.getAnimationBySid(I.a);k&&(this.cur_animation=k);this.cur_frame=I.f;0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);this.cur_anim_speed=I.cas;this.frameStart=I.fs;this.animRepeats=I.ar;this.animTimer.reset();
this.animTimer.sum=I.at;this.animPlaying=I.hasOwnProperty("ap")?I.ap:!0;this.animForwards=I.hasOwnProperty("af")?I.af:!0;I.hasOwnProperty("rt")?this.cur_anim_repeatto=I.rt:this.cur_anim_repeatto=this.cur_animation.repeatto;this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture;this.collision_poly.set_pts(this.curFrame.poly_pts);this.hotspotX=this.curFrame.hotspotX;this.hotspotY=this.curFrame.hotspotY};w.animationFinish=function(I){this.cur_frame=I?
0:this.cur_animation.frames.length-1;this.animPlaying=!1;this.animTriggerName=this.cur_animation.name;this.inAnimTrigger=!0;this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnimFinished,this);this.inAnimTrigger=!1;this.animRepeats=0};w.getNowTime=function(){return this.animTimer.sum};w.tick=function(){this.animTimer.add(this.runtime.getDt(this));this.changeAnimName.length&&this.doChangeAnim();0<=this.changeAnimFrame&&
this.doChangeAnimFrame();var I=this.getNowTime(),k=this.cur_animation,p=k.frames[this.cur_frame],H=p.duration/this.cur_anim_speed;this.animPlaying&&I>=this.frameStart+H&&(this.animForwards?this.cur_frame++:this.cur_frame--,this.frameStart+=H,this.cur_frame>=k.frames.length&&(k.pingpong?(this.animForwards=!1,this.cur_frame=k.frames.length-2):k.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=k.repeatcount?this.animationFinish(!1):this.cur_frame=this.cur_anim_repeatto)),
0>this.cur_frame&&(k.pingpong?(this.cur_frame=1,this.animForwards=!0,k.loop||(this.animRepeats++,this.animRepeats>=k.repeatcount&&this.animationFinish(!0))):k.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=k.repeatcount?this.animationFinish(!0):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame?this.cur_frame=0:this.cur_frame>=k.frames.length&&(this.cur_frame=k.frames.length-1),I>this.frameStart+k.frames[this.cur_frame].duration/this.cur_anim_speed&&(this.frameStart=
I),I=k.frames[this.cur_frame],this.OnFrameChanged(p,I),this.runtime.redraw=!0)};w.getAnimationByName=function(I){var k;var p=0;for(k=this.type.animations.length;p<k;p++){var H=this.type.animations[p];if(cr.equals_nocase(H.name,I))return H}return null};w.getAnimationBySid=function(I){var k;var p=0;for(k=this.type.animations.length;p<k;p++){var H=this.type.animations[p];if(H.sid===I)return H}return null};w.doChangeAnim=function(){var I=this.cur_animation.frames[this.cur_frame],k=this.getAnimationByName(this.changeAnimName);
this.changeAnimName="";!k||cr.equals_nocase(k.name,this.cur_animation.name)&&this.animPlaying||(this.cur_animation=k,this.animForwards=0<=k.speed,this.cur_anim_speed=Math.abs(k.speed),this.cur_anim_repeatto=k.repeatto,0>this.cur_frame&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),1===this.changeAnimFrom&&(this.cur_frame=0),this.animPlaying=!0,this.frameStart=this.getNowTime(),this.OnFrameChanged(I,this.cur_animation.frames[this.cur_frame]),
this.runtime.redraw=!0)};w.doChangeAnimFrame=function(){var I=this.cur_animation.frames[this.cur_frame],k=this.cur_frame;this.cur_frame=cr.floor(this.changeAnimFrame);0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);k!==this.cur_frame&&(this.OnFrameChanged(I,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0);this.changeAnimFrame=-1};w.OnFrameChanged=function(I,
k){var p=I.width,H=I.height,m=k.width,E=k.height;p!=m&&(this.width*=m/p);H!=E&&(this.height*=E/H);this.hotspotX=k.hotspotX;this.hotspotY=k.hotspotY;this.collision_poly.set_pts(k.poly_pts);this.set_bbox_changed();this.curFrame=k;this.curWebGLTexture=k.webGL_texture;p=0;for(H=this.behavior_insts.length;p<H;p++)if(m=this.behavior_insts[p],m.onSpriteFrameChanged)m.onSpriteFrameChanged(I,k);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)};w.draw=function(I){I.globalAlpha=this.opacity;
var k=this.curFrame,p=k.spritesheeted,H=k.texture_img,m=this.x,E=this.y,L=this.width,N=this.height;if(0===this.angle&&0<=L&&0<=N)m-=this.hotspotX*L,E-=this.hotspotY*N,this.runtime.pixel_rounding&&(m=Math.round(m),E=Math.round(E)),p?I.drawImage(H,k.offx,k.offy,k.width,k.height,m,E,L,N):I.drawImage(H,m,E,L,N);else{this.runtime.pixel_rounding&&(m=Math.round(m),E=Math.round(E));I.save();var V=0<L?1:-1,W=0<N?1:-1;I.translate(m,E);1===V&&1===W||I.scale(V,W);I.rotate(this.angle*V*W);m=-(this.hotspotX*cr.abs(L));
E=-(this.hotspotY*cr.abs(N));p?I.drawImage(H,k.offx,k.offy,k.width,k.height,m,E,cr.abs(L),cr.abs(N)):I.drawImage(H,m,E,cr.abs(L),cr.abs(N));I.restore()}};w.drawGL_earlyZPass=function(I){this.drawGL(I)};w.drawGL=function(I){I.setTexture(this.curWebGLTexture);I.setOpacity(this.opacity);var k=this.curFrame,p=this.bquad;if(this.runtime.pixel_rounding){var H=Math.round(this.x)-this.x,m=Math.round(this.y)-this.y;k.spritesheeted?I.quadTex(p.tlx+H,p.tly+m,p.trx+H,p.try_+m,p.brx+H,p.bry+m,p.blx+H,p.bly+m,
k.sheetTex):I.quad(p.tlx+H,p.tly+m,p.trx+H,p.try_+m,p.brx+H,p.bry+m,p.blx+H,p.bly+m)}else k.spritesheeted?I.quadTex(p.tlx,p.tly,p.trx,p.try_,p.brx,p.bry,p.blx,p.bly,k.sheetTex):I.quad(p.tlx,p.tly,p.trx,p.try_,p.brx,p.bry,p.blx,p.bly)};w.getImagePointIndexByName=function(I){var k=this.curFrame,p;var H=0;for(p=k.image_points.length;H<p;H++)if(cr.equals_nocase(I,k.image_points[H][0]))return H;return-1};w.getImagePoint=function(I,k){var p=this.curFrame,H=p.image_points;var m=cr.is_string(I)?this.getImagePointIndexByName(I):
I-1;m=cr.floor(m);if(0>m||m>=H.length)return k?this.x:this.y;I=(H[m][1]-p.hotspotX)*this.width;H=H[m][2];H=(H-p.hotspotY)*this.height;p=Math.cos(this.angle);m=Math.sin(this.angle);var E=I*p-H*m;H=H*p+I*m;I=E+this.x;H+=this.y;return k?I:H};var r=[],x=-2,A=[];f.prototype.OnCollision=function(I){if(!I)return!1;var k=this.runtime,p=k.getCurrentCondition(),H=p.type,m=null;p.extra.collmemory?m=p.extra.collmemory:(m={},p.extra.collmemory=m);p.extra.spriteCreatedDestroyCallback||(p.extra.spriteCreatedDestroyCallback=
!0,k.addDestroyCallback(function(J){var F=p.extra.collmemory;J=J.uid;var M;for(M in F)if(F.hasOwnProperty(M)){var S=F[M];if(S[0]===J||S[1]===J)g(F[M]),delete F[M]}}));var E=H.getCurrentSol(),L=I.getCurrentSol();E=E.getObjects();var N,V,W=this.runtime.tickcount,X=W-1,Y=k.getCurrentEventStack().current_event;for(N=0;N<E.length;N++){var ea=E[N];if(L.select_all){ea.update_bbox();this.runtime.getCollisionCandidates(ea.layer,I,ea.bbox,A);var ha=A;this.runtime.addRegisteredCollisionCandidates(ea,I,ha)}else ha=
L.getObjects();for(V=0;V<ha.length;V++){var q=ha[V];if(k.testOverlap(ea,q)||k.checkRegisteredCollision(ea,q)){var B=c(m,ea,q);B=!B||x<X;t(m,ea,q,W);if(B){k.pushCopySol(Y.solModifiers);B=H.getCurrentSol();var G=I.getCurrentSol();B.select_all=!1;G.select_all=!1;H===I?(B.instances.length=2,B.instances[0]=ea,B.instances[1]=q,H.applySolToContainer()):(B.instances.length=1,G.instances.length=1,B.instances[0]=ea,G.instances[0]=q,H.applySolToContainer(),I.applySolToContainer());Y.retrigger();k.popSol(Y.solModifiers)}}else e(m,
ea,q)}cr.clearArray(A)}return!1};var l=null,y=new cr.ObjectSet,z=!1,O=[],Q=new cr.rect(0,0,0,0);v.finish=function(I){if(z){if(I){var k=this.runtime.getCurrentEventStack().current_event.orblock;I=l.getCurrentSol();var p=y.valuesRef(),H;if(I.select_all){I.select_all=!1;cr.clearArray(I.instances);var m=0;for(H=p.length;m<H;++m)I.instances[m]=p[m];if(k)for(cr.clearArray(I.else_instances),m=0,H=l.instances.length;m<H;++m)p=l.instances[m],y.contains(p)||I.else_instances.push(p)}else if(k)for(k=I.instances.length,
m=0,H=p.length;m<H;++m)I.instances[k+m]=p[m],cr.arrayFindRemove(I.else_instances,p[m]);else cr.shallowAssignArray(I.instances,p);l.applySolToContainer()}y.clear();z=!1}};f.prototype.IsOverlapping=function(I){return a.call(this,I,0,0)};f.prototype.IsOverlappingOffset=function(I,k,p){return a.call(this,I,k,p)};f.prototype.IsAnimPlaying=function(I){return this.changeAnimName.length?cr.equals_nocase(this.changeAnimName,I):cr.equals_nocase(this.cur_animation.name,I)};f.prototype.CompareFrame=function(I,
k){return cr.do_cmp(this.cur_frame,I,k)};f.prototype.CompareAnimSpeed=function(I,k){return cr.do_cmp(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed,I,k)};f.prototype.OnAnimFinished=function(I){return cr.equals_nocase(this.animTriggerName,I)};f.prototype.OnAnyAnimFinished=function(){return!0};f.prototype.OnFrameChanged=function(){return!0};f.prototype.IsMirrored=function(){return 0>this.width};f.prototype.IsFlipped=function(){return 0>this.height};f.prototype.OnURLLoaded=function(){return!0};
f.prototype.IsCollisionEnabled=function(){return this.collisionsEnabled};u.cnds=new f;d.prototype.Spawn=function(I,k,p){if(I&&k&&(k=this.runtime.createInstance(I,k,this.getImagePoint(p,!0),this.getImagePoint(p,!1)))){"undefined"!==typeof k.angle&&(k.angle=this.angle,k.set_bbox_changed());this.runtime.isInOnDestroy++;var H;this.runtime.trigger(Object.getPrototypeOf(I.plugin).cnds.OnCreated,k);if(k.is_contained){var m=0;for(H=k.siblings.length;m<H;m++){var E=k.siblings[m];this.runtime.trigger(Object.getPrototypeOf(E.type.plugin).cnds.OnCreated,
E)}}this.runtime.isInOnDestroy--;m=this.runtime.getCurrentAction();p=!1;if(cr.is_undefined(m.extra.Spawn_LastExec)||m.extra.Spawn_LastExec<this.runtime.execcount)p=!0,m.extra.Spawn_LastExec=this.runtime.execcount;if(I!=this.type&&(I=I.getCurrentSol(),I.select_all=!1,p?(cr.clearArray(I.instances),I.instances[0]=k):I.instances.push(k),k.is_contained))for(m=0,H=k.siblings.length;m<H;m++)E=k.siblings[m],I=E.type.getCurrentSol(),I.select_all=!1,p?(cr.clearArray(I.instances),I.instances[0]=E):I.instances.push(E)}};
d.prototype.SetEffect=function(I){this.blend_mode=I;this.compositeOp=cr.effectToCompositeOp(I);cr.setGLBlend(this,I,this.runtime.gl);this.runtime.redraw=!0};d.prototype.StopAnim=function(){this.animPlaying=!1};d.prototype.StartAnim=function(I){this.animPlaying=!0;this.frameStart=this.getNowTime();1===I&&0!==this.cur_frame&&(this.changeAnimFrame=0,this.inAnimTrigger||this.doChangeAnimFrame());this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};d.prototype.SetAnim=function(I,k){this.changeAnimName=
I;this.changeAnimFrom=k;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnim()};d.prototype.SetAnimFrame=function(I){this.changeAnimFrame=I;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnimFrame()};d.prototype.SetAnimSpeed=function(I){this.cur_anim_speed=cr.abs(I);this.animForwards=0<=I;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};d.prototype.SetAnimRepeatToFrame=function(I){I=Math.floor(I);
0>I&&(I=0);I>=this.cur_animation.frames.length&&(I=this.cur_animation.frames.length-1);this.cur_anim_repeatto=I};d.prototype.SetMirrored=function(I){I=cr.abs(this.width)*(0===I?-1:1);this.width!==I&&(this.width=I,this.set_bbox_changed())};d.prototype.SetFlipped=function(I){I=cr.abs(this.height)*(0===I?-1:1);this.height!==I&&(this.height=I,this.set_bbox_changed())};d.prototype.SetScale=function(I){var k=this.curFrame,p=k.width*I*(0>this.width?-1:1);I=k.height*I*(0>this.height?-1:1);if(this.width!==
p||this.height!==I)this.width=p,this.height=I,this.set_bbox_changed()};d.prototype.LoadURL=function(I,k,p){var H=new Image,m=this,E=this.curFrame;H.onload=function(){E.texture_img.src===H.src?m.runtime.glwrap&&m.curFrame===E&&(m.curWebGLTexture=E.webGL_texture):(E.texture_img=H,E.offx=0,E.offy=0,E.width=H.width,E.height=H.height,E.spritesheeted=!1,E.datauri="",E.pixelformat=0,m.runtime.glwrap&&(E.webGL_texture&&m.runtime.glwrap.deleteTexture(E.webGL_texture),E.webGL_texture=m.runtime.glwrap.loadTexture(H,
!1,m.runtime.linearSampling),m.curFrame===E&&(m.curWebGLTexture=E.webGL_texture),m.type.updateAllCurrentTexture()));0===k&&(m.width=H.width,m.height=H.height,m.set_bbox_changed());m.runtime.redraw=!0;m.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,m)};"data:"!==I.substr(0,5)&&0===p&&(H.crossOrigin="anonymous");this.runtime.setImageSrc(H,I)};d.prototype.SetCollisions=function(I){this.collisionsEnabled!==(0!==I)&&((this.collisionsEnabled=0!==I)?this.set_bbox_changed():(this.collcells.right>=
this.collcells.left&&this.type.collision_grid.update(this,this.collcells,null),this.collcells.set(0,0,-1,-1)))};u.acts=new d;h.prototype.AnimationFrame=function(I){I.set_int(this.cur_frame)};h.prototype.AnimationFrameCount=function(I){I.set_int(this.cur_animation.frames.length)};h.prototype.AnimationName=function(I){I.set_string(this.cur_animation.name)};h.prototype.AnimationSpeed=function(I){I.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)};h.prototype.ImagePointX=function(I,
k){I.set_float(this.getImagePoint(k,!0))};h.prototype.ImagePointY=function(I,k){I.set_float(this.getImagePoint(k,!1))};h.prototype.ImagePointCount=function(I){I.set_int(this.curFrame.image_points.length)};h.prototype.ImageWidth=function(I){I.set_float(this.curFrame.width)};h.prototype.ImageHeight=function(I){I.set_float(this.curFrame.height)};u.exps=new h})();cr.plugins_.Particles=function(b){this.runtime=b};
(function(){function b(a){this.owner=a;this.active=!1;this.angle=this.speed=this.y=this.x=0;this.opacity=1;this.age=this.gs=this.size=this.grow=0;cr.seal(this)}function f(){}function g(){}function n(){}var t=cr.plugins_.Particles.prototype;t.Type=function(a){this.plugin=a;this.runtime=a.runtime};var e=t.Type.prototype;e.onCreate=function(){this.is_family||(this.texture_img=this.runtime.findWaitingTexture(this.texture_file),this.texture_img||(this.texture_img=new Image,this.texture_img.cr_src=this.texture_file,
this.texture_img.cr_filesize=this.texture_filesize,this.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(this.texture_img,this.texture_file)),this.spriteX=this.texture_data[3],this.spriteY=this.texture_data[4],this.spriteWidth=this.texture_data[5],this.spriteHeight=this.texture_data[6])};e.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};e.createParticleTexture=function(){var a=document.createElement("canvas"),d=this.spriteWidth,h=this.spriteHeight;a.width=d;
a.height=h;a.getContext("2d").drawImage(this.texture_img,this.spriteX,this.spriteY,d,h,0,0,d,h);this.webGL_texture=this.runtime.glwrap.loadTexture(a,!0,this.runtime.linearSampling,this.texture_pixelformat)};e.onRestoreWebGLContext=function(){!this.is_family&&this.instances.length&&(this.webGL_texture||this.createParticleTexture())};e.loadTextures=function(){this.is_family||this.webGL_texture||!this.runtime.glwrap||this.createParticleTexture()};e.unloadTextures=function(){this.is_family||this.instances.length||
!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};e.preloadCanvas2D=function(a){a.drawImage(this.texture_img,0,0)};b.prototype.init=function(){var a=this.owner;this.x=a.x-a.xrandom/2+Math.random()*a.xrandom;this.y=a.y-a.yrandom/2+Math.random()*a.yrandom;this.speed=a.initspeed-a.speedrandom/2+Math.random()*a.speedrandom;this.angle=a.angle-a.spraycone/2+Math.random()*a.spraycone;this.opacity=a.initopacity;this.size=a.initsize-a.sizerandom/2+Math.random()*
a.sizerandom;this.grow=a.growrate-a.growrandom/2+Math.random()*a.growrandom;this.age=this.gs=0};b.prototype.tick=function(a){var d=this.owner;this.x+=Math.cos(this.angle)*this.speed*a;this.y+=Math.sin(this.angle)*this.speed*a;this.y+=this.gs*a;this.speed+=d.acc*a;this.size+=this.grow*a;this.gs+=d.g*a;this.age+=a;1>this.size?this.active=!1:(0!==d.lifeanglerandom&&(this.angle+=Math.random()*d.lifeanglerandom*a-d.lifeanglerandom*a/2),0!==d.lifespeedrandom&&(this.speed+=Math.random()*d.lifespeedrandom*
a-d.lifespeedrandom*a/2),0!==d.lifeopacityrandom&&(this.opacity+=Math.random()*d.lifeopacityrandom*a-d.lifeopacityrandom*a/2,0>this.opacity?this.opacity=0:1<this.opacity&&(this.opacity=1)),1>=d.destroymode&&this.age>=d.timeout&&(this.active=!1),2===d.destroymode&&0>=this.speed&&(this.active=!1))};b.prototype.draw=function(a){var d=this.owner.opacity*this.opacity;if(0!==d){0===this.owner.destroymode&&(d*=1-this.age/this.owner.timeout);a.globalAlpha=d;d=this.x-this.size/2;var h=this.y-this.size/2;this.owner.runtime.pixel_rounding&&
(d=d+.5|0,h=h+.5|0);var u=this.owner.type;a.drawImage(u.texture_img,u.spriteX,u.spriteY,u.spriteWidth,u.spriteHeight,d,h,this.size,this.size)}};b.prototype.drawGL=function(a){var d=this.owner.opacity*this.opacity;0===this.owner.destroymode&&(d*=1-this.age/this.owner.timeout);var h=this.size,u=h*this.owner.particlescale,v=this.x-h/2,C=this.y-h/2;this.owner.runtime.pixel_rounding&&(v=v+.5|0,C=C+.5|0);1>u||0===d||(u<a.minPointSize||u>a.maxPointSize?(a.setOpacity(d),a.quad(v,C,v+h,C,v+h,C+h,v,C+h)):a.point(this.x,
this.y,u,d))};b.prototype.left=function(){return this.x-this.size/2};b.prototype.right=function(){return this.x+this.size/2};b.prototype.top=function(){return this.y-this.size/2};b.prototype.bottom=function(){return this.y+this.size/2};t.Instance=function(a){this.type=a;this.runtime=a.runtime};e=t.Instance.prototype;var c=[];e.onCreate=function(){var a=this.properties;this.rate=a[0];this.spraycone=cr.to_radians(a[1]);this.spraytype=a[2];this.spraying=!0;this.initspeed=a[4];this.initsize=a[5];this.initopacity=
a[6]/100;this.growrate=a[7];this.xrandom=a[8];this.yrandom=a[9];this.speedrandom=a[10];this.sizerandom=a[11];this.growrandom=a[12];this.acc=a[13];this.g=a[14];this.lifeanglerandom=a[15];this.lifespeedrandom=a[16];this.lifeopacityrandom=a[17];this.destroymode=a[18];this.timeout=a[19];this.particleCreateCounter=0;this.particlescale=1;this.particleBoxLeft=this.x;this.particleBoxTop=this.y;this.particleBoxRight=this.x;this.particleBoxBottom=this.y;this.add_bbox_changed_callback(function(d){d.bbox.set(d.particleBoxLeft,
d.particleBoxTop,d.particleBoxRight,d.particleBoxBottom);d.bquad.set_from_rect(d.bbox);d.bbox_changed=!1;d.update_collision_cell();d.update_render_cell()});this.recycled||(this.particles=[]);this.runtime.tickMe(this);this.type.loadTextures();if(1===this.spraytype)for(a=0;a<this.rate;a++)this.allocateParticle().opacity=0;this.first_tick=!0};e.saveToJSON=function(){var a={r:this.rate,sc:this.spraycone,st:this.spraytype,s:this.spraying,isp:this.initspeed,isz:this.initsize,io:this.initopacity,gr:this.growrate,
xr:this.xrandom,yr:this.yrandom,spr:this.speedrandom,szr:this.sizerandom,grnd:this.growrandom,acc:this.acc,g:this.g,lar:this.lifeanglerandom,lsr:this.lifespeedrandom,lor:this.lifeopacityrandom,dm:this.destroymode,to:this.timeout,pcc:this.particleCreateCounter,ft:this.first_tick,p:[]},d,h=a.p;var u=0;for(d=this.particles.length;u<d;u++){var v=this.particles[u];h.push([v.x,v.y,v.speed,v.angle,v.opacity,v.grow,v.size,v.gs,v.age])}return a};e.loadFromJSON=function(a){this.rate=a.r;this.spraycone=a.sc;
this.spraytype=a.st;this.spraying=a.s;this.initspeed=a.isp;this.initsize=a.isz;this.initopacity=a.io;this.growrate=a.gr;this.xrandom=a.xr;this.yrandom=a.yr;this.speedrandom=a.spr;this.sizerandom=a.szr;this.growrandom=a.grnd;this.acc=a.acc;this.g=a.g;this.lifeanglerandom=a.lar;this.lifespeedrandom=a.lsr;this.lifeopacityrandom=a.lor;this.destroymode=a.dm;this.timeout=a.to;this.particleCreateCounter=a.pcc;this.first_tick=a.ft;c.push.apply(c,this.particles);cr.clearArray(this.particles);var d,h=a.p;a=
0;for(d=h.length;a<d;a++){var u=this.allocateParticle();var v=h[a];u.x=v[0];u.y=v[1];u.speed=v[2];u.angle=v[3];u.opacity=v[4];u.grow=v[5];u.size=v[6];u.gs=v[7];u.age=v[8]}};e.onDestroy=function(){c.push.apply(c,this.particles);cr.clearArray(this.particles)};e.allocateParticle=function(){if(c.length){var a=c.pop();a.owner=this}else a=new b(this);this.particles.push(a);a.active=!0;return a};e.tick=function(){var a=this.runtime.getDt(this),d;if(0===this.spraytype&&this.spraying){this.particleCreateCounter+=
a*this.rate;var h=cr.floor(this.particleCreateCounter);this.particleCreateCounter-=h;for(d=0;d<h;d++){var u=this.allocateParticle();u.init()}}this.particleBoxLeft=this.x;this.particleBoxTop=this.y;this.particleBoxRight=this.x;this.particleBoxBottom=this.y;var v=d=0;for(h=this.particles.length;d<h;d++)u=this.particles[d],this.particles[v]=u,this.runtime.redraw=!0,1===this.spraytype&&this.first_tick&&u.init(),u.tick(a),u.active?(u.left()<this.particleBoxLeft&&(this.particleBoxLeft=u.left()),u.right()>
this.particleBoxRight&&(this.particleBoxRight=u.right()),u.top()<this.particleBoxTop&&(this.particleBoxTop=u.top()),u.bottom()>this.particleBoxBottom&&(this.particleBoxBottom=u.bottom()),v++):c.push(u);cr.truncateArray(this.particles,v);this.set_bbox_changed();this.first_tick=!1;1===this.spraytype&&0===this.particles.length&&this.runtime.DestroyInstance(this)};e.draw=function(a){var d,h=this.layer;var u=0;for(d=this.particles.length;u<d;u++){var v=this.particles[u];v.right()>=h.viewLeft&&v.bottom()>=
h.viewTop&&v.left()<=h.viewRight&&v.top()<=h.viewBottom&&v.draw(a)}};e.drawGL=function(a){this.particlescale=this.layer.getScale();a.setTexture(this.type.webGL_texture);var d,h=this.layer;var u=0;for(d=this.particles.length;u<d;u++){var v=this.particles[u];v.right()>=h.viewLeft&&v.bottom()>=h.viewTop&&v.left()<=h.viewRight&&v.top()<=h.viewBottom&&v.drawGL(a)}};f.prototype.IsSpraying=function(){return this.spraying};t.cnds=new f;g.prototype.SetSpraying=function(a){this.spraying=0!==a};g.prototype.SetEffect=
function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};g.prototype.SetRate=function(a){this.rate=a;var d;if(1===this.spraytype&&this.first_tick)if(a<this.particles.length)for(a=this.particles.length-a,d=0;d<a;d++)c.push(this.particles.pop());else if(a>this.particles.length)for(a-=this.particles.length,d=0;d<a;d++)this.allocateParticle().opacity=0};g.prototype.SetSprayCone=function(a){this.spraycone=cr.to_radians(a)};g.prototype.SetInitSpeed=
function(a){this.initspeed=a};g.prototype.SetInitSize=function(a){this.initsize=a};g.prototype.SetInitOpacity=function(a){this.initopacity=a/100};g.prototype.SetGrowRate=function(a){this.growrate=a};g.prototype.SetXRandomiser=function(a){this.xrandom=a};g.prototype.SetYRandomiser=function(a){this.yrandom=a};g.prototype.SetSpeedRandomiser=function(a){this.speedrandom=a};g.prototype.SetSizeRandomiser=function(a){this.sizerandom=a};g.prototype.SetGrowRateRandomiser=function(a){this.growrandom=a};g.prototype.SetParticleAcc=
function(a){this.acc=a};g.prototype.SetGravity=function(a){this.g=a};g.prototype.SetAngleRandomiser=function(a){this.lifeanglerandom=a};g.prototype.SetLifeSpeedRandomiser=function(a){this.lifespeedrandom=a};g.prototype.SetOpacityRandomiser=function(a){this.lifeopacityrandom=a};g.prototype.SetTimeout=function(a){this.timeout=a};t.acts=new g;n.prototype.ParticleCount=function(a){a.set_int(this.particles.length)};n.prototype.Rate=function(a){a.set_float(this.rate)};n.prototype.SprayCone=function(a){a.set_float(cr.to_degrees(this.spraycone))};
n.prototype.InitSpeed=function(a){a.set_float(this.initspeed)};n.prototype.InitSize=function(a){a.set_float(this.initsize)};n.prototype.InitOpacity=function(a){a.set_float(100*this.initopacity)};n.prototype.InitGrowRate=function(a){a.set_float(this.growrate)};n.prototype.XRandom=function(a){a.set_float(this.xrandom)};n.prototype.YRandom=function(a){a.set_float(this.yrandom)};n.prototype.InitSpeedRandom=function(a){a.set_float(this.speedrandom)};n.prototype.InitSizeRandom=function(a){a.set_float(this.sizerandom)};
n.prototype.InitGrowRandom=function(a){a.set_float(this.growrandom)};n.prototype.ParticleAcceleration=function(a){a.set_float(this.acc)};n.prototype.Gravity=function(a){a.set_float(this.g)};n.prototype.ParticleAngleRandom=function(a){a.set_float(this.lifeanglerandom)};n.prototype.ParticleSpeedRandom=function(a){a.set_float(this.lifespeedrandom)};n.prototype.ParticleOpacityRandom=function(a){a.set_float(this.lifeopacityrandom)};n.prototype.Timeout=function(a){a.set_float(this.timeout)};t.exps=new n})();
cr.plugins_.TiledBg=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.plugins_.TiledBg.prototype;n.Type=function(e){this.plugin=e;this.runtime=e.runtime};var t=n.Type.prototype;t.onCreate=function(){this.is_family||(this.texture_img=this.runtime.findWaitingTexture(this.texture_file),this.texture_img||(this.texture_img=new Image,this.texture_img.cr_src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(this.texture_img,
this.texture_file)),this.webGL_texture=this.pattern=null)};t.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};t.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat));var e;var c=0;for(e=this.instances.length;c<e;c++)this.instances[c].webGL_texture=this.webGL_texture}};t.loadTextures=function(){this.is_family||
this.webGL_texture||!this.runtime.glwrap||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat))};t.unloadTextures=function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};t.preloadCanvas2D=function(e){e.drawImage(this.texture_img,0,0)};n.Instance=function(e){this.type=e;this.runtime=e.runtime};t=n.Instance.prototype;t.onCreate=function(){this.visible=
this.properties[0];this.rcTex=new cr.rect(0,0,0,0);this.has_own_texture=!1;this.texture_img=this.type.texture_img;this.runtime.glwrap?(this.type.loadTextures(),this.webGL_texture=this.type.webGL_texture):(this.type.pattern||(this.type.pattern=this.runtime.ctx.createPattern(this.type.texture_img,"repeat")),this.pattern=this.type.pattern)};t.afterLoad=function(){this.has_own_texture=!1;this.texture_img=this.type.texture_img};t.onDestroy=function(){this.runtime.glwrap&&this.has_own_texture&&this.webGL_texture&&
(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};t.draw=function(e){e.globalAlpha=this.opacity;e.save();e.fillStyle=this.pattern;var c=this.x,a=this.y;this.runtime.pixel_rounding&&(c=Math.round(c),a=Math.round(a));var d=-(this.hotspotX*this.width),h=-(this.hotspotY*this.height),u=d%this.texture_img.width,v=h%this.texture_img.height;0>u&&(u+=this.texture_img.width);0>v&&(v+=this.texture_img.height);e.translate(c,a);e.rotate(this.angle);e.translate(u,v);e.fillRect(d-
u,h-v,this.width,this.height);e.restore()};t.drawGL_earlyZPass=function(e){this.drawGL(e)};t.drawGL=function(e){e.setTexture(this.webGL_texture);e.setOpacity(this.opacity);var c=this.rcTex;c.right=this.width/this.texture_img.width;c.bottom=this.height/this.texture_img.height;var a=this.bquad;if(this.runtime.pixel_rounding){var d=Math.round(this.x)-this.x,h=Math.round(this.y)-this.y;e.quadTex(a.tlx+d,a.tly+h,a.trx+d,a.try_+h,a.brx+d,a.bry+h,a.blx+d,a.bly+h,c)}else e.quadTex(a.tlx,a.tly,a.trx,a.try_,
a.brx,a.bry,a.blx,a.bly,c)};b.prototype.OnURLLoaded=function(){return!0};n.cnds=new b;f.prototype.SetEffect=function(e){this.blend_mode=e;this.compositeOp=cr.effectToCompositeOp(e);cr.setGLBlend(this,e,this.runtime.gl);this.runtime.redraw=!0};f.prototype.LoadURL=function(e,c){var a=new Image,d=this;a.onload=function(){d.texture_img=a;d.runtime.glwrap?(d.has_own_texture&&d.webGL_texture&&d.runtime.glwrap.deleteTexture(d.webGL_texture),d.webGL_texture=d.runtime.glwrap.loadTexture(a,!0,d.runtime.linearSampling)):
d.pattern=d.runtime.ctx.createPattern(a,"repeat");d.has_own_texture=!0;d.runtime.redraw=!0;d.runtime.trigger(cr.plugins_.TiledBg.prototype.cnds.OnURLLoaded,d)};"data:"!==e.substr(0,5)&&0===c&&(a.crossOrigin="anonymous");this.runtime.setImageSrc(a,e)};n.acts=new f;g.prototype.ImageWidth=function(e){e.set_float(this.texture_img.width)};g.prototype.ImageHeight=function(e){e.set_float(this.texture_img.height)};n.exps=new g})();cr.plugins_.Audio=function(b){this.runtime=b};
(function(){function b(D){-1===xa.indexOf(D)&&xa.push(D)}function f(D){var K=D.instanceObject;try{var P=K.play()}catch(R){b(D);return}P?P.catch(function(R){b(D)}):Ca&&!q.isInUserInputEvent&&b(D)}function g(){var D,K;Da||ka||!M||(n(),"running"===M.state&&(Da=!0));var P=xa.slice(0);cr.clearArray(xa);if(!ba){var R=0;for(D=P.length;R<D;++R){var aa=P[R];aa.stopped||aa.is_paused||(K=aa.instanceObject.play())&&K.catch(function(ca){b(aa)})}}}function n(){"suspended"===M.state&&M.resume&&M.resume();if(M.createBuffer){var D=
M.createBuffer(1,220,22050),K=M.createBufferSource();K.buffer=D;K.connect(M.destination);h(K)}}function t(D){D=Math.pow(10,D/20);isFinite(D)||(D=0);0>D&&(D=0);1<D&&(D=1);return D}function e(D){0>D&&(D=0);1<D&&(D=1);return Math.log(D)/Math.log(10)*20}function c(D){D=D.toLowerCase();return oa.hasOwnProperty(D)&&oa[D].length?oa[D][0].getInputNode():M.destination}function a(){return M.createGain?M.createGain():M.createGainNode()}function d(D){return M.createDelay?M.createDelay(D):M.createDelayNode(D)}
function h(D,K){D.start?D.start(K||0):D.noteOn(K||0)}function u(D,K,P,R){D.start?D.start(R||0,K):D.noteGrainOn(R||0,K,P-K)}function v(D){try{D.stop?D.stop(0):D.noteOff(0)}catch(K){}}function C(D,K,P,R){if(D)if(D.cancelScheduledValues(0),0===R)D.value=K;else{var aa=M.currentTime;R+=aa;switch(P){case 0:D.setValueAtTime(K,R);break;case 1:D.setValueAtTime(D.value,aa);D.linearRampToValueAtTime(K,R);break;case 2:D.setValueAtTime(D.value,aa),D.exponentialRampToValueAtTime(K,R)}}}function w(D,K,P,R,aa,ca){this.type=
"filter";this.params=[D,K,P,R,aa,ca];this.inputNode=a();this.wetNode=a();this.wetNode.gain.value=ca;this.dryNode=a();this.dryNode.gain.value=1-ca;this.filterNode=M.createBiquadFilter();this.filterNode.type="number"===typeof this.filterNode.type?D:Ea[D];this.filterNode.frequency.value=K;this.filterNode.detune&&(this.filterNode.detune.value=P);this.filterNode.Q.value=R;this.filterNode.gain.value=aa;this.inputNode.connect(this.filterNode);this.inputNode.connect(this.dryNode);this.filterNode.connect(this.wetNode)}
function r(D,K,P){this.type="delay";this.params=[D,K,P];this.inputNode=a();this.wetNode=a();this.wetNode.gain.value=P;this.dryNode=a();this.dryNode.gain.value=1-P;this.mainNode=a();this.delayNode=d(D);this.delayNode.delayTime.value=D;this.delayGainNode=a();this.delayGainNode.gain.value=K;this.inputNode.connect(this.mainNode);this.inputNode.connect(this.dryNode);this.mainNode.connect(this.wetNode);this.mainNode.connect(this.delayNode);this.delayNode.connect(this.delayGainNode);this.delayGainNode.connect(this.mainNode)}
function x(D,K,P,R){this.type="convolve";this.params=[K,P,R];this.inputNode=a();this.wetNode=a();this.wetNode.gain.value=P;this.dryNode=a();this.dryNode.gain.value=1-P;this.convolveNode=M.createConvolver();D&&(this.convolveNode.normalize=K,this.convolveNode.buffer=D);this.inputNode.connect(this.convolveNode);this.inputNode.connect(this.dryNode);this.convolveNode.connect(this.wetNode)}function A(D,K,P,R,aa){this.type="flanger";this.params=[D,K,P,R,aa];this.inputNode=a();this.dryNode=a();this.dryNode.gain.value=
1-aa/2;this.wetNode=a();this.wetNode.gain.value=aa/2;this.feedbackNode=a();this.feedbackNode.gain.value=R;this.delayNode=d(D+K);this.delayNode.delayTime.value=D;this.oscNode=M.createOscillator();this.oscNode.frequency.value=P;this.oscGainNode=a();this.oscGainNode.gain.value=K;this.inputNode.connect(this.delayNode);this.inputNode.connect(this.dryNode);this.delayNode.connect(this.wetNode);this.delayNode.connect(this.feedbackNode);this.feedbackNode.connect(this.delayNode);this.oscNode.connect(this.oscGainNode);
this.oscGainNode.connect(this.delayNode.delayTime);h(this.oscNode)}function l(D,K,P,R,aa,ca){this.type="phaser";this.params=[D,K,P,R,aa,ca];this.inputNode=a();this.dryNode=a();this.dryNode.gain.value=1-ca/2;this.wetNode=a();this.wetNode.gain.value=ca/2;this.filterNode=M.createBiquadFilter();this.filterNode.type="number"===typeof this.filterNode.type?7:"allpass";this.filterNode.frequency.value=D;this.filterNode.detune&&(this.filterNode.detune.value=K);this.filterNode.Q.value=P;this.oscNode=M.createOscillator();
this.oscNode.frequency.value=aa;this.oscGainNode=a();this.oscGainNode.gain.value=R;this.inputNode.connect(this.filterNode);this.inputNode.connect(this.dryNode);this.filterNode.connect(this.wetNode);this.oscNode.connect(this.oscGainNode);this.oscGainNode.connect(this.filterNode.frequency);h(this.oscNode)}function y(D){this.type="gain";this.params=[D];this.node=a();this.node.gain.value=D}function z(D,K){this.type="tremolo";this.params=[D,K];this.node=a();this.node.gain.value=1-K/2;this.oscNode=M.createOscillator();
this.oscNode.frequency.value=D;this.oscGainNode=a();this.oscGainNode.gain.value=K/2;this.oscNode.connect(this.oscGainNode);this.oscGainNode.connect(this.node.gain);h(this.oscNode)}function O(D,K){this.type="ringmod";this.params=[D,K];this.inputNode=a();this.wetNode=a();this.wetNode.gain.value=K;this.dryNode=a();this.dryNode.gain.value=1-K;this.ringNode=a();this.ringNode.gain.value=0;this.oscNode=M.createOscillator();this.oscNode.frequency.value=D;this.oscNode.connect(this.ringNode.gain);h(this.oscNode);
this.inputNode.connect(this.ringNode);this.inputNode.connect(this.dryNode);this.ringNode.connect(this.wetNode)}function Q(D,K,P,R,aa){this.type="distortion";this.params=[D,K,P,R,aa];this.inputNode=a();this.preGain=a();this.postGain=a();this.setDrive(P,Math.pow(10,R/20));this.wetNode=a();this.wetNode.gain.value=aa;this.dryNode=a();this.dryNode.gain.value=1-aa;this.waveShaper=M.createWaveShaper();this.curve=new Float32Array(65536);this.generateColortouchCurve(D,K);this.waveShaper.curve=this.curve;this.inputNode.connect(this.preGain);
this.inputNode.connect(this.dryNode);this.preGain.connect(this.waveShaper);this.waveShaper.connect(this.postGain);this.postGain.connect(this.wetNode)}function I(D,K,P,R,aa){this.type="compressor";this.params=[D,K,P,R,aa];this.node=M.createDynamicsCompressor();try{this.node.threshold.value=D,this.node.knee.value=K,this.node.ratio.value=P,this.node.attack.value=R,this.node.release.value=aa}catch(ca){}}function k(D,K){this.type="analyser";this.params=[D,K];this.node=M.createAnalyser();this.node.fftSize=
D;this.node.smoothingTimeConstant=K;this.freqBins=new Float32Array(this.node.frequencyBinCount);this.signal=new Uint8Array(D);this.rms=this.peak=0}function p(){this.obj=null;this.loadUid=0}function H(D,K,P){this.src=D;this.type=K;this.myapi=F;this.is_music=P;this.added_end_listener=!1;var R=this;this.mediaSourceNode=this.outNode=null;this.panWhenReady=[];this.seekWhenReady=0;this.failedToLoad=this.supportWebAudioAPI=this.pauseWhenReady=!1;this.needsSoftwareDecode="audio/webm; codecs=opus"===this.type&&
!ta;this.wasEverReady=!1;this.is_music&&this.needsSoftwareDecode&&(Fa=!0);1!==F||!P||ya||this.needsSoftwareDecode||(this.myapi=0,this.outNode=a());this.audioData=this.bufferObject=null;switch(this.myapi){case 0:this.bufferObject=new Audio;this.bufferObject.crossOrigin="anonymous";this.bufferObject.addEventListener("canplaythrough",function(){R.wasEverReady=!0});1===F&&M.createMediaElementSource&&!/wiiu/i.test(navigator.userAgent)&&(this.supportWebAudioAPI=!0,this.bufferObject.addEventListener("canplay",
function(){!R.mediaSourceNode&&R.bufferObject&&(R.mediaSourceNode=M.createMediaElementSource(R.bufferObject),R.mediaSourceNode.connect(R.outNode))}));this.bufferObject.autoplay=!1;this.bufferObject.preload="auto";this.bufferObject.src=D;break;case 1:if(q.isWKWebView)q.fetchLocalFileViaCordovaAsArrayBuffer(D,function(ca){R.audioData=ca;R.decodeAudioBuffer()},function(ca){R.failedToLoad=!0});else{var aa=new XMLHttpRequest;aa.open("GET",D,!0);aa.responseType="arraybuffer";aa.onload=function(){R.audioData=
aa.response;R.decodeAudioBuffer()};aa.onerror=function(){R.failedToLoad=!0};aa.send()}break;case 2:this.bufferObject=!0}}function m(D,K){var P=this;this.tag=K;this.stopped=this.fresh=!0;this.src=D.src;this.buffer=D;this.myapi=F;this.is_music=D.is_music;this.playbackRate=1;this.hasPlaybackEnded=!0;this.is_paused=this.resume_me=!1;this.resume_position=0;this.is_silent=this.is_muted=this.looping=!1;this.volume=1;this.onended_handler=function(aa){if(!P.is_paused&&!P.resume_me){var ca=this;ca||(ca=aa.target);
ca===P.active_buffer&&(P.hasPlaybackEnded=!0,P.stopped=!0,G=P.tag,q.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,B))}};this.active_buffer=null;this.isTimescaled=1===fa&&!this.is_music||2===fa;this.mutevol=1;this.startTime=this.isTimescaled?q.kahanTime.sum:q.wallTime.sum;this.pannerNode=this.gainNode=null;this.pannerEnabled=!1;this.objectTracker=null;this.panConeOuterGain=this.panConeOuter=this.panConeInner=this.panAngle=this.panY=this.panX=0;this.instanceObject=null;var R=!1;1!==this.myapi||0!==
this.buffer.myapi||this.buffer.supportWebAudioAPI||(this.myapi=0);switch(this.myapi){case 0:this.is_music?(this.instanceObject=D.bufferObject,R=!D.added_end_listener,D.added_end_listener=!0):(this.instanceObject=new Audio,this.instanceObject.crossOrigin="anonymous",this.instanceObject.autoplay=!1,this.instanceObject.src=D.bufferObject.src,R=!0);R&&this.instanceObject.addEventListener("ended",function(){G=P.tag;P.stopped=!0;q.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,B)});break;case 1:this.gainNode=
a();this.gainNode.connect(c(K));1===this.buffer.myapi?D.bufferObject&&(this.instanceObject=M.createBufferSource(),this.instanceObject.buffer=D.bufferObject,this.instanceObject.connect(this.gainNode)):(this.instanceObject=this.buffer.bufferObject,this.buffer.outNode.connect(this.gainNode),this.buffer.added_end_listener||(this.buffer.added_end_listener=!0,this.buffer.bufferObject.addEventListener("ended",function(){G=P.tag;P.stopped=!0;q.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,B)})));break;
case 2:this.instanceObject=new window.Media(J+this.src,null,null,function(aa){aa===window.Media.MEDIA_STOPPED&&(P.hasPlaybackEnded=!0,P.stopped=!0,G=P.tag,q.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,B))})}}function E(D,K){D=D.isPlaying()?1:0;K=K.isPlaying()?1:0;return D===K?0:D<K?1:-1}function L(D,K){cr.clearArray(na);if(D.length){var P;var R=0;for(P=T.length;R<P;R++){var aa=T[R];cr.equals_nocase(D,aa.tag)&&na.push(aa)}K&&na.sort(E)}else U&&!U.hasEnded()&&(cr.clearArray(na),na[0]=U)}function N(D){var K,
P=M.destination;if(oa.hasOwnProperty(D)){var R=oa[D];if(R.length){P=R[0].getInputNode();var aa=0;for(K=R.length;aa<K;aa++){var ca=R[aa];aa+1===K?ca.connectTo(M.destination):ca.connectTo(R[aa+1].getInputNode())}}}L(D);aa=0;for(K=na.length;aa<K;aa++)na[aa].reconnect(P);ua&&Aa===D&&(ua.disconnect(),ua.connect(P))}function V(D,K){oa.hasOwnProperty(D)?oa[D].push(K):oa[D]=[K];N(D)}function W(){}function X(){}function Y(){}function ea(D,K){var P=null;oa.hasOwnProperty(D)&&(P=oa[D]);return P&&0<=K&&K<P.length&&
P[K].freqBins?P[K]:null}var ha=cr.plugins_.Audio.prototype;ha.Type=function(D){this.plugin=D;this.runtime=D.runtime};ha.Type.prototype.onCreate=function(){};var q=null,B=null,G="",J="",F=0,M=null,S=[],T=[],U=null,fa=0,ba=!1,Z=1,da=0,ia=0,ka=!1,ta=!!(new Audio).canPlayType("audio/webm; codecs=opus"),qa=1,Ba=1,Ga=10,Ha=1E4,Ia=1,ua=null,Aa="",Ca=!1,xa=[],ya=!1,Fa=!1,Da=!1;document.addEventListener("pointerup",g,!0);document.addEventListener("touchend",g,!0);document.addEventListener("click",g,!0);document.addEventListener("keydown",
g,!0);document.addEventListener("gamepadconnected",g,!0);var oa={},Ea="lowpass highpass bandpass lowshelf highshelf peaking notch allpass".split(" ");w.prototype.connectTo=function(D){this.wetNode.disconnect();this.wetNode.connect(D);this.dryNode.disconnect();this.dryNode.connect(D)};w.prototype.remove=function(){this.inputNode.disconnect();this.filterNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};w.prototype.getInputNode=function(){return this.inputNode};w.prototype.setParam=
function(D,K,P,R){switch(D){case 0:K/=100;0>K&&(K=0);1<K&&(K=1);this.params[5]=K;C(this.wetNode.gain,K,P,R);C(this.dryNode.gain,1-K,P,R);break;case 1:this.params[1]=K;C(this.filterNode.frequency,K,P,R);break;case 2:this.params[2]=K;C(this.filterNode.detune,K,P,R);break;case 3:this.params[3]=K;C(this.filterNode.Q,K,P,R);break;case 4:this.params[4]=K,C(this.filterNode.gain,K,P,R)}};r.prototype.connectTo=function(D){this.wetNode.disconnect();this.wetNode.connect(D);this.dryNode.disconnect();this.dryNode.connect(D)};
r.prototype.remove=function(){this.inputNode.disconnect();this.mainNode.disconnect();this.delayNode.disconnect();this.delayGainNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};r.prototype.getInputNode=function(){return this.inputNode};r.prototype.setParam=function(D,K,P,R){switch(D){case 0:K/=100;0>K&&(K=0);1<K&&(K=1);this.params[2]=K;C(this.wetNode.gain,K,P,R);C(this.dryNode.gain,1-K,P,R);break;case 4:this.params[1]=t(K);C(this.delayGainNode.gain,t(K),P,R);break;case 5:this.params[0]=
K,C(this.delayNode.delayTime,K,P,R)}};x.prototype.connectTo=function(D){this.wetNode.disconnect();this.wetNode.connect(D);this.dryNode.disconnect();this.dryNode.connect(D)};x.prototype.remove=function(){this.inputNode.disconnect();this.convolveNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};x.prototype.getInputNode=function(){return this.inputNode};x.prototype.setParam=function(D,K,P,R){switch(D){case 0:K/=100,0>K&&(K=0),1<K&&(K=1),this.params[1]=K,C(this.wetNode.gain,K,P,R),
C(this.dryNode.gain,1-K,P,R)}};A.prototype.connectTo=function(D){this.dryNode.disconnect();this.dryNode.connect(D);this.wetNode.disconnect();this.wetNode.connect(D)};A.prototype.remove=function(){this.inputNode.disconnect();this.delayNode.disconnect();this.oscNode.disconnect();this.oscGainNode.disconnect();this.dryNode.disconnect();this.wetNode.disconnect();this.feedbackNode.disconnect()};A.prototype.getInputNode=function(){return this.inputNode};A.prototype.setParam=function(D,K,P,R){switch(D){case 0:K/=
100;0>K&&(K=0);1<K&&(K=1);this.params[4]=K;C(this.wetNode.gain,K/2,P,R);C(this.dryNode.gain,1-K/2,P,R);break;case 6:this.params[1]=K/1E3;C(this.oscGainNode.gain,K/1E3,P,R);break;case 7:this.params[2]=K;C(this.oscNode.frequency,K,P,R);break;case 8:this.params[3]=K/100,C(this.feedbackNode.gain,K/100,P,R)}};l.prototype.connectTo=function(D){this.dryNode.disconnect();this.dryNode.connect(D);this.wetNode.disconnect();this.wetNode.connect(D)};l.prototype.remove=function(){this.inputNode.disconnect();this.filterNode.disconnect();
this.oscNode.disconnect();this.oscGainNode.disconnect();this.dryNode.disconnect();this.wetNode.disconnect()};l.prototype.getInputNode=function(){return this.inputNode};l.prototype.setParam=function(D,K,P,R){switch(D){case 0:K/=100;0>K&&(K=0);1<K&&(K=1);this.params[5]=K;C(this.wetNode.gain,K/2,P,R);C(this.dryNode.gain,1-K/2,P,R);break;case 1:this.params[0]=K;C(this.filterNode.frequency,K,P,R);break;case 2:this.params[1]=K;C(this.filterNode.detune,K,P,R);break;case 3:this.params[2]=K;C(this.filterNode.Q,
K,P,R);break;case 6:this.params[3]=K;C(this.oscGainNode.gain,K,P,R);break;case 7:this.params[4]=K,C(this.oscNode.frequency,K,P,R)}};y.prototype.connectTo=function(D){this.node.disconnect();this.node.connect(D)};y.prototype.remove=function(){this.node.disconnect()};y.prototype.getInputNode=function(){return this.node};y.prototype.setParam=function(D,K,P,R){switch(D){case 4:this.params[0]=t(K),C(this.node.gain,t(K),P,R)}};z.prototype.connectTo=function(D){this.node.disconnect();this.node.connect(D)};
z.prototype.remove=function(){this.oscNode.disconnect();this.oscGainNode.disconnect();this.node.disconnect()};z.prototype.getInputNode=function(){return this.node};z.prototype.setParam=function(D,K,P,R){switch(D){case 0:K/=100;0>K&&(K=0);1<K&&(K=1);this.params[1]=K;C(this.node.gain.value,1-K/2,P,R);C(this.oscGainNode.gain.value,K/2,P,R);break;case 7:this.params[0]=K,C(this.oscNode.frequency,K,P,R)}};O.prototype.connectTo=function(D){this.wetNode.disconnect();this.wetNode.connect(D);this.dryNode.disconnect();
this.dryNode.connect(D)};O.prototype.remove=function(){this.oscNode.disconnect();this.ringNode.disconnect();this.inputNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};O.prototype.getInputNode=function(){return this.inputNode};O.prototype.setParam=function(D,K,P,R){switch(D){case 0:K/=100;0>K&&(K=0);1<K&&(K=1);this.params[1]=K;C(this.wetNode.gain,K,P,R);C(this.dryNode.gain,1-K,P,R);break;case 7:this.params[0]=K,C(this.oscNode.frequency,K,P,R)}};Q.prototype.setDrive=function(D,
K){.01>D&&(D=.01);this.preGain.gain.value=D;this.postGain.gain.value=Math.pow(1/D,.6)*K};Q.prototype.shape=function(D,K,P){P=1.05*P*K-K;var R=0>D?-D:D;return(R<K?R:K+P*(1-Math.exp(-(1/P)*(R-K))))*(0>D?-1:1)};Q.prototype.generateColortouchCurve=function(D,K){D=Math.pow(10,D/20);K=Math.pow(10,K/20);for(var P,R=0;32768>R;++R)P=R/32768,P=this.shape(P,D,K),this.curve[32768+R]=P,this.curve[32768-R-1]=-P};Q.prototype.connectTo=function(D){this.wetNode.disconnect();this.wetNode.connect(D);this.dryNode.disconnect();
this.dryNode.connect(D)};Q.prototype.remove=function(){this.inputNode.disconnect();this.preGain.disconnect();this.waveShaper.disconnect();this.postGain.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};Q.prototype.getInputNode=function(){return this.inputNode};Q.prototype.setParam=function(D,K,P,R){switch(D){case 0:K/=100,0>K&&(K=0),1<K&&(K=1),this.params[4]=K,C(this.wetNode.gain,K,P,R),C(this.dryNode.gain,1-K,P,R)}};I.prototype.connectTo=function(D){this.node.disconnect();this.node.connect(D)};
I.prototype.remove=function(){this.node.disconnect()};I.prototype.getInputNode=function(){return this.node};I.prototype.setParam=function(D,K,P,R){};k.prototype.tick=function(){this.node.getFloatFrequencyData(this.freqBins);this.node.getByteTimeDomainData(this.signal);for(var D=this.node.fftSize,K=0,P=this.peak=0,R;K<D;K++)R=(this.signal[K]-128)/128,0>R&&(R=-R),this.peak<R&&(this.peak=R),P+=R*R;this.peak=e(this.peak);this.rms=e(Math.sqrt(P/D))};k.prototype.connectTo=function(D){this.node.disconnect();
this.node.connect(D)};k.prototype.remove=function(){this.node.disconnect()};k.prototype.getInputNode=function(){return this.node};k.prototype.setParam=function(D,K,P,R){};p.prototype.setObject=function(D){this.obj=D};p.prototype.hasObject=function(){return!!this.obj};p.prototype.tick=function(D){};H.prototype.release=function(){var D,K;var P=D=0;for(K=T.length;D<K;++D){var R=T[D];T[P]=R;R.buffer===this?R.stop():++P}T.length=P;this.mediaSourceNode&&(this.mediaSourceNode.disconnect(),this.mediaSourceNode=
null);this.outNode&&(this.outNode.disconnect(),this.outNode=null);this.audioData=this.bufferObject=null};H.prototype.decodeAudioBuffer=function(){if(!this.bufferObject&&this.audioData){var D=this;if(this.needsSoftwareDecode){var K=this.audioData;this.audioData=null;window.OpusDecoder(K,function(P,R){if(P)D.onDecodeError(P);else P=new Float32Array(R),R=M.createBuffer(1,P.length,48E3),R.getChannelData(0).set(P),D.onDecodeComplete(R)})}else M.decodeAudioData(this.audioData,function(P){D.onDecodeComplete(P)},
function(P){D.onDecodeError(P)})}};H.prototype.onDecodeComplete=function(D){this.bufferObject=D;this.audioData=null;var K;if(cr.is_undefined(this.playTagWhenReady)||ba)cr.is_undefined(this.convolveWhenReady)||(P=this.convolveWhenReady.convolveNode,P.normalize=this.normalizeWhenReady,P.buffer=D);else if(this.panWhenReady.length){var P=0;for(K=this.panWhenReady.length;P<K;P++){D=this.panWhenReady[P];var R=new m(this,D.thistag);R.setPannerEnabled(!0);if("undefined"!==typeof D.objUid&&(D.obj=q.getObjectByUID(D.objUid),
!D.obj))continue;if(D.obj){var aa=cr.rotatePtAround(D.obj.x,D.obj.y,-D.obj.layer.getAngle(),da,ia,!0),ca=cr.rotatePtAround(D.obj.x,D.obj.y,-D.obj.layer.getAngle(),da,ia,!1);R.setPan(aa,ca,cr.to_degrees(D.obj.angle-D.obj.layer.getAngle()),D.ia,D.oa,D.og);R.setObject(D.obj)}else R.setPan(D.x,D.y,D.a,D.ia,D.oa,D.og);R.play(this.loopWhenReady,this.volumeWhenReady,this.seekWhenReady);this.pauseWhenReady&&R.pause();T.push(R)}cr.clearArray(this.panWhenReady)}else R=new m(this,this.playTagWhenReady||""),
R.play(this.loopWhenReady,this.volumeWhenReady,this.seekWhenReady),this.pauseWhenReady&&R.pause(),T.push(R)};H.prototype.onDecodeError=function(D){self.failedToLoad=!0;console.error("Failed to decode audio '"+this.src+"': "+D)};H.prototype.isLoaded=function(){switch(this.myapi){case 0:var D=4<=this.bufferObject.readyState;D&&(this.wasEverReady=!0);return D||this.wasEverReady;case 1:return!!this.audioData||!!this.bufferObject;case 2:return!0}return!1};H.prototype.isLoadedAndDecoded=function(){switch(this.myapi){case 0:return this.isLoaded();
case 1:return!!this.bufferObject;case 2:return!0}return!1};H.prototype.hasFailedToLoad=function(){switch(this.myapi){case 0:return!!this.bufferObject.error;case 1:return this.failedToLoad}return!1};m.prototype.hasEnded=function(){switch(this.myapi){case 0:return this.instanceObject.ended;case 1:return 1===this.buffer.myapi?!this.fresh&&!this.stopped&&this.instanceObject.loop||this.is_paused?!1:this.hasPlaybackEnded:this.instanceObject.ended;case 2:return this.hasPlaybackEnded}return!0};m.prototype.canBeRecycled=
function(){return this.fresh||this.stopped?!0:this.hasEnded()};m.prototype.setPannerEnabled=function(D){1===F&&(!this.pannerEnabled&&D?this.gainNode&&(this.pannerNode||(this.pannerNode=M.createPanner(),this.pannerNode.panningModel="number"===typeof this.pannerNode.panningModel?qa:["equalpower","HRTF","soundfield"][qa],this.pannerNode.distanceModel="number"===typeof this.pannerNode.distanceModel?Ba:["linear","inverse","exponential"][Ba],this.pannerNode.refDistance=Ga,this.pannerNode.maxDistance=Ha,
this.pannerNode.rolloffFactor=Ia),this.gainNode.disconnect(),this.gainNode.connect(this.pannerNode),this.pannerNode.connect(c(this.tag)),this.pannerEnabled=!0):this.pannerEnabled&&!D&&this.gainNode&&(this.pannerNode.disconnect(),this.gainNode.disconnect(),this.gainNode.connect(c(this.tag)),this.pannerEnabled=!1))};m.prototype.setPan=function(D,K,P,R,aa,ca){this.pannerEnabled&&1===F&&(this.pannerNode.setPosition(D,K,0),this.pannerNode.setOrientation(Math.cos(cr.to_radians(P)),Math.sin(cr.to_radians(P)),
0),this.pannerNode.coneInnerAngle=R,this.pannerNode.coneOuterAngle=aa,this.pannerNode.coneOuterGain=ca,this.panX=D,this.panY=K,this.panAngle=P,this.panConeInner=R,this.panConeOuter=aa,this.panConeOuterGain=ca)};m.prototype.setObject=function(D){this.pannerEnabled&&1===F&&(this.objectTracker||(this.objectTracker=new p),this.objectTracker.setObject(D))};m.prototype.tick=function(D){if(this.pannerEnabled&&1===F&&this.objectTracker&&this.objectTracker.hasObject()&&this.isPlaying()){this.objectTracker.tick(D);
D=this.objectTracker.obj;var K=cr.rotatePtAround(D.x,D.y,-D.layer.getAngle(),da,ia,!0),P=cr.rotatePtAround(D.x,D.y,-D.layer.getAngle(),da,ia,!1);this.pannerNode.setPosition(K,P,0);"undefined"!==typeof this.objectTracker.obj.angle&&(D=D.angle-D.layer.getAngle(),this.pannerNode.setOrientation(Math.cos(D),Math.sin(D),0))}};m.prototype.play=function(D,K,P,R){var aa=this.instanceObject;this.looping=D;this.volume=K;P=P||0;R=R||0;switch(this.myapi){case 0:1!==aa.playbackRate&&(aa.playbackRate=1);aa.volume!==
K*Z&&(aa.volume=K*Z);aa.loop!==D&&(aa.loop=D);aa.muted&&(aa.muted=!1);if(aa.currentTime!==P)try{aa.currentTime=P}catch(ca){}f(this);break;case 1:this.muted=!1;this.mutevol=1;if(1===this.buffer.myapi)this.gainNode.gain.value=K*Z,this.fresh||(this.instanceObject=M.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode)),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=D,this.hasPlaybackEnded=
!1,0===P?h(this.instanceObject,R):u(this.instanceObject,P,this.getDuration(),R);else{1!==aa.playbackRate&&(aa.playbackRate=1);aa.loop!==D&&(aa.loop=D);aa.volume=K*Z;if(aa.currentTime!==P)try{aa.currentTime=P}catch(ca){}f(this)}break;case 2:(!this.fresh&&this.stopped||0!==P)&&aa.seekTo(P),aa.play(),this.hasPlaybackEnded=!1}this.playbackRate=1;this.startTime=(this.isTimescaled?q.kahanTime.sum:q.wallTime.sum)-P;this.is_paused=this.stopped=this.fresh=!1};m.prototype.stop=function(){switch(this.myapi){case 0:this.instanceObject.paused||
this.instanceObject.pause();break;case 1:1===this.buffer.myapi?v(this.instanceObject):this.instanceObject.paused||this.instanceObject.pause();break;case 2:this.instanceObject.stop()}this.stopped=!0;this.is_paused=!1};m.prototype.pause=function(){if(!(this.fresh||this.stopped||this.hasEnded()||this.is_paused)){switch(this.myapi){case 0:this.instanceObject.paused||this.instanceObject.pause();break;case 1:1===this.buffer.myapi?(this.resume_position=this.getPlaybackTime(!0),this.looping&&(this.resume_position%=
this.getDuration()),this.is_paused=!0,v(this.instanceObject)):this.instanceObject.paused||this.instanceObject.pause();break;case 2:this.instanceObject.pause()}this.is_paused=!0}};m.prototype.resume=function(){if(!(this.fresh||this.stopped||this.hasEnded())&&this.is_paused){switch(this.myapi){case 0:f(this);break;case 1:1===this.buffer.myapi?(this.instanceObject=M.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=
this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=Z*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=(this.isTimescaled?q.kahanTime.sum:q.wallTime.sum)-this.resume_position/(this.playbackRate||.001),u(this.instanceObject,this.resume_position,this.getDuration())):f(this);break;case 2:this.instanceObject.play()}this.is_paused=!1}};m.prototype.seek=function(D){if(!(this.fresh||this.stopped||this.hasEnded()))switch(this.myapi){case 0:try{this.instanceObject.currentTime=
D}catch(K){}break;case 1:if(1===this.buffer.myapi)this.is_paused?this.resume_position=D:(this.pause(),this.resume_position=D,this.resume());else try{this.instanceObject.currentTime=D}catch(K){}}};m.prototype.reconnect=function(D){1===this.myapi&&(this.pannerEnabled?(this.pannerNode.disconnect(),this.pannerNode.connect(D)):(this.gainNode.disconnect(),this.gainNode.connect(D)))};m.prototype.getDuration=function(D){var K=0;switch(this.myapi){case 0:"undefined"!==typeof this.instanceObject.duration&&
(K=this.instanceObject.duration);break;case 1:K=this.buffer.bufferObject.duration;break;case 2:K=this.instanceObject.getDuration()}D&&(K/=this.playbackRate||.001);return K};m.prototype.getPlaybackTime=function(D){var K=this.getDuration(),P=0;switch(this.myapi){case 0:"undefined"!==typeof this.instanceObject.currentTime&&(P=this.instanceObject.currentTime);break;case 1:if(1===this.buffer.myapi){if(this.is_paused)return this.resume_position;P=(this.isTimescaled?q.kahanTime.sum:q.wallTime.sum)-this.startTime}else"undefined"!==
typeof this.instanceObject.currentTime&&(P=this.instanceObject.currentTime)}D&&(P*=this.playbackRate);!this.looping&&P>K&&(P=K);return P};m.prototype.isPlaying=function(){return!this.is_paused&&!this.fresh&&!this.stopped&&!this.hasEnded()};m.prototype.shouldSave=function(){return!this.fresh&&!this.stopped&&!this.hasEnded()};m.prototype.setVolume=function(D){this.volume=D;this.updateVolume()};m.prototype.updateVolume=function(){var D=this.volume*Z;isFinite(D)||(D=0);switch(this.myapi){case 0:"undefined"!==
typeof this.instanceObject.volume&&this.instanceObject.volume!==D&&(this.instanceObject.volume=D);break;case 1:1===this.buffer.myapi?this.gainNode.gain.value=D*this.mutevol:"undefined"!==typeof this.instanceObject.volume&&this.instanceObject.volume!==D&&(this.instanceObject.volume=D)}};m.prototype.getVolume=function(){return this.volume};m.prototype.doSetMuted=function(D){switch(this.myapi){case 0:this.instanceObject.muted!==!!D&&(this.instanceObject.muted=!!D);break;case 1:1===this.buffer.myapi?
(this.mutevol=D?0:1,this.gainNode.gain.value=Z*this.volume*this.mutevol):this.instanceObject.muted!==!!D&&(this.instanceObject.muted=!!D)}};m.prototype.setMuted=function(D){this.is_muted=!!D;this.doSetMuted(this.is_muted||this.is_silent)};m.prototype.setSilent=function(D){this.is_silent=!!D;this.doSetMuted(this.is_muted||this.is_silent)};m.prototype.setLooping=function(D){this.looping=D;switch(this.myapi){case 0:this.instanceObject.loop!==!!D&&(this.instanceObject.loop=!!D);break;case 1:this.instanceObject.loop!==
!!D&&(this.instanceObject.loop=!!D)}};m.prototype.setPlaybackRate=function(D){this.playbackRate=D;this.updatePlaybackRate()};m.prototype.getPlaybackRate=function(D){return this.playbackRate};m.prototype.updatePlaybackRate=function(){var D=this.playbackRate;this.isTimescaled&&(D*=q.timescale);switch(this.myapi){case 0:this.instanceObject.playbackRate!==D&&(this.instanceObject.playbackRate=D);break;case 1:1===this.buffer.myapi?this.instanceObject.playbackRate.value!==D&&(this.instanceObject.playbackRate.value=
D):this.instanceObject.playbackRate!==D&&(this.instanceObject.playbackRate=D)}};m.prototype.setSuspended=function(D){switch(this.myapi){case 0:D?this.isPlaying()?(this.resume_me=!0,this.instanceObject.pause()):this.resume_me=!1:this.resume_me&&(this.instanceObject.play(),this.resume_me=!1);break;case 1:D?this.isPlaying()?(this.resume_me=!0,1===this.buffer.myapi?(this.resume_position=this.getPlaybackTime(!0),this.looping&&(this.resume_position%=this.getDuration()),v(this.instanceObject)):this.instanceObject.pause()):
this.resume_me=!1:this.resume_me&&(1===this.buffer.myapi?(this.instanceObject=M.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=Z*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=(this.isTimescaled?q.kahanTime.sum:q.wallTime.sum)-this.resume_position/(this.playbackRate||
.001),u(this.instanceObject,this.resume_position,this.getDuration())):this.instanceObject.play(),this.resume_me=!1);break;case 2:D?this.isPlaying()?(this.instanceObject.pause(),this.resume_me=!0):this.resume_me=!1:this.resume_me&&(this.resume_me=!1,this.instanceObject.play())}};ha.Instance=function(D){this.type=D;q=this.runtime=D.runtime;B=this;this.listenerTracker=null;this.listenerZ=-600;this.runtime.isWKWebView&&(ya=!0);!(this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))||
this.runtime.isCrosswalk||this.runtime.isAmazonWebApp||ya||(Ca=!0);M=null;"undefined"!==typeof AudioContext?(F=1,M=new AudioContext):"undefined"!==typeof webkitAudioContext&&(F=1,M=new webkitAudioContext);this.runtime.isiOS&&M&&(M.close&&M.close(),"undefined"!==typeof AudioContext?M=new AudioContext:"undefined"!==typeof webkitAudioContext&&(M=new webkitAudioContext));1!==F&&this.runtime.isCordova&&"undefined"!==typeof window.Media&&(F=2);2===F&&(J=location.href,D=J.lastIndexOf("/"),-1<D&&(J=J.substr(0,
D+1)),J=J.replace("file://",""));this.runtime.tickMe(this)};var ra=ha.Instance.prototype;ra.onCreate=function(){this.runtime.audioInstance=this;fa=this.properties[0];this.saveload=this.properties[1];this.playinbackground=this.properties[2];this.nextPlayTime=0;qa=this.properties[4];Ba=this.properties[5];this.listenerZ=-this.properties[6];Ga=this.properties[7];Ha=this.properties[8];Ia=this.properties[9];this.listenerTracker=new p;var D=this.runtime.draw_width||this.runtime.width,K=this.runtime.draw_height||
this.runtime.height;1===F&&(M.listener.setPosition(D/2,K/2,this.listenerZ),M.listener.setOrientation(0,0,1,0,-1,0),window.c2OnAudioMicStream=function(R,aa){ua&&ua.disconnect();Aa=aa.toLowerCase();ua=M.createMediaStreamSource(R);ua.connect(c(Aa))});this.runtime.addSuspendCallback(function(R){B.onSuspend(R)});var P=this;this.runtime.addDestroyCallback(function(R){P.onInstanceDestroyed(R)})};ra.onInstanceDestroyed=function(D){var K;var P=0;for(K=T.length;P<K;P++){var R=T[P];R.objectTracker&&R.objectTracker.obj===
D&&(R.objectTracker.obj=null,R.pannerEnabled&&R.isPlaying()&&R.looping&&R.stop())}this.listenerTracker.obj===D&&(this.listenerTracker.obj=null)};ra.saveToJSON=function(){var D={silent:ba,masterVolume:Z,listenerZ:this.listenerZ,listenerUid:this.listenerTracker.hasObject()?this.listenerTracker.obj.uid:-1,playing:[],effects:{}},K=D.playing,P,R;var aa=0;for(P=T.length;aa<P;aa++){var ca=T[aa];if(ca.shouldSave()&&3!==this.saveload&&(!ca.is_music||1!==this.saveload)&&(ca.is_music||2!==this.saveload)){var la=
ca.getPlaybackTime();ca.looping&&(la%=ca.getDuration());la={tag:ca.tag,buffersrc:ca.buffer.src,buffertype:ca.buffer.type,is_music:ca.is_music,playbackTime:la,volume:ca.volume,looping:ca.looping,muted:ca.is_muted,playbackRate:ca.playbackRate,paused:ca.is_paused,resume_position:ca.resume_position};if(ca.pannerEnabled){la.pan={};var ma=la.pan;ca.objectTracker&&ca.objectTracker.hasObject()?ma.objUid=ca.objectTracker.obj.uid:(ma.x=ca.panX,ma.y=ca.panY,ma.a=ca.panAngle);ma.ia=ca.panConeInner;ma.oa=ca.panConeOuter;
ma.og=ca.panConeOuterGain}K.push(la)}}K=D.effects;for(R in oa)if(oa.hasOwnProperty(R)){ca=[];aa=0;for(P=oa[R].length;aa<P;aa++)ca.push({type:oa[R][aa].type,params:oa[R][aa].params});K[R]=ca}return D};var va=[];ra.loadFromJSON=function(D){var K=D.silent;Z=D.masterVolume;this.listenerZ=D.listenerZ;this.listenerTracker.setObject(null);var P=D.listenerUid;-1!==P&&(this.listenerTracker.loadUid=P,va.push(this.listenerTracker));P=D.playing;var R;if(3!==this.saveload){var aa=0;for(R=T.length;aa<R;aa++){var ca=
T[aa];ca.is_music&&1===this.saveload||(ca.is_music||2!==this.saveload)&&ca.stop()}}for(pa in oa)if(oa.hasOwnProperty(pa))for(aa=0,R=oa[pa].length;aa<R;aa++)oa[pa][aa].remove();cr.wipe(oa);for(pa in D.effects)if(D.effects.hasOwnProperty(pa)){var la=D.effects[pa];aa=0;for(R=la.length;aa<R;aa++){var ma=la[aa].type;var ja=la[aa].params;switch(ma){case "filter":V(pa,new w(ja[0],ja[1],ja[2],ja[3],ja[4],ja[5]));break;case "delay":V(pa,new r(ja[0],ja[1],ja[2]));break;case "convolve":ma=ja[2];ca=this.getAudioBuffer(ma,
!1);ca.bufferObject?ma=new x(ca.bufferObject,ja[0],ja[1],ma):(ma=new x(null,ja[0],ja[1],ma),ca.normalizeWhenReady=ja[0],ca.convolveWhenReady=ma);V(pa,ma);break;case "flanger":V(pa,new A(ja[0],ja[1],ja[2],ja[3],ja[4]));break;case "phaser":V(pa,new l(ja[0],ja[1],ja[2],ja[3],ja[4],ja[5]));break;case "gain":V(pa,new y(ja[0]));break;case "tremolo":V(pa,new z(ja[0],ja[1]));break;case "ringmod":V(pa,new O(ja[0],ja[1]));break;case "distortion":V(pa,new Q(ja[0],ja[1],ja[2],ja[3],ja[4]));break;case "compressor":V(pa,
new I(ja[0],ja[1],ja[2],ja[3],ja[4]));break;case "analyser":V(pa,new k(ja[0],ja[1]))}}}aa=0;for(R=P.length;aa<R;aa++)if(3!==this.saveload){D=P[aa];ma=D.buffersrc;ca=D.buffertype||"";var sa=D.is_music;var pa=D.tag;la=D.playbackTime;var Ja=D.looping;var Ka=D.volume;var za=(ja=D.pan)&&ja.hasOwnProperty("objUid")?ja.objUid:-1;if(!sa||1!==this.saveload)if(sa||2!==this.saveload)(ca=this.getAudioInstance({url:ma,type:ca},pa,sa,Ja,Ka))?(ca.resume_position=D.resume_position,ca.setPannerEnabled(!!ja),ca.play(Ja,
Ka,la),ca.updatePlaybackRate(),ca.updateVolume(),ca.doSetMuted(ca.is_muted||ca.is_silent),D.paused&&ca.pause(),D.muted&&ca.setMuted(!0),ca.doSetMuted(ca.is_muted||ca.is_silent),ja&&(-1!==za?(ca.objectTracker=ca.objectTracker||new p,ca.objectTracker.loadUid=za,va.push(ca.objectTracker)):ca.setPan(ja.x,ja.y,ja.a,ja.ia,ja.oa,ja.og))):(ca=this.getAudioBuffer({url:ma,type:""},sa),ca.seekWhenReady=la,ca.pauseWhenReady=D.paused,ja&&(-1!==za?ca.panWhenReady.push({objUid:za,ia:ja.ia,oa:ja.oa,og:ja.og,thistag:pa}):
ca.panWhenReady.push({x:ja.x,y:ja.y,a:ja.a,ia:ja.ia,oa:ja.oa,og:ja.og,thistag:pa})))}if(K&&!ba){aa=0;for(R=T.length;aa<R;aa++)T[aa].setSilent(!0);ba=!0}else if(!K&&ba){aa=0;for(R=T.length;aa<R;aa++)T[aa].setSilent(!1);ba=!1}};ra.afterLoad=function(){var D;var K=0;for(D=va.length;K<D;K++){var P=va[K];var R=this.runtime.getObjectByUID(P.loadUid);P.setObject(R);P.loadUid=-1;R&&(da=R.x,ia=R.y)}cr.clearArray(va)};ra.onSuspend=function(D){if(!this.playinbackground){!D&&M&&M.resume&&(M.resume(),ka=!1);var K;
var P=0;for(K=T.length;P<K;P++)T[P].setSuspended(D);D&&M&&M.suspend&&(M.suspend(),ka=!0)}};ra.tick=function(){var D=this.runtime.dt,K;var P=0;for(K=T.length;P<K;P++){var R=T[P];R.tick(D);0!==fa&&R.updatePlaybackRate()}var aa;for(aa in oa)if(oa.hasOwnProperty(aa))for(R=oa[aa],P=0,K=R.length;P<K;P++){var ca=R[P];ca.tick&&ca.tick()}1===F&&this.listenerTracker.hasObject()&&(this.listenerTracker.tick(D),da=this.listenerTracker.obj.x,ia=this.listenerTracker.obj.y,M.listener.setPosition(this.listenerTracker.obj.x,
this.listenerTracker.obj.y,this.listenerZ))};var wa=[];ra.setPreloadList=function(D){var K,P=0;var R=0;for(K=D.length;R<K;++R){var aa=D[R];var ca=2*aa.size;wa.push({filename:aa.filename,size:ca,type:aa.type,obj:null});P+=ca}return P};ra.startPreloads=function(){var D;var K=0;for(D=wa.length;K<D;++K){var P=wa[K];var R=this.runtime.getProjectFileUrl(P.filename);P.obj=this.getAudioBuffer({url:R,type:P.type},!1)}};ra.getPreloadedSize=function(){var D=0,K;var P=0;for(K=wa.length;P<K;++P){var R=wa[P];R.obj.isLoadedAndDecoded()||
R.obj.hasFailedToLoad()||this.runtime.isAndroidStockBrowser?D+=R.size:R.obj.isLoaded()&&(D+=Math.floor(R.size/2))}return D};ra.releaseAllMusicBuffers=function(){var D,K;var P=D=0;for(K=S.length;D<K;++D){var R=S[D];S[P]=R;R.is_music?R.release():++P}S.length=P};ra.getAudioBuffer=function(D,K,P){var R,aa=null,ca=D.url;var la=0;for(R=S.length;la<R;la++){var ma=S[la];if(ma.src===ca){aa=ma;break}}aa||P||((ya||Fa)&&K&&this.releaseAllMusicBuffers(),aa=new H(ca,D.type,K),S.push(aa));return aa};ra.getAudioInstance=
function(D,K,P,R,aa){var ca,la=D.url;var ma=0;for(ca=T.length;ma<ca;ma++){var ja=T[ma];if(ja.src===la&&(ja.canBeRecycled()||P))return ja.tag=K,ja}D=this.getAudioBuffer(D,P);if(!D.bufferObject)return"<preload>"!==K&&(D.playTagWhenReady=K,D.loopWhenReady=R,D.volumeWhenReady=aa),null;ja=new m(D,K);T.push(ja);return ja};var na=[];W.prototype.OnEnded=function(D){return cr.equals_nocase(G,D)};W.prototype.PreloadsComplete=function(){var D;var K=0;for(D=S.length;K<D;K++)if(!S[K].isLoadedAndDecoded()&&!S[K].hasFailedToLoad())return!1;
return!0};W.prototype.AdvancedAudioSupported=function(){return 1===F};W.prototype.IsSilent=function(){return ba};W.prototype.IsAnyPlaying=function(){var D;var K=0;for(D=T.length;K<D;K++)if(T[K].isPlaying())return!0;return!1};W.prototype.IsTagPlaying=function(D){L(D);var K;D=0;for(K=na.length;D<K;D++)if(na[D].isPlaying())return!0;return!1};ha.cnds=new W;X.prototype.Play=function(D,K,P,R){if(!ba){P=t(P);var aa=D[1];if(D=this.runtime.getProjectAudioFileUrl(D[0]))if(U=this.getAudioInstance(D,R,aa,0!==
K,P))U.setPannerEnabled(!1),U.play(0!==K,P,0,this.nextPlayTime),this.nextPlayTime=0}};X.prototype.PlayAtPosition=function(D,K,P,R,aa,ca,la,ma,ja,sa){if(!ba){P=t(P);var pa=D[1];if(D=this.runtime.getProjectAudioFileUrl(D[0]))(U=this.getAudioInstance(D,sa,pa,0!==K,P))?(U.setPannerEnabled(!0),U.setPan(R,aa,ca,la,ma,t(ja)),U.play(0!==K,P,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(D,pa).panWhenReady.push({x:R,y:aa,a:ca,ia:la,oa:ma,og:t(ja),thistag:sa})}};X.prototype.PlayAtObject=function(D,
K,P,R,aa,ca,la,ma){if(!ba&&R&&(R=R.getFirstPicked())){P=t(P);var ja=D[1];if(D=this.runtime.getProjectAudioFileUrl(D[0]))(U=this.getAudioInstance(D,ma,ja,0!==K,P))?(U.setPannerEnabled(!0),ma=cr.rotatePtAround(R.x,R.y,-R.layer.getAngle(),da,ia,!0),D=cr.rotatePtAround(R.x,R.y,-R.layer.getAngle(),da,ia,!1),U.setPan(ma,D,cr.to_degrees(R.angle-R.layer.getAngle()),aa,ca,t(la)),U.setObject(R),U.play(0!==K,P,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(D,ja).panWhenReady.push({obj:R,ia:aa,
oa:ca,og:t(la),thistag:ma})}};X.prototype.PlayByName=function(D,K,P,R,aa){!ba&&(R=t(R),D=1===D,K=this.runtime.getProjectAudioFileUrl(K))&&(U=this.getAudioInstance(K,aa,D,0!==P,R))&&(U.setPannerEnabled(!1),U.play(0!==P,R,0,this.nextPlayTime),this.nextPlayTime=0)};X.prototype.PlayAtPositionByName=function(D,K,P,R,aa,ca,la,ma,ja,sa,pa){!ba&&(R=t(R),D=1===D,K=this.runtime.getProjectAudioFileUrl(K))&&((U=this.getAudioInstance(K,pa,D,0!==P,R))?(U.setPannerEnabled(!0),U.setPan(aa,ca,la,ma,ja,t(sa)),U.play(0!==
P,R,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(K,D).panWhenReady.push({x:aa,y:ca,a:la,ia:ma,oa:ja,og:t(sa),thistag:pa}))};X.prototype.PlayAtObjectByName=function(D,K,P,R,aa,ca,la,ma,ja){!ba&&aa&&(aa=aa.getFirstPicked())&&(R=t(R),D=1===D,K=this.runtime.getProjectAudioFileUrl(K))&&((U=this.getAudioInstance(K,ja,D,0!==P,R))?(U.setPannerEnabled(!0),ja=cr.rotatePtAround(aa.x,aa.y,-aa.layer.getAngle(),da,ia,!0),K=cr.rotatePtAround(aa.x,aa.y,-aa.layer.getAngle(),da,ia,!1),U.setPan(ja,
K,cr.to_degrees(aa.angle-aa.layer.getAngle()),ca,la,t(ma)),U.setObject(aa),U.play(0!==P,R,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(K,D).panWhenReady.push({obj:aa,ia:ca,oa:la,og:t(ma),thistag:ja}))};X.prototype.SetLooping=function(D,K){L(D);var P;D=0;for(P=na.length;D<P;D++)na[D].setLooping(0===K)};X.prototype.SetMuted=function(D,K){L(D);var P;D=0;for(P=na.length;D<P;D++)na[D].setMuted(0===K)};X.prototype.SetVolume=function(D,K){L(D);D=t(K);var P;K=0;for(P=na.length;K<P;K++)na[K].setVolume(D)};
X.prototype.Preload=function(D){if(!ba){var K=D[1];(D=this.runtime.getProjectAudioFileUrl(D[0]))&&2!==F&&this.getAudioInstance(D,"<preload>",K,!1)}};X.prototype.PreloadByName=function(D,K){ba||(D=1===D,(K=this.runtime.getProjectAudioFileUrl(K))&&2!==F&&this.getAudioInstance(K,"<preload>",D,!1))};X.prototype.SetPlaybackRate=function(D,K){L(D);0>K&&(K=0);var P;D=0;for(P=na.length;D<P;D++)na[D].setPlaybackRate(K)};X.prototype.Stop=function(D){L(D);var K;D=0;for(K=na.length;D<K;D++)na[D].stop()};X.prototype.StopAll=
function(){var D;var K=0;for(D=T.length;K<D;K++)T[K].stop()};X.prototype.SetPaused=function(D,K){L(D);var P;D=0;for(P=na.length;D<P;D++)0===K?na[D].pause():na[D].resume()};X.prototype.Seek=function(D,K){L(D);var P;D=0;for(P=na.length;D<P;D++)na[D].seek(K)};X.prototype.SetSilent=function(D){var K;2===D&&(D=ba?1:0);if(0===D&&!ba){D=0;for(K=T.length;D<K;D++)T[D].setSilent(!0);ba=!0}else if(1===D&&ba){D=0;for(K=T.length;D<K;D++)T[D].setSilent(!1);ba=!1}};X.prototype.SetMasterVolume=function(D){Z=t(D);
var K;D=0;for(K=T.length;D<K;D++)T[D].updateVolume()};X.prototype.AddFilterEffect=function(D,K,P,R,aa,ca,la){1!==F||0>K||K>=Ea.length||!M.createBiquadFilter||(D=D.toLowerCase(),la/=100,0>la&&(la=0),1<la&&(la=1),V(D,new w(K,P,R,aa,ca,la)))};X.prototype.AddDelayEffect=function(D,K,P,R){1===F&&(D=D.toLowerCase(),R/=100,0>R&&(R=0),1<R&&(R=1),V(D,new r(K,t(P),R)))};X.prototype.AddFlangerEffect=function(D,K,P,R,aa,ca){1===F&&M.createOscillator&&(D=D.toLowerCase(),ca/=100,0>ca&&(ca=0),1<ca&&(ca=1),V(D,new A(K/
1E3,P/1E3,R,aa/100,ca)))};X.prototype.AddPhaserEffect=function(D,K,P,R,aa,ca,la){1===F&&M.createOscillator&&(D=D.toLowerCase(),la/=100,0>la&&(la=0),1<la&&(la=1),V(D,new l(K,P,R,aa,ca,la)))};X.prototype.AddConvolutionEffect=function(D,K,P,R){if(1===F&&M.createConvolver){P=0===P;var aa=this.runtime.getProjectAudioFileUrl(K[0]);aa&&(K=this.getAudioBuffer(aa,!1),D=D.toLowerCase(),R/=100,0>R&&(R=0),1<R&&(R=1),K.bufferObject?R=new x(K.bufferObject,P,R,aa.url):(R=new x(null,P,R,aa.url),K.normalizeWhenReady=
P,K.convolveWhenReady=R),V(D,R))}};X.prototype.AddGainEffect=function(D,K){1===F&&(D=D.toLowerCase(),V(D,new y(t(K))))};X.prototype.AddMuteEffect=function(D){1===F&&(D=D.toLowerCase(),V(D,new y(0)))};X.prototype.AddTremoloEffect=function(D,K,P){1===F&&M.createOscillator&&(D=D.toLowerCase(),P/=100,0>P&&(P=0),1<P&&(P=1),V(D,new z(K,P)))};X.prototype.AddRingModEffect=function(D,K,P){1===F&&M.createOscillator&&(D=D.toLowerCase(),P/=100,0>P&&(P=0),1<P&&(P=1),V(D,new O(K,P)))};X.prototype.AddDistortionEffect=
function(D,K,P,R,aa,ca){1===F&&M.createWaveShaper&&(D=D.toLowerCase(),ca/=100,0>ca&&(ca=0),1<ca&&(ca=1),V(D,new Q(K,P,R,aa,ca)))};X.prototype.AddCompressorEffect=function(D,K,P,R,aa,ca){1===F&&M.createDynamicsCompressor&&(D=D.toLowerCase(),V(D,new I(K,P,R,aa/1E3,ca/1E3)))};X.prototype.AddAnalyserEffect=function(D,K,P){1===F&&(D=D.toLowerCase(),V(D,new k(K,P)))};X.prototype.RemoveEffects=function(D){if(1===F){D=D.toLowerCase();var K;if(oa.hasOwnProperty(D)){var P=oa[D];if(P.length){var R=0;for(K=P.length;R<
K;R++)P[R].remove();cr.clearArray(P);N(D)}}}};X.prototype.SetEffectParameter=function(D,K,P,R,aa,ca){1===F&&(D=D.toLowerCase(),K=Math.floor(K),oa.hasOwnProperty(D)&&(D=oa[D],0>K||K>=D.length||D[K].setParam(P,R,aa,ca)))};X.prototype.SetListenerObject=function(D){D&&1===F&&(D=D.getFirstPicked())&&(this.listenerTracker.setObject(D),da=D.x,ia=D.y)};X.prototype.SetListenerZ=function(D){this.listenerZ=D};X.prototype.ScheduleNextPlay=function(D){M&&(this.nextPlayTime=D)};X.prototype.UnloadAudio=function(D){var K=
D[1];if(D=this.runtime.getProjectAudioFileUrl(D[0]))if(K=this.getAudioBuffer(D,K,!0))K.release(),cr.arrayFindRemove(S,K)};X.prototype.UnloadAudioByName=function(D,K){D=1===D;if(K=this.runtime.getProjectAudioFileUrl(K))if(K=this.getAudioBuffer(K,D,!0))K.release(),cr.arrayFindRemove(S,K)};X.prototype.UnloadAll=function(){var D;var K=0;for(D=S.length;K<D;++K)S[K].release();cr.clearArray(S)};ha.acts=new X;Y.prototype.Duration=function(D,K){L(K,!0);na.length?D.set_float(na[0].getDuration()):D.set_float(0)};
Y.prototype.PlaybackTime=function(D,K){L(K,!0);na.length?D.set_float(na[0].getPlaybackTime(!0)):D.set_float(0)};Y.prototype.PlaybackRate=function(D,K){L(K,!0);na.length?D.set_float(na[0].getPlaybackRate()):D.set_float(0)};Y.prototype.Volume=function(D,K){L(K,!0);na.length?(K=na[0].getVolume(),D.set_float(e(K))):D.set_float(0)};Y.prototype.MasterVolume=function(D){D.set_float(e(Z))};Y.prototype.EffectCount=function(D,K){K=K.toLowerCase();var P=null;oa.hasOwnProperty(K)&&(P=oa[K]);D.set_int(P?P.length:
0)};Y.prototype.AnalyserFreqBinCount=function(D,K,P){K=K.toLowerCase();P=Math.floor(P);K=ea(K,P);D.set_int(K?K.node.frequencyBinCount:0)};Y.prototype.AnalyserFreqBinAt=function(D,K,P,R){K=K.toLowerCase();P=Math.floor(P);R=Math.floor(R);(K=ea(K,P))?0>R||R>=K.node.frequencyBinCount?D.set_float(0):D.set_float(K.freqBins[R]):D.set_float(0)};Y.prototype.AnalyserPeakLevel=function(D,K,P){K=K.toLowerCase();P=Math.floor(P);(K=ea(K,P))?D.set_float(K.peak):D.set_float(0)};Y.prototype.AnalyserRMSLevel=function(D,
K,P){K=K.toLowerCase();P=Math.floor(P);(K=ea(K,P))?D.set_float(K.rms):D.set_float(0)};Y.prototype.SampleRate=function(D){D.set_int(M?M.sampleRate:0)};Y.prototype.CurrentTime=function(D){D.set_float(M?M.currentTime:cr.performance_now())};ha.exps=new Y})();cr.plugins_.Function=function(b){this.runtime=b};
(function(){function b(){this.name="";this.retVal=0;this.params=[]}function f(){d++;d===a.length&&a.push(new b);return a[d]}function g(){return 0>d?null:a[d]}function n(){}function t(){}function e(){}var c=cr.plugins_.Function.prototype;c.Type=function(h){this.plugin=h;this.runtime=h.runtime};c.Type.prototype.onCreate=function(){};c.Instance=function(h){this.type=h;this.runtime=h.runtime};var a=[],d=-1;c.Instance.prototype.onCreate=function(){var h=this;window.c2_callFunction=function(u,v){var C,
w=f();w.name=u.toLowerCase();w.retVal=0;if(v)for(w.params.length=v.length,u=0,C=v.length;u<C;++u){var r=v[u];w.params[u]="number"===typeof r||"string"===typeof r?r:"boolean"===typeof r?r?1:0:0}else cr.clearArray(w.params);h.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,h,w.name);d--;return w.retVal}};n.prototype.OnFunction=function(h){var u=g();return u?cr.equals_nocase(h,u.name):!1};n.prototype.CompareParam=function(h,u,v){var C=g();if(!C)return!1;h=cr.floor(h);var w=0;0<=h&&h<C.params.length&&
(w=C.params[h]);return cr.do_cmp(w,u,v)};c.cnds=new n;t.prototype.CallFunction=function(h,u){var v=f();v.name=h.toLowerCase();v.retVal=0;cr.shallowAssignArray(v.params,u);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,v.name);d--};t.prototype.SetReturnValue=function(h){var u=g();u&&(u.retVal=h)};t.prototype.CallExpression=function(h){};c.acts=new t;e.prototype.ReturnValue=function(h){if(a.length){var u=d+1;u>=a.length&&(u=a.length-1);u=a[u]}else u=null;u?h.set_any(u.retVal):
h.set_int(0)};e.prototype.ParamCount=function(h){var u=g();u?h.set_int(u.params.length):h.set_int(0)};e.prototype.Param=function(h,u){u=cr.floor(u);var v=g();v?0<=u&&u<v.params.length?h.set_any(v.params[u]):h.set_int(0):h.set_int(0)};e.prototype.Call=function(h,u){var v=f();v.name=u.toLowerCase();v.retVal=0;cr.clearArray(v.params);var C;var w=2;for(C=arguments.length;w<C;w++)v.params.push(arguments[w]);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,v.name);d--;h.set_any(v.retVal)};
c.exps=new e})();cr.plugins_.Keyboard=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(c){c=Math.floor(c);switch(c){case 8:return"backspace";case 9:return"tab";case 13:return"enter";case 16:return"shift";case 17:return"control";case 18:return"alt";case 19:return"pause";case 20:return"capslock";case 27:return"esc";case 33:return"pageup";case 34:return"pagedown";case 35:return"end";case 36:return"home";case 37:return"\u2190";case 38:return"\u2191";case 39:return"\u2192";case 40:return"\u2193";case 45:return"insert";case 46:return"del";
case 91:return"left window key";case 92:return"right window key";case 93:return"select";case 96:return"numpad 0";case 97:return"numpad 1";case 98:return"numpad 2";case 99:return"numpad 3";case 100:return"numpad 4";case 101:return"numpad 5";case 102:return"numpad 6";case 103:return"numpad 7";case 104:return"numpad 8";case 105:return"numpad 9";case 106:return"numpad *";case 107:return"numpad +";case 109:return"numpad -";case 110:return"numpad .";case 111:return"numpad /";case 112:return"F1";case 113:return"F2";
case 114:return"F3";case 115:return"F4";case 116:return"F5";case 117:return"F6";case 118:return"F7";case 119:return"F8";case 120:return"F9";case 121:return"F10";case 122:return"F11";case 123:return"F12";case 144:return"numlock";case 145:return"scroll lock";case 186:return";";case 187:return"=";case 188:return",";case 189:return"-";case 190:return".";case 191:return"/";case 192:return"'";case 219:return"[";case 220:return"\\";case 221:return"]";case 222:return"#";case 223:return"`";default:return String.fromCharCode(c)}}
var n=cr.plugins_.Keyboard.prototype;n.Type=function(c){this.plugin=c;this.runtime=c.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(c){this.type=c;this.runtime=c.runtime;this.keyMap=Array(256);this.typedKeyMap=Array(256);this.usedKeys=Array(256);this.triggerKey=0};var t=n.Instance.prototype;t.onCreate=function(){var c=this;document.addEventListener("keydown",function(a){c.onKeyDown(a)});document.addEventListener("keyup",function(a){c.onKeyUp(a)})};var e=[32,33,34,35,36,37,38,
39,40,44];t.onKeyDown=function(c){var a=!1;window!=window.top&&-1<e.indexOf(c.which)&&(c.preventDefault(),a=!0,c.stopPropagation());if(this.keyMap[c.which])this.usedKeys[c.which]&&!a&&c.preventDefault();else{var d=c.which;this.typedKeyMap[d]=c.key;this.keyMap[d]=!0;this.triggerKey=d;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKey,this);var h=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKey,this),u=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCode,
this);this.runtime.isInUserInputEvent=!1;if(h||u)this.usedKeys[d]=!0,a||c.preventDefault()}};t.onKeyUp=function(c){var a=c.which;this.typedKeyMap[a]=c.key;this.keyMap[a]=!1;this.triggerKey=a;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var d=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),h=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);this.runtime.isInUserInputEvent=
!1;if(d||h||this.usedKeys[c.which])this.usedKeys[a]=!0,c.preventDefault()};t.onWindowBlur=function(){var c;for(c=0;256>c;++c)if(this.keyMap[c]){this.keyMap[c]=!1;this.triggerKey=c;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var a=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),d=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);if(a||d)this.usedKeys[c]=!0}};t.saveToJSON=function(){return{triggerKey:this.triggerKey}};
t.loadFromJSON=function(c){this.triggerKey=c.triggerKey};b.prototype.IsKeyDown=function(c){return this.keyMap[c]};b.prototype.OnKey=function(c){return c===this.triggerKey};b.prototype.OnAnyKey=function(c){return!0};b.prototype.OnAnyKeyReleased=function(c){return!0};b.prototype.OnKeyReleased=function(c){return c===this.triggerKey};b.prototype.IsKeyCodeDown=function(c){c=Math.floor(c);return 0>c||c>=this.keyMap.length?!1:this.keyMap[c]};b.prototype.OnKeyCode=function(c){return c===this.triggerKey};
b.prototype.OnKeyCodeReleased=function(c){return c===this.triggerKey};n.cnds=new b;n.acts=new function(){};f.prototype.TypedKey=function(c){c.set_string(this.typedKeyMap[this.triggerKey]||"")};f.prototype.LastKeyCode=function(c){c.set_int(this.triggerKey)};f.prototype.StringFromKeyCode=function(c,a){c.set_string(g(a))};n.exps=new f})();cr.plugins_.Mouse=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.plugins_.Mouse.prototype;n.Type=function(c){this.plugin=c;this.runtime=c.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(c){this.type=c;this.runtime=c.runtime;this.buttonMap=Array(4);this.triggerDir=this.triggerType=this.triggerButton=this.mouseYcanvas=this.mouseXcanvas=0;this.handled=!1};var t=n.Instance.prototype;t.onCreate=function(){var c=this;document.addEventListener("mousemove",function(d){c.onMouseMove(d)});
document.addEventListener("mousedown",function(d){c.onMouseDown(d)});document.addEventListener("mouseup",function(d){c.onMouseUp(d)});document.addEventListener("dblclick",function(d){c.onDoubleClick(d)});var a=function(d){c.onWheel(d)};document.addEventListener("mousewheel",a,!1);document.addEventListener("DOMMouseScroll",a,!1)};t.onMouseMove=function(c){this.mouseXcanvas=c.pageX-this.runtime.canvas.offsetLeft;this.mouseYcanvas=c.pageY-this.runtime.canvas.offsetTop};t.mouseInGame=function(){return 0<
this.runtime.fullscreen_mode?!0:0<=this.mouseXcanvas&&0<=this.mouseYcanvas&&this.mouseXcanvas<this.runtime.width&&this.mouseYcanvas<this.runtime.height};t.onMouseDown=function(c){this.mouseInGame()&&(this.buttonMap[c.which]=!0,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnAnyClick,this),this.triggerButton=c.which-1,this.triggerType=0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,
this),this.runtime.isInUserInputEvent=!1)};t.onMouseUp=function(c){this.buttonMap[c.which]&&(this.runtime.had_a_click&&!this.runtime.isMobile&&c.preventDefault(),this.runtime.had_a_click=!0,this.buttonMap[c.which]=!1,this.runtime.isInUserInputEvent=!0,this.triggerButton=c.which-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this),this.runtime.isInUserInputEvent=!1)};t.onDoubleClick=function(c){this.mouseInGame()&&(c.preventDefault(),this.runtime.isInUserInputEvent=!0,this.triggerButton=
c.which-1,this.triggerType=1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,this),this.runtime.isInUserInputEvent=!1)};t.onWheel=function(c){this.triggerDir=0>(c.wheelDelta?c.wheelDelta:c.detail?-c.detail:0)?0:1;this.handled=!1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnWheel,this);this.runtime.isInUserInputEvent=!1;this.handled&&cr.isCanvasInputEvent(c)&&c.preventDefault()};
t.onWindowBlur=function(){var c;var a=0;for(c=this.buttonMap.length;a<c;++a)this.buttonMap[a]&&(this.buttonMap[a]=!1,this.triggerButton=a-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this))};t.isMouseOverCanvas=function(){return 0<=this.mouseXcanvas&&0<=this.mouseYcanvas&&this.mouseXcanvas<this.runtime.width&&this.mouseYcanvas<this.runtime.height};b.prototype.OnClick=function(c,a){return c===this.triggerButton&&a===this.triggerType};b.prototype.OnAnyClick=function(){return!0};
b.prototype.IsButtonDown=function(c){return this.buttonMap[c+1]};b.prototype.OnRelease=function(c){return c===this.triggerButton};b.prototype.IsOverObject=function(c){if(this.isMouseOverCanvas()){var a=this.runtime.getCurrentCondition();return cr.xor(this.runtime.testAndSelectCanvasPointOverlap(c,this.mouseXcanvas,this.mouseYcanvas,a.inverted),a.inverted)}};b.prototype.OnObjectClicked=function(c,a,d){if(c!==this.triggerButton||a!==this.triggerType)return!1;if(this.isMouseOverCanvas())return this.runtime.testAndSelectCanvasPointOverlap(d,
this.mouseXcanvas,this.mouseYcanvas,!1)};b.prototype.OnWheel=function(c){this.handled=!0;return c===this.triggerDir};n.cnds=new b;var e=null;f.prototype.SetCursor=function(c){c="auto pointer text crosshair move help wait none".split(" ")[c];e!==c&&(e=c,document.body.style.cursor=c)};f.prototype.SetCursorSprite=function(c){!this.runtime.isMobile&&c&&(c=c.getFirstPicked())&&c.curFrame&&(c=c.curFrame,e!==c&&(e=c,c="url("+c.getDataUri()+") "+Math.round(c.hotspotX*c.width)+" "+Math.round(c.hotspotY*c.height)+
", auto",document.body.style.cursor="",document.body.style.cursor=c))};n.acts=new f;g.prototype.X=function(c,a){if(cr.is_undefined(a)){a=this.runtime.getLayerByNumber(0);var d=a.scale;var h=a.zoomRate;var u=a.parallaxX;var v=a.angle;a.scale=1;a.zoomRate=1;a.parallaxX=1;a.angle=0;c.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0));a.scale=d;a.zoomRate=h;a.parallaxX=u;a.angle=v}else(a=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?c.set_float(a.canvasToLayer(this.mouseXcanvas,
this.mouseYcanvas,!0)):c.set_float(0)};g.prototype.Y=function(c,a){if(cr.is_undefined(a)){a=this.runtime.getLayerByNumber(0);var d=a.scale;var h=a.zoomRate;var u=a.parallaxY;var v=a.angle;a.scale=1;a.zoomRate=1;a.parallaxY=1;a.angle=0;c.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1));a.scale=d;a.zoomRate=h;a.parallaxY=u;a.angle=v}else(a=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?c.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,
!1)):c.set_float(0)};g.prototype.AbsoluteX=function(c){c.set_float(this.mouseXcanvas)};g.prototype.AbsoluteY=function(c){c.set_float(this.mouseYcanvas)};n.exps=new g})();cr.plugins_.Touch=function(b){this.runtime=b};
(function(){function b(l){h=l.x;u=l.y;v=l.z}function f(l,y,z,O){var Q=C.length?C.pop():new g;Q.init(l,y,z,O);return Q}function g(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function n(l){return l.sourceCapabilities&&l.sourceCapabilities.firesTouchEvents||l.originalEvent&&l.originalEvent.sourceCapabilities&&l.originalEvent.sourceCapabilities.firesTouchEvents}function t(){}function e(){}
function c(){}var a=cr.plugins_.Touch.prototype;a.Type=function(l){this.plugin=l;this.runtime=l.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(l){this.type=l;this.runtime=l.runtime;this.touches=[];this.mouseDown=!1};var d=a.Instance.prototype;d.findTouch=function(l){var y;var z=0;for(y=this.touches.length;z<y;z++)if(this.touches[z].id===l)return z;return-1};var h=0,u=0,v=0,C=[];g.prototype.init=function(l,y,z,O){var Q=cr.performance_now();this.starttime=this.lasttime=this.time=
Q;this.startx=l;this.starty=y;this.x=l;this.y=y;this.lastx=l;this.lasty=y;this.pressure=this.height=this.width=0;this.id=z;this.startindex=O;this.tooFarForHold=this.triggeredHold=!1};g.prototype.update=function(l,y,z,O,Q,I){this.lasttime=this.time;this.time=l;this.lastx=this.x;this.lasty=this.y;this.x=y;this.y=z;this.width=O;this.height=Q;this.pressure=I;!this.tooFarForHold&&15<=cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.tooFarForHold=!0)};g.prototype.maybeTriggerHold=function(l,
y){!this.triggeredHold&&500<=cr.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,l.trigger_index=this.startindex,l.trigger_id=this.id,l.getTouchIndex=y,l.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGesture,l),l.curTouchX=this.x,l.curTouchY=this.y,l.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject,l),l.getTouchIndex=0)};var w=-1E3,r=-1E3,x=-1E4;g.prototype.maybeTriggerTap=function(l,
y){if(!this.triggeredHold){var z=cr.performance_now();333>=z-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(l.trigger_index=this.startindex,l.trigger_id=this.id,l.getTouchIndex=y,666>=z-x&&25>cr.distanceTo(w,r,this.x,this.y)?(l.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,l),l.curTouchX=this.x,l.curTouchY=this.y,l.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,l),r=w=-1E3,x=-1E4):(l.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGesture,
l),l.curTouchX=this.x,l.curTouchY=this.y,l.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,l),w=this.x,r=this.y,x=z),l.getTouchIndex=0)}};d.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.getTouchIndex=this.trigger_permission=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=
this.properties[0];var l=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,y=document,z=this;"undefined"!==typeof PointerEvent?(l.addEventListener("pointerdown",function(p){z.onPointerStart(p)},!1),l.addEventListener("pointermove",function(p){z.onPointerMove(p)},!1),y.addEventListener("pointerup",function(p){z.onPointerEnd(p,!1)},!1),y.addEventListener("pointercancel",function(p){z.onPointerEnd(p,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(p){p.preventDefault()},
!1),document.addEventListener("MSGestureHold",function(p){p.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(p){p.preventDefault()},!1),document.addEventListener("gesturehold",function(p){p.preventDefault()},!1))):window.navigator.msPointerEnabled?(l.addEventListener("MSPointerDown",function(p){z.onPointerStart(p)},!1),l.addEventListener("MSPointerMove",function(p){z.onPointerMove(p)},!1),y.addEventListener("MSPointerUp",function(p){z.onPointerEnd(p,!1)},!1),y.addEventListener("MSPointerCancel",
function(p){z.onPointerEnd(p,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(p){p.preventDefault()},!1),document.addEventListener("MSGestureHold",function(p){p.preventDefault()},!1))):(l.addEventListener("touchstart",function(p){z.onTouchStart(p)},!1),l.addEventListener("touchmove",function(p){z.onTouchMove(p)},!1),y.addEventListener("touchend",function(p){z.onTouchEnd(p,!1)},!1),y.addEventListener("touchcancel",function(p){z.onTouchEnd(p,!0)},!1));if(this.isWindows8){var O=
function(p){p=p.reading;z.acc_x=p.accelerationX;z.acc_y=p.accelerationY;z.acc_z=p.accelerationZ},Q=function(p){p=p.reading;z.orient_alpha=p.yawDegrees;z.orient_beta=p.pitchDegrees;z.orient_gamma=p.rollDegrees},I=Windows.Devices.Sensors.Accelerometer.getDefault();I&&(I.reportInterval=Math.max(I.minimumReportInterval,16),I.addEventListener("readingchanged",O));var k=Windows.Devices.Sensors.Inclinometer.getDefault();k&&(k.reportInterval=Math.max(k.minimumReportInterval,16),k.addEventListener("readingchanged",
Q));document.addEventListener("visibilitychange",function(p){document.hidden||document.msHidden?(I&&I.removeEventListener("readingchanged",O),k&&k.removeEventListener("readingchanged",Q)):(I&&I.addEventListener("readingchanged",O),k&&k.addEventListener("readingchanged",Q))},!1)}else window.addEventListener("deviceorientation",function(p){z.orient_alpha=p.alpha||0;z.orient_beta=p.beta||0;z.orient_gamma=p.gamma||0},!1),window.addEventListener("devicemotion",function(p){p.accelerationIncludingGravity&&
(z.acc_g_x=p.accelerationIncludingGravity.x||0,z.acc_g_y=p.accelerationIncludingGravity.y||0,z.acc_g_z=p.accelerationIncludingGravity.z||0);p.acceleration&&(z.acc_x=p.acceleration.x||0,z.acc_y=p.acceleration.y||0,z.acc_z=p.acceleration.z||0)},!1);this.useMouseInput&&(document.addEventListener("mousemove",function(p){z.onMouseMove(p)}),document.addEventListener("mousedown",function(p){z.onMouseDown(p)}),document.addEventListener("mouseup",function(p){z.onMouseUp(p)}));!this.runtime.isiOS&&this.runtime.isCordova&&
navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(b,null,{frequency:40});this.runtime.tick2Me(this)};d.onPointerMove=function(l){if(l.pointerType!==l.MSPOINTER_TYPE_MOUSE&&"mouse"!==l.pointerType){l.preventDefault&&l.preventDefault();var y=this.findTouch(l.pointerId),z=cr.performance_now();0<=y&&(y=this.touches[y],2>z-y.time||y.update(z,l.pageX-this.runtime.canvas.offsetLeft,l.pageY-this.runtime.canvas.offsetTop,l.width||0,l.height||0,l.pressure||
0))}};d.onPointerStart=function(l){if(l.pointerType!==l.MSPOINTER_TYPE_MOUSE&&"mouse"!==l.pointerType&&-1===this.findTouch(l.pointerId)){l.preventDefault&&cr.isCanvasInputEvent(l)&&l.preventDefault();var y=l.pageX-this.runtime.canvas.offsetLeft,z=l.pageY-this.runtime.canvas.offsetTop;cr.performance_now();this.trigger_index=this.touches.length;this.trigger_id=l.pointerId;this.touches.push(f(y,z,l.pointerId,this.trigger_index));this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,
this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=y;this.curTouchY=z;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this);this.runtime.isInUserInputEvent=!1}};d.onPointerEnd=function(l,y){l.pointerType!==l.MSPOINTER_TYPE_MOUSE&&"mouse"!==l.pointerType&&(l.preventDefault&&cr.isCanvasInputEvent(l)&&l.preventDefault(),l=this.findTouch(l.pointerId),this.trigger_index=0<=l?this.touches[l].startindex:-1,this.trigger_id=0<=l?this.touches[l].id:
-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),0<=l&&(y||this.touches[l].maybeTriggerTap(this,l),100>C.length&&C.push(this.touches[l]),this.touches.splice(l,1)),this.runtime.isInUserInputEvent=!1)};d.onTouchMove=function(l){l.preventDefault&&l.preventDefault();var y=cr.performance_now(),z;var O=0;for(z=l.changedTouches.length;O<z;O++){var Q=l.changedTouches[O];var I=
this.findTouch(Q.identifier);if(0<=I){var k=this.runtime.canvas.offsetLeft,p=this.runtime.canvas.offsetTop;I=this.touches[I];2>y-I.time||I.update(y,Q.pageX-k,Q.pageY-p,2*(Q.radiusX||Q.webkitRadiusX||Q.mozRadiusX||Q.msRadiusX||0),2*(Q.radiusY||Q.webkitRadiusY||Q.mozRadiusY||Q.msRadiusY||0),Q.force||Q.webkitForce||Q.mozForce||Q.msForce||0)}}};d.onTouchStart=function(l){l.preventDefault&&cr.isCanvasInputEvent(l)&&l.preventDefault();var y=this.runtime.canvas.offsetLeft,z=this.runtime.canvas.offsetTop;
cr.performance_now();this.runtime.isInUserInputEvent=!0;var O;var Q=0;for(O=l.changedTouches.length;Q<O;Q++){var I=l.changedTouches[Q];var k=this.findTouch(I.identifier);if(-1===k){k=I.pageX-y;var p=I.pageY-z;this.trigger_index=this.touches.length;this.trigger_id=I.identifier;this.touches.push(f(k,p,I.identifier,this.trigger_index));this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=k;
this.curTouchY=p;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this)}}this.runtime.isInUserInputEvent=!1};d.onTouchEnd=function(l,y){l.preventDefault&&cr.isCanvasInputEvent(l)&&l.preventDefault();this.runtime.isInUserInputEvent=!0;var z;var O=0;for(z=l.changedTouches.length;O<z;O++){var Q=l.changedTouches[O];Q=this.findTouch(Q.identifier);0<=Q&&(this.trigger_index=this.touches[Q].startindex,this.trigger_id=this.touches[Q].id,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,
this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),y||this.touches[Q].maybeTriggerTap(this,Q),100>C.length&&C.push(this.touches[Q]),this.touches.splice(Q,1))}this.runtime.isInUserInputEvent=!1};d.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==v?90*v:this.orient_alpha};d.getBeta=function(){return this.runtime.isCordova&&0===this.orient_beta&&0!==u?90*u:this.orient_beta};d.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&
0!==h?90*h:this.orient_gamma};d.onMouseDown=function(l){n(l)||(this.onTouchStart({changedTouches:[{pageX:l.pageX,pageY:l.pageY,identifier:0}]}),this.mouseDown=!0)};d.onMouseMove=function(l){if(this.mouseDown&&!n(l))this.onTouchMove({changedTouches:[{pageX:l.pageX,pageY:l.pageY,identifier:0}]})};d.onMouseUp=function(l){l.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&l.preventDefault();this.runtime.had_a_click=!0;n(l)||(this.onTouchEnd({changedTouches:[{pageX:l.pageX,pageY:l.pageY,
identifier:0}]}),this.mouseDown=!1)};d.isClientPosOverCanvas=function(l,y){return 0<=l&&0<=y&&l<this.runtime.width&&y<this.runtime.height};d.tick2=function(){var l,y=cr.performance_now();var z=0;for(l=this.touches.length;z<l;++z){var O=this.touches[z];O.time<=y-50&&(O.lasttime=y);O.maybeTriggerHold(this,z)}};t.prototype.OnTouchStart=function(){return!0};t.prototype.OnTouchEnd=function(){return!0};t.prototype.IsInTouch=function(){return this.touches.length};t.prototype.OnTouchObject=function(l){return l&&
this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(l,this.curTouchX,this.curTouchY,!1):!1};var A=[];t.prototype.IsTouchingObject=function(l){if(!l)return!1;var y=l.getCurrentSol(),z=y.getObjects(),O,Q;var I=0;for(O=z.length;I<O;I++){var k=z[I];k.update_bbox();var p=0;for(Q=this.touches.length;p<Q;p++){var H=this.touches[p];if(this.isClientPosOverCanvas(H.x,H.y)){var m=k.layer.canvasToLayer(H.x,H.y,!0);H=k.layer.canvasToLayer(H.x,H.y,!1);if(k.contains_pt(m,
H)){A.push(k);break}}}}return A.length?(y.select_all=!1,cr.shallowAssignArray(y.instances,A),l.applySolToContainer(),cr.clearArray(A),!0):!1};t.prototype.CompareTouchSpeed=function(l,y,z){l=Math.floor(l);if(0>l||l>=this.touches.length)return!1;var O=this.touches[l];l=cr.distanceTo(O.x,O.y,O.lastx,O.lasty);O=(O.time-O.lasttime)/1E3;var Q=0;0<O&&(Q=l/O);return cr.do_cmp(Q,y,z)};t.prototype.OrientationSupported=function(){return"undefined"!==typeof window.DeviceOrientationEvent};t.prototype.MotionSupported=
function(){return"undefined"!==typeof window.DeviceMotionEvent};t.prototype.CompareOrientation=function(l,y,z){l=0===l?this.getAlpha():1===l?this.getBeta():this.getGamma();return cr.do_cmp(l,y,z)};t.prototype.CompareAcceleration=function(l,y,z){var O=0;0===l?O=this.acc_g_x:1===l?O=this.acc_g_y:2===l?O=this.acc_g_z:3===l?O=this.acc_x:4===l?O=this.acc_y:5===l&&(O=this.acc_z);return cr.do_cmp(O,y,z)};t.prototype.OnNthTouchStart=function(l){l=Math.floor(l);return l===this.trigger_index};t.prototype.OnNthTouchEnd=
function(l){l=Math.floor(l);return l===this.trigger_index};t.prototype.HasNthTouch=function(l){l=Math.floor(l);return this.touches.length>=l+1};t.prototype.OnHoldGesture=function(){return!0};t.prototype.OnTapGesture=function(){return!0};t.prototype.OnDoubleTapGesture=function(){return!0};t.prototype.OnHoldGestureObject=function(l){return l&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(l,this.curTouchX,this.curTouchY,!1):!1};t.prototype.OnTapGestureObject=
function(l){return l&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(l,this.curTouchX,this.curTouchY,!1):!1};t.prototype.OnDoubleTapGestureObject=function(l){return l&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(l,this.curTouchX,this.curTouchY,!1):!1};t.prototype.OnPermissionGranted=function(l){return this.trigger_permission===l};t.prototype.OnPermissionDenied=function(l){return this.trigger_permission===
l};a.cnds=new t;e.prototype.RequestPermission=function(l){var y=this,z=Promise.resolve(!0);0===l?window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission&&(z=window.DeviceOrientationEvent.requestPermission().then(function(O){return"granted"===O})):window.DeviceMotionEvent&&window.DeviceMotionEvent.requestPermission&&(z=window.DeviceMotionEvent.requestPermission().then(function(O){return"granted"===O}));z.then(function(O){y.trigger_permission=l;O?y.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionGranted,
y):y.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionDenied,y)})};a.acts=new e;c.prototype.TouchCount=function(l){l.set_int(this.touches.length)};c.prototype.X=function(l,y){var z=this.getTouchIndex;if(0>z||z>=this.touches.length)l.set_float(0);else if(cr.is_undefined(y)){y=this.runtime.getLayerByNumber(0);var O=y.scale;var Q=y.zoomRate;var I=y.parallaxX;var k=y.angle;y.scale=1;y.zoomRate=1;y.parallaxX=1;y.angle=0;l.set_float(y.canvasToLayer(this.touches[z].x,this.touches[z].y,!0));y.scale=
O;y.zoomRate=Q;y.parallaxX=I;y.angle=k}else(y=cr.is_number(y)?this.runtime.getLayerByNumber(y):this.runtime.getLayerByName(y))?l.set_float(y.canvasToLayer(this.touches[z].x,this.touches[z].y,!0)):l.set_float(0)};c.prototype.XAt=function(l,y,z){y=Math.floor(y);if(0>y||y>=this.touches.length)l.set_float(0);else if(cr.is_undefined(z)){z=this.runtime.getLayerByNumber(0);var O=z.scale;var Q=z.zoomRate;var I=z.parallaxX;var k=z.angle;z.scale=1;z.zoomRate=1;z.parallaxX=1;z.angle=0;l.set_float(z.canvasToLayer(this.touches[y].x,
this.touches[y].y,!0));z.scale=O;z.zoomRate=Q;z.parallaxX=I;z.angle=k}else(z=cr.is_number(z)?this.runtime.getLayerByNumber(z):this.runtime.getLayerByName(z))?l.set_float(z.canvasToLayer(this.touches[y].x,this.touches[y].y,!0)):l.set_float(0)};c.prototype.XForID=function(l,y,z){y=this.findTouch(y);if(0>y)l.set_float(0);else if(y=this.touches[y],cr.is_undefined(z)){z=this.runtime.getLayerByNumber(0);var O=z.scale;var Q=z.zoomRate;var I=z.parallaxX;var k=z.angle;z.scale=1;z.zoomRate=1;z.parallaxX=1;
z.angle=0;l.set_float(z.canvasToLayer(y.x,y.y,!0));z.scale=O;z.zoomRate=Q;z.parallaxX=I;z.angle=k}else(z=cr.is_number(z)?this.runtime.getLayerByNumber(z):this.runtime.getLayerByName(z))?l.set_float(z.canvasToLayer(y.x,y.y,!0)):l.set_float(0)};c.prototype.Y=function(l,y){var z=this.getTouchIndex;if(0>z||z>=this.touches.length)l.set_float(0);else if(cr.is_undefined(y)){y=this.runtime.getLayerByNumber(0);var O=y.scale;var Q=y.zoomRate;var I=y.parallaxY;var k=y.angle;y.scale=1;y.zoomRate=1;y.parallaxY=
1;y.angle=0;l.set_float(y.canvasToLayer(this.touches[z].x,this.touches[z].y,!1));y.scale=O;y.zoomRate=Q;y.parallaxY=I;y.angle=k}else(y=cr.is_number(y)?this.runtime.getLayerByNumber(y):this.runtime.getLayerByName(y))?l.set_float(y.canvasToLayer(this.touches[z].x,this.touches[z].y,!1)):l.set_float(0)};c.prototype.YAt=function(l,y,z){y=Math.floor(y);if(0>y||y>=this.touches.length)l.set_float(0);else if(cr.is_undefined(z)){z=this.runtime.getLayerByNumber(0);var O=z.scale;var Q=z.zoomRate;var I=z.parallaxY;
var k=z.angle;z.scale=1;z.zoomRate=1;z.parallaxY=1;z.angle=0;l.set_float(z.canvasToLayer(this.touches[y].x,this.touches[y].y,!1));z.scale=O;z.zoomRate=Q;z.parallaxY=I;z.angle=k}else(z=cr.is_number(z)?this.runtime.getLayerByNumber(z):this.runtime.getLayerByName(z))?l.set_float(z.canvasToLayer(this.touches[y].x,this.touches[y].y,!1)):l.set_float(0)};c.prototype.YForID=function(l,y,z){y=this.findTouch(y);if(0>y)l.set_float(0);else if(y=this.touches[y],cr.is_undefined(z)){z=this.runtime.getLayerByNumber(0);
var O=z.scale;var Q=z.zoomRate;var I=z.parallaxY;var k=z.angle;z.scale=1;z.zoomRate=1;z.parallaxY=1;z.angle=0;l.set_float(z.canvasToLayer(y.x,y.y,!1));z.scale=O;z.zoomRate=Q;z.parallaxY=I;z.angle=k}else(z=cr.is_number(z)?this.runtime.getLayerByNumber(z):this.runtime.getLayerByName(z))?l.set_float(z.canvasToLayer(y.x,y.y,!1)):l.set_float(0)};c.prototype.AbsoluteX=function(l){this.touches.length?l.set_float(this.touches[0].x):l.set_float(0)};c.prototype.AbsoluteXAt=function(l,y){y=Math.floor(y);0>y||
y>=this.touches.length?l.set_float(0):l.set_float(this.touches[y].x)};c.prototype.AbsoluteXForID=function(l,y){y=this.findTouch(y);0>y?l.set_float(0):l.set_float(this.touches[y].x)};c.prototype.AbsoluteY=function(l){this.touches.length?l.set_float(this.touches[0].y):l.set_float(0)};c.prototype.AbsoluteYAt=function(l,y){y=Math.floor(y);0>y||y>=this.touches.length?l.set_float(0):l.set_float(this.touches[y].y)};c.prototype.AbsoluteYForID=function(l,y){y=this.findTouch(y);0>y?l.set_float(0):l.set_float(this.touches[y].y)};
c.prototype.SpeedAt=function(l,y){y=Math.floor(y);if(0>y||y>=this.touches.length)l.set_float(0);else{var z=this.touches[y];y=cr.distanceTo(z.x,z.y,z.lastx,z.lasty);z=(z.time-z.lasttime)/1E3;0>=z?l.set_float(0):l.set_float(y/z)}};c.prototype.SpeedForID=function(l,y){y=this.findTouch(y);if(0>y)l.set_float(0);else{var z=this.touches[y];y=cr.distanceTo(z.x,z.y,z.lastx,z.lasty);z=(z.time-z.lasttime)/1E3;0>=z?l.set_float(0):l.set_float(y/z)}};c.prototype.AngleAt=function(l,y){y=Math.floor(y);0>y||y>=this.touches.length?
l.set_float(0):(y=this.touches[y],l.set_float(cr.to_degrees(cr.angleTo(y.lastx,y.lasty,y.x,y.y))))};c.prototype.AngleForID=function(l,y){y=this.findTouch(y);0>y?l.set_float(0):(y=this.touches[y],l.set_float(cr.to_degrees(cr.angleTo(y.lastx,y.lasty,y.x,y.y))))};c.prototype.Alpha=function(l){l.set_float(this.getAlpha())};c.prototype.Beta=function(l){l.set_float(this.getBeta())};c.prototype.Gamma=function(l){l.set_float(this.getGamma())};c.prototype.AccelerationXWithG=function(l){l.set_float(this.acc_g_x)};
c.prototype.AccelerationYWithG=function(l){l.set_float(this.acc_g_y)};c.prototype.AccelerationZWithG=function(l){l.set_float(this.acc_g_z)};c.prototype.AccelerationX=function(l){l.set_float(this.acc_x)};c.prototype.AccelerationY=function(l){l.set_float(this.acc_y)};c.prototype.AccelerationZ=function(l){l.set_float(this.acc_z)};c.prototype.TouchIndex=function(l){l.set_int(this.trigger_index)};c.prototype.TouchID=function(l){l.set_float(this.trigger_id)};c.prototype.WidthForID=function(l,y){y=this.findTouch(y);
0>y?l.set_float(0):l.set_float(this.touches[y].width)};c.prototype.HeightForID=function(l,y){y=this.findTouch(y);0>y?l.set_float(0):l.set_float(this.touches[y].height)};c.prototype.PressureForID=function(l,y){y=this.findTouch(y);0>y?l.set_float(0):l.set_float(this.touches[y].pressure)};a.exps=new c})();cr.plugins_.NodeWebkit=function(b){this.runtime=b};
(function(){function b(z,O){var Q=document.createElement("input");Q.type="file";Q.style.display="none";Q.id=z;O&&Q.setAttribute(O,"");document.body.appendChild(Q);return Q}function f(){}function g(){}function n(){}var t=!1,e=null,c=null,a=null,d=null,h=null,u="",v="",C="",w="\\",r=[],x="",A="",l=cr.plugins_.NodeWebkit.prototype;l.Type=function(z){this.plugin=z;this.runtime=z.runtime};l.Type.prototype.onCreate=function(){};l.Instance=function(z){this.type=z;this.runtime=z.runtime};var y=l.Instance.prototype;
y.onCreate=function(){t=this.runtime.isNWjs;var z=this;if(t){e=require("path");c=require("fs");d=require("child_process");h=window.process||nw.process;"win32"!==h.platform&&(w="/");u=e.dirname(h.execPath)+w;v=(h.env.HOME||h.env.HOMEPATH||h.env.USERPROFILE)+w;a=window.nwgui;C=h.mainModule.filename;var O=Math.max(C.lastIndexOf("/"),C.lastIndexOf("\\"));-1!==O&&(C=C.substr(0,O+1));window.ondrop=function(p){p.preventDefault();for(var H=0;H<p.dataTransfer.files.length;++H)x=p.dataTransfer.files[H].path,
z.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnFileDrop,z);return!1};var Q=b("c2nwOpenFileDialog");Q.onchange=function(p){A=Q.value;z.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnOpenDlg,z);try{Q.value=null}catch(H){}};Q.oncancel=function(){z.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnOpenDlgCancel,z)};var I=b("c2nwChooseFolderDialog","nwdirectory");I.onchange=function(p){A=I.value;z.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnFolderDlg,z);try{I.value=
null}catch(H){}};I.oncancel=function(){z.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnFolderDlgCancel,z)};var k=b("c2nwSaveDialog","nwsaveas");k.onchange=function(p){A=k.value;z.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnSaveDlg,z);try{k.value=null}catch(H){}};k.oncancel=function(){z.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnSaveDlgCancel,z)}}};y.onDestroy=function(){};y.saveToJSON=function(){return{}};y.loadFromJSON=function(z){};f.prototype.PathExists=function(z){return t?
c.existsSync(z):!1};f.prototype.OnFileDrop=function(){return!0};f.prototype.OnOpenDlg=function(){return!0};f.prototype.OnFolderDlg=function(){return!0};f.prototype.OnSaveDlg=function(){return!0};f.prototype.OnOpenDlgCancel=function(){return!0};f.prototype.OnFolderDlgCancel=function(){return!0};f.prototype.OnSaveDlgCancel=function(){return!0};l.cnds=new f;g.prototype.WriteTextFile=function(z,O){if(t)try{c.writeFileSync(z,O,{encoding:"utf8"})}catch(Q){}};g.prototype.RenameFile=function(z,O){if(t)try{c.renameSync(z,
O)}catch(Q){}};g.prototype.DeleteFile=function(z){if(t)try{c.unlinkSync(z)}catch(O){}};g.prototype.CopyFile=function(z,O){if(t&&z!==O)try{var Q=c.readFileSync(z,{flags:"rb"});c.writeFileSync(O,Q,{flags:"wb"})}catch(I){}};g.prototype.MoveFile=function(z,O){if(t&&z!==O)try{var Q=c.readFileSync(z,{flags:"rb"});c.writeFileSync(O,Q,{flags:"wb"});c.existsSync(O)&&c.unlinkSync(z)}catch(I){}};g.prototype.RunFile=function(z){t&&d.exec(z,function(){})};g.prototype.ShellOpen=function(z){t&&nw.Shell.openItem(z)};
g.prototype.OpenBrowser=function(z){t&&nw.Shell.openExternal(z)};g.prototype.CreateFolder=function(z){if(t)try{c.mkdirSync(z)}catch(O){}};g.prototype.AppendFile=function(z,O){if(t)try{c.appendFileSync(z,O,{encoding:"utf8"})}catch(Q){}};g.prototype.ListFiles=function(z){if(t){try{r=c.readdirSync(z)}catch(O){r=[],console.warn("Error listing files at '"+z+"': ",O)}r||(r=[])}};g.prototype.ShowOpenDlg=function(z){if(t){var O=document.getElementById("c2nwOpenFileDialog");O.setAttribute("accept",z);O.click()}};
g.prototype.ShowFolderDlg=function(z){t&&document.getElementById("c2nwChooseFolderDialog").click()};g.prototype.ShowSaveDlg=function(z){if(t){var O=document.getElementById("c2nwSaveDialog");O.setAttribute("accept",z);O.click()}};g.prototype.SetWindowX=function(z){t&&a&&(a.Window.get().x=z)};g.prototype.SetWindowY=function(z){t&&a&&(a.Window.get().y=z)};g.prototype.SetWindowWidth=function(z){t&&a&&(a.Window.get().width=z)};g.prototype.SetWindowHeight=function(z){t&&a&&(a.Window.get().height=z)};g.prototype.SetWindowTitle=
function(z){t&&a&&(a.Window.get().title=z,document.title=z)};g.prototype.WindowMinimize=function(){if(t&&a){var z=a.Window.get();setTimeout(function(){z.minimize()},100)}};g.prototype.WindowMaximize=function(){if(t&&a){var z=a.Window.get();setTimeout(function(){z.maximize()},100)}};g.prototype.WindowUnmaximize=function(){if(t&&a){var z=a.Window.get();setTimeout(function(){z.unmaximize()},100)}};g.prototype.WindowRestore=function(){if(t&&a){var z=a.Window.get();setTimeout(function(){z.restore()},100)}};
g.prototype.WindowRequestAttention=function(z){t&&a&&a.Window.get().requestAttention(z?3:0)};g.prototype.WindowSetMaxSize=function(z,O){t&&a&&a.Window.get().setMaximumSize(z,O)};g.prototype.WindowSetMinSize=function(z,O){t&&a&&a.Window.get().setMinimumSize(z,O)};g.prototype.WindowSetResizable=function(z){t&&a&&a.Window.get().setResizable(0!==z)};g.prototype.WindowSetAlwaysOnTop=function(z){t&&a&&a.Window.get().setAlwaysOnTop(0!==z)};g.prototype.ShowDevTools=function(){t&&a&&a.Window.get().showDevTools()};
g.prototype.SetClipboardText=function(z){t&&a&&a.Clipboard.get().set(z)};g.prototype.ClearClipboard=function(){t&&a&&a.Clipboard.get().clear()};l.acts=new g;n.prototype.AppFolder=function(z){z.set_string(u)};n.prototype.AppFolderURL=function(z){z.set_string("file://"+u)};n.prototype.ProjectFilesFolder=function(z){z.set_string(C)};n.prototype.ProjectFilesFolderURL=function(z){z.set_string("file://"+C)};n.prototype.UserFolder=function(z){z.set_string(v)};n.prototype.ReadFile=function(z,O){if(t){var Q=
"";try{Q=c.readFileSync(O,{encoding:"utf8"})}catch(I){}z.set_string(Q)}else z.set_string("")};n.prototype.FileSize=function(z,O){if(t){var Q=0;try{var I=c.statSync(O);I&&(Q=I.size||0)}catch(k){}z.set_int(Q)}else z.set_int(0)};n.prototype.ListCount=function(z){z.set_int(r.length)};n.prototype.ListAt=function(z,O){O=Math.floor(O);0>O||O>=r.length?z.set_string(""):z.set_string(r[O])};n.prototype.DroppedFile=function(z){z.set_string(x)};n.prototype.ChosenPath=function(z){z.set_string(A)};n.prototype.WindowX=
function(z){z.set_int(t&&a?a.Window.get().x:0)};n.prototype.WindowY=function(z){z.set_int(t&&a?a.Window.get().y:0)};n.prototype.WindowWidth=function(z){z.set_int(t&&a?a.Window.get().width:0)};n.prototype.WindowHeight=function(z){z.set_int(t&&a?a.Window.get().height:0)};n.prototype.WindowTitle=function(z){z.set_string(t&&a?a.Window.get().title||"":0)};n.prototype.ClipboardText=function(z){z.set_string(t&&a?a.Clipboard.get().get()||"":0)};n.prototype.ArgumentCount=function(z){z.set_int(t?nw.App.argv.length:
0)};n.prototype.ArgumentAt=function(z,O){if(t){O=Math.floor(O);var Q=nw.App.argv;0>O||O>=Q.length?z.set_string(""):z.set_string(Q[O])}else z.set_string("")};l.exps=new n})();cr.plugins_.Browser=function(b){this.runtime=b};
(function(){function b(){d&&h&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(function(A){u.onSWMessage(A)})}function f(){if(!C&&navigator.getBattery){var A=navigator.getBattery();C=!0;A&&A.then(function(l){v=l})}}function g(){}function n(){}function t(A){console&&console.warn&&console.warn("Fullscreen request failed: ",A);r.setSize(window.innerWidth,window.innerHeight)}function e(){}var c=cr.plugins_.Browser.prototype;c.Type=function(A){this.plugin=A;this.runtime=A.runtime};
var a=c.Type.prototype;a.onCreate=function(){};var d=!1,h=!1;document.addEventListener("DOMContentLoaded",function(){if(window.C3_RegisterSW&&navigator.serviceWorker){var A=document.createElement("script");A.onload=function(){d=!0;b()};A.src="offlineclient.js";document.head.appendChild(A)}});var u=null;a.onAppBegin=function(){h=!0;b()};c.Instance=function(A){this.type=A;this.runtime=A.runtime};a=c.Instance.prototype;a.onCreate=function(){var A=this;window.addEventListener("resize",function(){A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnResize,
A)});u=this;"undefined"!==typeof navigator.onLine&&(window.addEventListener("online",function(){A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOnline,A)}),window.addEventListener("offline",function(){A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOffline,A)}));document.addEventListener("backbutton",function(){A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,A)});document.addEventListener("menubutton",function(){A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,
A)});document.addEventListener("searchbutton",function(){A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnSearchButton,A)});document.addEventListener("tizenhwkey",function(l){switch(l.keyName){case "back":var y=A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,A);!y&&window.tizen&&window.tizen.application.getCurrentApplication().exit();break;case "menu":(y=A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,A))||l.preventDefault()}});this.runtime.isWindows10&&"undefined"!==
typeof Windows?Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",function(l){A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,A)&&(l.handled=!0)}):this.runtime.isWinJS&&WinJS.Application&&(WinJS.Application.onbackclick=function(l){return!!A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,A)});this.runtime.addSuspendCallback(function(l){l?A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageHidden,A):A.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageVisible,
A)});this.is_arcade="undefined"!==typeof window.is_scirra_arcade};a.onSWMessage=function(A){A=A.data.type;"downloading-update"===A?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateFound,this):"update-ready"===A||"update-pending"===A?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,this):"offline-ready"===A&&this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOfflineReady,this)};var v=null,C=!1;g.prototype.CookiesEnabled=function(){return navigator?navigator.cookieEnabled:
!1};g.prototype.IsOnline=function(){return navigator?navigator.onLine:!1};g.prototype.HasJava=function(){return navigator?navigator.javaEnabled():!1};g.prototype.OnOnline=function(){return!0};g.prototype.OnOffline=function(){return!0};g.prototype.IsDownloadingUpdate=function(){return!1};g.prototype.PageVisible=function(){return!this.runtime.isSuspended};g.prototype.OnPageVisible=function(){return!0};g.prototype.OnPageHidden=function(){return!0};g.prototype.OnResize=function(){return!0};g.prototype.IsFullscreen=
function(){return!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen)};g.prototype.OnBackButton=function(){return!0};g.prototype.OnMenuButton=function(){return!0};g.prototype.OnSearchButton=function(){return!0};g.prototype.IsMetered=function(){var A=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return A?!!A.metered:!1};g.prototype.IsCharging=function(){var A=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(A)return!!A.charging;
f();return v?!!v.charging:!0};g.prototype.IsPortraitLandscape=function(A){return(window.innerWidth<=window.innerHeight?0:1)===A};g.prototype.SupportsFullscreen=function(){if(this.runtime.isNWjs)return!0;var A=this.runtime.canvas;return!!(A.requestFullscreen||A.mozRequestFullScreen||A.msRequestFullscreen||A.webkitRequestFullScreen)};g.prototype.OnUpdateFound=function(){return!0};g.prototype.OnUpdateReady=function(){return!0};g.prototype.OnOfflineReady=function(){return!0};c.cnds=new g;n.prototype.Alert=
function(A){alert(A.toString())};n.prototype.Close=function(){window.tizen?window.tizen.application.getCurrentApplication().exit():navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():this.is_arcade||window.close()};n.prototype.Focus=function(){this.runtime.isNWjs?nw.Window.get().focus():this.is_arcade||window.focus()};n.prototype.Blur=function(){this.runtime.isNWjs?nw.Window.get().blur():this.is_arcade||window.blur()};
n.prototype.GoBack=function(){navigator.app&&navigator.app.backHistory?navigator.app.backHistory():!this.is_arcade&&window.back&&window.back()};n.prototype.GoForward=function(){!this.is_arcade&&window.forward&&window.forward()};n.prototype.GoHome=function(){!this.is_arcade&&window.home&&window.home()};n.prototype.GoToURL=function(A,l){this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(A)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(A,{openExternal:!0}):
this.runtime.isCordova?window.open(A,"_system"):this.runtime.isPreview?window.open(A,"_blank"):this.is_arcade||(2!==l||this.is_arcade?1!==l||this.is_arcade?window.location=A:window.parent.location=A:window.top.location=A)};n.prototype.GoToURLWindow=function(A,l){this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(A)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(A,{openExternal:!0}):this.runtime.isCordova?window.open(A,"_system"):this.is_arcade||window.open(A,
l)};n.prototype.Reload=function(){this.is_arcade||window.location.reload()};var w=!0,r=null;n.prototype.RequestFullScreen=function(A,l){2<=A&&(A+=1);6===A&&(A=2);document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||document.fullScreenElement||(this.runtime.fullscreen_scaling=2<=A?A:0,A={navigationUI:"auto"},1===l?A.navigationUI="hide":2===l&&(A.navigationUI="show"),l=document.documentElement,w&&(w=!1,r=this.runtime,l.addEventListener("mozfullscreenerror",
t),l.addEventListener("webkitfullscreenerror",t),l.addEventListener("MSFullscreenError",t),l.addEventListener("fullscreenerror",t)),l.requestFullscreen?l.requestFullscreen(A):l.mozRequestFullScreen?l.mozRequestFullScreen(A):l.msRequestFullscreen?l.msRequestFullscreen(A):l.webkitRequestFullScreen&&("undefined"!==typeof Element&&"undefined"!==typeof Element.ALLOW_KEYBOARD_INPUT?l.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):l.webkitRequestFullScreen()))};n.prototype.CancelFullScreen=function(){document.exitFullscreen?
document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()};n.prototype.Vibrate=function(A){try{var l=A.split(","),y;var z=0;for(y=l.length;z<y;z++)l[z]=parseInt(l[z],10);navigator.vibrate?navigator.vibrate(l):navigator.mozVibrate?navigator.mozVibrate(l):navigator.webkitVibrate?navigator.webkitVibrate(l):navigator.msVibrate&&navigator.msVibrate(l)}catch(O){}};
n.prototype.InvokeDownload=function(A,l){if(l){var y=document.createElement("a");if("undefined"===typeof y.download)window.open(A);else{var z=document.getElementsByTagName("body")[0];y.textContent=l;y.href=A;y.download=l;z.appendChild(y);A=new MouseEvent("click");y.dispatchEvent(A);z.removeChild(y)}}};n.prototype.InvokeDownloadString=function(A,l,y){if(y){var z="data:"+l+","+encodeURIComponent(A);A=document.createElement("a");"undefined"===typeof A.download?window.open(z):(l=document.getElementsByTagName("body")[0],
A.textContent=y,A.href=z,A.download=y,l.appendChild(A),y=new MouseEvent("click"),A.dispatchEvent(y),l.removeChild(A))}};n.prototype.ConsoleLog=function(A,l){"undefined"!==typeof console&&(0===A&&console.log&&console.log(l.toString()),1===A&&console.warn&&console.warn(l.toString()),2===A&&console.error&&console.error(l.toString()))};n.prototype.ConsoleGroup=function(A){console&&console.group&&console.group(A)};n.prototype.ConsoleGroupEnd=function(){console&&console.groupEnd&&console.groupEnd()};n.prototype.ExecJs=
function(A){try{eval&&eval(A)}catch(l){console&&console.error&&console.error("Error executing Javascript: ",l)}};var x="portrait landscape portrait-primary portrait-secondary landscape-primary landscape-secondary".split(" ");n.prototype.LockOrientation=function(A){A=Math.floor(A);0>A||A>=x.length||(this.runtime.autoLockOrientation=!1,A=x[A],screen.orientation&&screen.orientation.lock?screen.orientation.lock(A):screen.lockOrientation?screen.lockOrientation(A):screen.webkitLockOrientation?screen.webkitLockOrientation(A):
screen.mozLockOrientation?screen.mozLockOrientation(A):screen.msLockOrientation&&screen.msLockOrientation(A))};n.prototype.UnlockOrientation=function(){this.runtime.autoLockOrientation=!1;screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()};c.acts=
new n;e.prototype.URL=function(A){A.set_string(window.location.toString())};e.prototype.Protocol=function(A){A.set_string(window.location.protocol)};e.prototype.Domain=function(A){A.set_string(window.location.hostname)};e.prototype.PathName=function(A){A.set_string(window.location.pathname)};e.prototype.Hash=function(A){A.set_string(window.location.hash)};e.prototype.Referrer=function(A){A.set_string(document.referrer)};e.prototype.Title=function(A){A.set_string(document.title)};e.prototype.Name=
function(A){A.set_string(navigator.appName)};e.prototype.Version=function(A){A.set_string(navigator.appVersion)};e.prototype.Language=function(A){navigator&&navigator.language?A.set_string(navigator.language):A.set_string("")};e.prototype.Platform=function(A){A.set_string(navigator.platform)};e.prototype.Product=function(A){navigator&&navigator.product?A.set_string(navigator.product):A.set_string("")};e.prototype.Vendor=function(A){navigator&&navigator.vendor?A.set_string(navigator.vendor):A.set_string("")};
e.prototype.UserAgent=function(A){A.set_string(navigator.userAgent)};e.prototype.QueryString=function(A){A.set_string(window.location.search)};e.prototype.QueryParam=function(A,l){(l=RegExp("[?&]"+l+"=([^&]*)").exec(window.location.search))?A.set_string(decodeURIComponent(l[1].replace(/\+/g," "))):A.set_string("")};e.prototype.Bandwidth=function(A){var l=navigator.connection||navigator.mozConnection||navigator.webkitConnection;l?"undefined"!==typeof l.bandwidth?A.set_float(l.bandwidth):"undefined"!==
typeof l.downlinkMax?A.set_float(l.downlinkMax):A.set_float(Number.POSITIVE_INFINITY):A.set_float(Number.POSITIVE_INFINITY)};e.prototype.ConnectionType=function(A){var l=navigator.connection||navigator.mozConnection||navigator.webkitConnection;l?A.set_string(l.type||"unknown"):A.set_string("unknown")};e.prototype.BatteryLevel=function(A){var l=navigator.battery||navigator.mozBattery||navigator.webkitBattery;l?A.set_float(l.level):(f(),v?A.set_float(v.level):A.set_float(1))};e.prototype.BatteryTimeLeft=
function(A){var l=navigator.battery||navigator.mozBattery||navigator.webkitBattery;l?A.set_float(l.dischargingTime):(f(),v?A.set_float(v.dischargingTime):A.set_float(Number.POSITIVE_INFINITY))};e.prototype.ExecJS=function(A,l){if(eval){var y=0;try{y=eval(l)}catch(z){console&&console.error&&console.error("Error executing Javascript: ",z)}"number"===typeof y?A.set_any(y):"string"===typeof y?A.set_any(y):"boolean"===typeof y?A.set_any(y?1:0):A.set_any(0)}else A.set_any(0)};e.prototype.ScreenWidth=function(A){A.set_int(screen.width)};
e.prototype.ScreenHeight=function(A){A.set_int(screen.height)};e.prototype.DevicePixelRatio=function(A){A.set_float(this.runtime.devicePixelRatio)};e.prototype.WindowInnerWidth=function(A){A.set_int(window.innerWidth)};e.prototype.WindowInnerHeight=function(A){A.set_int(window.innerHeight)};e.prototype.WindowOuterWidth=function(A){A.set_int(window.outerWidth)};e.prototype.WindowOuterHeight=function(A){A.set_int(window.outerHeight)};c.exps=new e})();cr.plugins_.Text=function(b){this.runtime=b};
(function(){function b(){return u.length?u.pop():{}}function f(v){var C;var w=0;for(C=v.length;w<C;w++)u.push(v[w]);cr.clearArray(v)}function g(v){return v.length&&" "===v.charAt(v.length-1)?v.substring(0,v.length-1):v}function n(){}function t(){}function e(){}var c=cr.plugins_.Text.prototype;c.onCreate=function(){c.acts.SetWidth=function(v){this.width!==v&&(this.width=v,this.text_changed=!0,this.set_bbox_changed())}};c.Type=function(v){this.plugin=v;this.runtime=v.runtime};var a=c.Type.prototype;
a.onCreate=function(){};a.onLostWebGLContext=function(){if(!this.is_family){var v;var C=0;for(v=this.instances.length;C<v;C++){var w=this.instances[C];w.mycanvas=null;w.myctx=null;w.mytex=null}}};c.Instance=function(v){this.type=v;this.runtime=v.runtime;this.recycled?cr.clearArray(this.lines):this.lines=[];this.text_changed=!0};a=c.Instance.prototype;var d={};a.onCreate=function(){this.text=this.properties[0];this.facename=this.properties[2];this.ptSize=this.properties[3];this.line_height_offset=
this.properties[4];this.isBold=this.properties[5];this.isItalic=this.properties[6];var v=this.properties[7];this.color="rgb("+Math.floor(255*v[0])+","+Math.floor(255*v[1])+","+Math.floor(255*v[2])+")";this.halign=this.properties[8];this.valign=this.properties[9];this.wrapbyword=0===this.properties[10];this.visible=this.properties[11];this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height;this.fontstyle=this.font="";this.textHeight=this.textWidth=this.pxHeight=0;this.updateFont();
this.mytex=this.myctx=this.mycanvas=null;this.need_text_redraw=!1;this.last_render_tick=this.runtime.tickcount;this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr.rect(0,0,1,1);this.runtime.glwrap&&this.runtime.tickMe(this)};a.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,fn:this.facename,fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}};
a.loadFromJSON=function(v){this.text=v.t;this.font=v.f;this.color=v.c;this.halign=v.ha;this.valign=v.va;this.wrapbyword=v.wr;this.line_height_offset=v.lho;this.facename=v.fn;this.fontstyle=v.fs;this.ptSize=v.ps;this.pxHeight=v.pxh;this.textWidth=v.tw;this.textHeight=v.th;this.last_render_tick=v.lrt;this.isBold=0!==this.fontstyle.indexOf("bold");this.isItalic=0!==this.fontstyle.indexOf("italic");this.text_changed=!0;this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height};a.tick=function(){if(this.runtime.glwrap&&
this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var v=this.layer;this.update_bbox();var C=this.bbox;if(C.right<v.viewLeft||C.bottom<v.viewTop||C.left>v.viewRight||C.top>v.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mycanvas=this.myctx=this.mytex=null}};a.onDestroy=function(){this.mycanvas=this.myctx=null;this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex);this.mytex=null};a.updateFont=function(){this.pxHeight=Math.ceil(this.ptSize/72*96)+
4;var v=[];this.isBold&&v.push("bold");this.isItalic&&v.push("italic");this.fontstyle=v.join(" ");this.font=this.fontstyle+" "+this.ptSize.toString()+"pt '"+this.facename+"'";this.text_changed=!0;this.runtime.redraw=!0};a.draw=function(v,C){v.font=this.font;v.textBaseline="top";v.fillStyle=this.color;v.globalAlpha=C?1:this.opacity;if(C){var w=this.layer.getScale();v.save();v.scale(w,w)}if(this.text_changed||this.width!==this.lastwrapwidth)this.type.plugin.WordWrap(this.text,this.lines,v,this.width,
this.wrapbyword),this.text_changed=!1,this.lastwrapwidth=this.width;this.update_bbox();w=C?0:this.bquad.tlx;var r=C?0:this.bquad.tly;this.runtime.pixel_rounding&&(w=w+.5|0,r=r+.5|0);0===this.angle||C||(v.save(),v.translate(w,r),v.rotate(this.angle),r=w=0);var x=r+this.height,A=this.pxHeight;A+=this.line_height_offset;var l;1===this.valign?r+=Math.max(this.height/2-this.lines.length*A/2,0):2===this.valign&&(r+=Math.max(this.height-this.lines.length*A-2,0));for(l=0;l<this.lines.length;l++){var y=w;
1===this.halign?y=w+(this.width-this.lines[l].width)/2:2===this.halign&&(y=w+(this.width-this.lines[l].width));v.fillText(this.lines[l].text,y,r);r+=A;if(r>=x-A)break}(0!==this.angle||C)&&v.restore();this.last_render_tick=this.runtime.tickcount};a.drawGL=function(v){if(!(1>this.width||1>this.height)){var C=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var w=this.layer.getScale(),r=this.layer.getAngle(),x=this.rcTex,A=w*this.width,l=w*this.height,y=Math.ceil(A),z=Math.ceil(l),O=
this.runtime.draw_width/2,Q=this.runtime.draw_height/2;this.myctx||(this.mycanvas=document.createElement("canvas"),this.mycanvas.width=y,this.mycanvas.height=z,this.lastwidth=y,this.lastheight=z,C=!0,this.myctx=this.mycanvas.getContext("2d"));if(y!==this.lastwidth||z!==this.lastheight)this.mycanvas.width=y,this.mycanvas.height=z,this.mytex&&(v.deleteTexture(this.mytex),this.mytex=null),C=!0;C&&(this.myctx.clearRect(0,0,y,z),this.draw(this.myctx,!0),this.mytex||(this.mytex=v.createEmptyTexture(y,z,
this.runtime.linearSampling,this.runtime.isMobile)),v.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile));this.lastwidth=y;this.lastheight=z;v.setTexture(this.mytex);v.setOpacity(this.opacity);v.resetModelView();v.translate(-O,-Q);v.updateModelView();var I=this.bquad;C=this.layer.layerToCanvas(I.tlx,I.tly,!0,!0);O=this.layer.layerToCanvas(I.tlx,I.tly,!1,!0);Q=this.layer.layerToCanvas(I.trx,I.try_,!0,!0);var k=this.layer.layerToCanvas(I.trx,I.try_,!1,!0),p=this.layer.layerToCanvas(I.brx,
I.bry,!0,!0),H=this.layer.layerToCanvas(I.brx,I.bry,!1,!0),m=this.layer.layerToCanvas(I.blx,I.bly,!0,!0);I=this.layer.layerToCanvas(I.blx,I.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===r){var E=(C+.5|0)-C,L=(O+.5|0)-O;C+=E;O+=L;Q+=E;k+=L;p+=E;H+=L;m+=E;I+=L}0===this.angle&&0===r?(Q=C+y,k=O,p=Q,H=O+z,m=C,I=H,x.right=1,x.bottom=1):(x.right=A/y,x.bottom=l/z);v.quadTex(C,O,Q,k,p,H,m,I,x);v.resetModelView();v.scale(w,w);v.rotateZ(-this.layer.getAngle());v.translate((this.layer.viewLeft+
this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2);v.updateModelView();this.last_render_tick=this.runtime.tickcount}};var h=[];c.TokeniseWords=function(v){cr.clearArray(h);for(var C="",w,r=0;r<v.length;)if(w=v.charAt(r),"\n"===w)C.length&&(h.push(C),C=""),h.push("\n"),++r;else if(" "===w||"\t"===w||"-"===w){do C+=v.charAt(r),r++;while(r<v.length&&(" "===v.charAt(r)||"\t"===v.charAt(r)));h.push(C);C=""}else r<v.length&&(C+=w,r++);C.length&&h.push(C)};var u=[];c.WordWrap=function(v,
C,w,r,x){if(v&&v.length)if(2>=r)f(C);else{if(100>=v.length&&-1===v.indexOf("\n")){var A=w.measureText(v).width;if(A<=r){f(C);C.push(b());C[0].text=v;C[0].width=A;return}}this.WrapText(v,C,w,r,x)}else f(C)};c.WrapText=function(v,C,w,r,x){x&&(this.TokeniseWords(v),v=h);var A="",l,y=0;for(l=0;l<v.length;l++)if("\n"===v[l]){y>=C.length&&C.push(b());A=g(A);var z=C[y];z.text=A;z.width=w.measureText(A).width;y++;A=""}else{var O=A;A+=v[l];z=w.measureText(g(A)).width;z>=r&&(y>=C.length&&C.push(b()),O=g(O),
z=C[y],z.text=O,z.width=w.measureText(O).width,y++,A=v[l],x||" "!==A||(A=""))}A.length&&(y>=C.length&&C.push(b()),A=g(A),z=C[y],z.text=A,z.width=w.measureText(A).width,y++);for(l=y;l<C.length;l++)u.push(C[l]);C.length=y};n.prototype.CompareText=function(v,C){return C?this.text==v:cr.equals_nocase(this.text,v)};c.cnds=new n;t.prototype.SetText=function(v){cr.is_number(v)&&1E9>v&&(v=Math.round(1E10*v)/1E10);v=v.toString();this.text!==v&&(this.text=v,this.text_changed=!0,this.runtime.redraw=!0)};t.prototype.AppendText=
function(v){cr.is_number(v)&&(v=Math.round(1E10*v)/1E10);if(v=v.toString())this.text+=v,this.text_changed=!0,this.runtime.redraw=!0};t.prototype.SetFontFace=function(v,C){var w=!1,r=!1;switch(C){case 1:w=!0;break;case 2:r=!0;break;case 3:r=w=!0}if(v!==this.facename||this.isBold!==w||this.isItalic!==r)this.facename=v,this.isBold=w,this.isItalic=r,this.updateFont()};t.prototype.SetFontSize=function(v){this.ptSize!==v&&(this.ptSize=v,this.updateFont())};t.prototype.SetFontColor=function(v){var C=cr.clamp(Math.floor(255*
cr.GetRValue(v)),0,255),w=cr.clamp(Math.floor(255*cr.GetGValue(v)),0,255);v=cr.clamp(Math.floor(255*cr.GetBValue(v)),0,255);C="rgb("+C+","+w+","+v+")";C!==this.color&&(this.color=C,this.need_text_redraw=!0,this.runtime.redraw=!0)};t.prototype.SetWebFont=function(v,C){var w=this,r=function(){w.runtime.redraw=!0;w.text_changed=!0};if(d.hasOwnProperty(C)){if(v="'"+v+"'",this.facename!==v)for(this.facename=v,this.updateFont(),v=1;10>v;v++)setTimeout(r,100*v),setTimeout(r,1E3*v)}else{var x=document.createElement("link");
x.href=C;x.rel="stylesheet";x.type="text/css";x.onload=r;document.getElementsByTagName("head")[0].appendChild(x);d[C]=!0;this.facename="'"+v+"'";this.updateFont();for(v=1;10>v;v++)setTimeout(r,100*v),setTimeout(r,1E3*v)}};t.prototype.SetEffect=function(v){this.blend_mode=v;this.compositeOp=cr.effectToCompositeOp(v);cr.setGLBlend(this,v,this.runtime.gl);this.runtime.redraw=!0};c.acts=new t;e.prototype.Text=function(v){v.set_string(this.text)};e.prototype.FaceName=function(v){v.set_string(this.facename)};
e.prototype.FaceSize=function(v){v.set_int(this.ptSize)};e.prototype.TextWidth=function(v){var C=0,w;var r=0;for(w=this.lines.length;r<w;r++){var x=this.lines[r].width;C<x&&(C=x)}v.set_int(C)};e.prototype.TextHeight=function(v){v.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)};c.exps=new e})();cr.plugins_.Spritefont2=function(b){this.runtime=b};
(function(){function b(r,x){return r.length?r.pop():new x}function f(r,x,A){if(A){var l;A=0;for(l=x.length;A<l;A++)r.length<d&&r.push(x[A]);cr.clearArray(x)}else for(l in x)Object.prototype.hasOwnProperty.call(x,l)&&(r.length<d&&r.push(x[l]),delete x[l])}function g(r,x,A){var l=r.lines;A=A.replace(/\s\s*$/,"");x>=l.length&&l.push(b(h,Object));x=l[x];x.text=A;x.width=r.measureWidth(A);r.textWidth=cr.max(r.textWidth,x.width)}function n(){}function t(){}function e(){}var c=cr.plugins_.Spritefont2.prototype;
c.onCreate=function(){};c.Type=function(r){this.plugin=r;this.runtime=r.runtime};var a=c.Type.prototype;a.onCreate=function(){this.is_family||(this.texture_img=this.runtime.findWaitingTexture(this.texture_file),this.texture_img||(this.texture_img=new Image,this.texture_img.cr_src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(this.texture_img,this.texture_file)),this.spriteX=this.texture_data[3],this.spriteY=
this.texture_data[4],this.spriteWidth=this.texture_data[5],this.spriteHeight=this.texture_data[6],this.webGL_texture=null)};a.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};a.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!1,this.runtime.linearSampling,this.texture_pixelformat));var r;var x=0;for(r=this.instances.length;x<r;x++)this.instances[x].webGL_texture=
this.webGL_texture}};a.unloadTextures=function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};a.preloadCanvas2D=function(r){r.drawImage(this.texture_img,0,0)};c.Instance=function(r){this.type=r;this.runtime=r.runtime};a=c.Instance.prototype;a.onDestroy=function(){f(h,this.lines,!0);f(u,this.clipList,!1);f(v,this.clipUV,!1);cr.wipe(this.characterWidthList)};a.onCreate=function(){this.texture_img=this.type.texture_img;
this.text=this.properties[0];this.characterWidth=this.properties[2];this.characterHeight=this.properties[3];this.characterSet=this.properties[4];var r=this.properties[5];this.characterScale=this.properties[6];this.characterSpacing=this.properties[7];this.lineHeight=this.properties[8];this.halign=this.properties[9]/2;this.valign=this.properties[10]/2;this.wrapbyword=0===this.properties[11];this.visible=this.properties[12];this.textHeight=this.textWidth=0;this.recycled?(cr.clearArray(this.lines),cr.wipe(this.clipList),
cr.wipe(this.clipUV),cr.wipe(this.characterWidthList)):(this.lines=[],this.clipList={},this.clipUV={},this.characterWidthList={});this.text_changed=!0;this.lastwrapwidth=this.width;this.runtime.glwrap&&(this.type.webGL_texture||(this.type.webGL_texture=this.runtime.glwrap.loadTexture(this.type.texture_img,!1,this.runtime.linearSampling,this.type.texture_pixelformat)),this.webGL_texture=this.type.webGL_texture);this.LoadCharacterSpacingData(r);this.SplitSheet()};a.saveToJSON=function(){var r={t:this.text,
csc:this.characterScale,csp:this.characterSpacing,lh:this.lineHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick,ha:this.halign,va:this.valign,cw:{}},x;for(x in this.characterWidthList)r.cw[x]=this.characterWidthList[x];return r};a.loadFromJSON=function(r){this.text=r.t;this.characterScale=r.csc;this.characterSpacing=r.csp;this.lineHeight=r.lh;this.textWidth=r.tw;this.textHeight=r.th;this.last_render_tick=r.lrt;r.hasOwnProperty("ha")&&(this.halign=r.ha);r.hasOwnProperty("va")&&
(this.valign=r.va);for(var x in r.cw)this.characterWidthList[x]=r.cw[x];this.text_changed=!0;this.lastwrapwidth=this.width};var d=1E3,h=[],u=[],v=[];a.SplitSheet=function(){var r=this.texture_img.width,x=this.texture_img.height,A=this.type.spriteX,l=this.type.spriteY,y=this.characterWidth,z=this.characterHeight,O=A/r,Q=l/x;r=y/r;x=z/x;for(var I=this.characterSet,k=Math.floor(this.type.spriteWidth/y),p=Math.floor(this.type.spriteHeight/z),H=0;H<I.length&&!(H>=k*p);H++){var m=H%k,E=Math.floor(H/k),
L=I.charAt(H);if(this.runtime.glwrap){var N=this.clipUV,V=m*r+O,W=E*x+Q;m=(m+1)*r+O;E=(E+1)*x+Q;void 0===N[L]&&(N[L]=b(v,cr.rect));N[L].left=V;N[L].top=W;N[L].right=m;N[L].bottom=E}else N=this.clipList,m=m*y+A,E=E*z+l,V=y,W=z,void 0===N[L]&&(N[L]=b(u,Object)),N[L].x=m,N[L].y=E,N[L].w=V,N[L].h=W}};var C=[];c.TokeniseWords=function(r){cr.clearArray(C);for(var x="",A,l=0;l<r.length;)if(A=r.charAt(l),"\n"===A)x.length&&(C.push(x),x=""),C.push("\n"),++l;else if(" "===A||"\t"===A||"-"===A){do x+=r.charAt(l),
l++;while(l<r.length&&(" "===r.charAt(l)||"\t"===r.charAt(l)));C.push(x);x=""}else l<r.length&&(x+=A,l++);x.length&&C.push(x)};c.WordWrap=function(r){var x=r.text,A=r.lines;if(x&&x.length){var l=r.width;if(2>=l)f(h,A,!0);else{var y=r.characterScale,z=r.characterSpacing;if(x.length*(r.characterWidth*y+z)-z<=l&&-1===x.indexOf("\n")&&(z=r.measureWidth(x),z<=l)){f(h,A,!0);A.push(b(h,Object));A[0].text=x;A[0].width=z;r.textWidth=z;r.textHeight=r.characterHeight*y+r.lineHeight;return}this.WrapText(r);r.textHeight=
A.length*(r.characterHeight*y+r.lineHeight)}}else f(h,A,!0)};c.WrapText=function(r){var x=r.wrapbyword,A=r.text,l=r.lines,y=r.width;x&&(this.TokeniseWords(A),A=C);var z="",O,Q=0,I=!1;for(O=0;O<A.length;O++)if("\n"===A[O])!0===I?I=!1:(g(r,Q,z),Q++),z="";else{I=!1;var k=z;z+=A[O];var p=r.measureWidth(z.replace(/\s\s*$/,""));p>y&&(""===k?(g(r,Q,z),z="",I=!0):(g(r,Q,k),z=A[O]),Q++,x||" "!==z||(z=""))}z.replace(/\s\s*$/,"").length&&(g(r,Q,z),Q++);for(O=Q;O<l.length;O++)h.length<d&&h.push(l[O]);l.length=
Q};a.measureWidth=function(r){for(var x=this.characterSpacing,A=r.length,l=0,y=0;y<A;y++)l+=this.getCharacterWidth(r.charAt(y))*this.characterScale+x;return l-(0<l?x:0)};a.getCharacterWidth=function(r){var x=this.characterWidthList;return void 0!==x[r]?x[r]:this.characterWidth};a.rebuildText=function(){if(this.text_changed||this.width!==this.lastwrapwidth)this.textHeight=this.textWidth=0,this.type.plugin.WordWrap(this),this.text_changed=!1,this.lastwrapwidth=this.width};a.draw=function(r,x){x=this.texture_img;
if(""!==this.text&&null!=x&&(this.rebuildText(),!(this.height<this.characterHeight*this.characterScale+this.lineHeight))){r.globalAlpha=this.opacity;x=this.x;var A=this.y;this.runtime.pixel_rounding&&(x=Math.round(x),A=Math.round(A));var l=this.layer.viewLeft,y=this.layer.viewTop,z=this.layer.viewRight,O=this.layer.viewBottom;r.save();r.translate(x,A);r.rotate(this.angle);var Q=this.angle,I=this.halign,k=this.characterScale,p=this.characterHeight*k,H=this.lineHeight,m=this.characterSpacing,E=this.lines,
L=this.valign*cr.max(0,this.height-this.textHeight),N=-(this.hotspotX*this.width);L=-(this.hotspotY*this.height)+L;for(var V,W,X=0;X<E.length;X++){var Y=E[X].text;var ea=I*cr.max(0,this.width-E[X].width);var ha=N+ea;L+=H;if(0===Q&&A+L+p<y)L+=p;else{for(var q=0;q<Y.length;q++){V=Y.charAt(q);ea=this.getCharacterWidth(V);var B=this.clipList[V];if(0===Q&&x+ha+ea*k+m<l)ha+=ea*k+m;else{if(ha+ea*k>this.width+1E-5)break;void 0!==B&&(V=ha,W=L,0===Q&&1===k&&(V=Math.round(V),W=Math.round(W)),r.drawImage(this.texture_img,
B.x,B.y,B.w,B.h,V,W,B.w*k,B.h*k));ha+=ea*k+m;if(0===Q&&x+ha>z)break}}L+=p;if(0===Q&&(L+p+H>this.height||A+L>O))break}}r.restore()}};var w=new cr.quad;a.drawGL=function(r){r.setTexture(this.webGL_texture);r.setOpacity(this.opacity);if(this.text&&(this.rebuildText(),!(this.height<this.characterHeight*this.characterScale+this.lineHeight))){this.update_bbox();var x=this.bquad,A=0,l=0;this.runtime.pixel_rounding&&(A=Math.round(this.x)-this.x,l=Math.round(this.y)-this.y);var y=this.layer.viewLeft,z=this.layer.viewTop,
O=this.layer.viewRight,Q=this.layer.viewBottom,I=this.angle,k=this.halign,p=this.valign,H=this.characterScale,m=this.characterHeight*H,E=this.lineHeight,L=this.characterSpacing,N=this.lines,V=this.textHeight,W;if(0!==I){var X=Math.cos(I);var Y=Math.sin(I)}p*=cr.max(0,this.height-V);A=x.tlx+A;x=x.tly+l;l=p;for(p=0;p<N.length;p++){V=N[p].text;var ea=W=k*cr.max(0,this.width-N[p].width);l+=E;if(0===I&&x+l+m<z)l+=m;else{for(var ha=0;ha<V.length;ha++){var q=V.charAt(ha);W=this.getCharacterWidth(q);q=this.clipUV[q];
if(0===I&&A+ea+W*H+L<y)ea+=W*H+L;else{if(ea+W*H>this.width+1E-5)break;if(void 0!==q){var B=this.characterWidth*H,G=this.characterHeight*H;var J=ea;var F=l;0===I&&1===H&&(J=Math.round(J),F=Math.round(F));w.tlx=J;w.tly=F;w.trx=J+B;w.try_=F;w.blx=J;w.bly=F+G;w.brx=J+B;w.bry=F+G;0!==I&&(F=w,B=X,G=Y,J=F.tlx*B-F.tly*G,F.tly=F.tly*B+F.tlx*G,F.tlx=J,J=F.trx*B-F.try_*G,F.try_=F.try_*B+F.trx*G,F.trx=J,J=F.blx*B-F.bly*G,F.bly=F.bly*B+F.blx*G,F.blx=J,J=F.brx*B-F.bry*G,F.bry=F.bry*B+F.brx*G,F.brx=J);w.offset(A,
x);r.quadTex(w.tlx,w.tly,w.trx,w.try_,w.brx,w.bry,w.blx,w.bly,q)}ea+=W*H+L;if(0===I&&A+ea>O)break}}l+=m;if(0===I&&(l+m+E>this.height||x+l>Q))break}}}};n.prototype.CompareText=function(r,x){return x?this.text==r:cr.equals_nocase(this.text,r)};c.cnds=new n;t.prototype.SetText=function(r){cr.is_number(r)&&1E9>r&&(r=Math.round(1E10*r)/1E10);r=r.toString();this.text!==r&&(this.text=r,this.text_changed=!0,this.runtime.redraw=!0)};t.prototype.AppendText=function(r){cr.is_number(r)&&(r=Math.round(1E10*r)/
1E10);if(r=r.toString())this.text+=r,this.text_changed=!0,this.runtime.redraw=!0};t.prototype.SetScale=function(r){r!==this.characterScale&&(this.characterScale=r,this.text_changed=!0,this.runtime.redraw=!0)};t.prototype.SetCharacterSpacing=function(r){r!==this.CharacterSpacing&&(this.characterSpacing=r,this.text_changed=!0,this.runtime.redraw=!0)};t.prototype.SetLineHeight=function(r){r!==this.lineHeight&&(this.lineHeight=r,this.text_changed=!0,this.runtime.redraw=!0)};a.SetCharWidth=function(r,
x){x=parseInt(x,10);this.characterWidthList[r]!==x&&(this.characterWidthList[r]=x,this.text_changed=!0,this.runtime.redraw=!0)};a.LoadCharacterSpacingData=function(r){var x,A;if(r){try{var l=JSON.parse(r)}catch(Q){return}if(Array.isArray(l))for(r=0,x=l.length;r<x;++r){var y=l[r];if(Array.isArray(y)&&2===y.length&&"number"===typeof y[0]&&"string"===typeof y[1]){var z=y[0];y=y[1];var O=0;for(A=y.length;O<A;++O)this.SetCharWidth(y.charAt(O),z)}}}};t.prototype.SetCharacterWidth=function(r,x){if(""!==
r)for(var A=0;A<r.length;A++)this.SetCharWidth(r.charAt(A),x)};t.prototype.SetEffect=function(r){this.blend_mode=r;this.compositeOp=cr.effectToCompositeOp(r);cr.setGLBlend(this,r,this.runtime.gl);this.runtime.redraw=!0};t.prototype.SetHAlign=function(r){this.halign=r/2;this.text_changed=!0;this.runtime.redraw=!0};t.prototype.SetVAlign=function(r){this.valign=r/2;this.text_changed=!0;this.runtime.redraw=!0};c.acts=new t;e.prototype.CharacterWidth=function(r,x){r.set_int(this.getCharacterWidth(x))};
e.prototype.CharacterHeight=function(r){r.set_int(this.characterHeight)};e.prototype.CharacterScale=function(r){r.set_float(this.characterScale)};e.prototype.CharacterSpacing=function(r){r.set_int(this.characterSpacing)};e.prototype.LineHeight=function(r){r.set_int(this.lineHeight)};e.prototype.Text=function(r){r.set_string(this.text)};e.prototype.TextWidth=function(r){this.rebuildText();r.set_float(this.textWidth)};e.prototype.TextHeight=function(r){this.rebuildText();r.set_float(this.textHeight)};
c.exps=new e})();cr.plugins_.NinePatch=function(b){this.runtime=b};
(function(){function b(e,c,a,d,h,u,v,C,w,r){e.save();e.fillStyle=c;c=h%a;var x=u%d;0>c&&(c+=a);0>x&&(x+=d);e.translate(c+w,x+r);e.fillRect(h-c-w,u-x-r,v,C);e.restore()}function f(){}function g(){}var n=cr.plugins_.NinePatch.prototype;n.Type=function(e){this.plugin=e;this.runtime=e.runtime};var t=n.Type.prototype;t.onCreate=function(){this.is_family||(this.texture_img=this.runtime.findWaitingTexture(this.texture_file),this.texture_img||(this.texture_img=new Image,this.texture_img.cr_src=this.texture_file,
this.texture_img.cr_filesize=this.texture_filesize,this.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(this.texture_img,this.texture_file)),this.webGL_bottomTexture=this.webGL_topTexture=this.webGL_rightTexture=this.webGL_leftTexture=this.webGL_fillTexture=this.webGL_texture=this.bottomPattern=this.topPattern=this.rightPattern=this.leftPattern=this.fillPattern=null)};t.onLostWebGLContext=function(){this.is_family||(this.webGL_bottomTexture=this.webGL_topTexture=this.webGL_rightTexture=
this.webGL_leftTexture=this.webGL_fillTexture=this.webGL_texture=null)};t.onRestoreWebGLContext=function(){this.is_family||!this.instances.length||this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat))};t.unloadTextures=function(){this.is_family||this.instances.length||!this.runtime.glwrap||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.runtime.glwrap.deleteTexture(this.webGL_fillTexture),this.runtime.glwrap.deleteTexture(this.webGL_leftTexture),
this.runtime.glwrap.deleteTexture(this.webGL_rightTexture),this.runtime.glwrap.deleteTexture(this.webGL_topTexture),this.runtime.glwrap.deleteTexture(this.webGL_bottomTexture),this.webGL_bottomTexture=this.webGL_topTexture=this.webGL_rightTexture=this.webGL_leftTexture=this.webGL_fillTexture=this.webGL_texture=null)};t.slicePatch=function(e,c,a,d){var h=this.texture_data[3],u=this.texture_data[4],v=document.createElement("canvas");a-=e;d-=c;v.width=a;v.height=d;v.getContext("2d").drawImage(this.texture_img,
e+h,c+u,a,d,0,0,a,d);return v};t.createPatch=function(e,c,a,d){var h=this.texture_data[5],u=this.texture_data[6],v=h-c,C=u-d;if(this.runtime.glwrap){if(!this.webGL_fillTexture){var w=this.runtime.glwrap,r=this.runtime.linearSampling,x=this.texture_pixelformat;v>e&&C>a&&(this.webGL_fillTexture=w.loadTexture(this.slicePatch(e,a,v,C),!0,r,x));0<e&&C>a&&(this.webGL_leftTexture=w.loadTexture(this.slicePatch(0,a,e,C),!0,r,x,"repeat-y"));0<c&&C>a&&(this.webGL_rightTexture=w.loadTexture(this.slicePatch(v,
a,h,C),!0,r,x,"repeat-y"));0<a&&v>e&&(this.webGL_topTexture=w.loadTexture(this.slicePatch(e,0,v,a),!0,r,x,"repeat-x"));0<d&&v>e&&(this.webGL_bottomTexture=w.loadTexture(this.slicePatch(e,C,v,u),!0,r,x,"repeat-x"))}}else this.fillPattern||(w=this.runtime.ctx,v>e&&C>a&&(this.fillPattern=w.createPattern(this.slicePatch(e,a,v,C),"repeat")),0<e&&C>a&&(this.leftPattern=w.createPattern(this.slicePatch(0,a,e,C),"repeat")),0<c&&C>a&&(this.rightPattern=w.createPattern(this.slicePatch(v,a,h,C),"repeat")),0<
a&&v>e&&(this.topPattern=w.createPattern(this.slicePatch(e,0,v,a),"repeat")),0<d&&v>e&&(this.bottomPattern=w.createPattern(this.slicePatch(e,C,v,u),"repeat")))};n.Instance=function(e){this.type=e;this.runtime=e.runtime};t=n.Instance.prototype;t.onCreate=function(){this.leftMargin=this.properties[0];this.rightMargin=this.properties[1];this.topMargin=this.properties[2];this.bottomMargin=this.properties[3];this.edges=this.properties[4];this.fill=this.properties[5];this.visible=this.properties[6];this.seamless=
0!==this.properties[8];this.recycled?this.rcTex.set(0,0,0,0):this.rcTex=new cr.rect(0,0,0,0);this.runtime.glwrap&&!this.type.webGL_texture&&(this.type.webGL_texture=this.runtime.glwrap.loadTexture(this.type.texture_img,!1,this.runtime.linearSampling,this.type.texture_pixelformat));this.type.createPatch(this.leftMargin,this.rightMargin,this.topMargin,this.bottomMargin)};t.draw=function(e){var c=this.type.texture_img,a=this.leftMargin,d=this.rightMargin,h=this.topMargin,u=this.bottomMargin,v=this.type.texture_data[5],
C=this.type.texture_data[6],w=this.type.texture_data[3],r=this.type.texture_data[4],x=v-d,A=C-u;e.globalAlpha=this.opacity;e.save();var l=this.x,y=this.y,z=this.width,O=this.height;this.runtime.pixel_rounding&&(l=Math.round(l),y=Math.round(y));var Q=-(this.hotspotX*this.width),I=-(this.hotspotY*this.height),k=Q%v,p=I%C;0>k&&(k+=v);0>p&&(p+=C);e.translate(l+k,y+p);v=Q-k;I-=p;p=this.seamless?1:0;0<a&&0<h&&e.drawImage(c,w,r,a+p,h+p,v,I,a+p,h+p);0<d&&0<h&&e.drawImage(c,w+x-p,r,d+p,h+p,v+z-d-p,I,d+p,h+
p);0<d&&0<u&&e.drawImage(c,w+x-p,r+A-p,d+p,u+p,v+z-d-p,I+O-u-p,d+p,u+p);0<a&&0<u&&e.drawImage(c,w,r+A-p,a+p,u+p,v,I+O-u-p,a+p,u+p);0===this.edges?(p=2===this.fill?0:p,0<a&&A>h&&b(e,this.type.leftPattern,a,A-h,v,I+h,a+p,O-h-u,0,0),0<d&&A>h&&b(e,this.type.rightPattern,d,A-h,v+z-d-p,I+h,d+p,O-h-u,p,0),0<h&&x>a&&b(e,this.type.topPattern,x-a,h,v+a,I,z-a-d,h+p,0,0),0<u&&x>a&&b(e,this.type.bottomPattern,x-a,u,v+a,I+O-u-p,z-a-d,u+p,0,p)):1===this.edges&&(0<a&&A>h&&0<O-h-u&&e.drawImage(c,w,r+h,a,A-h,v,I+h,
a,O-h-u),0<d&&A>h&&0<O-h-u&&e.drawImage(c,w+x,r+h,d,A-h,v+z-d,I+h,d,O-h-u),0<h&&x>a&&0<z-a-d&&e.drawImage(c,w+a,r,x-a,h,v+a,I,z-a-d,h),0<u&&x>a&&0<z-a-d&&e.drawImage(c,w+a,r+A,x-a,u,v+a,I+O-u,z-a-d,u));A>h&&x>a&&(0===this.fill?b(e,this.type.fillPattern,x-a,A-h,v+a,I+h,z-a-d,O-h-u,0,0):1===this.fill&&0<z-a-d&&0<O-h-u&&e.drawImage(c,w+a,r+h,x-a,A-h,v+a,I+h,z-a-d,O-h-u));e.restore()};t.drawPatch=function(e,c,a,d,h,u,v,C,w,r){e.setTexture(c);var x=this.rcTex;x.left=a/c.c2width;x.top=d/c.c2height;x.right=
(a+h)/c.c2width;x.bottom=(d+u)/c.c2height;e.quadTex(v,C,v+w,C,v+w,C+r,v,C+r,x)};t.tilePatch=function(e,c,a,d,h,u,v,C){e.setTexture(c);var w=this.rcTex;w.left=-v/c.c2width;w.top=-C/c.c2height;w.right=(h-v)/c.c2width;w.bottom=(u-C)/c.c2height;e.quadTex(a,d,a+h,d,a+h,d+u,a,d+u,w)};t.drawGL_earlyZPass=function(e){this.drawGL(e)};t.drawGL=function(e){var c=this.leftMargin,a=this.rightMargin,d=this.topMargin,h=this.bottomMargin,u=this.type.texture_data[3],v=this.type.texture_data[4],C=this.type.texture_data[5]-
a,w=this.type.texture_data[6]-h;e.setOpacity(this.opacity);var r=this.bquad,x=r.tlx;r=r.tly;var A=this.width,l=this.height;this.runtime.pixel_rounding&&(x=Math.round(x),r=Math.round(r));var y=this.seamless?1:0;0<c&&0<d&&this.drawPatch(e,this.type.webGL_texture,u,v,c+y,d+y,x,r,c+y,d+y);0<a&&0<d&&this.drawPatch(e,this.type.webGL_texture,u+C-y,v,a+y,d+y,x+A-a-y,r,a+y,d+y);0<a&&0<h&&this.drawPatch(e,this.type.webGL_texture,u+C-y,v+w-y,a+y,h+y,x+A-a-y,r+l-h-y,a+y,h+y);0<c&&0<h&&this.drawPatch(e,this.type.webGL_texture,
u,v+w-y,c+y,h+y,x,r+l-h-y,c+y,h+y);0===this.edges?(y=2===this.fill?0:y,0<c&&w>d&&this.tilePatch(e,this.type.webGL_leftTexture,x,r+d,c+y,l-d-h,0,0),0<a&&w>d&&this.tilePatch(e,this.type.webGL_rightTexture,x+A-a-y,r+d,a+y,l-d-h,y,0),0<d&&C>c&&this.tilePatch(e,this.type.webGL_topTexture,x+c,r,A-c-a,d+y,0,0),0<h&&C>c&&this.tilePatch(e,this.type.webGL_bottomTexture,x+c,r+l-h-y,A-c-a,h+y,0,y)):1===this.edges&&(0<c&&w>d&&this.drawPatch(e,this.type.webGL_texture,u,v+d,c,w-d,x,r+d,c,l-d-h),0<a&&w>d&&this.drawPatch(e,
this.type.webGL_texture,u+C,v+d,a,w-d,x+A-a,r+d,a,l-d-h),0<d&&C>c&&this.drawPatch(e,this.type.webGL_texture,u+c,v,C-c,d,x+c,r,A-c-a,d),0<h&&C>c&&this.drawPatch(e,this.type.webGL_texture,u+c,v+w,C-c,h,x+c,r+l-h,A-c-a,h));w>d&&C>c&&(0===this.fill?this.tilePatch(e,this.type.webGL_fillTexture,x+c,r+d,A-c-a,l-d-h,0,0):1===this.fill&&this.drawPatch(e,this.type.webGL_texture,u+c,v+d,C-c,w-d,x+c,r+d,A-c-a,l-d-h))};f.prototype.OnURLLoaded=function(){return!0};n.cnds=new f;g.prototype.SetEffect=function(e){this.blend_mode=
e;this.compositeOp=cr.effectToCompositeOp(e);cr.setGLBlend(this,e,this.runtime.gl);this.runtime.redraw=!0};n.acts=new g;n.exps=new function(){}})();cr.plugins_.Button=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.plugins_.Button.prototype;n.Type=function(e){this.plugin=e;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e){this.type=e;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.isCheckbox=1===this.properties[0];this.inputElem=document.createElement("input");this.elem=this.isCheckbox?document.createElement("label"):this.inputElem;this.labelText=null;this.inputElem.type=this.isCheckbox?
"checkbox":"button";this.inputElem.id=this.properties[7];document.body.appendChild(this.elem);this.isCheckbox?(this.elem.appendChild(this.inputElem),this.labelText=document.createTextNode(this.properties[1]),this.elem.appendChild(this.labelText),this.inputElem.checked=this.properties[6],this.elem.style.fontFamily="sans-serif",this.elem.style.display="inline-block",this.elem.style.color="black"):this.inputElem.value=this.properties[1];this.elem.title=this.properties[2];this.inputElem.disabled=!this.properties[4];
this.autoFontSize=this.properties[5];this.element_hidden=!1;this.properties[3]||(this.elem.style.display="none",this.visible=!1,this.element_hidden=!0);this.inputElem.onclick=function(e){return function(c){c.stopPropagation();e.runtime.isInUserInputEvent=!0;e.runtime.trigger(cr.plugins_.Button.prototype.cnds.OnClicked,e);e.runtime.isInUserInputEvent=!1}}(this);this.elem.addEventListener("touchstart",function(e){e.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(e){e.stopPropagation()},
!1);this.elem.addEventListener("touchend",function(e){e.stopPropagation()},!1);this.elem.addEventListener("mousedown",function(e){e.stopPropagation()});this.elem.addEventListener("mouseup",function(e){e.stopPropagation()});this.elem.addEventListener("keydown",function(e){e.stopPropagation()});this.elem.addEventListener("keyup",function(e){e.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)};
t.saveToJSON=function(){var e={tooltip:this.elem.title,disabled:!!this.inputElem.disabled};this.isCheckbox?(e.checked=!!this.inputElem.checked,e.text=this.labelText.nodeValue):e.text=this.elem.value;return e};t.loadFromJSON=function(e){this.elem.title=e.tooltip;this.inputElem.disabled=e.disabled;this.isCheckbox?(this.inputElem.checked=e.checked,this.labelText.nodeValue=e.text):this.elem.value=e.text};t.onDestroy=function(){this.elem.parentElement.removeChild(this.elem);this.elem=null};t.tick=function(){this.updatePosition()};
t.updatePosition=function(e){var c=this.layer.layerToCanvas(this.x,this.y,!0),a=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),h=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),u=this.runtime.width/this.runtime.devicePixelRatio,v=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=h||c>=u||a>=v?(this.element_hidden||(this.elem.style.display="none"),this.element_hidden=!0):(1>
c&&(c=1),1>a&&(a=1),d>=u&&(d=u-1),h>=v&&(h=v-1),u=window.innerWidth,v=window.innerHeight,e||this.lastLeft!==c||this.lastTop!==a||this.lastRight!==d||this.lastBottom!==h||this.lastWinWidth!==u||this.lastWinHeight!==v?(this.lastLeft=c,this.lastTop=a,this.lastRight=d,this.lastBottom=h,this.lastWinWidth=u,this.lastWinHeight=v,this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1),e=Math.round(c)+this.runtime.canvas.offsetLeft,u=Math.round(a)+this.runtime.canvas.offsetTop,this.elem.style.position=
"absolute",this.elem.style.left=e+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(d-c)+"px",this.elem.style.height=Math.round(h-a)+"px",this.autoFontSize&&(this.elem.style.fontSize=this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1))};t.draw=function(e){};t.drawGL=function(e){};b.prototype.OnClicked=function(){return!0};b.prototype.IsChecked=function(){return this.isCheckbox&&this.inputElem.checked};
b.prototype.CompareText=function(e,c){var a=this.isCheckbox?this.labelText.nodeValue:this.elem.value;return c?a==e:cr.equals_nocase(a,e)};n.cnds=new b;f.prototype.SetText=function(e){this.isCheckbox?this.labelText.nodeValue=e:this.elem.value=e};f.prototype.SetTooltip=function(e){this.elem.title=e};f.prototype.SetVisible=function(e){this.visible=0!==e};f.prototype.SetCSSStyle=function(e,c){this.elem.style[cr.cssToCamelCase(e)]=c};f.prototype.SetChecked=function(e){this.isCheckbox&&(this.inputElem.checked=
1===e)};f.prototype.ToggleChecked=function(){this.isCheckbox&&(this.inputElem.checked=!this.inputElem.checked)};n.acts=new f;g.prototype.Text=function(e){this.isCheckbox?e.set_string(this.labelText.nodeValue):e.set_string(this.elem.value)};n.exps=new g})();cr.plugins_.video=function(b){this.runtime=b};
(function(){function b(x){return x&&!x.paused&&!x.ended&&0<x.currentTime}function f(){var x=C.slice(0);cr.clearArray(C);var A,l;var y=0;for(A=x.length;y<A;++y){var z=x[y];(l=z.play())&&l.catch(function(O){g(z)})}}function g(x){-1===C.indexOf(x)&&C.push(x)}function n(x){0>x&&(x=0);1<x&&(x=1);return Math.log(x)/Math.log(10)*20}function t(){}function e(){}function c(){}var a=cr.plugins_.video.prototype;a.Type=function(x){this.plugin=x;this.runtime=x.runtime};var d=a.Type.prototype;d.onCreate=function(){};
d.onLostWebGLContext=function(){if(!this.is_family){var x;var A=0;for(x=this.instances.length;A<x;++A){var l=this.instances[A];l.webGL_texture=null}}};d=document.createElement("video");var h=!!d.canPlayType("video/webm"),u=!!d.canPlayType("video/ogg"),v=!!d.canPlayType("video/mp4");d=null;a.Instance=function(x){this.type=x;this.runtime=x.runtime};d=a.Instance.prototype;var C=[];document.addEventListener("touchend",f,!0);document.addEventListener("click",f,!0);document.addEventListener("keydown",f,
!0);d.queueVideoPlay=function(x){if(this.video){var A=this;if(x){try{var l=this.video.play()}catch(y){g(this.video);return}l?l.catch(function(y){A.video&&g(A.video)}):this.useNextTouchWorkaround&&!this.runtime.isInUserInputEvent&&g(this.video)}else x=C.indexOf(this.video),0<=x&&C.splice(x,1)}};d.onCreate=function(){this.webm_src=this.properties[0];this.ogv_src=this.properties[1];this.mp4_src=this.properties[2];this.autoplay=this.properties[3];this.playInBackground=this.properties[4];this.videoWasPlayingOnSuspend=
!1;this.video=document.createElement("video");this.video.crossOrigin="anonymous";this.video.playsInline=!0;this.webGL_texture=null;this.currentTrigger=-1;this.viaCtx=this.viaCanvas=null;this.useViaCanvasWorkaround=this.runtime.isIE||this.runtime.isMicrosoftEdge;var x=this;this.video.addEventListener("canplay",function(){x.currentTrigger=0;x.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,x)});this.video.addEventListener("canplaythrough",function(){x.currentTrigger=1;x.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,
x)});this.video.addEventListener("ended",function(){x.currentTrigger=2;x.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,x)});this.video.addEventListener("error",function(){x.currentTrigger=3;x.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,x)});this.video.addEventListener("loadstart",function(){x.currentTrigger=4;x.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,x)});this.video.addEventListener("playing",function(){x.currentTrigger=5;x.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,
x)});this.video.addEventListener("pause",function(){x.currentTrigger=6;x.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,x)});this.video.addEventListener("stalled",function(){x.currentTrigger=7;x.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,x)});this.useNextTouchWorkaround=(this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))&&!this.runtime.isCrosswalk;0===this.autoplay?(this.video.autoplay=!1,this.video.preload=
"none"):1===this.autoplay?(this.video.autoplay=!1,this.video.preload="auto"):2===this.autoplay&&(this.video.autoplay=!0);this.setSource(this.webm_src,this.ogv_src,this.mp4_src);2===this.autoplay&&this.queueVideoPlay(!0);this.visible=this.properties[5];this.runtime.tickMe(this);this.recycled||(x=this,this.runtime.addSuspendCallback(function(A){x.onSuspend(A)}))};d.onSuspend=function(x){!this.playInBackground&&this.video&&(x?b(this.video)&&(this.queueVideoPlay(!1),this.video.pause(),this.videoWasPlayingOnSuspend=
!0):this.videoWasPlayingOnSuspend&&(this.queueVideoPlay(!0),this.videoWasPlayingOnSuspend=!1))};d.setSource=function(x,A,l){var y="";h&&x?y=x:u&&A?y=A:v&&l&&(y=l);y&&(this.runtime.isAbsoluteUrl(y)?this.video.src=y:this.video.src=this.runtime.getProjectFileUrl(y.toLowerCase()));this.runtime.glwrap&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null);this.viaCtx=this.viaCanvas=null};d.onDestroy=function(){this.queueVideoPlay(!1);b(this.video)&&this.video.pause();
this.runtime.glwrap&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null);this.viaCtx=this.viaCanvas=null;this.video.src="";this.video=null};d.tick=function(){b(this.video)&&(this.runtime.redraw=!0)};d.saveToJSON=function(){return{s:this.video.src||"",p:!!b(this.video),t:this.video.currentTime||0}};d.loadFromJSON=function(x){if(x&&"undefined"!==typeof x.s){var A=x.s;this.setSource(A,A,A);try{this.video.currentTime=x.t}catch(l){}x.p?this.queueVideoPlay(!0):
(this.queueVideoPlay(!1),this.video.pause())}};d.draw=function(x){if(this.video){var A=this.video.videoWidth,l=this.video.videoHeight;if(!(0>=A||0>=l)){var y=A/l;A=this.width;l=this.height;var z=0,O=0;if(A/l>y){var Q=l*y;y=l;z=Math.floor((A-Q)/2);0>z&&(z=0)}else Q=A,y=A/y,O=Math.floor((l-y)/2),0>O&&(O=0);x.globalAlpha=this.opacity;x.drawImage(this.video,this.x+z,this.y+O,Q,y)}}};var w=new cr.rect(0,0,0,0),r=new cr.quad;d.drawGL=function(x){if(this.video){var A=this.video.videoWidth,l=this.video.videoHeight;
if(!(0>=A||0>=l)){var y=A/l,z=this.width,O=this.height,Q=0,I=0;if(z/O>y){var k=O*y;y=O;Q=Math.floor((z-k)/2);0>Q&&(Q=0)}else k=z,y=z/y,I=Math.floor((O-y)/2),0>I&&(I=0);this.webGL_texture||(this.webGL_texture=x.createEmptyTexture(A,l,this.runtime.linearSampling,!1,!1));this.useViaCanvasWorkaround?(this.viaCtx||(this.viaCanvas=document.createElement("canvas"),this.viaCanvas.width=A,this.viaCanvas.height=l,this.viaCtx=this.viaCanvas.getContext("2d")),this.viaCtx.drawImage(this.video,0,0),x.videoToTexture(this.viaCanvas,
this.webGL_texture)):x.videoToTexture(this.video,this.webGL_texture);x.setBlend(this.srcBlend,this.destBlend);x.setOpacity(this.opacity);x.setTexture(this.webGL_texture);w.set(this.x+Q,this.y+I,this.x+Q+k,this.y+I+y);r.set_from_rect(w);x.quad(r.tlx,r.tly,r.trx,r.try_,r.brx,r.bry,r.blx,r.bly)}}};t.prototype.IsPlaying=function(){return b(this.video)};t.prototype.IsPaused=function(){return this.video.paused};t.prototype.HasEnded=function(){return this.video.ended};t.prototype.IsMuted=function(){return this.video.muted};
t.prototype.OnPlaybackEvent=function(x){return this.currentTrigger===x};a.cnds=new t;e.prototype.SetSource=function(x,A,l){this.setSource(x,A,l);this.video.load()};e.prototype.SetPlaybackTime=function(x){try{this.video.currentTime=x}catch(A){console&&console.error&&console.error("Exception setting video playback time: ",A)}};e.prototype.SetLooping=function(x){this.video.loop=0!==x};e.prototype.SetMuted=function(x){this.video.muted=0!==x};e.prototype.SetVolume=function(x){var A=this.video;x=Math.pow(10,
x/20);0>x&&(x=0);1<x&&(x=1);A.volume=x};e.prototype.Pause=function(){this.queueVideoPlay(!1);this.video.pause()};e.prototype.Play=function(){this.queueVideoPlay(!0)};a.acts=new e;c.prototype.PlaybackTime=function(x){x.set_float(this.video.currentTime||0)};c.prototype.Duration=function(x){x.set_float(this.video.duration||0)};c.prototype.Volume=function(x){x.set_float(n(this.video.volume||0))};c.prototype.VideoWidth=function(x){x.set_float(this.video.videoWidth||0)};c.prototype.VideoHeight=function(x){x.set_float(this.video.videoHeight||
0)};a.exps=new c})();cr.plugins_.TextBox=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.plugins_.TextBox.prototype;n.Type=function(c){this.plugin=c;this.runtime=c.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(c){this.type=c;this.runtime=c.runtime};var t=n.Instance.prototype,e="text password email number tel url textarea search".split(" ");-1<navigator.userAgent.indexOf("MSIE 9")&&(e[2]="text",e[3]="text",e[4]="text",e[5]="text",e[7]="text");t.onCreate=function(){6===this.properties[7]?(this.elem=document.createElement("textarea"),
this.elem.style.resize="none"):(this.elem=document.createElement("input"),this.elem.type=e[this.properties[7]]);this.elem.id=this.properties[9];document.body.appendChild(this.elem);this.elem.autocomplete="off";this.elem.value=this.properties[0];this.elem.placeholder=this.properties[1];this.elem.title=this.properties[2];this.elem.disabled=!this.properties[4];this.elem.readOnly=this.properties[5];this.elem.spellcheck=this.properties[6];this.autoFontSize=this.properties[8];this.element_hidden=!1;this.properties[3]||
(this.elem.style.display="none",this.visible=!1,this.element_hidden=!0);var c=function(a){return function(){a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnTextChanged,a)}}(this);this.elem.oninput=c;-1!==navigator.userAgent.indexOf("MSIE")&&(this.elem.oncut=c);this.elem.onclick=function(a){return function(d){d.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnClicked,a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.ondblclick=function(a){return function(d){d.stopPropagation();
a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnDoubleClicked,a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchend",function(a){a.stopPropagation()},!1);this.elem.addEventListener("mousedown",function(a){a.stopPropagation()});this.elem.addEventListener("mouseup",function(a){a.stopPropagation()});
this.elem.addEventListener("keydown",function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});this.elem.addEventListener("keyup",function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)};t.saveToJSON=function(){return{text:this.elem.value,placeholder:this.elem.placeholder,tooltip:this.elem.title,disabled:!!this.elem.disabled,readonly:!!this.elem.readOnly,
spellcheck:!!this.elem.spellcheck}};t.loadFromJSON=function(c){this.elem.value=c.text;this.elem.placeholder=c.placeholder;this.elem.title=c.tooltip;this.elem.disabled=c.disabled;this.elem.readOnly=c.readonly;this.elem.spellcheck=c.spellcheck};t.onDestroy=function(){this.elem.parentElement.removeChild(this.elem);this.elem=null};t.tick=function(){this.updatePosition()};t.updatePosition=function(c){var a=this.layer.layerToCanvas(this.x,this.y,!0),d=this.layer.layerToCanvas(this.x,this.y,!1),h=this.layer.layerToCanvas(this.x+
this.width,this.y+this.height,!0),u=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),v=this.runtime.width/this.runtime.devicePixelRatio,C=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=h||0>=u||a>=v||d>=C?(this.element_hidden||(this.elem.style.display="none"),this.element_hidden=!0):(1>a&&(a=1),1>d&&(d=1),h>=v&&(h=v-1),u>=C&&(u=C-1),v=window.innerWidth,C=window.innerHeight,c||this.lastLeft!==a||this.lastTop!==d||this.lastRight!==h||this.lastBottom!==
u||this.lastWinWidth!==v||this.lastWinHeight!==C?(this.lastLeft=a,this.lastTop=d,this.lastRight=h,this.lastBottom=u,this.lastWinWidth=v,this.lastWinHeight=C,this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1),c=Math.round(a)+this.runtime.canvas.offsetLeft,v=Math.round(d)+this.runtime.canvas.offsetTop,this.elem.style.position="absolute",this.elem.style.left=c+"px",this.elem.style.top=v+"px",this.elem.style.width=Math.round(h-a)+"px",this.elem.style.height=Math.round(u-d)+"px",
this.autoFontSize&&(this.elem.style.fontSize=this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1))};t.draw=function(c){};t.drawGL=function(c){};b.prototype.CompareText=function(c,a){return 0===a?cr.equals_nocase(this.elem.value,c):this.elem.value===c};b.prototype.OnTextChanged=function(){return!0};b.prototype.OnClicked=function(){return!0};b.prototype.OnDoubleClicked=function(){return!0};n.cnds=new b;f.prototype.SetText=
function(c){this.elem.value=c.toString()};f.prototype.SetPlaceholder=function(c){this.elem.placeholder=c};f.prototype.SetTooltip=function(c){this.elem.title=c};f.prototype.SetReadOnly=function(c){this.elem.readOnly=0===c};f.prototype.ScrollToBottom=function(){this.elem.scrollTop=this.elem.scrollHeight};n.acts=new f;g.prototype.Text=function(c){c.set_string(this.elem.value)};n.exps=new g})();cr.plugins_.sliderbar=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.plugins_.sliderbar.prototype;n.Type=function(e){this.plugin=e;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e){this.type=e;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.elem=document.createElement("input");this.elem.type="range";this.elem.max=this.properties[2];this.elem.min=this.properties[1];this.elem.step=this.properties[3];this.elem.value=this.properties[0];this.elem.disabled=
!this.properties[6];this.elem.id=this.properties[7];this.elem.title=this.properties[4];document.body.appendChild(this.elem);this.element_hidden=!1;this.properties[5]||(this.elem.style.display="none",this.visible=!1,this.element_hidden=!0);this.elem.onclick=function(e){return function(c){c.stopPropagation();e.runtime.isInUserInputEvent=!0;e.runtime.trigger(cr.plugins_.sliderbar.prototype.cnds.OnClicked,e);e.runtime.isInUserInputEvent=!1}}(this);this.elem.onchange=function(e){return function(c){e.runtime.isInUserInputEvent=
!0;e.runtime.trigger(cr.plugins_.sliderbar.prototype.cnds.OnChanged,e);e.runtime.isInUserInputEvent=!1}}(this);this.elem.addEventListener("touchstart",function(e){e.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(e){e.stopPropagation()},!1);this.elem.addEventListener("touchend",function(e){e.stopPropagation()},!1);this.elem.addEventListener("mousedown",function(e){e.stopPropagation()});this.elem.addEventListener("mouseup",function(e){e.stopPropagation()});this.elem.addEventListener("keydown",
function(e){e.stopPropagation()});this.elem.addEventListener("keyup",function(e){e.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)};t.saveToJSON=function(){return{v:this.elem.value,mi:this.elem.min,ma:this.elem.max,s:this.elem.step}};t.loadFromJSON=function(e){this.elem.min=e.mi;this.elem.max=e.ma;this.elem.step=e.s;this.elem.value=e.v};t.onDestroy=function(){this.elem.parentElement.removeChild(this.elem);
this.elem=null};t.tick=function(){this.updatePosition()};t.updatePosition=function(e){var c=this.layer.layerToCanvas(this.x,this.y,!0),a=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),h=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),u=this.runtime.width/this.runtime.devicePixelRatio,v=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=h||c>=u||a>=v?(this.element_hidden||(this.elem.style.display=
"none"),this.element_hidden=!0):(1>c&&(c=1),1>a&&(a=1),d>=u&&(d=u-1),h>=v&&(h=v-1),u=window.innerWidth,v=window.innerHeight,e||this.lastLeft!==c||this.lastTop!==a||this.lastRight!==d||this.lastBottom!==h||this.lastWinWidth!==u||this.lastWinHeight!==v?(this.lastLeft=c,this.lastTop=a,this.lastRight=d,this.lastBottom=h,this.lastWinWidth=u,this.lastWinHeight=v,this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1),e=Math.round(c)+this.runtime.canvas.offsetLeft,u=Math.round(a)+this.runtime.canvas.offsetTop,
this.elem.style.position="absolute",this.elem.style.left=e+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(d-c)+"px",this.elem.style.height=Math.round(h-a)+"px"):this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1))};t.draw=function(e){};t.drawGL=function(e){};b.prototype.OnClicked=function(){return!0};b.prototype.OnChanged=function(){return!0};b.prototype.CompareValue=function(e,c){return cr.do_cmp(parseFloat(this.elem.value),e,c)};n.cnds=new b;f.prototype.SetTooltip=
function(e){this.elem.title=e};f.prototype.SetValue=function(e){this.elem.value=e};f.prototype.SetMaximum=function(e){this.elem.max=e};f.prototype.SetMinimum=function(e){this.elem.min=e};f.prototype.SetStep=function(e){this.elem.step=e};n.acts=new f;g.prototype.Value=function(e){e.set_float(parseFloat(this.elem.value)||0)};g.prototype.Maximum=function(e){e.set_float(parseFloat(this.elem.max)||0)};g.prototype.Minimum=function(e){e.set_float(parseFloat(this.elem.min)||0)};g.prototype.Step=function(e){e.set_float(parseFloat(this.elem.step)||
0)};n.exps=new g})();cr.plugins_.List=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.plugins_.List.prototype;n.Type=function(e){this.plugin=e;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e){this.type=e;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.elem=document.createElement("select");this.elem.id=this.properties[7];document.body.appendChild(this.elem);this.elem.title=this.properties[1];this.elem.disabled=!this.properties[3];0===this.properties[4]&&
(this.elem.size=2);this.elem.multiple=this.properties[5];this.autoFontSize=this.properties[6];this.properties[2]||(this.elem.style.display="none",this.visible=!1);if(this.properties[0]){var e=this.properties[0].split("\n"),c;var a=0;for(c=e.length;a<c;a++){var d=document.createElement("option");d.text=e[a];this.elem.add(d)}}var h=this;this.elem.onchange=function(){h.runtime.trigger(cr.plugins_.List.prototype.cnds.OnSelectionChanged,h)};this.elem.onclick=function(u){u.stopPropagation();h.runtime.isInUserInputEvent=
!0;h.runtime.trigger(cr.plugins_.List.prototype.cnds.OnClicked,h);h.runtime.isInUserInputEvent=!1};this.elem.ondblclick=function(u){u.stopPropagation();h.runtime.isInUserInputEvent=!0;h.runtime.trigger(cr.plugins_.List.prototype.cnds.OnDoubleClicked,h);h.runtime.isInUserInputEvent=!1};this.elem.addEventListener("touchstart",function(u){u.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(u){u.stopPropagation()},!1);this.elem.addEventListener("touchend",function(u){u.stopPropagation()},
!1);this.elem.addEventListener("mousedown",function(u){u.stopPropagation()});this.elem.addEventListener("mouseup",function(u){u.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.isVisible=!0;this.updatePosition(!0);this.runtime.tickMe(this)};t.saveToJSON=function(){var e={tooltip:this.elem.title,disabled:!!this.elem.disabled,items:[],sel:[]},c,a=e.items;var d=0;for(c=this.elem.length;d<c;d++)a.push(this.elem.options[d].text);
a=e.sel;if(this.elem.multiple)for(d=0,c=this.elem.length;d<c;d++)this.elem.options[d].selected&&a.push(d);else a.push(this.elem.selectedIndex);return e};t.loadFromJSON=function(e){this.elem.title=e.tooltip;this.elem.disabled=e.disabled;for(var c=e.items;this.elem.length;)this.elem.remove(this.elem.length-1);var a;var d=0;for(a=c.length;d<a;d++){var h=document.createElement("option");h.text=c[d];this.elem.add(h)}e=e.sel;if(this.elem.multiple)for(d=0,a=e.length;d<a;d++)e[d]<this.elem.length&&(this.elem.options[e[d]].selected=
!0);else 1<=e.length&&(this.elem.selectedIndex=e[0])};t.onDestroy=function(){this.elem.parentElement.removeChild(this.elem);this.elem=null};t.tick=function(){this.updatePosition()};t.updatePosition=function(e){var c=this.layer.layerToCanvas(this.x,this.y,!0),a=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),h=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),u=this.runtime.width/this.runtime.devicePixelRatio,v=this.runtime.height/
this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=h||c>=u||a>=v?(this.isVisible&&(this.elem.style.display="none"),this.isVisible=!1):(1>c&&(c=1),1>a&&(a=1),d>=u&&(d=u-1),h>=v&&(h=v-1),u=window.innerWidth,v=window.innerHeight,e||this.lastLeft!==c||this.lastTop!==a||this.lastRight!==d||this.lastBottom!==h||this.lastWinWidth!==u||this.lastWinHeight!==v?(this.lastLeft=c,this.lastTop=a,this.lastRight=d,this.lastBottom=h,this.lastWinWidth=u,this.lastWinHeight=v,this.isVisible||
(this.elem.style.display="",this.isVisible=!0),e=Math.round(c)+this.runtime.canvas.offsetLeft,u=Math.round(a)+this.runtime.canvas.offsetTop,this.elem.style.position="absolute",this.elem.style.left=e+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(d-c)+"px",this.elem.style.height=Math.round(h-a)+"px",this.autoFontSize&&(this.elem.style.fontSize=this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.isVisible||(this.elem.style.display="",this.isVisible=!0))};t.draw=function(e){};
t.drawGL=function(e){};b.prototype.CompareSelection=function(e,c){return cr.do_cmp(this.elem.selectedIndex,e,c)};b.prototype.OnSelectionChanged=function(){return!0};b.prototype.OnClicked=function(){return!0};b.prototype.OnDoubleClicked=function(){return!0};b.prototype.CompareSelectedText=function(e,c){var a=this.elem.selectedIndex;if(0>a||a>=this.elem.length)return!1;a=this.elem.options[a].text;return c?a==e:cr.equals_nocase(a,e)};b.prototype.CompareTextAt=function(e,c,a){e=Math.floor(e);if(0>e||
e>=this.elem.length)return!1;e=this.elem.options[e].text;return a?e==c:cr.equals_nocase(e,c)};n.cnds=new b;f.prototype.Select=function(e){this.elem.selectedIndex=e};f.prototype.SetTooltip=function(e){this.elem.title=e};f.prototype.AddItem=function(e){var c=document.createElement("option");c.text=e;this.elem.add(c)};f.prototype.AddItemAt=function(e,c){e=Math.floor(e);0>e&&(e=0);var a=document.createElement("option");a.text=c;e>=this.elem.length?this.elem.add(a):this.elem.add(a,this.elem.options[e])};
f.prototype.Remove=function(e){e=Math.floor(e);this.elem.remove(e)};f.prototype.SetItemText=function(e,c){e=Math.floor(e);0>e||e>=this.elem.length||(this.elem.options[e].text=c)};f.prototype.Clear=function(){this.elem.innerHTML=""};n.acts=new f;g.prototype.ItemCount=function(e){e.set_int(this.elem.length)};g.prototype.ItemTextAt=function(e,c){c=Math.floor(c);0>c||c>=this.elem.length?e.set_string(""):e.set_string(this.elem.options[c].text)};g.prototype.SelectedIndex=function(e){e.set_int(this.elem.selectedIndex)};
g.prototype.SelectedText=function(e){var c=this.elem.selectedIndex;0>c||c>=this.elem.length?e.set_string(""):e.set_string(this.elem.options[c].text)};g.prototype.SelectedCount=function(e){var c,a=0;var d=0;for(c=this.elem.length;d<c;d++)this.elem.options[d].selected&&a++;e.set_int(a)};g.prototype.SelectedIndexAt=function(e,c){c=Math.floor(c);var a,d=0,h=0;var u=0;for(a=this.elem.length;u<a;u++)if(this.elem.options[u].selected){if(d===c){h=u;break}d++}e.set_int(h)};g.prototype.SelectedTextAt=function(e,
c){c=Math.floor(c);var a,d=0,h="";var u=0;for(a=this.elem.length;u<a;u++)if(this.elem.options[u].selected){if(d===c){h=this.elem.options[u].text;break}d++}e.set_string(h)};n.exps=new g})();cr.plugins_.progressbar=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.plugins_.progressbar.prototype;n.Type=function(e){this.plugin=e;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e){this.type=e;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.elem=document.createElement("progress");this.value=this.properties[0];this.max=this.properties[1];0<this.max&&0<=this.value&&(this.elem.max=this.max,this.elem.value=this.value);this.elem.id=this.properties[4];
this.elem.title=this.properties[2];document.body.appendChild(this.elem);this.element_hidden=!1;this.properties[3]||(this.elem.style.display="none",this.visible=!1,this.element_hidden=!0);this.elem.onclick=function(e){return function(c){c.stopPropagation();e.runtime.isInUserInputEvent=!0;e.runtime.trigger(cr.plugins_.progressbar.prototype.cnds.OnClicked,e);e.runtime.isInUserInputEvent=!1}}(this);this.elem.addEventListener("touchstart",function(e){e.stopPropagation()},!1);this.elem.addEventListener("touchmove",
function(e){e.stopPropagation()},!1);this.elem.addEventListener("touchend",function(e){e.stopPropagation()},!1);this.elem.addEventListener("mousedown",function(e){e.stopPropagation()});this.elem.addEventListener("mouseup",function(e){e.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)};t.saveToJSON=function(){return{v:this.elem.value,m:this.elem.max}};t.loadFromJSON=function(e){this.elem.value=
e.v;this.elem.max=e.m};t.onDestroy=function(){this.elem.parentElement.removeChild(this.elem);this.elem=null};t.tick=function(){this.updatePosition()};t.updatePosition=function(e){var c=this.layer.layerToCanvas(this.x,this.y,!0),a=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),h=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),u=this.runtime.width/this.runtime.devicePixelRatio,v=this.runtime.height/this.runtime.devicePixelRatio;
!this.visible||!this.layer.visible||0>=d||0>=h||c>=u||a>=v?(this.element_hidden||(this.elem.style.display="none"),this.element_hidden=!0):(1>c&&(c=1),1>a&&(a=1),d>=u&&(d=u-1),h>=v&&(h=v-1),u=window.innerWidth,v=window.innerHeight,e||this.lastLeft!==c||this.lastTop!==a||this.lastRight!==d||this.lastBottom!==h||this.lastWinWidth!==u||this.lastWinHeight!==v?(this.lastLeft=c,this.lastTop=a,this.lastRight=d,this.lastBottom=h,this.lastWinWidth=u,this.lastWinHeight=v,this.element_hidden&&(this.elem.style.display=
"",this.element_hidden=!1),e=Math.round(c)+this.runtime.canvas.offsetLeft,u=Math.round(a)+this.runtime.canvas.offsetTop,this.elem.style.position="absolute",this.elem.style.left=e+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(d-c)+"px",this.elem.style.height=Math.round(h-a)+"px"):this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1))};t.draw=function(e){};t.drawGL=function(e){};b.prototype.OnClicked=function(){return!0};b.prototype.CompareProgress=function(e,c){return cr.do_cmp(this.elem.value,
e,c)};n.cnds=new b;f.prototype.SetTooltip=function(e){this.elem.title=e};f.prototype.SetProgress=function(e){this.value=e;this.elem.max=this.max;this.elem.value=this.value};f.prototype.SetMaximum=function(e){this.max=e;this.elem.max=this.max;this.elem.value=this.value};f.prototype.SetIndeterminate=function(){this.elem.removeAttribute("value");this.elem.removeAttribute("max")};n.acts=new f;g.prototype.Progress=function(e){e.set_float(this.elem.value)};g.prototype.Maximum=function(e){e.set_float(this.elem.max)};
n.exps=new g})();var Box2D=window.Box2DFn(),b2Vec2=Box2D.b2Vec2;function createPolygonShape(b){for(var f=new Box2D.b2PolygonShape,g=Box2D._malloc(8*b.length),n=0,t=0;t<b.length;t++)Box2D.HEAPF32[g+n>>2]=b[t].get_x(),Box2D.HEAPF32[g+(n+4)>>2]=b[t].get_y(),n+=8;n=Box2D.wrapPointer(g,Box2D.b2Vec2);f.Set(n,b.length);Box2D._free(g);return f}b2Vec2._freeCache=[];b2Vec2.Get=function(b,f){if(b2Vec2._freeCache.length){var g=b2Vec2._freeCache.pop();g.set_x(b);g.set_y(f);return g}return new b2Vec2(b,f)};
b2Vec2.Free=function(b){b2Vec2._freeCache.push(b)};b2Vec2.Clone=function(b){return b2Vec2.Get(b.get_x(),b.get_y())};var tmpvec2a=b2Vec2.Get(0,0),tmpvec2b=b2Vec2.Get(0,0);function getTempVec2a(b,f){tmpvec2a.set_x(b);tmpvec2a.set_y(f);return tmpvec2a}function getTempVec2b(b,f){tmpvec2b.set_x(b);tmpvec2b.set_y(f);return tmpvec2b}cr.b2Separator=function(){};cr.b2Separator.det=function(b,f,g,n,t,e){return b*n+g*e+t*f-f*g-n*t-e*b};
cr.b2Separator.hitRay=function(b,f,g,n,t,e,c,a){var d=g-b,h=n-f,u=c-t,v=a-e;u=(u*(e-f)-v*(t-b))/(h*u-d*v);d=b+u*d;h=f+u*h;b=cr.b2Separator.isOnSegment(g,n,b,f,d,h);t=cr.b2Separator.isOnSegment(d,h,t,e,c,a);return b&&t?b2Vec2.Get(d,h):null};cr.b2Separator.isOnSegment=function(b,f,g,n,t,e){return(g+.1>=b&&b>=t-.1||g-.1<=b&&b<=t+.1)&&(n+.1>=f&&f>=e-.1||n-.1<=f&&f<=e+.1)&&cr.b2Separator.isOnLine(b,f,g,n,t,e)};
cr.b2Separator.isOnLine=function(b,f,g,n,t,e){return.1<Math.abs(t-g)?.1>Math.abs((e-n)/(t-g)*(b-g)+n-f):.1>Math.abs(b-g)};cr.b2Separator.pointsMatch=function(b,f,g,n){return.1>Math.abs(g-b)&&.1>Math.abs(n-f)};
cr.b2Separator.Separate=function(b,f){b=cr.b2Separator.calcShapes(b);var g=[],n,t,e;var c=0;for(n=b.length;c<n;c++){var a=b[c];var d=[];d.length=a.length;var h=e=0;for(t=a.length;h<t;h++){var u=a[h];var v=a[(h+1)%t];e+=u.get_x()*v.get_y()-u.get_y()*v.get_x();d[h]=b2Vec2.Get(u.get_x(),u.get_y())}e=Math.abs(e/2);if(e>=.001*f)g.push(d);else for(h=0,t=d.length;h<t;h++)b2Vec2.Free(d[h])}return g=SplitConvexPolysOver8Points(g)};
cr.b2Separator.calcShapes=function(b){var f,g,n=0,t=0,e=[],c=[];for(c.push(b);c.length;){b=c[0];var a=b.length;var d=!0;for(f=0;f<a;f++){var h=f;var u=f<a-1?f+1:f+1-a;var v=f<a-2?f+2:f+2-a;var C=b[h];var w=b[u];v=b[v];v=cr.b2Separator.det(C.get_x(),C.get_y(),w.get_x(),w.get_y(),v.get_x(),v.get_y());if(0>v){d=!1;var r=1E9;for(g=0;g<a;g++)if(g!==h&&g!==u){f=g;v=g<a-1?g+1:0;var x=b[f];var A=b[v];if(x=cr.b2Separator.hitRay(C.get_x(),C.get_y(),w.get_x(),w.get_y(),x.get_x(),x.get_y(),A.get_x(),A.get_y())){A=
w.get_x()-x.get_x();var l=w.get_y()-x.get_y();A=A*A+l*l;if(A<r){t=f;n=v;var y=x;r=A}else b2Vec2.Free(x)}}if(1E9===r)return[];g=[];r=[];f=t;v=n;x=b[f];A=b[v];n=!1;cr.b2Separator.pointsMatch(y.get_x(),y.get_y(),A.get_x(),A.get_y())||(g.push(y),n=!0);cr.b2Separator.pointsMatch(y.get_x(),y.get_y(),x.get_x(),x.get_y())||(r.push(y),n=!0);n||b2Vec2.Free(y);t=-1;for(n=h;;){if(n!==v)g.push(b[n]);else{if(0>t||t>=a)return[];cr.b2Separator.isOnSegment(A.get_x(),A.get_y(),b[t].get_x(),b[t].get_y(),C.get_x(),C.get_y())||
g.push(b[n]);break}t=n;0>n-1?n=a-1:n--}g.reverse();t=-1;for(n=u;;){if(n!==f)r.push(b[n]);else{if(0>t||t>=a)return[];n!==f||cr.b2Separator.isOnSegment(x.get_x(),x.get_y(),b[t].get_x(),b[t].get_y(),w.get_x(),w.get_y())||r.push(b[n]);break}t=n;n+1>a-1?n=0:n++}c.push(g,r);c.shift();break}}d&&e.push(c.shift())}return e};function SplitConvexPolysOver8Points(b){var f=[],g;var n=0;for(g=b.length;n<g;++n){var t=b[n];8>=t.length?f.push(t):f.push.apply(f,SplitConvexPoly(t))}return f}
function SplitConvexPoly(b){var f=[];f.push(b.splice(0,8));for(var g=f[0][0],n=f[0][7];b.length;){var t=b.splice(0,Math.min(b.length,6));var e=t[t.length-1];t.push(b2Vec2.Clone(g));t.push(b2Vec2.Clone(n));f.push(t);n=e}return f}
cr.behaviors.Physics=function(b){this.runtime=b;this.world=new Box2D.b2World(getTempVec2a(0,10),!0);this.worldG=10;this.lastUpdateTick=-1;var f=new Box2D.JSContactListener;f.BeginContact=function(n){var t=Box2D.wrapPointer(n,Box2D.b2Contact);n=t.GetFixtureA().GetBody().c2userdata;t=t.GetFixtureB().GetBody().c2userdata;b.registerCollision(n.inst,t.inst)};f.EndContact=function(){};f.PreSolve=function(){};f.PostSolve=function(){};this.world.SetContactListener(f);f=new Box2D.JSContactFilter;var g=this;
f.ShouldCollide=function(n,t){if(g.allCollisionsEnabled)return!0;n=Box2D.wrapPointer(n,Box2D.b2Fixture);var e=Box2D.wrapPointer(t,Box2D.b2Fixture);t=n.GetBody().c2userdata.inst.type;n=e.GetBody().c2userdata.inst.type;return(e=t.extra.Physics_DisabledCollisions)&&e.contains(n)?!1:(e=n.extra.Physics_DisabledCollisions)&&e.contains(t)?!1:!0};this.world.SetContactFilter(f);this.steppingMode=0;this.velocityIterations=8;this.positionIterations=3;this.allCollisionsEnabled=!0};
(function(){function b(){}function f(){}function g(w,r,x){x?((x=w.extra.Physics_DisabledCollisions)&&x.remove(r),(x=r.extra.Physics_DisabledCollisions)&&x.remove(w)):(w.extra.Physics_DisabledCollisions||(w.extra.Physics_DisabledCollisions=new cr.ObjectSet),w.extra.Physics_DisabledCollisions.add(r),r.extra.Physics_DisabledCollisions||(r.extra.Physics_DisabledCollisions=new cr.ObjectSet),r.extra.Physics_DisabledCollisions.add(w))}function n(){}var t=Box2D.b2BodyDef,e=Box2D.b2FixtureDef,c=Box2D.b2PolygonShape,
a=Box2D.b2CircleShape,d=Box2D.b2DistanceJointDef,h=Box2D.b2RevoluteJointDef,u=cr.behaviors.Physics.prototype;u.Type=function(w,r){this.behavior=w;this.objtype=r;this.runtime=w.runtime};u.Type.prototype.onCreate=function(){};u.Instance=function(w,r){this.type=w;this.behavior=w.behavior;this.inst=r;this.runtime=w.runtime;this.world=this.behavior.world};var v=u.Instance.prototype;v.onCreate=function(){this.immovable=this.properties[0];this.collisionmask=this.properties[1];this.preventRotation=this.properties[2];
this.density=this.properties[3];this.friction=this.properties[4];this.restitution=this.properties[5];this.linearDamping=this.properties[6];this.angularDamping=this.properties[7];this.bullet=this.properties[8];this.enabled=this.properties[9];this.body=null;this.fixtures=[];this.inst.update_bbox();this.lastKnownX=this.inst.x;this.lastKnownY=this.inst.y;this.lastKnownAngle=this.inst.angle;this.lastHeight=this.lastWidth=0;this.recreateBody=this.lastTickOverride=!1;this.lastAnimation=null;this.lastAnimationFrame=
-1;this.myJoints?(cr.clearArray(this.myJoints),cr.clearArray(this.myCreatedJoints),this.joiningMe.clear()):(this.myJoints=[],this.myCreatedJoints=[],this.joiningMe=new cr.ObjectSet);var w=this;this.recycled||(this.myDestroyCallback=function(r){w.onInstanceDestroyed(r)});this.runtime.addDestroyCallback(this.myDestroyCallback)};v.postCreate=function(){this.inst.update_bbox();this.createBody();this.lastAnimation=this.inst.cur_animation;this.lastAnimationFrame=this.inst.cur_frame};v.onDestroy=function(){this.destroyBody();
cr.clearArray(this.myCreatedJoints);this.joiningMe.clear();this.runtime.removeDestroyCallback(this.myDestroyCallback)};v.saveToJSON=function(){var w={e:this.enabled,im:this.immovable,pr:this.preventRotation,d:this.density,fr:this.friction,re:this.restitution,ld:this.linearDamping,ad:this.angularDamping,b:this.bullet,mcj:this.myCreatedJoints};if(this.enabled){var r=this.body.GetLinearVelocity();w.vx=r.get_x();w.vy=r.get_y();w.om=this.body.GetAngularVelocity()}return w};v.loadFromJSON=function(w){this.destroyBody();
cr.clearArray(this.myCreatedJoints);this.joiningMe.clear();this.enabled=w.e;this.immovable=w.im;this.preventRotation=w.pr;this.density=w.d;this.friction=w.fr;this.restitution=w.re;this.linearDamping=w.ld;this.angularDamping=w.ad;this.bullet=w.b;this.lastKnownX=this.inst.x;this.lastKnownY=this.inst.y;this.lastKnownAngle=this.inst.angle;this.lastWidth=this.inst.width;this.lastHeight=this.inst.height;this.enabled&&(this.createBody(),this.body.SetLinearVelocity(getTempVec2a(w.vx,w.vy)),this.body.SetAngularVelocity(w.om),
0===w.vx&&0===w.vy&&0===w.om||this.body.SetAwake(!0),this.myCreatedJoints=w.mcj)};v.afterLoad=function(){this.enabled&&this.recreateMyJoints()};v.onInstanceDestroyed=function(w){var r,x,A=w.uid;var l=r=0;for(x=this.myCreatedJoints.length;r<x;r++)this.myCreatedJoints[l]=this.myCreatedJoints[r],l<this.myJoints.length&&(this.myJoints[l]=this.myJoints[r]),this.myCreatedJoints[r].params[1]==A?r<this.myJoints.length&&this.world.DestroyJoint(this.myJoints[r]):l++;this.myCreatedJoints.length=l;l<this.myJoints.length&&
(this.myJoints.length=l);this.joiningMe.remove(w)};v.destroyMyJoints=function(){var w;var r=0;for(w=this.myJoints.length;r<w;r++)this.world.DestroyJoint(this.myJoints[r]);cr.clearArray(this.myJoints)};v.recreateMyJoints=function(){var w;var r=0;for(w=this.myCreatedJoints.length;r<w;r++){var x=this.myCreatedJoints[r];switch(x.type){case 0:this.doCreateDistanceJoint(x.params[0],x.params[1],x.params[2],x.params[3],x.params[4]);break;case 1:this.doCreateRevoluteJoint(x.params[0],x.params[1]);break;case 2:this.doCreateLimitedRevoluteJoint(x.params[0],
x.params[1],x.params[2],x.params[3])}}};v.createFixture=function(w){if(this.body)return w=this.body.CreateFixture(w),this.fixtures.push(w),w};v.destroyFixtures=function(){if(this.body){var w;var r=0;for(w=this.fixtures.length;r<w;++r)this.body.DestroyFixture(this.fixtures[r]);cr.clearArray(this.fixtures)}};v.destroyBody=function(){this.body&&(this.destroyMyJoints(),this.destroyFixtures(),this.world.DestroyBody(this.body),this.body=null,this.inst.extra.box2dbody=null)};var C=[];v.createBody=function(){if(this.enabled){var w=
this.inst;w.update_bbox();var r;if(!this.body){var x=new t;x.set_type(this.immovable?0:2);x.set_position(getTempVec2b(.02*w.bquad.midX(),.02*w.bquad.midY()));x.set_angle(w.angle);x.set_fixedRotation(this.preventRotation);x.set_linearDamping(this.linearDamping);x.set_angularDamping(this.angularDamping);x.set_bullet(this.bullet);this.body=this.world.CreateBody(x);this.body.c2userdata=this;w.extra.box2dbody=this.body;Box2D.destroy(x)}this.destroyFixtures();x=new e;x.set_density(this.density);x.set_friction(this.friction);
x.set_restitution(this.restitution);var A=this.inst.collision_poly&&!this.inst.collision_poly.is_empty();var l=this.collisionmask;A||this.inst.tilemap_exists||0!==this.collisionmask||(l=1);var y=Math.max(Math.abs(w.width),1);var z=Math.max(Math.abs(w.height),1);var O=0>w.width;var Q=0>w.height;if(0===l)if(w.tilemap_exists){var I=w.bquad.midX()-w.x;var k=w.bquad.midY()-w.y;w.getAllCollisionRects(C);A=[];l=0;for(y=C.length;l<y;++l){O=C[l];Q=O.rc;if(O.poly){if(!O.poly.convexpolys){var p=O.poly.pts_cache;
var H=O.poly.pts_count;for(z=0;z<H;++z)A.push(b2Vec2.Get(p[2*z],p[2*z+1]));z=O.id&3758096384;(-2147483648===z||1073741824===z||536870912===z||z&-2147483648&&z&1073741824&&z&536870912)&&A.reverse();O.poly.convexpolys=cr.b2Separator.Separate(A,(Q.right-Q.left)*(Q.bottom-Q.top));z=0;for(H=A.length;z<H;++z)b2Vec2.Free(A[z]);cr.clearArray(A)}z=0;for(H=O.poly.convexpolys.length;z<H;++z){var m=O.poly.convexpolys[z];p=0;for(r=m.length;p<r;++p)A.push(b2Vec2.Get(.02*(Q.left+m[p].get_x()-I),.02*(Q.top+m[p].get_y()-
k)));p=createPolygonShape(A);x.set_shape(p);this.createFixture(x);Box2D.destroy(p);p=0;for(r=A.length;p<r;++p)b2Vec2.Free(A[p]);cr.clearArray(A)}}else A.push(b2Vec2.Get(.02*(Q.left-I),.02*(Q.top-k))),A.push(b2Vec2.Get(.02*(Q.right-I),.02*(Q.top-k))),A.push(b2Vec2.Get(.02*(Q.right-I),.02*(Q.bottom-k))),A.push(b2Vec2.Get(.02*(Q.left-I),.02*(Q.bottom-k))),p=createPolygonShape(A),x.set_shape(p),this.createFixture(x),Box2D.destroy(p);z=0;for(H=A.length;z<H;++z)b2Vec2.Free(A[z]);cr.clearArray(A)}}else{l=
w.angle;w.angle=0;w.set_bbox_changed();w.update_bbox();I=w.bquad.midX()-w.x;k=w.bquad.midY()-w.y;w.angle=l;w.set_bbox_changed();w.collision_poly.cache_poly(O?-y:y,Q?-z:z,0);p=w.collision_poly.pts_cache;H=w.collision_poly.pts_count;A=[];A.length=H;for(l=0;l<H;l++)A[l]=b2Vec2.Get(p[2*l]-I,p[2*l+1]-k);O!==Q&&A.reverse();I=cr.b2Separator.Separate(A,y*z);for(l=0;l<H;l++)b2Vec2.Free(A[l]);if(I.length)for(l=0,y=I.length;l<y;l++){A=I[l];z=0;for(H=A.length;z<H;z++)k=A[z],k.set_x(.02*k.get_x()),k.set_y(.02*
k.get_y());p=createPolygonShape(A);x.set_shape(p);this.createFixture(x);Box2D.destroy(p);z=0;for(H=A.length;z<H;z++)b2Vec2.Free(A[z])}else p=new c,p.SetAsBox(.01*y,.01*z),x.set_shape(p),this.createFixture(x),Box2D.destroy(p)}else 1===l?(p=new c,p.SetAsBox(.01*y,.01*z)):(p=new a,p.set_m_radius(.01*Math.min(y,z))),x.set_shape(p),this.createFixture(x),Box2D.destroy(p);this.lastWidth=w.width;this.lastHeight=w.height;Box2D.destroy(x);cr.clearArray(C)}};v.tick=function(){if(this.enabled){var w=this.inst;
if(0===this.behavior.steppingMode)var r=this.runtime.timescale/60;else r=this.runtime.getDt(this.inst),r>1/30&&(r=1/30);this.runtime.tickcount_nosave>this.behavior.lastUpdateTick&&0<this.runtime.timescale&&(0!==r&&this.world.Step(r,this.behavior.velocityIterations,this.behavior.positionIterations),this.world.ClearForces(),this.behavior.lastUpdateTick=this.runtime.tickcount_nosave);if(this.recreateBody||w.width!==this.lastWidth||w.height!==this.lastHeight||w.cur_animation!==this.lastAnimation||w.cur_frame!==
this.lastAnimationFrame||w.tilemap_exists&&w.physics_changed)this.createBody(),this.recreateBody=!1,this.lastAnimation=w.cur_animation,this.lastAnimationFrame=w.cur_frame,w.tilemap_exists&&w.physics_changed&&(w.physics_changed=!1);r=w.x!==this.lastKnownX||w.y!==this.lastKnownY;var x=w.angle!==this.lastKnownAngle;if(r){w.update_bbox();var A=w.bquad.midX(),l=w.bquad.midY(),y=A-this.lastKnownX,z=l-this.lastKnownY;x?this.body.SetTransform(getTempVec2a(.02*A,.02*l),w.angle):this.body.SetTransform(getTempVec2a(.02*
A,.02*l),this.body.GetAngle());this.body.SetLinearVelocity(getTempVec2a(y,z));this.lastTickOverride=!0;this.body.SetAwake(!0)}else this.lastTickOverride&&(this.lastTickOverride=!1,this.body.SetLinearVelocity(getTempVec2a(0,0)),this.body.SetTransform(getTempVec2a(.02*w.bquad.midX(),.02*w.bquad.midY()),this.body.GetAngle()));!r&&x&&(this.body.SetTransform(this.body.GetPosition(),w.angle),this.body.SetAwake(!0));x=this.body.GetPosition();r=x.get_x()/.02;x=x.get_y()/.02;A=this.body.GetAngle();if(r!==
w.x||x!==w.y||A!==w.angle)if(w.x=r,w.y=x,w.angle=A,w.set_bbox_changed(),w.update_bbox(),r=w.bquad.midX()-w.x,x=w.bquad.midY()-w.y,0!==r||0!==x)w.x-=r,w.y-=x,w.set_bbox_changed();this.lastKnownX=w.x;this.lastKnownY=w.y;this.lastKnownAngle=w.angle}};v.getInstImgPointX=function(w){return-1!==w&&this.inst.getImagePoint?0===w&&this.body?(this.body.GetPosition().get_x()+this.body.GetLocalCenter().get_x())/.02:this.inst.getImagePoint(w,!0):this.inst.x};v.getInstImgPointY=function(w){return-1!==w&&this.inst.getImagePoint?
0===w&&this.body?(this.body.GetPosition().get_y()+this.body.GetLocalCenter().get_y())/.02:this.inst.getImagePoint(w,!1):this.inst.y};b.prototype.IsSleeping=function(){return this.enabled?!this.body.IsAwake():!1};b.prototype.CompareVelocity=function(w,r,x){if(!this.enabled)return!1;var A=this.body.GetLinearVelocity();0===w?A=A.get_x()/.02:1===w?A=A.get_y()/.02:(w=A.get_x()/.02,A=A.get_y()/.02,A=cr.distanceTo(0,0,w,A));return cr.do_cmp(A,r,x)};b.prototype.CompareAngularVelocity=function(w,r){if(!this.enabled)return!1;
var x=cr.to_degrees(this.body.GetAngularVelocity());return cr.do_cmp(x,w,r)};b.prototype.CompareMass=function(w,r){if(!this.enabled)return!1;var x=this.body.GetMass()/.02;return cr.do_cmp(x,w,r)};b.prototype.IsEnabled=function(){return this.enabled};u.cnds=new b;f.prototype.ApplyForce=function(w,r,x){if(this.enabled){var A=this.getInstImgPointX(x);x=this.getInstImgPointY(x);this.body.ApplyForce(getTempVec2a(w,r),getTempVec2b(.02*A,.02*x),!0)}};f.prototype.ApplyForceToward=function(w,r,x,A){if(this.enabled){var l=
this.getInstImgPointX(A);A=this.getInstImgPointY(A);r=cr.angleTo(l,A,r,x);this.body.ApplyForce(getTempVec2a(Math.cos(r)*w,Math.sin(r)*w),getTempVec2b(.02*l,.02*A),!0)}};f.prototype.ApplyForceAtAngle=function(w,r,x){if(this.enabled){r=cr.to_radians(r);var A=this.getInstImgPointX(x);x=this.getInstImgPointY(x);this.body.ApplyForce(getTempVec2a(Math.cos(r)*w,Math.sin(r)*w),getTempVec2b(.02*A,.02*x),!0)}};f.prototype.ApplyImpulse=function(w,r,x){if(this.enabled){var A=this.getInstImgPointX(x);x=this.getInstImgPointY(x);
this.body.ApplyLinearImpulse(getTempVec2a(w,r),getTempVec2b(.02*A,.02*x),!0);this.lastTickOverride=!1;this.lastKnownX=this.inst.x;this.lastKnownY=this.inst.y}};f.prototype.ApplyImpulseToward=function(w,r,x,A){if(this.enabled){var l=this.getInstImgPointX(A);A=this.getInstImgPointY(A);r=cr.angleTo(l,A,r,x);this.body.ApplyLinearImpulse(getTempVec2a(Math.cos(r)*w,Math.sin(r)*w),getTempVec2b(.02*l,.02*A),!0);this.lastTickOverride=!1;this.lastKnownX=this.inst.x;this.lastKnownY=this.inst.y}};f.prototype.ApplyImpulseAtAngle=
function(w,r,x){if(this.enabled){r=cr.to_radians(r);var A=this.getInstImgPointX(x);x=this.getInstImgPointY(x);this.body.ApplyLinearImpulse(getTempVec2a(Math.cos(r)*w,Math.sin(r)*w),getTempVec2b(.02*A,.02*x),!0);this.lastTickOverride=!1;this.lastKnownX=this.inst.x;this.lastKnownY=this.inst.y}};f.prototype.ApplyTorque=function(w){this.enabled&&this.body.ApplyTorque(cr.to_radians(w),!0)};f.prototype.ApplyTorqueToAngle=function(w,r){this.enabled&&(w=cr.to_radians(w),r=cr.to_radians(r),cr.angleClockwise(this.inst.angle,
r)?this.body.ApplyTorque(-w,!0):this.body.ApplyTorque(w,!0))};f.prototype.ApplyTorqueToPosition=function(w,r,x){this.enabled&&(w=cr.to_radians(w),r=cr.angleTo(this.inst.x,this.inst.y,r,x),cr.angleClockwise(this.inst.angle,r)?this.body.ApplyTorque(-w,!0):this.body.ApplyTorque(w,!0))};f.prototype.SetAngularVelocity=function(w){this.enabled&&(this.body.SetAngularVelocity(cr.to_radians(w)),this.body.SetAwake(!0))};f.prototype.CreateDistanceJoint=function(w,r,x,A,l){r&&this.enabled&&(r=r.getFirstPicked(this.inst))&&
r!=this.inst&&r.extra.box2dbody&&(this.myCreatedJoints.push({type:0,params:[w,r.uid,x,A,l]}),this.doCreateDistanceJoint(w,r.uid,x,A,l))};v.doCreateDistanceJoint=function(w,r,x,A,l){if(this.enabled&&(r=this.runtime.getObjectByUID(r))&&r!=this.inst&&r.extra.box2dbody){r.extra.box2dbody.c2userdata.joiningMe.add(this.inst);var y=this.getInstImgPointX(w);w=this.getInstImgPointY(w);if(r.getImagePoint){var z=r.getImagePoint(x,!0);x=r.getImagePoint(x,!1)}else z=r.x,x=r.y;var O=y-z,Q=w-x,I=new d;I.Initialize(this.body,
r.extra.box2dbody,getTempVec2a(.02*y,.02*w),getTempVec2b(.02*z,.02*x));I.set_length(.02*Math.sqrt(O*O+Q*Q));I.set_dampingRatio(A);I.set_frequencyHz(l);this.myJoints.push(this.world.CreateJoint(I));Box2D.destroy(I)}};f.prototype.CreateRevoluteJoint=function(w,r){r&&this.enabled&&(r=r.getFirstPicked(this.inst))&&r!=this.inst&&r.extra.box2dbody&&(this.myCreatedJoints.push({type:1,params:[w,r.uid]}),this.doCreateRevoluteJoint(w,r.uid))};v.doCreateRevoluteJoint=function(w,r){if(this.enabled&&(r=this.runtime.getObjectByUID(r))&&
r!=this.inst&&r.extra.box2dbody){r.extra.box2dbody.c2userdata.joiningMe.add(this.inst);var x=this.getInstImgPointX(w);w=this.getInstImgPointY(w);var A=new h;A.Initialize(this.body,r.extra.box2dbody,getTempVec2a(.02*x,.02*w));this.myJoints.push(this.world.CreateJoint(A));Box2D.destroy(A)}};f.prototype.CreateLimitedRevoluteJoint=function(w,r,x,A){r&&this.enabled&&(r=r.getFirstPicked(this.inst))&&r!=this.inst&&r.extra.box2dbody&&(this.myCreatedJoints.push({type:2,params:[w,r.uid,x,A]}),this.doCreateLimitedRevoluteJoint(w,
r.uid,x,A))};v.doCreateLimitedRevoluteJoint=function(w,r,x,A){if(this.enabled&&(r=this.runtime.getObjectByUID(r))&&r!=this.inst&&r.extra.box2dbody){r.extra.box2dbody.c2userdata.joiningMe.add(this.inst);var l=this.getInstImgPointX(w);w=this.getInstImgPointY(w);var y=new h;y.Initialize(this.body,r.extra.box2dbody,getTempVec2a(.02*l,.02*w));y.set_enableLimit(!0);y.set_lowerAngle(cr.to_radians(x));y.set_upperAngle(cr.to_radians(A));this.myJoints.push(this.world.CreateJoint(y));Box2D.destroy(y)}};f.prototype.SetWorldGravity=
function(w){if(w!==this.behavior.worldG){this.world.SetGravity(getTempVec2a(0,w));this.behavior.worldG=w;var r,x=this.behavior.my_instances.valuesRef();w=0;for(r=x.length;w<r;w++)x[w].extra.box2dbody&&x[w].extra.box2dbody.SetAwake(!0)}};f.prototype.SetSteppingMode=function(w){this.behavior.steppingMode=w};f.prototype.SetIterations=function(w,r){1>w&&(w=1);1>r&&(r=1);this.behavior.velocityIterations=w;this.behavior.positionIterations=r};f.prototype.SetVelocity=function(w,r){this.enabled&&(this.body.SetLinearVelocity(getTempVec2a(.02*
w,.02*r)),this.body.SetAwake(!0),this.lastTickOverride=!1,this.lastKnownX=this.inst.x,this.lastKnownY=this.inst.y)};f.prototype.SetDensity=function(w){if(this.enabled&&this.density!==w){this.density=w;var r;var x=0;for(r=this.fixtures.length;x<r;++x)this.fixtures[x].SetDensity(w);this.body.ResetMassData()}};f.prototype.SetFriction=function(w){if(this.enabled&&this.friction!==w){this.friction=w;var r;var x=0;for(r=this.fixtures.length;x<r;++x)this.fixtures[x].SetFriction(w);for(w=this.body.GetContactList();Box2D.getPointer(w);w=
w.get_next())(x=w.get_contact())&&x.ResetFriction()}};f.prototype.SetElasticity=function(w){if(this.enabled&&this.restitution!==w){this.restitution=w;var r;var x=0;for(r=this.fixtures.length;x<r;++x)this.fixtures[x].SetRestitution(w)}};f.prototype.SetLinearDamping=function(w){this.enabled&&this.linearDamping!==w&&(this.linearDamping=w,this.body.SetLinearDamping(w))};f.prototype.SetAngularDamping=function(w){this.enabled&&this.angularDamping!==w&&(this.angularDamping=w,this.body.SetAngularDamping(w))};
f.prototype.SetImmovable=function(w){this.enabled&&this.immovable!==(0!==w)&&(this.immovable=0!==w,this.body.SetType(this.immovable?0:2),this.body.SetAwake(!0))};f.prototype.EnableCollisions=function(w,r){if(w&&this.enabled){var x;if(w.is_family){var A=0;for(x=w.members.length;A<x;A++)g(this.inst.type,w.members[A],0!==r)}else g(this.inst.type,w,0!==r);this.behavior.allCollisionsEnabled=!1}};f.prototype.SetPreventRotate=function(w){this.enabled&&this.preventRotation!==(0!==w)&&(this.preventRotation=
0!==w,this.body.SetFixedRotation(this.preventRotation),this.body.SetAngularVelocity(0),this.body.SetAwake(!0))};f.prototype.SetBullet=function(w){this.enabled&&this.bullet!==(0!==w)&&(this.bullet=0!==w,this.body.SetBullet(this.bullet),this.body.SetAwake(!0))};f.prototype.RemoveJoints=function(){this.enabled&&(this.destroyMyJoints(),cr.clearArray(this.myCreatedJoints),this.joiningMe.clear())};f.prototype.SetEnabled=function(w){this.enabled&&0===w?(this.destroyBody(),this.enabled=!1):this.enabled||
1!==w||(this.enabled=!0,this.createBody())};u.acts=new f;n.prototype.VelocityX=function(w){w.set_float(this.enabled?this.body.GetLinearVelocity().get_x()/.02:0)};n.prototype.VelocityY=function(w){w.set_float(this.enabled?this.body.GetLinearVelocity().get_y()/.02:0)};n.prototype.AngularVelocity=function(w){w.set_float(this.enabled?cr.to_degrees(this.body.GetAngularVelocity()):0)};n.prototype.Mass=function(w){w.set_float(this.enabled?this.body.GetMass()/.02:0)};n.prototype.CenterOfMassX=function(w){w.set_float(this.enabled?
(this.body.GetPosition().get_x()+this.body.GetLocalCenter().get_x())/.02:0)};n.prototype.CenterOfMassY=function(w){w.set_float(this.enabled?(this.body.GetPosition().get_y()+this.body.GetLocalCenter().get_y())/.02:0)};n.prototype.Density=function(w){w.set_float(this.enabled?this.density:0)};n.prototype.Friction=function(w){w.set_float(this.enabled?this.friction:0)};n.prototype.Elasticity=function(w){w.set_float(this.enabled?this.restitution:0)};n.prototype.LinearDamping=function(w){w.set_float(this.enabled?
this.linearDamping:0)};n.prototype.AngularDamping=function(w){w.set_float(this.enabled?this.angularDamping:0)};u.exps=new n})();var easeOutBounceArray=[],easeInElasticArray=[],easeOutElasticArray=[],easeInOutElasticArray=[],easeInCircle=[],easeOutCircle=[],easeInOutCircle=[],easeInBack=[],easeOutBack=[],easeInOutBack=[],litetween_precision=1E4,updateLimit=0;
function easeOutBouncefunc(b){return result=(b/=1)<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+.9375:7.5625*(b-=2.625/2.75)*b+.984375}function integerize(b,f){return Math.round(b/f*litetween_precision)}
function easeFunc(b,f,g,n,t,e,c){var a=0;switch(b){case 0:a=n*f/t+g;break;case 1:a=n*(f/=t)*f+g;break;case 2:a=-n*(f/=t)*(f-2)+g;break;case 3:a=1>(f/=t/2)?n/2*f*f+g:-n/2*(--f*(f-2)-1)+g;break;case 4:a=n*(f/=t)*f*f+g;break;case 5:a=n*((f=f/t-1)*f*f+1)+g;break;case 6:a=1>(f/=t/2)?n/2*f*f*f+g:n/2*((f-=2)*f*f+2)+g;break;case 7:a=n*(f/=t)*f*f*f+g;break;case 8:a=-n*((f=f/t-1)*f*f*f-1)+g;break;case 9:a=1>(f/=t/2)?n/2*f*f*f*f+g:-n/2*((f-=2)*f*f*f-2)+g;break;case 10:a=n*(f/=t)*f*f*f*f+g;break;case 11:a=n*
((f=f/t-1)*f*f*f*f+1)+g;break;case 12:a=1>(f/=t/2)?n/2*f*f*f*f*f+g:n/2*((f-=2)*f*f*f*f+2)+g;break;case 13:a=c.optimized?easeInCircle[integerize(f,t)]:-(Math.sqrt(1-f*f)-1);break;case 14:a=c.optimized?easeOutCircle[integerize(f,t)]:Math.sqrt(1-(f-1)*(f-1));break;case 15:a=c.optimized?easeInOutCircle[integerize(f,t)]:1>(f/=t/2)?-n/2*(Math.sqrt(1-f*f)-1)+g:n/2*(Math.sqrt(1-(f-=2)*f)+1)+g;break;case 16:c.optimized?a=easeInBack[integerize(f,t)]:(c=c.s,a=n*(f/=t)*f*((c+1)*f-c)+g);break;case 17:c.optimized?
a=easeOutBack[integerize(f,t)]:(c=c.s,a=n*((f=f/t-1)*f*((c+1)*f+c)+1)+g);break;case 18:c.optimized?a=easeInOutBack[integerize(f,t)]:(c=c.s,a=1>(f/=t/2)?n/2*f*f*(((c*=1.525)+1)*f-c)+g:n/2*((f-=2)*f*(((c*=1.525)+1)*f+c)+2)+g);break;case 19:c.optimized?a=easeInElasticArray[integerize(f,t)]:(a=c.a,b=c.p,f/=t,0==b&&(b=.3*t),0==a||a<Math.abs(n)?(a=n,c=b/4):c=b/(2*Math.PI)*Math.asin(n/a),a=-(a*Math.pow(2,10*--f)*Math.sin(2*(f*t-c)*Math.PI/b))+g);break;case 20:c.optimized?a=easeOutElasticArray[integerize(f,
t)]:(a=c.a,b=c.p,f/=t,0==b&&(b=.3*t),0==a||a<Math.abs(n)?(a=n,c=b/4):c=b/(2*Math.PI)*Math.asin(n/a),a=a*Math.pow(2,-10*f)*Math.sin(2*(f*t-c)*Math.PI/b)+n+g);break;case 21:c.optimized?a=easeInOutElasticArray[integerize(f,t)]:(a=c.a,b=c.p,f/=t/2,0==b&&(b=.3*t*1.5),0==a||a<Math.abs(n)?(a=n,c=b/4):c=b/(2*Math.PI)*Math.asin(n/a),a=1>f?-.5*a*Math.pow(2,10*--f)*Math.sin(2*(f*t-c)*Math.PI/b)+g:a*Math.pow(2,-10*--f)*Math.sin(2*(f*t-c)*Math.PI/b)*.5+n+g);break;case 22:a=c.optimized?n-easeOutBounceArray[integerize(t-
f,t)]+g:n-easeOutBouncefunc(t-f/t)+g;break;case 23:a=c.optimized?easeOutBounceArray[integerize(f,t)]:easeOutBouncefunc(f/t);break;case 24:a=c.optimized?f<t/2?.5*(n-easeOutBounceArray[integerize(t-2*f,t)]+g)+g:.5*easeOutBounceArray[integerize(2*f-t,t)]+.5*n+g:f<t/2?.5*(n-easeOutBouncefunc(t-2*f)+g)+g:.5*easeOutBouncefunc((2*f-t)/t)+.5*n+g;break;case 25:f=f/t/2;a=2*f*f*(3-2*f);break;case 26:f=(f/t+1)/2;a=2*f*f*(3-2*f)-1;break;case 27:f/=t,a=f*f*(3-2*f)}return e?n-g-a:a}
(function(){for(var b,f,g,n,t=0;t<=litetween_precision;t++)g=t/litetween_precision,b=(g/=1)<1/2.75?7.5625*g*g:g<2/2.75?7.5625*(g-=1.5/2.75)*g+.75:g<2.5/2.75?7.5625*(g-=2.25/2.75)*g+.9375:7.5625*(g-=2.625/2.75)*g+.984375,easeOutBounceArray[t]=b,g=t/litetween_precision,f=b=0,g/=1,0==f&&(f=.3),0==b||1>b?(b=1,n=f/4):n=f/(2*Math.PI)*Math.asin(1/b),b=-(b*Math.pow(2,10*--g)*Math.sin(2*(1*g-n)*Math.PI/f)),easeInElasticArray[t]=b,g=t/litetween_precision,f=b=0,g/=1,0==f&&(f=.3),0==b||1>b?(b=1,n=f/4):n=f/(2*
Math.PI)*Math.asin(1/b),b=b*Math.pow(2,-10*g)*Math.sin(2*(1*g-n)*Math.PI/f)+1,easeOutElasticArray[t]=b,g=t/litetween_precision,f=b=0,g/=.5,0==f&&(f=.3*1.5),0==b||1>b?(b=1,n=f/4):n=f/(2*Math.PI)*Math.asin(1/b),b=1>g?-.5*b*Math.pow(2,10*--g)*Math.sin(2*(1*g-n)*Math.PI/f):b*Math.pow(2,-10*--g)*Math.sin(2*(1*g-n)*Math.PI/f)*.5+1,easeInOutElasticArray[t]=b,g=t/litetween_precision,easeInCircle[t]=-(Math.sqrt(1-g*g)-1),g=t/litetween_precision,easeOutCircle[t]=Math.sqrt(1-(g-1)*(g-1)),g=t/litetween_precision,
b=1>(g/=.5)?-.5*(Math.sqrt(1-g*g)-1):.5*(Math.sqrt(1-(g-=2)*g)+1),easeInOutCircle[t]=b,g=t/litetween_precision,n=0,0==n&&(n=1.70158),b=(g/=1)*g*((n+1)*g-n),easeInBack[t]=b,g=t/litetween_precision,n=0,0==n&&(n=1.70158),b=(g=g/1-1)*g*((n+1)*g+n)+1,easeOutBack[t]=b,g=t/litetween_precision,n=0,0==n&&(n=1.70158),b=1>(g/=.5)?.5*g*g*(((n*=1.525)+1)*g-n):.5*((g-=2)*g*(((n*=1.525)+1)*g+n)+2),easeInOutBack[t]=b})();
var TweenObject=function(){return function(b,f,g,n,t,e,c){this.name=b;this.value=0;this.setInitial(n);this.setTarget(t);this.easefunc=g;this.tweened=f;this.duration=e;this.state=this.progress=0;this.onReverseEnd=this.onReverseStart=this.onEnd=this.onStart=!1;this.lastKnownValue2=this.lastKnownValue=0;this.enforce=c;this.pingpong=1;this.flipEase=!1;this.easingparam=[];this.lastState=1;for(b=0;28>b;b++)this.easingparam[b]={},this.easingparam[b].a=0,this.easingparam[b].p=0,this.easingparam[b].t=0,this.easingparam[b].s=
0,this.easingparam[b].optimized=!0}}();
(function(){TweenObject.prototype={};TweenObject.prototype.flipTarget=function(){var b=this.initialparam1,f=this.initialparam2;this.initialparam1=this.targetparam1;this.initialparam2=this.targetparam2;this.targetparam1=b;this.targetparam2=f;this.lastKnownValue2=this.lastKnownValue=0};TweenObject.prototype.setInitial=function(b){this.initialparam1=parseFloat(b.split(",")[0]);this.initialparam2=parseFloat(b.split(",")[1]);this.lastKnownValue2=this.lastKnownValue=0};TweenObject.prototype.setTarget=function(b){this.targetparam1=
parseFloat(b.split(",")[0]);this.targetparam2=parseFloat(b.split(",")[1]);isNaN(this.targetparam2)&&(this.targetparam2=this.targetparam1)};TweenObject.prototype.OnTick=function(b){if(0===this.state)return-1;1===this.state&&(this.progress+=b);2===this.state&&(this.progress-=b);3===this.state&&(this.state=0);if(4===this.state||6===this.state)this.progress+=b*this.pingpong;5===this.state&&(this.progress+=b*this.pingpong);return 0>this.progress?(this.progress=0,4===this.state?this.pingpong=1:6===this.state?
(this.pingpong=1,this.flipEase=!1):this.state=0,this.onReverseEnd=!0,0):this.progress>this.duration?(this.progress=this.duration,4===this.state?this.pingpong=-1:6===this.state?(this.pingpong=-1,this.flipEase=!0):5===this.state?this.progress=0:this.state=0,this.onEnd=!0,1):this.flipEase?easeFunc(this.easefunc,this.duration-this.progress,0,1,this.duration,this.flipEase,this.easingparam[this.easefunc]):easeFunc(this.easefunc,this.progress,0,1,this.duration,this.flipEase,this.easingparam[this.easefunc])}})();
function trim(b){return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}cr.behaviors.lunarray_LiteTween=function(b){this.runtime=b};
(function(){var b=cr.behaviors.lunarray_LiteTween.prototype;b.Type=function(g,n){this.behavior=g;this.objtype=n;this.runtime=g.runtime};b.Type.prototype.onCreate=function(){};b.Instance=function(g,n){this.type=g;this.behavior=g.behavior;this.inst=n;this.runtime=g.runtime;this.i=0};var f=b.Instance.prototype;f.onCreate=function(){this.playmode=this.properties[0];this.active=1==this.playmode||2==this.playmode||3==this.playmode||4==this.playmode;this.tweened=this.properties[1];this.easing=this.properties[2];
this.target=this.properties[3];this.targetmode=this.properties[4];this.useCurrent=!1;1===this.targetmode&&(this.target="relative("+this.target+")");this.duration=this.properties[5];this.enforce=1===this.properties[6];this.value=0;this.tween_list={};this.addToTweenList("default",this.tweened,this.easing,"current",this.target,this.duration,this.enforce);1===this.properties[0]&&this.startTween(0);2===this.properties[0]&&this.startTween(2);3===this.properties[0]&&this.startTween(3);4===this.properties[0]&&
this.startTween(4)};f.parseCurrent=function(g,n){void 0===n&&(n="current");var t=trim(n);n=trim(n);var e=this.value;if("current"===n)switch(g){case 0:t=this.inst.x+","+this.inst.y;break;case 1:t=this.inst.width+","+this.inst.height;break;case 2:t=this.inst.width+","+this.inst.height;break;case 3:t=this.inst.width+","+this.inst.height;break;case 4:t=cr.to_degrees(this.inst.angle)+","+cr.to_degrees(this.inst.angle);break;case 5:t=100*this.inst.opacity+","+100*this.inst.opacity;break;case 6:t=e+","+
e;break;case 7:t=this.inst.x+","+this.inst.y;break;case 8:t=this.inst.x+","+this.inst.y;break;case 9:t=void 0!==this.inst.curFrame?this.inst.width/this.inst.curFrame.width+","+this.inst.height/this.inst.curFrame.height:"1,1"}if("relative"===n.substring(0,8)){if(n=n.match(/\((.*?)\)/))var c=parseFloat(n[1].split(",")[0]),a=parseFloat(n[1].split(",")[1]);isNaN(c)&&(c=0);isNaN(a)&&(a=0);switch(g){case 0:t=this.inst.x+c+","+(this.inst.y+a);break;case 1:t=this.inst.width+c+","+(this.inst.height+a);break;
case 2:t=this.inst.width+c+","+(this.inst.height+a);break;case 3:t=this.inst.width+c+","+(this.inst.height+a);break;case 4:t=cr.to_degrees(this.inst.angle)+c+","+(cr.to_degrees(this.inst.angle)+a);break;case 5:t=100*this.inst.opacity+c+","+(100*this.inst.opacity+a);break;case 6:t=e+c+","+e+c;break;case 7:t=this.inst.x+c+","+this.inst.y;break;case 8:t=this.inst.x+","+(this.inst.y+c);break;case 9:t=c+","+a}}return t};f.addToTweenList=function(g,n,t,e,c,a,d){e=this.parseCurrent(n,e);c=this.parseCurrent(n,
c);void 0!==this.tween_list[g]&&delete this.tween_list[g];this.tween_list[g]=new TweenObject(g,n,t,e,c,a,d);this.tween_list[g].dt=0};f.saveToJSON=function(){JSON.stringify(this.tween_list["default"]);return{playmode:this.playmode,active:this.active,tweened:this.tweened,easing:this.easing,target:this.target,targetmode:this.targetmode,useCurrent:this.useCurrent,duration:this.duration,enforce:this.enforce,value:this.value,tweenlist:JSON.stringify(this.tween_list["default"])}};TweenObject.Load=function(g,
n,t,e,c,a,d,h){n=new TweenObject(n,t,e,c,a,d,h);for(var u in g)n[u]=g[u];return n};f.loadFromJSON=function(g){var n=JSON.parse(g.tweenlist);n=TweenObject.Load(n,n.name,n.tweened,n.easefunc,n.initialparam1+","+n.initialparam2,n.targetparam1+","+n.targetparam2,n.duration,n.enforce);this.tween_list["default"]=n;this.playmode=g.playmode;this.active=g.active;this.movement=g.tweened;this.easing=g.easing;this.target=g.target;this.targetmode=g.targetmode;this.useCurrent=g.useCurrent;this.duration=g.duration;
this.enforce=g.enforce;this.value=g.value};f.setProgressTo=function(g){1<g&&(g=1);0>g&&(g=0);for(var n in this.tween_list){var t=this.tween_list[n];t.lastKnownValue=0;t.lastKnownValue2=0;t.state=3;t.progress=g*t.duration;var e=t.OnTick(0);this.updateTween(t,e)}};f.startTween=function(g){for(var n in this.tween_list){var t=this.tween_list[n];if(this.useCurrent){var e=this.parseCurrent(t.tweened,"current"),c=this.parseCurrent(t.tweened,this.target);t.setInitial(e);t.setTarget(c)}0===g&&(t.progress=
1E-6,t.lastKnownValue=0,t.lastKnownValue2=0,t.onStart=!0,t.state=1);1===g&&(t.state=t.lastState);if(2===g||4===g)t.progress=1E-6,t.lastKnownValue=0,t.lastKnownValue2=0,t.onStart=!0,2==g&&(t.state=4),4==g&&(t.state=6);3===g&&(t.progress=1E-6,t.lastKnownValue=0,t.lastKnownValue2=0,t.onStart=!0,t.state=5)}};f.stopTween=function(g){for(var n in this.tween_list){var t=this.tween_list[n];3!=t.state&&0!=t.state&&(t.lastState=t.state);1===g&&(t.progress=0);2===g&&(t.progress=t.duration);t.state=3;var e=t.OnTick(0);
this.updateTween(t,e)}};f.reverseTween=function(g){for(var n in this.tween_list){var t=this.tween_list[n];1===g&&(t.progress=t.duration,t.lastKnownValue=0,t.lastKnownValue2=0,t.onReverseStart=!0);t.state=2}};f.updateTween=function(g,n){if(0===g.tweened)g.enforce?(this.inst.x=g.initialparam1+(g.targetparam1-g.initialparam1)*n,this.inst.y=g.initialparam2+(g.targetparam2-g.initialparam2)*n):(this.inst.x+=(g.targetparam1-g.initialparam1)*n-g.lastKnownValue,this.inst.y+=(g.targetparam2-g.initialparam2)*
n-g.lastKnownValue2,g.lastKnownValue=(g.targetparam1-g.initialparam1)*n,g.lastKnownValue2=(g.targetparam2-g.initialparam2)*n);else if(1===g.tweened)g.enforce?(this.inst.width=g.initialparam1+(g.targetparam1-g.initialparam1)*n,this.inst.height=g.initialparam2+(g.targetparam2-g.initialparam2)*n):(this.inst.width+=(g.targetparam1-g.initialparam1)*n-g.lastKnownValue,this.inst.height+=(g.targetparam2-g.initialparam2)*n-g.lastKnownValue2,g.lastKnownValue=(g.targetparam1-g.initialparam1)*n,g.lastKnownValue2=
(g.targetparam2-g.initialparam2)*n);else if(2===g.tweened)g.enforce?this.inst.width=g.initialparam1+(g.targetparam1-g.initialparam1)*n:(this.inst.width+=(g.targetparam1-g.initialparam1)*n-g.lastKnownValue,g.lastKnownValue=(g.targetparam1-g.initialparam1)*n);else if(3===g.tweened)g.enforce?this.inst.height=g.initialparam2+(g.targetparam2-g.initialparam2)*n:(this.inst.height+=(g.targetparam2-g.initialparam2)*n-g.lastKnownValue2,g.lastKnownValue2=(g.targetparam2-g.initialparam2)*n);else if(4===g.tweened)if(g.enforce){var t=
g.initialparam1+(g.targetparam1-g.initialparam1)*n;this.inst.angle=cr.clamp_angle(cr.to_radians(t))}else t=(g.targetparam1-g.initialparam1)*n-g.lastKnownValue,this.inst.angle=cr.clamp_angle(this.inst.angle+cr.to_radians(t)),g.lastKnownValue=(g.targetparam1-g.initialparam1)*n;else if(5===g.tweened)g.enforce?this.inst.opacity=(g.initialparam1+(g.targetparam1-g.initialparam1)*n)/100:(this.inst.opacity+=((g.targetparam1-g.initialparam1)*n-g.lastKnownValue)/100,g.lastKnownValue=(g.targetparam1-g.initialparam1)*
n);else if(6===g.tweened)g.enforce?this.value=g.initialparam1+(g.targetparam1-g.initialparam1)*n:(this.value+=(g.targetparam1-g.initialparam1)*n-g.lastKnownValue,g.lastKnownValue=(g.targetparam1-g.initialparam1)*n);else if(7===g.tweened)g.enforce?this.inst.x=g.initialparam1+(g.targetparam1-g.initialparam1)*n:(this.inst.x+=(g.targetparam1-g.initialparam1)*n-g.lastKnownValue,g.lastKnownValue=(g.targetparam1-g.initialparam1)*n);else if(8===g.tweened)g.enforce?this.inst.y=g.initialparam2+(g.targetparam2-
g.initialparam2)*n:(this.inst.y+=(g.targetparam2-g.initialparam2)*n-g.lastKnownValue2,g.lastKnownValue2=(g.targetparam2-g.initialparam2)*n);else if(9===g.tweened){t=g.initialparam1+(g.targetparam1-g.initialparam1)*n;var e=g.initialparam2+(g.targetparam2-g.initialparam2)*n;0>this.inst.width&&(t=g.initialparam1+(g.targetparam1+g.initialparam1)*-n);0>this.inst.height&&(e=g.initialparam2+(g.targetparam2+g.initialparam2)*-n);g.enforce?(this.inst.width=this.inst.curFrame.width*t,this.inst.height=this.inst.curFrame.height*
e):(0>this.inst.width?(this.inst.width=this.inst.width/(-1+g.lastKnownValue)*t,g.lastKnownValue=t+1):(this.inst.width=this.inst.width/(1+g.lastKnownValue)*t,g.lastKnownValue=t-1),0>this.inst.height?(this.inst.height=this.inst.height/(-1+g.lastKnownValue2)*e,g.lastKnownValue2=e+1):(this.inst.height=this.inst.height/(1+g.lastKnownValue2)*e,g.lastKnownValue2=e-1))}this.inst.set_bbox_changed()};f.tick=function(){var g=this.runtime.getDt(this.inst),n=this.tween_list["default"];0!==n.state&&(n.onStart&&
(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnStart,this.inst),n.onStart=!1),n.onReverseStart&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnReverseStart,this.inst),n.onReverseStart=!1),this.active=1==n.state||2==n.state||4==n.state||5==n.state||6==n.state,g=n.OnTick(g),this.updateTween(n,g),n.onEnd&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnEnd,this.inst),n.onEnd=!1),n.onReverseEnd&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnReverseEnd,
this.inst),n.onReverseEnd=!1))};b.cnds={};f=b.cnds;f.IsActive=function(){return 0!==this.tween_list["default"].state};f.IsReversing=function(){return 2==this.tween_list["default"].state};f.CompareProgress=function(g,n){var t=this.tween_list["default"];return cr.do_cmp(t.progress/t.duration,g,n)};f.OnThreshold=function(g,n){var t=this.tween_list["default"];this.threshold=cr.do_cmp(t.progress/t.duration,g,n);if(g=this.oldthreshold!=this.threshold&&this.threshold)this.oldthreshold=this.threshold;return g};
f.OnStart=function(){return void 0===this.tween_list["default"]?!1:this.tween_list["default"].onStart};f.OnReverseStart=function(){return void 0===this.tween_list["default"]?!1:this.tween_list["default"].onReverseStart};f.OnEnd=function(){return void 0===this.tween_list["default"]?!1:this.tween_list["default"].onEnd};f.OnReverseEnd=function(){return void 0===this.tween_list["default"]?!1:this.tween_list["default"].onReverseEnd};b.acts={};f=b.acts;f.Start=function(g,n){this.oldthreshold=this.threshold=
!1;this.useCurrent=1==n;this.startTween(g)};f.Stop=function(g){this.stopTween(g)};f.Reverse=function(g){this.oldthreshold=this.threshold=!1;this.reverseTween(g)};f.ProgressTo=function(g){this.setProgressTo(g)};f.SetDuration=function(g){isNaN(g)||0>g||void 0===this.tween_list["default"]||(this.tween_list["default"].duration=g)};f.SetEnforce=function(g){void 0!==this.tween_list["default"]&&(this.tween_list["default"].enforce=1===g)};f.SetInitial=function(g){void 0!==this.tween_list["default"]&&(g=this.parseCurrent(this.tween_list["default"].tweened,
g),this.tween_list["default"].setInitial(g))};f.SetTarget=function(g,n,t){if(void 0!==this.tween_list["default"]&&!isNaN(t)){var e=this.tween_list["default"],c=t+"";this.targetmode=n;var a="",d="";if(1===n){this.target="relative("+c+")";switch(g){case 0:a=this.inst.x+t;d=e.targetparam2;break;case 1:a=e.targetparam1;d=this.inst.y+t;break;case 2:d=a=""+cr.to_degrees(this.inst.angle+cr.to_radians(t));break;case 3:d=a=""+100*this.inst.opacity+t;break;case 4:a=this.inst.width+t;d=e.targetparam2;break;
case 5:a=e.targetparam1;d=this.inst.height+t;break;case 6:d=a=t}c=a+","+d}else{switch(g){case 0:a=t;d=e.targetparam2;break;case 1:a=e.targetparam1;d=t;break;case 2:d=a=t;break;case 3:d=a=t;break;case 4:a=t;d=e.targetparam2;break;case 5:a=e.targetparam1;d=t;break;case 6:d=a=t}this.target=c=a+","+d}g=this.parseCurrent(this.tween_list["default"].tweened,"current");c=this.parseCurrent(this.tween_list["default"].tweened,c);e.setInitial(g);e.setTarget(c)}};f.SetTweenedProperty=function(g){void 0!==this.tween_list["default"]&&
(this.tween_list["default"].tweened=g)};f.SetEasing=function(g){void 0!==this.tween_list["default"]&&(this.tween_list["default"].easefunc=g)};f.SetEasingParam=function(g,n,t,e,c){void 0!==this.tween_list["default"]&&(this.tween_list["default"].easingparam[g].optimized=!1,this.tween_list["default"].easingparam[g].a=n,this.tween_list["default"].easingparam[g].p=t,this.tween_list["default"].easingparam[g].t=e,this.tween_list["default"].easingparam[g].s=c)};f.ResetEasingParam=function(){void 0!==this.tween_list["default"]&&
(this.tween_list["default"].optimized=!0)};f.SetValue=function(g){var n=this.tween_list["default"];this.value=g;6===n.tweened&&n.setInitial(this.parseCurrent(n.tweened,"current"))};f.SetParameter=function(g,n,t,e,c){if(void 0===this.tween_list["default"])this.addToTweenList("default",g,n,initial,t,e,c,0);else{var a=this.tween_list["default"];a.tweened=g;a.easefunc=n;a.setInitial(this.parseCurrent(g,"current"));a.setTarget(this.parseCurrent(g,t));a.duration=e;a.enforce=1===c}};b.exps={};b=b.exps;b.State=
function(g){var n="N/A";switch(this.tween_list["default"].state){case 0:n="paused";break;case 1:n="playing";break;case 2:n="reversing";break;case 3:n="seeking"}g.set_string(n)};b.Progress=function(g){g.set_float(this.tween_list["default"].progress/this.tween_list["default"].duration)};b.Duration=function(g){g.set_float(this.tween_list["default"].duration)};b.Target=function(g){var n=this.tween_list["default"],t="N/A";switch(n.tweened){case 0:t=n.targetparam1;break;case 1:t=n.targetparam2;break;case 2:t=
n.targetparam1;break;case 3:t=n.targetparam1;break;case 4:t=n.targetparam1;break;case 5:t=n.targetparam2;break;case 6:t=n.targetparam1}g.set_float(t)};b.Value=function(g){g.set_float(this.value)};b.Tween=function(g,n,t,e,c){e=1<e?1:e;c=easeFunc(c,0>e?0:e,0,1,1,!1,!1);g.set_float(n+c*(t-n))}})();cr.behaviors.Bullet=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.Bullet.prototype;n.Type=function(e,c){this.behavior=e;this.objtype=c;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e,c){this.type=e;this.behavior=e.behavior;this.inst=c;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){var e=this.properties[0];this.acc=this.properties[1];this.g=this.properties[2];this.bounceOffSolid=this.properties[3];this.setAngle=this.properties[4];
this.step=this.properties[5];this.stepSize=Math.abs(Math.min(this.inst.width,this.inst.height)/2);this.stopStepping=!1;this.dx=Math.cos(this.inst.angle)*e;this.dy=Math.sin(this.inst.angle)*e;this.lastx=this.inst.x;this.lasty=this.inst.y;this.lastKnownAngle=this.inst.angle;this.travelled=0;this.enabled=this.properties[6]};t.saveToJSON=function(){return{acc:this.acc,g:this.g,dx:this.dx,dy:this.dy,lx:this.lastx,ly:this.lasty,lka:this.lastKnownAngle,t:this.travelled,st:this.step,e:this.enabled}};t.loadFromJSON=
function(e){this.acc=e.acc;this.g=e.g;this.dx=e.dx;this.dy=e.dy;this.lastx=e.lx;this.lasty=e.ly;this.lastKnownAngle=e.lka;this.travelled=e.t;this.step=!!e.st;this.enabled=e.e};t.tick=function(){if(this.enabled){var e=this.runtime.getDt(this.inst);if(this.inst.angle!==this.lastKnownAngle){if(this.setAngle){var c=cr.distanceTo(0,0,this.dx,this.dy);this.dx=Math.cos(this.inst.angle)*c;this.dy=Math.sin(this.inst.angle)*c}this.lastKnownAngle=this.inst.angle}var a=0;var d=0;if(0!==this.acc){c=cr.distanceTo(0,
0,this.dx,this.dy);var h=0===this.dx&&0===this.dy?this.inst.angle:cr.angleTo(0,0,this.dx,this.dy);c+=this.acc*e;a=Math.cos(h)*this.acc;d=Math.sin(h)*this.acc;0>c&&(d=a=c=0);this.dx=Math.cos(h)*c;this.dy=Math.sin(h)*c}0!==this.g&&(this.dy+=this.g*e,d+=this.g);this.lastx=this.inst.x;this.lasty=this.inst.y;if(0!==this.dx||0!==this.dy)if(c=this.runtime.accelerate(this.dx,-Infinity,Infinity,a,e),d=this.runtime.accelerate(this.dy,-Infinity,Infinity,d,e),this.moveBy(c,d),this.travelled+=cr.distanceTo(this.lastx,
this.lasty,this.inst.x,this.inst.y),!this.setAngle||0===c&&0===d||(this.inst.angle=cr.angleTo(0,0,c,d),this.inst.set_bbox_changed(),this.lastKnownAngle=this.inst.angle),this.bounceOffSolid&&(c=this.runtime.testOverlapSolid(this.inst)))this.runtime.registerCollision(this.inst,c),c=cr.distanceTo(0,0,this.dx,this.dy),d=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty),this.dx=Math.cos(d)*c,this.dy=Math.sin(d)*c,this.inst.x+=this.dx*e,this.inst.y+=this.dy*e,this.inst.set_bbox_changed(),
this.setAngle&&(this.lastKnownAngle=this.inst.angle=d,this.inst.set_bbox_changed()),this.runtime.pushOutSolid(this.inst,this.dx/c,this.dy/c,Math.max(2.5*c*e,30))||this.runtime.pushOutSolidNearest(this.inst,100)}};t.moveBy=function(e,c){var a=cr.distanceTo(0,0,e,c);if(!this.step||a<=this.stepSize)this.inst.x+=e,this.inst.y+=c,this.inst.set_bbox_changed(),this.step&&this.runtime.trigger(cr.behaviors.Bullet.prototype.cnds.OnStep,this.inst);else{this.stopStepping=!1;var d=this.inst.x,h=this.inst.y,u=
d+e,v=h+c;c=cr.angleTo(0,0,e,c);e=Math.cos(c)*this.stepSize;c=Math.sin(c)*this.stepSize;a=Math.floor(a/this.stepSize);for(var C=1;C<=a;++C)if(this.inst.x=d+e*C,this.inst.y=h+c*C,this.inst.set_bbox_changed(),this.runtime.trigger(cr.behaviors.Bullet.prototype.cnds.OnStep,this.inst),this.inst.isDestroyed||this.stopStepping)return;this.inst.x=u;this.inst.y=v;this.inst.set_bbox_changed();this.runtime.trigger(cr.behaviors.Bullet.prototype.cnds.OnStep,this.inst)}};b.prototype.CompareSpeed=function(e,c){return cr.do_cmp(cr.distanceTo(0,
0,this.dx,this.dy),e,c)};b.prototype.CompareTravelled=function(e,c){return cr.do_cmp(this.travelled,e,c)};b.prototype.OnStep=function(){return!0};b.prototype.IsEnabled=function(){return this.enabled};n.cnds=new b;f.prototype.SetSpeed=function(e){var c=cr.angleTo(0,0,this.dx,this.dy);this.dx=Math.cos(c)*e;this.dy=Math.sin(c)*e};f.prototype.SetAcceleration=function(e){this.acc=e};f.prototype.SetGravity=function(e){this.g=e};f.prototype.SetAngleOfMotion=function(e){e=cr.to_radians(e);var c=cr.distanceTo(0,
0,this.dx,this.dy);this.dx=Math.cos(e)*c;this.dy=Math.sin(e)*c};f.prototype.Bounce=function(e){if(e&&(e=e.getFirstPicked(this.inst))){var c=this.runtime.getDt(this.inst),a=cr.distanceTo(0,0,this.dx,this.dy),d=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty,e);this.dx=Math.cos(d)*a;this.dy=Math.sin(d)*a;this.inst.x+=this.dx*c;this.inst.y+=this.dy*c;this.inst.set_bbox_changed();this.setAngle&&(this.lastKnownAngle=this.inst.angle=d,this.inst.set_bbox_changed());0!==a&&(this.bounceOffSolid?
this.runtime.pushOutSolid(this.inst,this.dx/a,this.dy/a,Math.max(2.5*a*c,30))||this.runtime.pushOutSolidNearest(this.inst,100):this.runtime.pushOut(this.inst,this.dx/a,this.dy/a,Math.max(2.5*a*c,30),e))}};f.prototype.SetBounceOffSolids=function(e){this.bounceOffSolid=e};f.prototype.SetDistanceTravelled=function(e){this.travelled=e};f.prototype.SetEnabled=function(e){this.enabled=1===e};f.prototype.StopStepping=function(){this.stopStepping=!0};n.acts=new f;g.prototype.Speed=function(e){var c=cr.distanceTo(0,
0,this.dx,this.dy);c=cr.round6dp(c);e.set_float(c)};g.prototype.Acceleration=function(e){e.set_float(this.acc)};g.prototype.AngleOfMotion=function(e){e.set_float(cr.to_degrees(cr.angleTo(0,0,this.dx,this.dy)))};g.prototype.DistanceTravelled=function(e){e.set_float(this.travelled)};g.prototype.Gravity=function(e){e.set_float(this.g)};n.exps=new g})();cr.behaviors.destroy=function(b){this.runtime=b};
(function(){var b=cr.behaviors.destroy.prototype;b.Type=function(f,g){this.behavior=f;this.objtype=g;this.runtime=f.runtime};b.Type.prototype.onCreate=function(){};b.Instance=function(f,g){this.type=f;this.behavior=f.behavior;this.inst=g;this.runtime=f.runtime};b=b.Instance.prototype;b.onCreate=function(){};b.tick=function(){this.inst.update_bbox();var f=this.inst.bbox,g=this.inst.layer.layout;(0>f.right||0>f.bottom||f.left>g.width||f.top>g.height)&&this.runtime.DestroyInstance(this.inst)}})();
cr.behaviors.Pin=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.Pin.prototype;n.Type=function(e,c){this.behavior=e;this.objtype=c;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e,c){this.type=e;this.behavior=e.behavior;this.inst=c;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.pinObject=null;this.pinObjectUid=-1;this.mode=this.lastKnownAngle=this.theirStartAngle=this.myStartAngle=this.pinDist=this.pinAngle=0;var e=this;this.recycled||
(this.myDestroyCallback=function(c){e.onInstanceDestroyed(c)});this.runtime.addDestroyCallback(this.myDestroyCallback)};t.saveToJSON=function(){return{uid:this.pinObject?this.pinObject.uid:-1,pa:this.pinAngle,pd:this.pinDist,msa:this.myStartAngle,tsa:this.theirStartAngle,lka:this.lastKnownAngle,m:this.mode}};t.loadFromJSON=function(e){this.pinObjectUid=e.uid;this.pinAngle=e.pa;this.pinDist=e.pd;this.myStartAngle=e.msa;this.theirStartAngle=e.tsa;this.lastKnownAngle=e.lka;this.mode=e.m};t.afterLoad=
function(){this.pinObject=-1===this.pinObjectUid?null:this.runtime.getObjectByUID(this.pinObjectUid);this.pinObjectUid=-1};t.onInstanceDestroyed=function(e){this.pinObject==e&&(this.pinObject=null)};t.onDestroy=function(){this.pinObject=null;this.runtime.removeDestroyCallback(this.myDestroyCallback)};t.tick=function(){};t.tick2=function(){if(this.pinObject){this.lastKnownAngle!==this.inst.angle&&(this.myStartAngle=cr.clamp_angle(this.myStartAngle+(this.inst.angle-this.lastKnownAngle)));var e=this.inst.x,
c=this.inst.y;if(3===this.mode||4===this.mode){var a=cr.distanceTo(this.inst.x,this.inst.y,this.pinObject.x,this.pinObject.y);if(a>this.pinDist||4===this.mode&&a<this.pinDist)c=cr.angleTo(this.pinObject.x,this.pinObject.y,this.inst.x,this.inst.y),e=this.pinObject.x+Math.cos(c)*this.pinDist,c=this.pinObject.y+Math.sin(c)*this.pinDist}else e=this.pinObject.x+Math.cos(this.pinObject.angle+this.pinAngle)*this.pinDist,c=this.pinObject.y+Math.sin(this.pinObject.angle+this.pinAngle)*this.pinDist;this.lastKnownAngle=
a=cr.clamp_angle(this.myStartAngle+(this.pinObject.angle-this.theirStartAngle));0!==this.mode&&1!==this.mode&&3!==this.mode&&4!==this.mode||this.inst.x===e&&this.inst.y===c||(this.inst.x=e,this.inst.y=c,this.inst.set_bbox_changed());0!==this.mode&&2!==this.mode||this.inst.angle===a||(this.inst.angle=a,this.inst.set_bbox_changed())}};b.prototype.IsPinned=function(){return!!this.pinObject};n.cnds=new b;f.prototype.Pin=function(e,c){e&&(e=e.getFirstPicked(this.inst))&&(this.pinObject=e,this.pinAngle=
cr.angleTo(e.x,e.y,this.inst.x,this.inst.y)-e.angle,this.pinDist=cr.distanceTo(e.x,e.y,this.inst.x,this.inst.y),this.lastKnownAngle=this.myStartAngle=this.inst.angle,this.theirStartAngle=e.angle,this.mode=c)};f.prototype.Unpin=function(){this.pinObject=null};n.acts=new f;g.prototype.PinnedUID=function(e){e.set_int(this.pinObject?this.pinObject.uid:-1)};n.exps=new g})();cr.behaviors.Fade=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.Fade.prototype;n.Type=function(e,c){this.behavior=e;this.objtype=c;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e,c){this.type=e;this.behavior=e.behavior;this.inst=c;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.fadeInTime=this.properties[0];this.waitTime=this.properties[1];this.fadeOutTime=this.properties[2];this.destroy=this.properties[3];this.activeAtStart=
this.properties[4];this.setMaxOpacity=!1;this.stage=this.activeAtStart?0:3;this.recycled?this.stageTime.reset():this.stageTime=new cr.KahanAdder;this.maxOpacity=this.inst.opacity?this.inst.opacity:1;this.activeAtStart&&(0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0))};t.saveToJSON=function(){return{fit:this.fadeInTime,wt:this.waitTime,fot:this.fadeOutTime,s:this.stage,st:this.stageTime.sum,mo:this.maxOpacity}};t.loadFromJSON=function(e){this.fadeInTime=
e.fit;this.waitTime=e.wt;this.fadeOutTime=e.fot;this.stage=e.s;this.stageTime.reset();this.stageTime.sum=e.st;this.maxOpacity=e.mo};t.tick=function(){this.stageTime.add(this.runtime.getDt(this.inst));0===this.stage&&(this.inst.opacity=this.stageTime.sum/this.fadeInTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity>=this.maxOpacity&&(this.inst.opacity=this.maxOpacity,this.stage=1,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeInEnd,this.inst)));1===this.stage&&
this.stageTime.sum>=this.waitTime&&(this.stage=2,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnWaitEnd,this.inst));2===this.stage&&0!==this.fadeOutTime&&(this.inst.opacity=this.maxOpacity-this.stageTime.sum/this.fadeOutTime*this.maxOpacity,this.runtime.redraw=!0,0>this.inst.opacity&&(this.inst.opacity=0,this.stage=3,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeOutEnd,this.inst),this.destroy&&this.runtime.DestroyInstance(this.inst)))};
t.doStart=function(){this.stage=0;this.stageTime.reset();0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0)};b.prototype.OnFadeOutEnd=function(){return!0};b.prototype.OnFadeInEnd=function(){return!0};b.prototype.OnWaitEnd=function(){return!0};n.cnds=new b;f.prototype.StartFade=function(){this.activeAtStart||this.setMaxOpacity||(this.maxOpacity=this.inst.opacity?this.inst.opacity:1,this.setMaxOpacity=!0);3===this.stage&&this.doStart()};
f.prototype.RestartFade=function(){this.doStart()};f.prototype.SetFadeInTime=function(e){0>e&&(e=0);this.fadeInTime=e};f.prototype.SetWaitTime=function(e){0>e&&(e=0);this.waitTime=e};f.prototype.SetFadeOutTime=function(e){0>e&&(e=0);this.fadeOutTime=e};n.acts=new f;g.prototype.FadeInTime=function(e){e.set_float(this.fadeInTime)};g.prototype.WaitTime=function(e){e.set_float(this.waitTime)};g.prototype.FadeOutTime=function(e){e.set_float(this.fadeOutTime)};n.exps=new g})();
cr.behaviors.Rotate=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.Rotate.prototype;n.Type=function(e,c){this.behavior=e;this.objtype=c;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e,c){this.type=e;this.behavior=e.behavior;this.inst=c;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.speed=cr.to_radians(this.properties[0]);this.acc=cr.to_radians(this.properties[1]);this.enabled=this.properties[2]};t.saveToJSON=function(){return{speed:this.speed,
acc:this.acc,e:this.enabled}};t.loadFromJSON=function(e){this.speed=e.speed;this.acc=e.acc;e.hasOwnProperty("e")?this.enabled=e.e:this.enabled=!0};t.tick=function(){if(this.enabled){var e=this.runtime.getDt(this.inst);0!==e&&(0!==this.acc&&(this.speed+=this.acc*e),0!==this.speed&&(this.inst.angle=cr.clamp_angle(this.inst.angle+this.speed*e),this.inst.set_bbox_changed()))}};b.prototype.IsEnabled=function(){return this.enabled};n.cnds=new b;f.prototype.SetSpeed=function(e){this.speed=cr.to_radians(e)};
f.prototype.SetAcceleration=function(e){this.acc=cr.to_radians(e)};f.prototype.SetEnabled=function(e){this.enabled=1===e};n.acts=new f;g.prototype.Speed=function(e){e.set_float(cr.to_degrees(this.speed))};g.prototype.Acceleration=function(e){e.set_float(cr.to_degrees(this.acc))};n.exps=new g})();cr.behaviors.Sin=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.Sin.prototype;n.Type=function(h,u){this.behavior=h;this.objtype=u;this.runtime=h.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(h,u){this.type=h;this.behavior=h.behavior;this.inst=u;this.runtime=h.runtime;this.i=0};var t=n.Instance.prototype,e=2*Math.PI,c=Math.PI/2,a=3*Math.PI/2,d=[0,1,8,3,4,2,5,6,7];t.onCreate=function(){this.movement=d[this.properties[0]];this.wave=this.properties[1];this.period=this.properties[2];
this.period+=Math.random()*this.properties[3];0===this.period?this.i=0:(this.i=this.properties[4]/this.period*e,this.i+=Math.random()*this.properties[5]/this.period*e);this.mag=this.properties[6];this.mag+=Math.random()*this.properties[7];this.isEnabled=this.properties[8];this.ratio=this.initialValue2=this.initialValue=0;5===this.movement&&(this.mag=cr.to_radians(this.mag));this.init()};t.saveToJSON=function(){return{i:this.i,a:this.isEnabled,mv:this.movement,w:this.wave,p:this.period,mag:this.mag,
iv:this.initialValue,iv2:this.initialValue2,r:this.ratio,lkv:this.lastKnownValue,lkv2:this.lastKnownValue2}};t.loadFromJSON=function(h){this.i=h.i;this.isEnabled=h.a;this.movement=h.mv;this.wave=h.w;this.period=h.p;this.mag=h.mag;this.initialValue=h.iv;this.initialValue2=h.iv2||0;this.ratio=h.r;this.lastKnownValue=h.lkv;this.lastKnownValue2=h.lkv2||0};t.init=function(){switch(this.movement){case 0:this.initialValue=this.inst.x;break;case 1:this.initialValue=this.inst.y;break;case 2:this.initialValue=
this.inst.width;this.ratio=this.inst.height/this.inst.width;break;case 3:this.initialValue=this.inst.width;break;case 4:this.initialValue=this.inst.height;break;case 5:this.initialValue=this.inst.angle;break;case 6:this.initialValue=this.inst.opacity;break;case 7:this.initialValue=0;break;case 8:this.initialValue=this.inst.x,this.initialValue2=this.inst.y}this.lastKnownValue=this.initialValue;this.lastKnownValue2=this.initialValue2};t.waveFunc=function(h){h%=e;switch(this.wave){case 0:return Math.sin(h);
case 1:return h<=c?h/c:h<=a?1-2*(h-c)/Math.PI:(h-a)/c-1;case 2:return 2*h/e-1;case 3:return-2*h/e+1;case 4:return h<Math.PI?-1:1}return 0};t.tick=function(){var h=this.runtime.getDt(this.inst);this.isEnabled&&0!==h&&(0===this.period?this.i=0:(this.i+=h/this.period*e,this.i%=e),this.updateFromPhase())};t.updateFromPhase=function(){switch(this.movement){case 0:this.inst.x!==this.lastKnownValue&&(this.initialValue+=this.inst.x-this.lastKnownValue);this.inst.x=this.initialValue+this.waveFunc(this.i)*
this.mag;this.lastKnownValue=this.inst.x;break;case 1:this.inst.y!==this.lastKnownValue&&(this.initialValue+=this.inst.y-this.lastKnownValue);this.inst.y=this.initialValue+this.waveFunc(this.i)*this.mag;this.lastKnownValue=this.inst.y;break;case 2:this.inst.width=this.initialValue+this.waveFunc(this.i)*this.mag;this.inst.height=this.inst.width*this.ratio;break;case 3:this.inst.width=this.initialValue+this.waveFunc(this.i)*this.mag;break;case 4:this.inst.height=this.initialValue+this.waveFunc(this.i)*
this.mag;break;case 5:this.inst.angle!==this.lastKnownValue&&(this.initialValue=cr.clamp_angle(this.initialValue+(this.inst.angle-this.lastKnownValue)));this.inst.angle=cr.clamp_angle(this.initialValue+this.waveFunc(this.i)*this.mag);this.lastKnownValue=this.inst.angle;break;case 6:this.inst.opacity=this.initialValue+this.waveFunc(this.i)*this.mag/100;0>this.inst.opacity?this.inst.opacity=0:1<this.inst.opacity&&(this.inst.opacity=1);break;case 8:this.inst.x!==this.lastKnownValue&&(this.initialValue+=
this.inst.x-this.lastKnownValue),this.inst.y!==this.lastKnownValue2&&(this.initialValue2+=this.inst.y-this.lastKnownValue2),this.inst.x=this.initialValue+Math.cos(this.inst.angle)*this.waveFunc(this.i)*this.mag,this.inst.y=this.initialValue2+Math.sin(this.inst.angle)*this.waveFunc(this.i)*this.mag,this.lastKnownValue=this.inst.x,this.lastKnownValue2=this.inst.y}this.inst.set_bbox_changed()};t.onSpriteFrameChanged=function(h,u){switch(this.movement){case 2:this.initialValue*=u.width/h.width;this.ratio=
u.height/u.width;break;case 3:this.initialValue*=u.width/h.width;break;case 4:this.initialValue*=u.height/h.height}};b.prototype.IsEnabled=function(){return this.isEnabled};b.prototype.CompareMovement=function(h){return this.movement===h};b.prototype.ComparePeriod=function(h,u){return cr.do_cmp(this.period,h,u)};b.prototype.CompareMagnitude=function(h,u){return 5===this.movement?cr.do_cmp(this.mag,h,cr.to_radians(u)):cr.do_cmp(this.mag,h,u)};b.prototype.CompareWave=function(h){return this.wave===
h};n.cnds=new b;f.prototype.SetEnabled=function(h){this.isEnabled=1===h};f.prototype.SetPeriod=function(h){this.period=h};f.prototype.SetMagnitude=function(h){this.mag=h;5===this.movement&&(this.mag=cr.to_radians(this.mag))};f.prototype.SetMovement=function(h){5===this.movement&&5!==h&&(this.mag=cr.to_degrees(this.mag));this.movement=h;this.init()};f.prototype.SetWave=function(h){this.wave=h};f.prototype.SetPhase=function(h){this.i=h*e%e;this.updateFromPhase()};f.prototype.UpdateInitialState=function(){this.init()};
n.acts=new f;g.prototype.CyclePosition=function(h){h.set_float(this.i/e)};g.prototype.Period=function(h){h.set_float(this.period)};g.prototype.Magnitude=function(h){5===this.movement?h.set_float(cr.to_degrees(this.mag)):h.set_float(this.mag)};g.prototype.Value=function(h){h.set_float(this.waveFunc(this.i)*this.mag)};n.exps=new g})();
cr.behaviors.DragnDrop=function(b){this.runtime=b;var f=this;document.addEventListener("mousemove",function(g){f.onMouseMove(g)});document.addEventListener("mousedown",function(g){f.onMouseDown(g)});document.addEventListener("mouseup",function(g){f.onMouseUp(g)});b=0<this.runtime.fullscreen_mode?document:this.runtime.canvas;"undefined"!==typeof PointerEvent?(b.addEventListener("pointerdown",function(g){f.onPointerStart(g)},!1),b.addEventListener("pointermove",function(g){f.onPointerMove(g)},!1),b.addEventListener("pointerup",
function(g){f.onPointerEnd(g)},!1),b.addEventListener("pointercancel",function(g){f.onPointerEnd(g)},!1)):window.navigator.msPointerEnabled?(b.addEventListener("MSPointerDown",function(g){f.onPointerStart(g)},!1),b.addEventListener("MSPointerMove",function(g){f.onPointerMove(g)},!1),b.addEventListener("MSPointerUp",function(g){f.onPointerEnd(g)},!1),b.addEventListener("MSPointerCancel",function(g){f.onPointerEnd(g)},!1)):(b.addEventListener("touchstart",function(g){f.onTouchStart(g)},!1),b.addEventListener("touchmove",
function(g){f.onTouchMove(g)},!1),b.addEventListener("touchend",function(g){f.onTouchEnd(g)},!1),b.addEventListener("touchcancel",function(g){f.onTouchEnd(g)},!1))};
(function(){function b(e){var c;var a=0;for(c=e.behavior_insts.length;a<c;a++)if(e.behavior_insts[a]instanceof n.Instance)return e.behavior_insts[a];return null}function f(){}function g(){}var n=cr.behaviors.DragnDrop.prototype;n.onMouseDown=function(e){if(1===e.which)this.onInputDown("leftmouse",e.pageX,e.pageY)};n.onMouseMove=function(e){if(1===e.which)this.onInputMove("leftmouse",e.pageX,e.pageY)};n.onMouseUp=function(e){if(1===e.which)this.onInputUp("leftmouse")};n.onTouchStart=function(e){e.preventDefault&&
cr.isCanvasInputEvent(e)&&e.preventDefault();var c;var a=0;for(c=e.changedTouches.length;a<c;a++){var d=e.changedTouches[a];var h=d.identifier;this.onInputDown(h?h.toString():"<none>",d.pageX,d.pageY)}};n.onTouchMove=function(e){e.preventDefault&&e.preventDefault();var c;var a=0;for(c=e.changedTouches.length;a<c;a++){var d=e.changedTouches[a];var h=d.identifier;this.onInputMove(h?h.toString():"<none>",d.pageX,d.pageY)}};n.onTouchEnd=function(e){e.preventDefault&&cr.isCanvasInputEvent(e)&&e.preventDefault();
var c;var a=0;for(c=e.changedTouches.length;a<c;a++){var d=e.changedTouches[a];d=d.identifier;this.onInputUp(d?d.toString():"<none>")}};n.onPointerStart=function(e){e.pointerType!==e.MSPOINTER_TYPE_MOUSE&&"mouse"!==e.pointerType&&(e.preventDefault&&cr.isCanvasInputEvent(e)&&e.preventDefault(),this.onInputDown(e.pointerId.toString(),e.pageX,e.pageY))};n.onPointerMove=function(e){e.pointerType!==e.MSPOINTER_TYPE_MOUSE&&"mouse"!==e.pointerType&&(e.preventDefault&&e.preventDefault(),this.onInputMove(e.pointerId.toString(),
e.pageX,e.pageY))};n.onPointerEnd=function(e){e.pointerType!==e.MSPOINTER_TYPE_MOUSE&&"mouse"!==e.pointerType&&(e.preventDefault&&cr.isCanvasInputEvent(e)&&e.preventDefault(),this.onInputUp(e.pointerId.toString()))};n.onInputDown=function(e,c,a){c-=this.runtime.canvas.offsetLeft;a-=this.runtime.canvas.offsetTop;var d=this.my_instances.valuesRef(),h,u=null;var v=0;for(h=d.length;v<h;v++){var C=d[v];var w=b(C);if(w.enabled&&!w.dragging){w=C.layer.canvasToLayer(c,a,!0);var r=C.layer.canvasToLayer(c,
a,!1);C.update_bbox();if(C.contains_pt(w,r))if(u)C.layer.index>u.layer.index?(u=C,x=w,A=r):C.layer.index===u.layer.index&&C.get_zindex()>u.get_zindex()&&(u=C,x=w,A=r);else{u=C;var x=w;var A=r}}}if(u)b(u).onDown(e,x,A)};n.onInputMove=function(e,c,a){c-=this.runtime.canvas.offsetLeft;a-=this.runtime.canvas.offsetTop;var d=this.my_instances.valuesRef(),h;var u=0;for(h=d.length;u<h;u++){var v=d[u];var C=b(v);if(C.enabled&&C.dragging&&(!C.dragging||C.dragsource===e)){var w=v.layer.canvasToLayer(c,a,!0);
v=v.layer.canvasToLayer(c,a,!1);C.onMove(w,v)}}};n.onInputUp=function(e){var c=this.my_instances.valuesRef(),a;var d=0;for(a=c.length;d<a;d++){var h=c[d];h=b(h);if(h.dragging&&h.dragsource===e)h.onUp()}};n.Type=function(e,c){this.behavior=e;this.objtype=c;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e,c){this.type=e;this.behavior=e.behavior;this.inst=c;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.dragging=!1;this.dy=this.dx=0;
this.dragsource="<none>";this.axes=this.properties[0];this.enabled=this.properties[1]};t.saveToJSON=function(){return{enabled:this.enabled}};t.loadFromJSON=function(e){this.enabled=e.enabled;this.dragging=!1};t.onDown=function(e,c,a){this.dx=c-this.inst.x;this.dy=a-this.inst.y;this.dragging=!0;this.dragsource=e;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.behaviors.DragnDrop.prototype.cnds.OnDragStart,this.inst);this.runtime.isInUserInputEvent=!1};t.onMove=function(e,c){e-=this.dx;c-=
this.dy;if(0===this.axes){if(this.inst.x!==e||this.inst.y!==c)this.inst.x=e,this.inst.y=c,this.inst.set_bbox_changed()}else 1===this.axes?this.inst.x!==e&&(this.inst.x=e,this.inst.set_bbox_changed()):2===this.axes&&this.inst.y!==c&&(this.inst.y=c,this.inst.set_bbox_changed())};t.onUp=function(){this.dragging=!1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.behaviors.DragnDrop.prototype.cnds.OnDrop,this.inst);this.runtime.isInUserInputEvent=!1};t.tick=function(){};f.prototype.IsDragging=
function(){return this.dragging};f.prototype.OnDragStart=function(){return!0};f.prototype.OnDrop=function(){return!0};f.prototype.IsEnabled=function(){return!!this.enabled};n.cnds=new f;g.prototype.SetEnabled=function(e){this.enabled=0!==e;this.enabled||(this.dragging=!1)};g.prototype.SetAxes=function(e){this.axes=e};g.prototype.Drop=function(){if(this.dragging)this.onUp()};n.acts=new g;n.exps=new function(){}})();cr.behaviors.Platform=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.Platform.prototype;n.Type=function(e,c){this.behavior=e;this.objtype=c;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e,c){this.type=e;this.behavior=e.behavior;this.inst=c;this.runtime=e.runtime;this.simjump=this.simright=this.simleft=this.ignoreInput=this.canDoubleJump=this.doubleJumped=this.jumped=this.jumpkey=this.rightkey=this.leftkey=!1;this.lastFloorObject=null;this.loadFloorObject=-1;
this.lastFloorY=this.lastFloorX=0;this.floorIsJumpthru=!1;this.fallthrough=this.animMode=this.ceilingCollisionMode=0;this.firstTick=!0;this.dy=this.dx=0};var t=n.Instance.prototype;t.updateGravity=function(){this.downx=Math.cos(this.ga);this.downy=Math.sin(this.ga);this.rightx=Math.cos(this.ga-Math.PI/2);this.righty=Math.sin(this.ga-Math.PI/2);this.downx=cr.round6dp(this.downx);this.downy=cr.round6dp(this.downy);this.rightx=cr.round6dp(this.rightx);this.righty=cr.round6dp(this.righty);this.g1=this.g;
0>this.g&&(this.downx*=-1,this.downy*=-1,this.g=Math.abs(this.g))};t.onCreate=function(){this.maxspeed=this.properties[0];this.acc=this.properties[1];this.dec=this.properties[2];this.jumpStrength=this.properties[3];this.g1=this.g=this.properties[4];this.maxFall=this.properties[5];this.enableDoubleJump=this.properties[6];this.jumpSustain=this.properties[7]/1E3;this.defaultControls=this.properties[8];this.enabled=this.properties[9];this.wasOnFloor=!1;this.wasOverJumpthru=this.runtime.testOverlapJumpThru(this.inst);
this.loadOverJumpthru=-1;this.sustainTime=0;this.ga=cr.to_radians(90);this.updateGravity();var e=this;this.defaultControls&&(document.addEventListener("keydown",function(c){e.onKeyDown(c)}),document.addEventListener("keyup",function(c){e.onKeyUp(c)}));this.recycled||(this.myDestroyCallback=function(c){e.onInstanceDestroyed(c)});this.runtime.addDestroyCallback(this.myDestroyCallback);this.inst.extra.isPlatformBehavior=!0};t.saveToJSON=function(){return{ii:this.ignoreInput,lfx:this.lastFloorX,lfy:this.lastFloorY,
lfo:this.lastFloorObject?this.lastFloorObject.uid:-1,am:this.animMode,en:this.enabled,fall:this.fallthrough,ft:this.firstTick,dx:this.dx,dy:this.dy,ms:this.maxspeed,acc:this.acc,dec:this.dec,js:this.jumpStrength,g:this.g,g1:this.g1,mf:this.maxFall,wof:this.wasOnFloor,woj:this.wasOverJumpthru?this.wasOverJumpthru.uid:-1,ga:this.ga,edj:this.enableDoubleJump,cdj:this.canDoubleJump,dj:this.doubleJumped,sus:this.jumpSustain,cc:this.ceilingCollisionMode}};t.loadFromJSON=function(e){this.ignoreInput=e.ii;
this.lastFloorX=e.lfx;this.lastFloorY=e.lfy;this.loadFloorObject=e.lfo;this.animMode=e.am;this.enabled=e.en;this.fallthrough=e.fall;this.firstTick=e.ft;this.dx=e.dx;this.dy=e.dy;this.maxspeed=e.ms;this.acc=e.acc;this.dec=e.dec;this.jumpStrength=e.js;this.g=e.g;this.g1=e.g1;this.maxFall=e.mf;this.wasOnFloor=e.wof;this.loadOverJumpthru=e.woj;this.ga=e.ga;this.enableDoubleJump=e.edj;this.canDoubleJump=e.cdj;this.doubleJumped=e.dj;this.jumpSustain=e.sus;this.ceilingCollisionMode=e.cc||0;this.simjump=
this.simright=this.simleft=this.jumped=this.jumpkey=this.rightkey=this.leftkey=!1;this.sustainTime=0;this.updateGravity()};t.afterLoad=function(){this.lastFloorObject=-1===this.loadFloorObject?null:this.runtime.getObjectByUID(this.loadFloorObject);this.wasOverJumpthru=-1===this.loadOverJumpthru?null:this.runtime.getObjectByUID(this.loadOverJumpthru)};t.onInstanceDestroyed=function(e){this.lastFloorObject==e&&(this.lastFloorObject=null)};t.onDestroy=function(){this.lastFloorObject=null;this.runtime.removeDestroyCallback(this.myDestroyCallback)};
t.onKeyDown=function(e){switch(e.which){case 38:e.preventDefault();this.jumpkey=!0;break;case 37:e.preventDefault();this.leftkey=!0;break;case 39:e.preventDefault(),this.rightkey=!0}};t.onKeyUp=function(e){switch(e.which){case 38:e.preventDefault();this.jumped=this.jumpkey=!1;break;case 37:e.preventDefault();this.leftkey=!1;break;case 39:e.preventDefault(),this.rightkey=!1}};t.onWindowBlur=function(){this.jumpkey=this.rightkey=this.leftkey=!1};t.getGDir=function(){return 0>this.g?-1:1};t.isOnFloor=
function(){var e,c=null;var a=this.inst.x;var d=this.inst.y;this.inst.x+=this.downx;this.inst.y+=this.downy;this.inst.set_bbox_changed();if(this.lastFloorObject&&this.runtime.testOverlap(this.inst,this.lastFloorObject)&&(!this.runtime.typeHasBehavior(this.lastFloorObject.type,cr.behaviors.solid)||this.lastFloorObject.extra.solidEnabled))return this.inst.x=a,this.inst.y=d,this.inst.set_bbox_changed(),this.lastFloorObject;(e=this.runtime.testOverlapSolid(this.inst))||0!==this.fallthrough||(c=this.runtime.testOverlapJumpThru(this.inst,
!0));this.inst.x=a;this.inst.y=d;this.inst.set_bbox_changed();if(e){if(this.runtime.testOverlap(this.inst,e))return null;this.floorIsJumpthru=!1;return e}if(c&&c.length){d=e=0;for(a=c.length;e<a;e++)c[d]=c[e],this.runtime.testOverlap(this.inst,c[e])||d++;if(1<=d)return this.floorIsJumpthru=!0,c[0]}return null};t.tick=function(){};t.posttick=function(){var e=this.runtime.getDt(this.inst),c;this.jumpkey||this.simjump||(this.jumped=!1);var a=this.leftkey||this.simleft;var d=this.rightkey||this.simright;
var h=(c=this.jumpkey||this.simjump)&&!this.jumped;this.simjump=this.simright=this.simleft=!1;if(this.enabled){this.ignoreInput&&(h=c=d=a=!1);c||(this.sustainTime=0);var u=this.lastFloorObject;var v=!1;this.firstTick&&((this.runtime.testOverlapSolid(this.inst)||this.runtime.testOverlapJumpThru(this.inst))&&this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,4,!0),this.firstTick=!1);if(u&&0===this.dy&&(u.y!==this.lastFloorY||u.x!==this.lastFloorX)){var C=u.x-this.lastFloorX;var w=u.y-this.lastFloorY;
this.inst.x+=C;this.inst.y+=w;this.inst.set_bbox_changed();this.lastFloorX=u.x;this.lastFloorY=u.y;v=!0;this.runtime.testOverlapSolid(this.inst)&&this.runtime.pushOutSolid(this.inst,-C,-w,2.5*Math.sqrt(C*C+w*w))}var r=this.isOnFloor();if(w=this.runtime.testOverlapSolid(this.inst)){var x=Math.abs(this.inst.width);var A=Math.abs(this.inst.height);if(this.inst.extra.inputPredicted)this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,10,!1);else if(this.runtime.pushOutSolidAxis(this.inst,-this.downx,
-this.downy,A/8))this.runtime.registerCollision(this.inst,w);else if(this.runtime.pushOutSolidAxis(this.inst,this.rightx,this.righty,x/2))this.runtime.registerCollision(this.inst,w);else if(this.runtime.pushOutSolidAxis(this.inst,this.downx,this.downy,A/2))this.runtime.registerCollision(this.inst,w);else if(this.runtime.pushOutSolidNearest(this.inst,Math.max(x,A)/2))this.runtime.registerCollision(this.inst,w);else return}r?(this.canDoubleJump=this.doubleJumped=!1,0<this.dy&&(this.wasOnFloor||(this.runtime.pushInFractional(this.inst,
-this.downx,-this.downy,r,16),this.wasOnFloor=!0),this.dy=0),u!=r)?(this.lastFloorObject=r,this.lastFloorX=r.x,this.lastFloorY=r.y,this.runtime.registerCollision(this.inst,r)):v&&(w=this.runtime.testOverlapSolid(this.inst))&&(this.runtime.registerCollision(this.inst,w),0!==C&&(0<C?this.runtime.pushOutSolid(this.inst,-this.rightx,-this.righty):this.runtime.pushOutSolid(this.inst,this.rightx,this.righty)),this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy)):c||(this.canDoubleJump=!0);if(r&&
h||!r&&this.enableDoubleJump&&c&&this.canDoubleJump&&!this.doubleJumped)u=this.inst.x,v=this.inst.y,this.inst.x-=this.downx,this.inst.y-=this.downy,this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst)?h=!1:(this.sustainTime=this.jumpSustain,this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnJump,this.inst),this.animMode=2,this.dy=-this.jumpStrength,h=!0,r?this.jumped=!0:this.doubleJumped=!0),this.inst.x=u,this.inst.y=v,this.inst.set_bbox_changed();r||(c&&0<this.sustainTime?
(this.dy=-this.jumpStrength,this.sustainTime-=e):(this.lastFloorObject=null,this.dy+=this.g*e,this.dy>this.maxFall&&(this.dy=this.maxFall)),h&&(this.jumped=!0));this.wasOnFloor=!!r;a==d&&(0>this.dx?(this.dx+=this.dec*e,0<this.dx&&(this.dx=0)):0<this.dx&&(this.dx-=this.dec*e,0>this.dx&&(this.dx=0)));w=0;a&&!d&&(w=0<this.dx?-(this.acc+this.dec):-this.acc);d&&!a&&(w=0>this.dx?this.acc+this.dec:this.acc);this.dx+=w*e;this.dx>this.maxspeed?this.dx=this.maxspeed:this.dx<-this.maxspeed&&(this.dx=-this.maxspeed);
a=!1;0!==this.dx&&(u=this.inst.x,v=this.inst.y,C=this.runtime.accelerate(this.dx,-this.maxspeed,this.maxspeed,w,e)*this.rightx,w=this.runtime.accelerate(this.dx,-this.maxspeed,this.maxspeed,w,e)*this.righty,this.inst.x+=this.rightx*(1<this.dx?1:-1)-this.downx,this.inst.y+=this.righty*(1<this.dx?1:-1)-this.downy,this.inst.set_bbox_changed(),c=!1,x=this.runtime.testOverlapSolid(this.inst),this.inst.x=u+C,this.inst.y=v+w,this.inst.set_bbox_changed(),d=this.runtime.testOverlapSolid(this.inst),!d&&r&&
(d=this.runtime.testOverlapJumpThru(this.inst))&&(this.inst.x=u,this.inst.y=v,this.inst.set_bbox_changed(),this.runtime.testOverlap(this.inst,d)?(d=null,c=!1):c=!0,this.inst.x=u+C,this.inst.y=v+w,this.inst.set_bbox_changed()),d?(C=Math.abs(this.dx*e)+2,x||!this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,C,c,d))?(this.runtime.registerCollision(this.inst,d),C=Math.max(Math.abs(this.dx*e*2.5),30),this.runtime.pushOutSolid(this.inst,this.rightx*(0>this.dx?1:-1),this.righty*(0>this.dx?1:-1),
C,!1)?!r||c||this.floorIsJumpthru||(u=this.inst.x,v=this.inst.y,this.inst.x+=this.downx,this.inst.y+=this.downy,this.runtime.testOverlapSolid(this.inst)?this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,3,!1)||(this.inst.x=u,this.inst.y=v,this.inst.set_bbox_changed()):(this.inst.x=u,this.inst.y=v,this.inst.set_bbox_changed())):(this.inst.x=u,this.inst.y=v,this.inst.set_bbox_changed()),c||(this.dx=0)):!x&&!h&&Math.abs(this.dy)<Math.abs(this.jumpStrength/4)&&(this.dy=0,r||(a=!0)):(u=this.isOnFloor(),
r&&!u?(w=Math.ceil(Math.abs(this.dx*e))+2,u=this.inst.x,v=this.inst.y,this.inst.x+=this.downx*w,this.inst.y+=this.downy*w,this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst)||this.runtime.testOverlapJumpThru(this.inst)?this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,w+2,!0):(this.inst.x=u,this.inst.y=v,this.inst.set_bbox_changed())):u&&(!r&&this.floorIsJumpthru&&(this.lastFloorObject=u,this.lastFloorX=u.x,this.lastFloorY=u.y,this.dy=0,a=!0),0===this.dy&&this.runtime.pushInFractional(this.inst,
-this.downx,-this.downy,u,16))));if(0!==this.dy){u=this.inst.x;v=this.inst.y;this.inst.x+=this.runtime.accelerate(this.dy,-Infinity,this.maxFall,this.g,e)*this.downx;this.inst.y+=this.runtime.accelerate(this.dy,-Infinity,this.maxFall,this.g,e)*this.downy;C=this.inst.x;d=this.inst.y;this.inst.set_bbox_changed();w=this.runtime.testOverlapSolid(this.inst);c=!1;if(!w&&0<this.dy&&!r){if((c=0<this.fallthrough?null:this.runtime.testOverlapJumpThru(this.inst,!0))&&c.length){if(this.wasOverJumpthru){this.inst.x=
u;this.inst.y=v;this.inst.set_bbox_changed();var l=x=0;for(A=c.length;x<A;x++)c[l]=c[x],this.runtime.testOverlap(this.inst,c[x])||l++;c.length=l;this.inst.x=C;this.inst.y=d;this.inst.set_bbox_changed()}1<=c.length&&(w=c[0])}c=!!w}if(w)if(this.runtime.registerCollision(this.inst,w),this.sustainTime=0,C=c?Math.abs(this.dy*e*2.5+10):Math.max(Math.abs(this.dy*e*2.5+10),30),this.runtime.pushOutSolid(this.inst,this.downx*(0>this.dy?1:-1),this.downy*(0>this.dy?1:-1),C,c,w)){this.lastFloorObject=w;this.lastFloorX=
w.x;this.lastFloorY=w.y;(this.floorIsJumpthru=c)&&(a=!0);if(0<this.dy||0===this.ceilingCollisionMode)this.dy=0;0>this.dy&&1===this.ceilingCollisionMode&&this.runtime.pushInFractional(this.inst,this.downx,this.downy,w,32)}else this.inst.x=u,this.inst.y=v,this.inst.set_bbox_changed(),this.wasOnFloor=!0,c||(this.dy=0)}3!==this.animMode&&0<this.dy&&!r&&(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnFall,this.inst),this.animMode=3);(r||a)&&0<=this.dy&&(3===this.animMode||a||h&&0===this.dy?
(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnLand,this.inst),this.animMode=0===this.dx&&0===this.dy?0:1):(0!==this.animMode&&0===this.dx&&0===this.dy&&(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnStop,this.inst),this.animMode=0),1===this.animMode||0===this.dx&&0===this.dy||h||(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnMove,this.inst),this.animMode=1)));0<this.fallthrough&&this.fallthrough--;this.wasOverJumpthru=this.runtime.testOverlapJumpThru(this.inst)}};
b.prototype.IsMoving=function(){return 0!==this.dx||0!==this.dy};b.prototype.CompareSpeed=function(e,c){return cr.do_cmp(Math.sqrt(this.dx*this.dx+this.dy*this.dy),e,c)};b.prototype.IsOnFloor=function(){if(0!==this.dy)return!1;var e,c=null;var a=this.inst.x;var d=this.inst.y;this.inst.x+=this.downx;this.inst.y+=this.downy;this.inst.set_bbox_changed();(e=this.runtime.testOverlapSolid(this.inst))||0!==this.fallthrough||(c=this.runtime.testOverlapJumpThru(this.inst,!0));this.inst.x=a;this.inst.y=d;this.inst.set_bbox_changed();
if(e)return!this.runtime.testOverlap(this.inst,e);if(c&&c.length){d=e=0;for(a=c.length;e<a;e++)c[d]=c[e],this.runtime.testOverlap(this.inst,c[e])||d++;if(1<=d)return!0}return!1};b.prototype.IsByWall=function(e){var c=this.inst.x,a=this.inst.y;0===e?(this.inst.x-=2*this.rightx,this.inst.y-=2*this.righty):(this.inst.x+=2*this.rightx,this.inst.y+=2*this.righty);this.inst.set_bbox_changed();if(!this.runtime.testOverlapSolid(this.inst))return this.inst.x=c,this.inst.y=a,this.inst.set_bbox_changed(),!1;
this.inst.x-=3*this.downx;this.inst.y-=3*this.downy;this.inst.set_bbox_changed();e=this.runtime.testOverlapSolid(this.inst);this.inst.x=c;this.inst.y=a;this.inst.set_bbox_changed();return e};b.prototype.IsJumping=function(){return 0>this.dy};b.prototype.IsFalling=function(){return 0<this.dy};b.prototype.OnJump=function(){return!0};b.prototype.OnFall=function(){return!0};b.prototype.OnStop=function(){return!0};b.prototype.OnMove=function(){return!0};b.prototype.OnLand=function(){return!0};b.prototype.IsDoubleJumpEnabled=
function(){return this.enableDoubleJump};b.prototype.IsEnabled=function(){return this.enabled};n.cnds=new b;f.prototype.SetIgnoreInput=function(e){this.ignoreInput=e};f.prototype.SetMaxSpeed=function(e){this.maxspeed=e;0>this.maxspeed&&(this.maxspeed=0)};f.prototype.SetAcceleration=function(e){this.acc=e;0>this.acc&&(this.acc=0)};f.prototype.SetDeceleration=function(e){this.dec=e;0>this.dec&&(this.dec=0)};f.prototype.SetJumpStrength=function(e){this.jumpStrength=e;0>this.jumpStrength&&(this.jumpStrength=
0)};f.prototype.SetGravity=function(e){this.g1!==e&&(this.g=e,this.updateGravity(),this.runtime.testOverlapSolid(this.inst)&&(this.runtime.pushOutSolid(this.inst,this.downx,this.downy,10),this.inst.x+=2*this.downx,this.inst.y+=2*this.downy,this.inst.set_bbox_changed()),this.lastFloorObject=null)};f.prototype.SetMaxFallSpeed=function(e){this.maxFall=e;0>this.maxFall&&(this.maxFall=0)};f.prototype.SimulateControl=function(e){switch(e){case 0:this.simleft=!0;break;case 1:this.simright=!0;break;case 2:this.simjump=
!0}};f.prototype.SetVectorX=function(e){this.dx=e};f.prototype.SetVectorY=function(e){this.dy=e};f.prototype.SetGravityAngle=function(e){e=cr.to_radians(e);e=cr.clamp_angle(e);this.ga!==e&&(this.ga=e,this.updateGravity(),this.lastFloorObject=null)};f.prototype.SetEnabled=function(e){this.enabled!==(1===e)&&(this.enabled=1===e,this.enabled||(this.lastFloorObject=null))};f.prototype.FallThrough=function(){var e=this.inst.x,c=this.inst.y;this.inst.x+=this.downx;this.inst.y+=this.downy;this.inst.set_bbox_changed();
var a=this.runtime.testOverlapJumpThru(this.inst,!1);this.inst.x=e;this.inst.y=c;this.inst.set_bbox_changed();a&&(this.fallthrough=3,this.lastFloorObject=null)};f.prototype.SetDoubleJumpEnabled=function(e){this.enableDoubleJump=0!==e};f.prototype.SetJumpSustain=function(e){this.jumpSustain=e/1E3};f.prototype.SetCeilingCollision=function(e){this.ceilingCollisionMode=e};n.acts=new f;g.prototype.Speed=function(e){e.set_float(Math.sqrt(this.dx*this.dx+this.dy*this.dy))};g.prototype.MaxSpeed=function(e){e.set_float(this.maxspeed)};
g.prototype.Acceleration=function(e){e.set_float(this.acc)};g.prototype.Deceleration=function(e){e.set_float(this.dec)};g.prototype.JumpStrength=function(e){e.set_float(this.jumpStrength)};g.prototype.Gravity=function(e){e.set_float(this.g)};g.prototype.GravityAngle=function(e){e.set_float(cr.to_degrees(this.ga))};g.prototype.MaxFallSpeed=function(e){e.set_float(this.maxFall)};g.prototype.MovingAngle=function(e){e.set_float(cr.to_degrees(Math.atan2(this.dy,this.dx)))};g.prototype.VectorX=function(e){e.set_float(this.dx)};
g.prototype.VectorY=function(e){e.set_float(this.dy)};g.prototype.JumpSustain=function(e){e.set_float(1E3*this.jumpSustain)};n.exps=new g})();cr.behaviors.solid=function(b){this.runtime=b};
(function(){function b(){}function f(){}var g=cr.behaviors.solid.prototype;g.Type=function(t,e){this.behavior=t;this.objtype=e;this.runtime=t.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(t,e){this.type=t;this.behavior=t.behavior;this.inst=e;this.runtime=t.runtime};var n=g.Instance.prototype;n.onCreate=function(){this.inst.extra.solidEnabled=this.properties[0]};n.tick=function(){};b.prototype.IsEnabled=function(){return this.inst.extra.solidEnabled};g.cnds=new b;f.prototype.SetEnabled=
function(t){this.inst.extra.solidEnabled=!!t};g.acts=new f})();cr.behaviors.Turret=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.Turret.prototype;n.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};n.Type.prototype.onCreate=function(){this.targetTypes=[]};n.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.range=this.properties[0];this.rateOfFire=this.properties[1];this.rotateEnabled=this.properties[2];this.rotateSpeed=cr.to_radians(this.properties[3]);
this.targetMode=this.properties[4];this.predictiveAim=this.properties[5];this.projectileSpeed=this.properties[6];this.useCollisionCells=this.properties[7];this.enabled=this.properties[8];this.lastCheckTime=0;this.fireTimeCount=this.rateOfFire;this.currentTarget=null;this.loadTargetUid=-1;this.oldTargetY=this.oldTargetX=0;this.lastSpeeds=[0,0,0,0];this.speedsCount=0;this.firstTickWithTarget=!0;var a=this;this.recycled||(this.myDestroyCallback=function(d){a.onInstanceDestroyed(d)});this.runtime.addDestroyCallback(this.myDestroyCallback)};
t.saveToJSON=function(){var a={r:this.range,rof:this.rateOfFire,re:this.rotateEnabled,rs:this.rotateSpeed,tm:this.targetMode,pa:this.predictiveAim,ps:this.projectileSpeed,en:this.enabled,lct:this.lastCheckTime,ftc:this.fireTimeCount,target:this.currentTarget?this.currentTarget.uid:-1,ox:this.oldTargetX,oy:this.oldTargetY,ls:this.lastSpeeds,sc:this.speedsCount,targs:[]},d;var h=0;for(d=this.type.targetTypes.length;h<d;h++)a.targs.push(this.type.targetTypes[h].sid);return a};t.loadFromJSON=function(a){this.range=
a.r;this.rateOfFire=a.rof;this.rotateEnabled=a.re;this.rotateSpeed=a.rs;this.targetMode=a.tm;this.predictiveAim=a.pa;this.projectileSpeed=a.ps;this.enabled=a.en;this.lastCheckTime=a.lct;this.fireTimeCount=a.ftc||0;this.loadTargetUid=a.target;this.oldTargetX=a.ox;this.oldTargetY=a.oy;this.lastSpeeds=a.ls;this.speedsCount=a.sc;cr.clearArray(this.type.targetTypes);var d,h;var u=0;for(d=a.targs.length;u<d;u++)(h=this.runtime.getObjectTypeBySid(a.targs[u]))&&this.type.targetTypes.push(h)};t.afterLoad=
function(){this.currentTarget=-1===this.loadTargetUid?null:this.runtime.getObjectByUID(this.loadTargetUid)};t.onInstanceDestroyed=function(a){this.currentTarget==a&&(this.currentTarget=null)};t.onDestroy=function(){this.currentTarget=null;this.runtime.removeDestroyCallback(this.myDestroyCallback)};t.addSpeed=function(a){4>this.speedsCount?(this.lastSpeeds[this.speedsCount]=a,this.speedsCount++):(this.lastSpeeds.shift(),this.lastSpeeds.push(a))};t.getSpeed=function(){for(var a=0,d=0;d<this.speedsCount;d++)a+=
this.lastSpeeds[d];return a/this.speedsCount};t.isInRange=function(a){var d=this.inst,h=a.x-d.x;a=a.y-d.y;return h*h+a*a<=this.range*this.range};var e=new cr.rect(0,0,0,0),c=[];t.lookForFirstTarget=function(){var a;e.left=this.inst.x-this.range;e.top=this.inst.y-this.range;e.right=this.inst.x+this.range;e.bottom=this.inst.y+this.range;if(this.useCollisionCells)this.runtime.getTypesCollisionCandidates(null,this.type.targetTypes,e,c);else{var d=0;for(a=this.type.targetTypes.length;d<a;++d)cr.appendArray(c,
this.type.targetTypes[d].instances)}d=0;for(a=c.length;d<a;++d){var h=c[d];if(this.isInRange(h)){this.currentTarget=h;cr.clearArray(c);return}}cr.clearArray(c)};t.lookForNearestTarget=function(){var a,d=this.inst.x,h=this.inst.y,u=this.range*this.range;this.currentTarget=null;e.left=d-this.range;e.top=h-this.range;e.right=d+this.range;e.bottom=h+this.range;if(this.useCollisionCells)this.runtime.getTypesCollisionCandidates(null,this.type.targetTypes,e,c);else{var v=0;for(a=this.type.targetTypes.length;v<
a;++v)cr.appendArray(c,this.type.targetTypes[v].instances)}v=0;for(a=c.length;v<a;++v){var C=c[v];var w=d-C.x;var r=h-C.y;w=w*w+r*r;w<u&&(this.currentTarget=C,u=w)}c.length=0};t.tick=function(){var a=this.runtime.getDt(this.inst),d=this.runtime.kahanTime.sum,h=this.inst;if(this.enabled){this.currentTarget&&!this.isInRange(this.currentTarget)&&(this.currentTarget=null,this.speedsCount=0,this.firstTickWithTarget=!0);d>=this.lastCheckTime+.1&&((this.lastCheckTime=d,0!==this.targetMode||this.currentTarget)?
1===this.targetMode&&(d=this.currentTarget,this.lookForNearestTarget(),this.currentTarget&&this.currentTarget!==d&&(this.speedsCount=0,this.firstTickWithTarget=!0,this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y,this.runtime.trigger(cr.behaviors.Turret.prototype.cnds.OnTargetAcquired,this.inst))):(this.lookForFirstTarget(),this.currentTarget&&(this.speedsCount=0,this.firstTickWithTarget=!0,this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y,this.runtime.trigger(cr.behaviors.Turret.prototype.cnds.OnTargetAcquired,
this.inst))));this.fireTimeCount+=a;if(this.currentTarget){d=cr.angleTo(h.x,h.y,this.currentTarget.x,this.currentTarget.y);if(this.predictiveAim){var u=h.x,v=h.y,C=this.currentTarget.x,w=this.currentTarget.y,r=cr.angleTo(C,w,this.oldTargetX,this.oldTargetY);this.firstTickWithTarget||this.addSpeed(cr.distanceTo(C,w,this.oldTargetX,this.oldTargetY)/a);var x=this.getSpeed(),A=w-v,l=C-u;u=Math.asin((x*Math.sin(r)*(u-C)-x*Math.cos(r)*(v-w))/this.projectileSpeed/Math.sqrt(A*A+l*l))-Math.atan2(A,-l)+Math.PI;
isNaN(u)||(d=u)}this.rotateEnabled&&(h.angle=cr.angleRotate(h.angle,d,this.rotateSpeed*a),h.set_bbox_changed());this.fireTimeCount>=this.rateOfFire&&(!this.rotateEnabled||.1>=cr.to_degrees(cr.angleDiff(h.angle,d)))&&(!this.predictiveAim||4<=this.speedsCount)&&(this.fireTimeCount-=this.rateOfFire,this.fireTimeCount>=this.rateOfFire&&(this.fireTimeCount=0),this.runtime.trigger(cr.behaviors.Turret.prototype.cnds.OnShoot,this.inst));this.currentTarget&&(this.oldTargetX=this.currentTarget.x,this.oldTargetY=
this.currentTarget.y);this.firstTickWithTarget=!1}this.fireTimeCount>this.rateOfFire&&(this.fireTimeCount=this.rateOfFire)}};b.prototype.HasTarget=function(){return!!this.currentTarget};b.prototype.OnShoot=function(){return!0};b.prototype.OnTargetAcquired=function(){return!0};b.prototype.IsEnabled=function(){return this.enabled};n.cnds=new b;f.prototype.AcquireTarget=function(a){if(a){a=a.getCurrentSol().getObjects();var d;var h=0;for(d=a.length;h<d;++h){var u=a[h];if(this.currentTarget!==u&&this.isInRange(u)){this.currentTarget=
u;this.speedsCount=0;this.firstTickWithTarget=!0;this.oldTargetX=this.currentTarget.x;this.oldTargetY=this.currentTarget.y;this.runtime.trigger(cr.behaviors.Turret.prototype.cnds.OnTargetAcquired,this.inst);break}}}};f.prototype.AddTarget=function(a){var d=this.type.targetTypes;if(-1===d.indexOf(a)){var h;var u=0;for(h=d.length;u<h;u++){var v=d[u];if(v.is_family&&-1!==v.members.indexOf(a))return}d.push(a)}};f.prototype.ClearTargets=function(){cr.clearArray(this.type.targetTypes)};f.prototype.UnacquireTarget=
function(){this.currentTarget=null;this.speedsCount=0;this.firstTickWithTarget=!0};f.prototype.SetEnabled=function(a){this.enabled=0!==a};f.prototype.SetRange=function(a){this.range=a};f.prototype.SetRateOfFire=function(a){this.rateOfFire=a};f.prototype.SetRotate=function(a){this.rotateEnabled=0!==a};f.prototype.SetRotateSpeed=function(a){this.rotateSpeed=cr.to_radians(a)};f.prototype.SetTargetMode=function(a){this.targetMode=a};f.prototype.SetPredictiveAim=function(a){this.predictiveAim=0!==a};f.prototype.SetProjectileSpeed=
function(a){this.projectileSpeed=a};n.acts=new f;g.prototype.TargetUID=function(a){a.set_int(this.currentTarget?this.currentTarget.uid:0)};g.prototype.Range=function(a){a.set_float(this.range)};g.prototype.RateOfFire=function(a){a.set_float(this.rateOfFire)};g.prototype.RotateSpeed=function(a){a.set_float(cr.to_degrees(this.rotateSpeed))};n.exps=new g})();cr.behaviors.scrollto=function(b){this.runtime=b;this.shakeMode=this.shakeEnd=this.shakeStart=this.shakeMag=0};
(function(){function b(){}function f(){}var g=cr.behaviors.scrollto.prototype;g.Type=function(t,e){this.behavior=t;this.objtype=e;this.runtime=t.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(t,e){this.type=t;this.behavior=t.behavior;this.inst=e;this.runtime=t.runtime};var n=g.Instance.prototype;n.onCreate=function(){this.enabled=this.properties[0]};n.saveToJSON=function(){return{smg:this.behavior.shakeMag,ss:this.behavior.shakeStart,se:this.behavior.shakeEnd,smd:this.behavior.shakeMode}};
n.loadFromJSON=function(t){this.behavior.shakeMag=t.smg;this.behavior.shakeStart=t.ss;this.behavior.shakeEnd=t.se;this.behavior.shakeMode=t.smd};n.tick=function(){};n.tick2=function(){if(this.enabled){var t=this.behavior.my_instances.valuesRef(),e=0,c=0,a,d=0;var h=0;for(a=t.length;h<a;h++){a:{var u,v=t[h];var C=0;for(u=v.behavior_insts.length;C<u;++C){var w=v.behavior_insts[C];if(w.behavior instanceof cr.behaviors.scrollto)break a}w=null}w&&w.enabled&&(e+=t[h].x,c+=t[h].y,++d)}t=this.inst.layer.layout;
a=this.runtime.kahanTime.sum;w=h=0;a>=this.behavior.shakeStart&&a<this.behavior.shakeEnd&&(h=this.behavior.shakeMag*Math.min(this.runtime.timescale,1),0===this.behavior.shakeMode&&(h*=1-(a-this.behavior.shakeStart)/(this.behavior.shakeEnd-this.behavior.shakeStart)),a=Math.random()*Math.PI*2,w=Math.random()*h,h=Math.cos(a)*w,w*=Math.sin(a));t.scrollToX(e/d+h);t.scrollToY(c/d+w)}};b.prototype.IsEnabled=function(){return this.enabled};g.cnds=new b;f.prototype.Shake=function(t,e,c){this.behavior.shakeMag=
t;this.behavior.shakeStart=this.runtime.kahanTime.sum;this.behavior.shakeEnd=this.behavior.shakeStart+e;this.behavior.shakeMode=c};f.prototype.SetEnabled=function(t){this.enabled=0!==t};g.acts=new f})();cr.behaviors.EightDir=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.EightDir.prototype;n.Type=function(e,c){this.behavior=e;this.objtype=c;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e,c){this.type=e;this.behavior=e.behavior;this.inst=c;this.runtime=e.runtime;this.simright=this.simleft=this.simdown=this.simup=this.ignoreInput=this.rightkey=this.leftkey=this.downkey=this.upkey=!1;this.lastrighttick=this.lastlefttick=this.lastdowntick=this.lastuptick=-1;this.dy=
this.dx=0};var t=n.Instance.prototype;t.onCreate=function(){this.maxspeed=this.properties[0];this.acc=this.properties[1];this.dec=this.properties[2];this.directions=this.properties[3];this.angleMode=this.properties[4];this.defaultControls=this.properties[5];this.enabled=this.properties[6];var e=this;this.defaultControls&&(document.addEventListener("keydown",function(c){e.onKeyDown(c)}),document.addEventListener("keyup",function(c){e.onKeyUp(c)}))};t.saveToJSON=function(){return{dx:this.dx,dy:this.dy,
enabled:this.enabled,maxspeed:this.maxspeed,acc:this.acc,dec:this.dec,ignoreInput:this.ignoreInput}};t.loadFromJSON=function(e){this.dx=e.dx;this.dy=e.dy;this.enabled=e.enabled;this.maxspeed=e.maxspeed;this.acc=e.acc;this.dec=e.dec;this.ignoreInput=e.ignoreInput;this.simright=this.simleft=this.simdown=this.simup=this.rightkey=this.leftkey=this.downkey=this.upkey=!1;this.lastrighttick=this.lastlefttick=this.lastdowntick=this.lastuptick=-1};t.onKeyDown=function(e){var c=this.runtime.tickcount;switch(e.which){case 37:e.preventDefault();
this.lastlefttick<c&&(this.leftkey=!0);break;case 38:e.preventDefault();this.lastuptick<c&&(this.upkey=!0);break;case 39:e.preventDefault();this.lastrighttick<c&&(this.rightkey=!0);break;case 40:e.preventDefault(),this.lastdowntick<c&&(this.downkey=!0)}};t.onKeyUp=function(e){var c=this.runtime.tickcount;switch(e.which){case 37:e.preventDefault();this.leftkey=!1;this.lastlefttick=c;break;case 38:e.preventDefault();this.upkey=!1;this.lastuptick=c;break;case 39:e.preventDefault();this.rightkey=!1;this.lastrighttick=
c;break;case 40:e.preventDefault(),this.downkey=!1,this.lastdowntick=c}};t.onWindowBlur=function(){this.rightkey=this.leftkey=this.downkey=this.upkey=!1};t.tick=function(){var e=this.runtime.getDt(this.inst),c=this.leftkey||this.simleft,a=this.rightkey||this.simright,d=this.upkey||this.simup,h=this.downkey||this.simdown;this.simdown=this.simup=this.simright=this.simleft=!1;if(this.enabled){var u=this.runtime.testOverlapSolid(this.inst);if(u&&(this.runtime.registerCollision(this.inst,u),!this.runtime.pushOutSolidNearest(this.inst)))return;
this.ignoreInput&&(h=d=a=c=!1);0===this.directions?a=c=!1:1===this.directions&&(h=d=!1);2===this.directions&&(d||h)&&(a=c=!1);c==a&&(0>this.dx?(this.dx+=this.dec*e,0<this.dx&&(this.dx=0)):0<this.dx&&(this.dx-=this.dec*e,0>this.dx&&(this.dx=0)));d==h&&(0>this.dy?(this.dy+=this.dec*e,0<this.dy&&(this.dy=0)):0<this.dy&&(this.dy-=this.dec*e,0>this.dy&&(this.dy=0)));var v=u=0;c&&!a&&(u=0<this.dx?-(this.acc+this.dec):-this.acc);a&&!c&&(u=0>this.dx?this.acc+this.dec:this.acc);d&&!h&&(v=0<this.dy?-(this.acc+
this.dec):-this.acc);h&&!d&&(v=0>this.dy?this.acc+this.dec:this.acc);this.dx+=u*e;this.dy+=v*e;if(0!==this.dx||0!==this.dy){c=Math.atan2(this.dy,this.dx);a=this.maxspeed*Math.cos(c);d=this.maxspeed*Math.sin(c);Math.sqrt(this.dx*this.dx+this.dy*this.dy)>this.maxspeed&&(this.dx=a,this.dy=d);a=Math.abs(a);d=Math.abs(d);h=this.inst.x;var C=this.inst.y;c=this.inst.angle;this.inst.x+=this.runtime.accelerate(this.dx,-a,a,u,e);this.inst.set_bbox_changed();if(u=this.runtime.testOverlapSolid(this.inst))this.runtime.pushOutSolid(this.inst,
0>this.dx?1:-1,0,Math.abs(Math.floor(this.dx*e)))||(this.inst.x=h,this.inst.set_bbox_changed()),this.dx=0,this.runtime.registerCollision(this.inst,u);this.inst.y+=this.runtime.accelerate(this.dy,-d,d,v,e);this.inst.set_bbox_changed();if(u=this.runtime.testOverlapSolid(this.inst))this.runtime.pushOutSolid(this.inst,0,0>this.dy?1:-1,Math.abs(Math.floor(this.dy*e)))||(this.inst.y=C,this.inst.set_bbox_changed()),this.dy=0,this.runtime.registerCollision(this.inst,u);e=cr.round6dp(this.dx);v=cr.round6dp(this.dy);
0===e&&0===v||!this.inst.type.plugin.is_rotatable||(1===this.angleMode?this.inst.angle=cr.to_clamped_radians(90*Math.round(cr.to_degrees(Math.atan2(v,e))/90)):2===this.angleMode?this.inst.angle=cr.to_clamped_radians(45*Math.round(cr.to_degrees(Math.atan2(v,e))/45)):3===this.angleMode&&(this.inst.angle=Math.atan2(v,e)));this.inst.set_bbox_changed();this.inst.angle!=c&&(u=this.runtime.testOverlapSolid(this.inst))&&(this.inst.angle=c,this.inst.set_bbox_changed(),this.runtime.registerCollision(this.inst,
u))}}};b.prototype.IsMoving=function(){return 1E-10<Math.sqrt(this.dx*this.dx+this.dy*this.dy)};b.prototype.CompareSpeed=function(e,c){return cr.do_cmp(Math.sqrt(this.dx*this.dx+this.dy*this.dy),e,c)};b.prototype.IsEnabled=function(){return this.enabled};n.cnds=new b;f.prototype.Stop=function(){this.dy=this.dx=0};f.prototype.Reverse=function(){this.dx*=-1;this.dy*=-1};f.prototype.SetIgnoreInput=function(e){this.ignoreInput=e};f.prototype.SetSpeed=function(e){0>e&&(e=0);e>this.maxspeed&&(e=this.maxspeed);
var c=Math.atan2(this.dy,this.dx);this.dx=e*Math.cos(c);this.dy=e*Math.sin(c)};f.prototype.SetMaxSpeed=function(e){this.maxspeed=e;0>this.maxspeed&&(this.maxspeed=0)};f.prototype.SetAcceleration=function(e){this.acc=e;0>this.acc&&(this.acc=0)};f.prototype.SetDeceleration=function(e){this.dec=e;0>this.dec&&(this.dec=0)};f.prototype.SimulateControl=function(e){switch(e){case 0:this.simleft=!0;break;case 1:this.simright=!0;break;case 2:this.simup=!0;break;case 3:this.simdown=!0}};f.prototype.SetEnabled=
function(e){this.enabled=1===e};f.prototype.SetVectorX=function(e){this.dx=e};f.prototype.SetVectorY=function(e){this.dy=e};n.acts=new f;g.prototype.Speed=function(e){e.set_float(Math.sqrt(this.dx*this.dx+this.dy*this.dy))};g.prototype.MaxSpeed=function(e){e.set_float(this.maxspeed)};g.prototype.Acceleration=function(e){e.set_float(this.acc)};g.prototype.Deceleration=function(e){e.set_float(this.dec)};g.prototype.MovingAngle=function(e){e.set_float(cr.to_degrees(Math.atan2(this.dy,this.dx)))};g.prototype.VectorX=
function(e){e.set_float(this.dx)};g.prototype.VectorY=function(e){e.set_float(this.dy)};n.exps=new g})();cr.behaviors.jumpthru=function(b){this.runtime=b};
(function(){function b(){}function f(){}var g=cr.behaviors.jumpthru.prototype;g.Type=function(t,e){this.behavior=t;this.objtype=e;this.runtime=t.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(t,e){this.type=t;this.behavior=t.behavior;this.inst=e;this.runtime=t.runtime};var n=g.Instance.prototype;n.onCreate=function(){this.inst.extra.jumpthruEnabled=this.properties[0]};n.tick=function(){};b.prototype.IsEnabled=function(){return this.inst.extra.jumpthruEnabled};g.cnds=new b;f.prototype.SetEnabled=
function(t){this.inst.extra.jumpthruEnabled=!!t};g.acts=new f})();cr.behaviors.Timer=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.Timer.prototype;n.Type=function(e,c){this.behavior=e;this.objtype=c;this.runtime=e.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(e,c){this.type=e;this.behavior=e.behavior;this.inst=c;this.runtime=e.runtime};var t=n.Instance.prototype;t.onCreate=function(){this.timers={}};t.onDestroy=function(){cr.wipe(this.timers)};t.saveToJSON=function(){var e={},c;for(c in this.timers)if(this.timers.hasOwnProperty(c)){var a=
this.timers[c];e[c]={c:a.current.sum,t:a.total.sum,d:a.duration,r:a.regular,p:a.paused}}return e};t.loadFromJSON=function(e){this.timers={};for(var c in e)e.hasOwnProperty(c)&&(this.timers[c]={current:new cr.KahanAdder,total:new cr.KahanAdder,duration:e[c].d,regular:e[c].r,paused:!!e[c].p},this.timers[c].current.sum=e[c].c,this.timers[c].total.sum=e[c].t)};t.tick=function(){var e=this.runtime.getDt(this.inst),c;for(c in this.timers)if(this.timers.hasOwnProperty(c)){var a=this.timers[c];a.paused||
(a.current.add(e),a.total.add(e))}};t.tick2=function(){var e;for(e in this.timers)if(this.timers.hasOwnProperty(e)){var c=this.timers[e];c.current.sum>=c.duration&&(c.regular?c.current.sum-=c.duration:delete this.timers[e])}};b.prototype.OnTimer=function(e){e=e.toLowerCase();return(e=this.timers[e])?e.current.sum>=e.duration:!1};b.prototype.IsTimerRunning=function(e){return this.timers.hasOwnProperty(e.toLowerCase())};b.prototype.IsTimerPaused=function(e){return(e=this.timers[e.toLowerCase()])&&e.paused};
n.cnds=new b;f.prototype.StartTimer=function(e,c,a){this.timers[a.toLowerCase()]={current:new cr.KahanAdder,total:new cr.KahanAdder,duration:e,regular:1===c,paused:!1}};f.prototype.StopTimer=function(e){e=e.toLowerCase();this.timers.hasOwnProperty(e)&&delete this.timers[e]};f.prototype.PauseResumeTimer=function(e,c){if(e=this.timers[e.toLowerCase()])e.paused=0===c};n.acts=new f;g.prototype.CurrentTime=function(e,c){c=this.timers[c.toLowerCase()];e.set_float(c?c.current.sum:0)};g.prototype.TotalTime=
function(e,c){c=this.timers[c.toLowerCase()];e.set_float(c?c.total.sum:0)};g.prototype.Duration=function(e,c){c=this.timers[c.toLowerCase()];e.set_float(c?c.duration:0)};n.exps=new g})();cr.behaviors.LOS=function(b){this.runtime=b};
(function(){function b(){}function f(){}function g(){}var n=cr.behaviors.LOS.prototype;n.Type=function(h,u){this.behavior=h;this.objtype=u;this.runtime=h.runtime};var t=n.Type.prototype;t.onCreate=function(){this.obstacleTypes=[]};t.findLosBehavior=function(h){var u;var v=0;for(u=h.behavior_insts.length;v<u;++v){var C=h.behavior_insts[v];if(C instanceof cr.behaviors.LOS.prototype.Instance&&C.type===this)return C}return null};n.Instance=function(h,u){this.type=h;this.behavior=h.behavior;this.inst=
u;this.runtime=h.runtime};t=n.Instance.prototype;t.onCreate=function(){this.obstacleMode=this.properties[0];this.range=this.properties[1];this.cone=cr.to_radians(this.properties[2]);this.useCollisionCells=this.properties[3]};t.onDestroy=function(){};t.saveToJSON=function(){var h={r:this.range,c:this.cone,t:[]},u;var v=0;for(u=this.type.obstacleTypes.length;v<u;v++)h.t.push(this.type.obstacleTypes[v].sid);return h};t.loadFromJSON=function(h){this.range=h.r;this.cone=h.c;cr.clearArray(this.type.obstacleTypes);
var u,v;var C=0;for(u=h.t.length;C<u;C++)(v=this.runtime.getObjectTypeBySid(h.t[C]))&&this.type.obstacleTypes.push(v)};t.tick=function(){};var e=[],c=new cr.rect(0,0,0,0);t.hasLOSto=function(h,u){var v=this.inst.x,C=this.inst.y,w=this.inst.angle;0>this.inst.width&&(w+=Math.PI);if(cr.distanceTo(v,C,h,u)>this.range)return!1;var r=cr.angleTo(v,C,h,u);if(cr.angleDiff(w,r)>this.cone/2)return!1;c.set(v,C,h,u);c.normalize();if(0===this.obstacleMode)for(this.useCollisionCells?this.runtime.getSolidCollisionCandidates(this.inst.layer,
c,e):(w=this.runtime.getSolidBehavior())&&cr.appendArray(e,w.my_instances.valuesRef()),w=0,r=e.length;w<r;++w){var x=e[w];if(x.extra.solidEnabled&&x!==this.inst&&this.runtime.testSegmentOverlap(v,C,h,u,x))return cr.clearArray(e),!1}else{if(this.useCollisionCells)this.runtime.getTypesCollisionCandidates(this.inst.layer,this.type.obstacleTypes,c,e);else for(w=0,r=this.type.obstacleTypes.length;w<r;++w)cr.appendArray(e,this.type.obstacleTypes[w].instances);w=0;for(r=e.length;w<r;++w)if(x=e[w],x!==this.inst&&
this.runtime.testSegmentOverlap(v,C,h,u,x))return cr.clearArray(e),!1}cr.clearArray(e);return!0};var a=new cr.ObjectSet,d=new cr.ObjectSet;b.prototype.HasLOSToObject=function(h){if(!h)return!1;var u,v,C=this.runtime.getCurrentConditionObjectType().getCurrentSol();h=h.getCurrentSol();var w=C.getObjects(),r=h.getObjects();C.select_all&&cr.clearArray(C.else_instances);h.select_all&&cr.clearArray(h.else_instances);var x=this.runtime.getCurrentCondition().inverted;var A=0;for(u=w.length;A<u;++A){var l=
w[A];var y=!1;var z=this.findLosBehavior(l);var O=0;for(v=r.length;O<v;++O){var Q=r[O];l!==Q&&cr.xor(z.hasLOSto(Q.x,Q.y),x)&&(y=!0,d.add(Q))}y&&a.add(l)}A=a.valuesRef();O=d.valuesRef();C.select_all=!1;h.select_all=!1;cr.shallowAssignArray(C.instances,A);cr.shallowAssignArray(h.instances,O);a.clear();d.clear();return C.hasObjects()};b.prototype.HasLOSToPosition=function(h,u){return this.hasLOSto(h,u)};n.cnds=new b;f.prototype.SetRange=function(h){this.range=h};f.prototype.SetCone=function(h){this.cone=
cr.to_radians(h)};f.prototype.AddObstacle=function(h){var u=this.type.obstacleTypes;if(-1===u.indexOf(h)){var v;var C=0;for(v=u.length;C<v;C++){var w=u[C];if(w.is_family&&-1!==w.members.indexOf(h))return}u.push(h)}};f.prototype.ClearObstacles=function(){cr.clearArray(this.type.obstacleTypes)};n.acts=new f;g.prototype.Range=function(h){h.set_float(this.range)};g.prototype.ConeOfView=function(h){h.set_float(cr.to_degrees(this.cone))};n.exps=new g})();
cr.getObjectRefTable=function(){return[cr.plugins_.Sprite,cr.plugins_.Particles,cr.behaviors.Physics,cr.behaviors.lunarray_LiteTween,cr.behaviors.Bullet,cr.behaviors.destroy,cr.behaviors.Pin,cr.behaviors.Fade,cr.behaviors.Rotate,cr.behaviors.Sin,cr.behaviors.DragnDrop,cr.behaviors.Platform,cr.plugins_.TiledBg,cr.behaviors.solid,cr.behaviors.Turret,cr.plugins_.Audio,cr.plugins_.Function,cr.plugins_.Keyboard,cr.plugins_.Mouse,cr.plugins_.Touch,cr.plugins_.NodeWebkit,cr.plugins_.Browser,cr.plugins_.Text,
cr.plugins_.Spritefont2,cr.behaviors.scrollto,cr.behaviors.EightDir,cr.plugins_.NinePatch,cr.plugins_.Button,cr.plugins_.video,cr.plugins_.TextBox,cr.plugins_.sliderbar,cr.plugins_.List,cr.plugins_.progressbar,cr.behaviors.jumpthru,cr.behaviors.Timer,cr.behaviors.LOS,cr.plugins_.Particles.prototype.cnds.OnCreated,cr.plugins_.Particles.prototype.acts.SetGrowRate,cr.plugins_.Particles.prototype.acts.SetAngle,cr.system_object.prototype.exps.random,cr.system_object.prototype.cnds.OnLayoutStart,cr.plugins_.Audio.prototype.acts.Stop,
cr.plugins_.Sprite.prototype.acts.SetPosToObject,cr.plugins_.Function.prototype.acts.CallFunction,cr.system_object.prototype.acts.CreateObject,cr.plugins_.Sprite.prototype.acts.SetAnim,cr.behaviors.Physics.prototype.acts.RemoveJoints,cr.system_object.prototype.cnds.CompareBoolVar,cr.plugins_.Function.prototype.cnds.OnFunction,cr.system_object.prototype.acts.SetBoolVar,cr.plugins_.Sprite.prototype.acts.SetVisible,cr.plugins_.Text.prototype.acts.SetVisible,cr.behaviors.EightDir.prototype.acts.SetEnabled,
cr.system_object.prototype.acts.SetLayerVisible,cr.behaviors.DragnDrop.prototype.acts.SetEnabled,cr.plugins_.Sprite.prototype.exps.X,cr.plugins_.Sprite.prototype.exps.Y,cr.system_object.prototype.acts.SetVar,cr.plugins_.Sprite.prototype.acts.Spawn,cr.plugins_.progressbar.prototype.acts.SetMaximum,cr.plugins_.Audio.prototype.acts.PlayByName,cr.system_object.prototype.acts.SetTimescale,cr.system_object.prototype.acts.SetLayerEffectParam,cr.system_object.prototype.acts.SetLayerScale,cr.plugins_.Sprite.prototype.acts.Destroy,
cr.system_object.prototype.cnds.Compare,cr.plugins_.Sprite.prototype.exps.Count,cr.plugins_.Sprite.prototype.acts.SetInstanceVar,cr.system_object.prototype.cnds.Else,cr.plugins_.TiledBg.prototype.exps.Count,cr.plugins_.TiledBg.prototype.exps.Y,cr.system_object.prototype.cnds.For,cr.plugins_.Sprite.prototype.cnds.CompareInstanceVar,cr.plugins_.Sprite.prototype.acts.SetBoolInstanceVar,cr.plugins_.Sprite.prototype.acts.SetAngle,cr.plugins_.Sprite.prototype.exps.Angle,cr.system_object.prototype.acts.Wait,
cr.plugins_.Sprite.prototype.cnds.IsBoolInstanceVarSet,cr.behaviors.Physics.prototype.acts.SetWorldGravity,cr.plugins_.Audio.prototype.acts.Play,cr.system_object.prototype.cnds.TriggerOnce,cr.behaviors.Platform.prototype.acts.SetEnabled,cr.system_object.prototype.exps.choose,cr.system_object.prototype.exps.layoutname,cr.plugins_.Text.prototype.acts.SetText,cr.plugins_.Text.prototype.cnds.CompareInstanceVar,cr.system_object.prototype.cnds.EveryTick,cr.behaviors.lunarray_LiteTween.prototype.acts.Stop,
cr.plugins_.progressbar.prototype.acts.SetPosToObject,cr.plugins_.progressbar.prototype.acts.SetProgress,cr.behaviors.Physics.prototype.acts.EnableCollisions,cr.system_object.prototype.cnds.IsGroupActive,cr.plugins_.Sprite.prototype.cnds.IsOnScreen,cr.system_object.prototype.cnds.Every,cr.plugins_.Sprite.prototype.acts.SetAnimFrame,cr.plugins_.Sprite.prototype.cnds.CompareFrame,cr.plugins_.Audio.prototype.cnds.IsTagPlaying,cr.plugins_.Sprite.prototype.cnds.IsOverlapping,cr.behaviors.Physics.prototype.acts.SetAngularDamping,
cr.behaviors.Physics.prototype.acts.SetLinearDamping,cr.behaviors.Platform.prototype.cnds.IsOnFloor,cr.behaviors.Platform.prototype.acts.SetVectorY,cr.behaviors.Platform.prototype.cnds.OnLand,cr.behaviors.Rotate.prototype.acts.SetEnabled,cr.plugins_.Sprite.prototype.acts.RotateTowardAngle,cr.behaviors.Platform.prototype.cnds.IsEnabled,cr.system_object.prototype.cnds.CompareVar,cr.behaviors.lunarray_LiteTween.prototype.acts.SetTarget,cr.behaviors.Physics.prototype.acts.SetEnabled,cr.behaviors.lunarray_LiteTween.prototype.acts.Start,
cr.system_object.prototype.cnds.ForEach,cr.plugins_.Sprite.prototype.cnds.OnCreated,cr.plugins_.Sprite.prototype.exps.Width,cr.plugins_.Sprite.prototype.cnds.OnCollision,cr.behaviors.Physics.prototype.cnds.CompareVelocity,cr.system_object.prototype.acts.SubVar,cr.plugins_.Sprite.prototype.acts.RotateClockwise,cr.system_object.prototype.exps.angle,cr.behaviors.Physics.prototype.exps.VelocityX,cr.behaviors.Physics.prototype.exps.VelocityY,cr.plugins_.Sprite.prototype.cnds.IsAnimPlaying,cr.plugins_.Sprite.prototype.acts.RotateCounterclockwise,
cr.behaviors.Timer.prototype.cnds.OnTimer,cr.behaviors.Sin.prototype.acts.SetEnabled,cr.plugins_.Sprite.prototype.acts.SetWidth,cr.behaviors.Pin.prototype.acts.Pin,cr.plugins_.Sprite.prototype.exps.LayerName,cr.behaviors.DragnDrop.prototype.cnds.IsEnabled,cr.behaviors.Fade.prototype.acts.StartFade,cr.plugins_.Sprite.prototype.cnds.OnDestroyed,cr.plugins_.Touch.prototype.cnds.IsTouchingObject,cr.plugins_.Touch.prototype.exps.TouchCount,cr.plugins_.Touch.prototype.exps.XAt,cr.system_object.prototype.exps.loopindex,
cr.plugins_.Sprite.prototype.cnds.PickDistance,cr.plugins_.Touch.prototype.exps.YAt,cr.system_object.prototype.exps.distance,cr.system_object.prototype.exps.min,cr.plugins_.Sprite.prototype.acts.SetPos,cr.system_object.prototype.exps.cos,cr.system_object.prototype.exps.sin,cr.plugins_.Sprite.prototype.exps.ImagePointX,cr.plugins_.Sprite.prototype.exps.ImagePointY,cr.plugins_.Sprite.prototype.acts.SetTowardPosition,cr.plugins_.Sprite.prototype.acts.SetSize,cr.system_object.prototype.acts.AddVar,cr.plugins_.Sprite.prototype.cnds.CompareY,
cr.system_object.prototype.cnds.PickNth,cr.plugins_.Sprite.prototype.acts.SubInstanceVar,cr.plugins_.Sprite.prototype.acts.SetX,cr.plugins_.Sprite.prototype.acts.SetY,cr.behaviors.Physics.prototype.acts.SetImmovable,cr.behaviors.Physics.prototype.acts.SetVelocity,cr.behaviors.Bullet.prototype.acts.SetAngleOfMotion,cr.behaviors.Bullet.prototype.acts.SetEnabled,cr.behaviors.Timer.prototype.cnds.IsTimerRunning,cr.plugins_.Sprite.prototype.acts.MoveForward,cr.behaviors.Physics.prototype.acts.ApplyImpulseAtAngle,
cr.plugins_.Sprite.prototype.cnds.CompareX,cr.behaviors.Physics.prototype.acts.ApplyImpulseToward,cr.plugins_.Sprite.prototype.acts.SetHeight,cr.plugins_.Sprite.prototype.exps.Height,cr.behaviors.scrollto.prototype.acts.Shake,cr.plugins_.Sprite.prototype.cnds.OnAnimFinished,cr.behaviors.Physics.prototype.acts.ApplyImpulse,cr.plugins_.Sprite.prototype.acts.AddInstanceVar,cr.behaviors.Physics.prototype.acts.ApplyForce,cr.plugins_.Sprite.prototype.acts.SetScale,cr.behaviors.lunarray_LiteTween.prototype.cnds.IsActive,
cr.behaviors.lunarray_LiteTween.prototype.cnds.OnEnd,cr.behaviors.Fade.prototype.acts.SetFadeInTime,cr.behaviors.Fade.prototype.acts.SetWaitTime,cr.behaviors.Fade.prototype.acts.SetFadeOutTime,cr.behaviors.Bullet.prototype.acts.SetGravity,cr.behaviors.Platform.prototype.exps.VectorX,cr.behaviors.Platform.prototype.exps.VectorY,cr.plugins_.TiledBg.prototype.acts.SetPosToObject,cr.plugins_.TiledBg.prototype.acts.SetAngle,cr.plugins_.TiledBg.prototype.acts.SetWidth,cr.plugins_.TiledBg.prototype.acts.MoveToBottom,
cr.plugins_.TiledBg.prototype.acts.Destroy,cr.plugins_.TiledBg.prototype.exps.X,cr.plugins_.TiledBg.prototype.acts.SetTowardPosition,cr.behaviors.Bullet.prototype.acts.SetSpeed,cr.behaviors.Bullet.prototype.exps.AngleOfMotion,cr.system_object.prototype.acts.SetObjectTimescale,cr.behaviors.Bullet.prototype.cnds.IsEnabled,cr.plugins_.Sprite.prototype.acts.ZMoveToObject,cr.behaviors.Rotate.prototype.acts.SetSpeed,cr.plugins_.Sprite.prototype.acts.RotateTowardPosition,cr.behaviors.Physics.prototype.acts.CreateDistanceJoint,
cr.behaviors.Physics.prototype.acts.CreateLimitedRevoluteJoint,cr.behaviors.Physics.prototype.acts.ApplyForceAtAngle,cr.plugins_.Sprite.prototype.acts.SetEffectParam,cr.behaviors.Sin.prototype.cnds.IsEnabled,cr.plugins_.Sprite.prototype.acts.MoveToBottom,cr.behaviors.lunarray_LiteTween.prototype.acts.SetDuration,cr.system_object.prototype.exps.timescale,cr.behaviors.Platform.prototype.acts.SimulateControl,cr.behaviors.Pin.prototype.acts.Unpin,cr.plugins_.Sprite.prototype.exps.AnimationName,cr.plugins_.Sprite.prototype.acts.StopAnim,
cr.behaviors.LOS.prototype.cnds.HasLOSToObject,cr.system_object.prototype.exps.abs,cr.behaviors.Physics.prototype.exps.Mass,cr.plugins_.Sprite.prototype.acts.SetCollisions,cr.plugins_.Sprite.prototype.acts.MoveToTop,cr.plugins_.Sprite.prototype.acts.ToggleBoolInstanceVar,cr.behaviors.Physics.prototype.acts.ApplyForceToward,cr.system_object.prototype.acts.CreateObjectByName,cr.behaviors.Turret.prototype.acts.AddTarget,cr.behaviors.Turret.prototype.acts.SetEnabled,cr.plugins_.Sprite.prototype.exps.AnimationFrame,
cr.behaviors.Turret.prototype.cnds.OnShoot,cr.behaviors.scrollto.prototype.acts.SetEnabled,cr.behaviors.lunarray_LiteTween.prototype.acts.SetEasing,cr.behaviors.lunarray_LiteTween.prototype.acts.Reverse,cr.plugins_.Sprite.prototype.acts.MoveToLayer,cr.plugins_.Mouse.prototype.exps.X,cr.plugins_.Mouse.prototype.exps.Y,cr.system_object.prototype.cnds.PickByComparison,cr.system_object.prototype.exps.dt,cr.behaviors.Physics.prototype.acts.CreateRevoluteJoint,cr.behaviors.Physics.prototype.acts.ApplyTorque,
cr.system_object.prototype.exps.lerp,cr.behaviors.Physics.prototype.acts.SetPreventRotate,cr.behaviors.Physics.prototype.acts.SetAngularVelocity,cr.plugins_.TiledBg.prototype.cnds.IsBoolInstanceVarSet,cr.plugins_.TiledBg.prototype.exps.Width,cr.plugins_.TiledBg.prototype.acts.SetX,cr.plugins_.TiledBg.prototype.cnds.CompareX,cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,cr.plugins_.Spritefont2.prototype.cnds.OnCreated,cr.plugins_.Spritefont2.prototype.acts.SetText,cr.plugins_.Spritefont2.prototype.acts.SetAngle,
cr.plugins_.Spritefont2.prototype.exps.Text,cr.plugins_.Sprite.prototype.cnds.CompareWidth,cr.plugins_.Text.prototype.acts.Destroy,cr.system_object.prototype.cnds.LayerVisible,cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,cr.system_object.prototype.acts.LoadState,cr.system_object.prototype.acts.RestartLayout,cr.behaviors.Rotate.prototype.cnds.IsEnabled,cr.plugins_.Sprite.prototype.cnds.IsVisible,cr.plugins_.Touch.prototype.cnds.OnTouchObject,cr.behaviors.Physics.prototype.acts.SetDensity,cr.plugins_.video.prototype.acts.SetVisible,
cr.plugins_.video.prototype.cnds.IsOnScreen,cr.plugins_.video.prototype.acts.SetSource,cr.plugins_.video.prototype.cnds.HasEnded,cr.plugins_.video.prototype.acts.SetPlaybackTime,cr.plugins_.video.prototype.acts.Play,cr.behaviors.Fade.prototype.acts.RestartFade,cr.plugins_.Browser.prototype.cnds.OnPageHidden,cr.system_object.prototype.acts.GoToLayout,cr.plugins_.Audio.prototype.acts.SetSilent,cr.plugins_.Audio.prototype.cnds.IsSilent,cr.plugins_.sliderbar.prototype.exps.Step,cr.plugins_.sliderbar.prototype.acts.SetValue,
cr.plugins_.sliderbar.prototype.acts.SetMaximum,cr.plugins_.sliderbar.prototype.exps.Value,cr.plugins_.sliderbar.prototype.cnds.CompareValue,cr.plugins_.sliderbar.prototype.exps.Maximum,cr.system_object.prototype.acts.GoToLayoutByName,cr.plugins_.Audio.prototype.cnds.OnEnded,cr.system_object.prototype.cnds.IsMobile,cr.plugins_.Touch.prototype.exps.X,cr.plugins_.Touch.prototype.exps.Y,cr.plugins_.TiledBg.prototype.acts.SetHeight,cr.plugins_.TiledBg.prototype.exps.Height,cr.plugins_.TiledBg.prototype.acts.SetY,
cr.plugins_.Spritefont2.prototype.acts.SetBoolInstanceVar,cr.plugins_.Spritefont2.prototype.cnds.IsBoolInstanceVarSet,cr.plugins_.Spritefont2.prototype.acts.SetY,cr.plugins_.Spritefont2.prototype.exps.Y,cr.plugins_.Touch.prototype.cnds.OnTouchStart,cr.plugins_.Touch.prototype.cnds.IsInTouch,cr.system_object.prototype.exps.scrollx,cr.system_object.prototype.exps.scrolly,cr.system_object.prototype.exps.layerscale,cr.plugins_.Mouse.prototype.cnds.OnWheel,cr.plugins_.Mouse.prototype.cnds.OnClick,cr.plugins_.Keyboard.prototype.cnds.OnKey,
cr.system_object.prototype.acts.ToggleBoolVar,cr.plugins_.Mouse.prototype.acts.SetCursorSprite,cr.system_object.prototype.acts.SetMinimumFramerate,cr.plugins_.Mouse.prototype.cnds.IsOverObject,cr.plugins_.Mouse.prototype.cnds.IsButtonDown,cr.plugins_.TiledBg.prototype.acts.SetSize,cr.system_object.prototype.acts.SetLayerBackground,cr.system_object.prototype.exps.rgbex,cr.plugins_.Browser.prototype.acts.GoToURLWindow,cr.plugins_.Browser.prototype.acts.RequestFullScreen,cr.plugins_.TiledBg.prototype.acts.SetPos,
cr.plugins_.Spritefont2.prototype.acts.SetVisible,cr.plugins_.Spritefont2.prototype.cnds.CompareInstanceVar,cr.plugins_.Spritefont2.prototype.cnds.CompareY,cr.plugins_.Keyboard.prototype.cnds.IsKeyDown,cr.behaviors.Platform.prototype.acts.SetVectorX,cr.system_object.prototype.exps.fps,cr.plugins_.Text.prototype.cnds.IsBoolInstanceVarSet,cr.plugins_.TiledBg.prototype.cnds.CompareWidth,cr.plugins_.Text.prototype.acts.SetFontFace,cr.plugins_.List.prototype.acts.SetCSSStyle,cr.system_object.prototype.exps.loadingprogress,
cr.system_object.prototype.cnds.OnLoadFinished,cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,cr.plugins_.Sprite.prototype.cnds.IsOnLayer,cr.plugins_.List.prototype.exps.SelectedText,cr.plugins_.Text.prototype.acts.SetPosToObject,cr.system_object.prototype.acts.SaveState,cr.plugins_.Sprite.prototype.exps.ImageWidth,cr.plugins_.Sprite.prototype.exps.ImageHeight,cr.behaviors.DragnDrop.prototype.cnds.OnDrop,cr.plugins_.List.prototype.cnds.OnSelectionChanged,cr.plugins_.TiledBg.prototype.cnds.OnCreated,
cr.plugins_.List.prototype.cnds.CompareSelectedText,cr.system_object.prototype.cnds.IsPreview,cr.plugins_.progressbar.prototype.acts.SetVisible,cr.behaviors.Timer.prototype.acts.StartTimer,cr.behaviors.Fade.prototype.cnds.OnFadeInEnd,cr.behaviors.DragnDrop.prototype.cnds.IsDragging,cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject]};
self.C3_JsPropNameTable=[{Big_Brother_Bird_Dots:0},{Blue_Bird_Dots:0},{Green_Bird_Dots:0},{Orange_Bird_Dots:0},{Yellow_Bird_Dots:0},{Bomb_Bird_Dots:0},{Red_Bird_Dots:0},{Black_Feather1:0},{Blue_Feather1:0},{Green_Feather1:0},{Red_Feather1:0},{Yellow_Feather1:0},{Pink_Feather1:0},{White_Feather1:0},{Black_Feather2:0},{Black_Feather3:0},{Blue_Feather2:0},{Blue_Feather3:0},{Green_Feather2:0},{Green_Feather3:0},{Orange_Feather1:0},{Orange_Feather2:0},{Orange_Feather3:0},{Pink_Feather2:0},{Pink_Feather3:0},
{Purple_Feather1:0},{Purple_Feather2:0},{Purple_Feather3:0},{Red_Feather1_2:0},{Red_Feather2:0},{Red_Feather2_2:0},{Red_Feather3:0},{Red_Feather3_2:0},{White_Feather2:0},{White_Feather3:0},{Yellow_Feather2:0},{Yellow_Feather3:0},{Bird_Launch_Trail:0},{Physics:0},{Egg_Bomb:0},{BirdScore:0},{BirdDestroyer:0},{BirdPowerCloud:0},{LiteTween:0},{BirdTarget:0},{Bullet:0},{ArcherBird_Arrow:0},{DestroyOutsideLayout:0},{TweetyBirdProjectile:0},{ArcherBird_Arrow_Hit:0},{Pin:0},{Alex_Bird_HookEnd:0},{Alex_Bird_Hook1:0},
{Fade:0},{GreyBird_QuakeZone:0},{Homing_Bird_Hat:0},{Homing_Bird_Radar:0},{Rotate:0},{Homing_Bird_Radar_Finder:0},{Stella_Bubbles:0},{Stella_Bubbles_Objects:0},{Big_Brother_Bird:0},{Blue_Bird:0},{Blue_Terence:0},{BlueClone1:0},{BlueClone2:0},{Bomb_Bird:0},{Red_Bird:0},{Yellow_Bird:0},{Orange_Bird:0},{Pink_Bird:0},{Boomerang_Bird:0},{White_Bird:0},{Mighty_Eagle:0},{Silver:0},{Dahlia:0},{Luca:0},{Poppy:0},{Willow:0},{Alex_Bird:0},{Archer_Bird:0},{Brooklyn:0},{Chirpy_Bird:0},{Grey_Bird:0},{Magnet_Bird:0},
{McDuck:0},{Swallow_Bird:0},{PiggyMcool:0},{Ostrich:0},{Sarge:0},{Schloob:0},{Tiiffany:0},{Sine2:0},{Sine3:0},{Song_Bird:0},{Woodzie:0},{Toucan:0},{Bounci:0},{Halo_Bird:0},{Lachie_Bird:0},{Magic_Bird:0},{Frenchie:0},{CannonDuck_Purple:0},{CuteBird_Blue:0},{CuteBird_BlueClone1:0},{CuteBird_BlueClone2:0},{CuteBird_Green:0},{CuteBird_Yellow:0},{CuteBird_Black:0},{DragDrop:0},{BirdPos:0},{BirdSlingshotPos:0},{Platform:0},{Caged_Hatchlings:0},{Caged_UnlockableBird:0},{LiteTween2:0},{LiteTween3:0},{Caged_UnlockableBird_PopUp:0},
{Debug_Bird:0},{Oil_Droplet1:0},{Oil_Droplet2:0},{Oil_Ground:0},{Red_Bird_Attack:0},{Red_Bird_Feather_Rotator:0},{Red_Bird_Yell_Left:0},{Red_Bird_Yell_Right:0},{Hoz_Sine:0},{Vert_Sine:0},{Red_Mighty_Feather:0},{Sardine:0},{Schloob_Box:0},{Schloob_Glove:0},{Schloob_Spring:0},{Sprite:0},{Sprite2:0},{TiffanyBrush:0},{White_Bird_Dots:0},{HatchlingScore:0},{Lachie_Headphones:0},{SlingScope_Handle:0},{SlingScope_Telescope:0},{Slingshot_Direction:0},{Slingshot_Direction2:0},{Slingshot_Limit:0},{Slingshot:0},
{Slingshot_Holder:0},{Slingshot_RubberBand1:0},{Slingshot_RubberBand2:0},{SlingshotOverlay:0},{Dahlia_Poer:0},{Alex_Hat:0},{Alakabam_Box:0},{Boomerang_Bird_Rot:0},{Boomerang_Bird_Rot2:0},{Boomerang_Bird_Rot3:0},{CannonDuck_Yellow:0},{chomp:0},{Collsion_Puff:0},{Grey_Bird_Dots:0},{Lachie_Rot:0},{Magnet_Bird_Field:0},{Mighty_Eagle2:0},{Pink_Bird_Dots:0},{Poppy_StompDots:0},{Poppy_StompDots2:0},{Purple1_Bird_Dots:0},{Purple2_Bird_Dots:0},{Purple3_Bird_Dots:0},{Purple4_Bird_Dots:0},{Red_Hats:0},{Slingshot_Position_Editor:0},
{Sprite3:0},{Sprite4:0},{Sprite5:0},{Swallow_Range:0},{Toucan_Tornado:0},{ZappedRange:0},{BirdPower_Icon:0},{BirdStrength_Icon:0},{Wood_Box:0},{Wood_Box_BP1:0},{Wood_Plank:0},{Wood_Plank_Thick:0},{Wood_Small_Cube:0},{Wood_Triangle1:0},{Wood_Triangle2:0},{Wood_Wheel_BP1:0},{Wood_Wheel_BP2:0},{Wheel_Holder_Wood_Back_BP:0},{Wheel_Holder_Wood_Front_BP:0},{Wood_Plank2:0},{Wood_Plank_Thick2:0},{Wood_Plank3:0},{Wood_Triangle2_Editor:0},{Wood_Small_Cube2:0},{Wood_Plank4:0},{WoodParticle1:0},{WoodParticle2:0},
{WoodParticle3:0},{Stone:0},{Stone_Small_Cube:0},{Stone_Triangle:0},{Stone2:0},{Stone_Small_Cube2:0},{Stone_Small_Cube3:0},{Stone_Small_Cube4:0},{Stone_Triangle2:0},{Stone3:0},{Stone_Small_Cube5:0},{Stone_Triangle3:0},{Stone4:0},{StoneParticle1:0},{StoneParticle2:0},{StoneParticle3:0},{Glass:0},{Glass2:0},{Glass3:0},{Glass4:0},{Glass5:0},{Glass6:0},{Glass7:0},{Glass8:0},{Glass10:0},{Glass9:0},{GlassParticle1:0},{GlassParticle2:0},{GlassParticle3:0},{GlassParticle4:0},{GlassParticle5:0},{Metal_Box_BP:0},
{Bench:0},{Ground_PoachedEggs:0},{Ground_PoachedEggsRevamp:0},{Ground_SeingRed:0},{Ground_Telepizza:0},{Ground_Volcano:0},{Test_Ground:0},{Test_Ground_Space:0},{Ground_Siege:0},{Ground_Warehouse:0},{Basic_Planet:0},{Aboveground_Mask:0},{Aboveground_CannonDuck:0},{Aboveground_Networks:0},{Aboveground_SeingRed:0},{Aboveground_Siege:0},{Aboveground_Telepizza:0},{Ground_CannonDuck:0},{Ground_City:0},{Ground_Editor:0},{Ground_Networks:0},{Aboveground_Warehouse:0},{Aboveground_City:0},{Aboveground_Networks2:0},
{Ground_Beach:0},{Solid:0},{Ground_Interactable:0},{Ground_HammingAround:0},{Ground_Volcano2:0},{Aboveground_War:0},{Ground_War:0},{Dynamite_Stick:0},{TNT_Block:0},{TNT_Block2:0},{TNT_Block3:0},{TNTBig_Block:0},{TNTBig_Block2:0},{TNTBig_Block3:0},{Telepizza_BG:0},{Telepizza_FG:0},{Telepizza_PBG:0},{Test_Background:0},{TiledBackground:0},{TiledBackground4:0},{Hill:0},{Grass:0},{Grass_Poached_Eggs_Overlay:0},{Grass_SeingRed:0},{GrassTall_PoachedEggs:0},{CannonDuck_Mountains:0},{CannonDuck_Mountains2:0},
{Giant_Bush:0},{Giant_Bush2:0},{Poached_Egg_Trees:0},{Siege_Foreground:0},{Poached_Egg_Trees3:0},{Poached_Eggs_Foreground_Tree:0},{SeingRed_Hills:0},{SeingRed_Hills2:0},{TiledBackground3:0},{TiledBackground5:0},{TiledBackground6:0},{TiledBackground7:0},{TiledBackground8:0},{TiledBackground9:0},{Volcano_BG:0},{Volcano_BG2:0},{Volcano_FG:0},{HammingAround_FG2:0},{Volcano_PBG:0},{HammingAround_BG2:0},{Obstacle:0},{Propeller:0},{Engine:0},{Cages:0},{Cannon_Holder:0},{LargeLardBomb:0},{Crate:0},{Grey_Blocks:0},
{McFood:0},{MetalCrate:0},{Golden_Egg:0},{Golden_Egg_PopUp:0},{goldenegg_swirl:0},{Turret:0},{Apple_Cannon:0},{Apple_Yellow:0},{Blasters:0},{Blasters_Project:0},{TrafficCone:0},{Wheel:0},{Wheel2:0},{Wheel3:0},{EggParticle1:0},{EggParticle2:0},{EggParticle3:0},{Trophy:0},{Propeller_Small:0},{Door:0},{DoorHinge:0},{Editor_BG:0},{Giant_Bush3:0},{Gravity_Field:0},{GravityPlug:0},{HardHat:0},{Iron_Box:0},{Lava_Destroy_Plane:0},{Lava_Tiled:0},{Metal_Box:0},{Metal_Rect:0},{Metal_Triangle:0},{Misc_Objects:0},
{particle_fan:0},{Popcorn:0},{Potion:0},{Roadblock:0},{Sand1:0},{Space_Bubble:0},{Sprite6:0},{Sprite8:0},{Stair:0},{Stone_Small_Cube6:0},{TiledBackground10:0},{TiledBackground11:0},{TiledBackground12:0},{TiledBackground13:0},{TiledBackground14:0},{TiledBackground15:0},{TiledBackground16:0},{TiledBackground17:0},{TiledBackground18:0},{UpdraftPlaceholder:0},{Volcano_BG3:0},{Volcano_FG3:0},{Volcano_PBG3:0},{Sine:0},{Water:0},{Wheel4:0},{Wood_Plank_Thick3:0},{Wood_Plank_Thick4:0},{Wheel5:0},{Volcano_BG4:0},
{Volcano_FG2:0},{Volcano_PBG2:0},{Audio:0},{Function:0},{Keyboard:0},{Mouse:0},{Touch:0},{NWjs:0},{Browser:0},{Audio_Button:0},{Back_Button:0},{Cutscene_Check_Button:0},{Episode_Button_Left:0},{Episode_Button:0},{Episode_Button_Right:0},{LevelClearFail_Level_Selection_Button:0},{LevelClearFail_NextLevel_Button:0},{LevelClearFail_Restart_Button:0},{Misc_Button:0},{Pause_Button:0},{Pause_Level_Selection_Button:0},{Pause_Menu_Back_Button:0},{Pause_Restart_Button:0},{Play_Button:0},{Restart_Button:0},
{Settings_Button:0},{Tutorial_Next_Button:0},{Tutorials_Button:0},{Pause_Shop_Button:0},{Pop_Up_Close_Button_Check:0},{Pop_Up_Close_Button_X:0},{Powerup_Bird:0},{Powerup_Homing_Bird:0},{Powerup_Intro:0},{Powerup_Slingscope:0},{Powerup_Slot:0},{Powerup_SuperSeeds:0},{Powerups_Bolt:0},{Powerups_Button:0},{ZoomIn_Button:0},{ZoomOut_Button:0},{Bug_Report_Button:0},{LevelIcon_BustlingCity:0},{LevelIcon_FamiliarTerritory:0},{LevelIcon_McDuck:0},{LevelIcon_NotRio:0},{LevelIcon_Testing:0},{Level_Selection_Objects:0},
{AB_Breakfast_Magnifying_Glass:0},{Level_ClearandFail_Screen:0},{GameMouse:0},{Pause_Menu:0},{LoadingBar:0},{LoadingBarBase:0},{LoadingBarHighlight:0},{LoadingBarOverlay:0},{HUD_Text:0},{Level_Failed_Pig:0},{Tutorial_OLD:0},{Episode_Drag1:0},{UI_Text_44:0},{UI_Text_53:0},{UI_Text_35:0},{UI_Text_Lvl:0},{Star_1:0},{Star_2:0},{Star_3:0},{Bird_Wear:0},{BirdWear_BG:0},{BirdWear_Bird:0},{BirdWear_BirdBG:0},{BirdWear_Scroller:0},{BirdWear_Scrolling:0},{BirdWear_Selection:0},{ScrollTo:0},{"8Direction":0},
{Camera:0},{DarkenScreenFade:0},{Pop_Up:0},{TiledBackground2:0},{Cinematic_CAM:0},{BigExplosionPuff:0},{BigExplosionPuff_Space:0},{BigExplosionPuff_Space_Shock:0},{McFoodScore:0},{ObjectScore_Classic:0},{ObjectScore_Current:0},{"1_References":0},{Button:0},{CreditsMinigame_Spawner:0},{Cutscene_TestingGrounds:0},{Cutscene_To_Level:0},{ElPorkador_Fan:0},{ExplosionEffect:0},{Gear:0},{Position:0},{Size:0},{Highscore_Bird:0},{Input_Object:0},{Level_Drag:0},{Level_Properties:0},{LevelClear_Score_Text:0},
{LevelIcon_TreeHoggers:0},{Loading_Mask_Seasons:0},{Loading_Rotator:0},{mask:0},{minigame_lock:0},{minigame_pig:0},{minigame_pig2:0},{minigame_sheet:0},{minigame_sheet2:0},{minigame_sheet3:0},{MinigamePig1:0},{PigCamera_Pos:0},{Pop_Up_Close_Button_Check2:0},{Pop_Up_Close_Button_Check3:0},{Portal_Cinematic:0},{PosterObject:0},{ray:0},{Rovio_Screen:0},{Rovio_Thanks:0},{ScoreInput:0},{ScoreSlider:0},{Settings_Button2:0},{Settings_Button3:0},{Settings_Button4:0},{Settings_Button5:0},{SettingsBox:0},{Splash_Screen:0},
{stargauge_overlay:0},{Test_Cutscene:0},{theme_dropdown:0},{Title_Screen_Logo:0},{UI_Text_BirdwearBio:0},{UI_Text_BirdwearName:0},{LevelIcon_BookfulNetworks:0},{Editor_Bird_Button:0},{Editor_Blocks_Button:0},{Editor_Decrease_Order:0},{Editor_Exit_Button:0},{Editor_Increase_Order:0},{Editor_Mode_Button:0},{Editor_Objects_Button:0},{Editor_Pig_Button:0},{Play_Button_Editor:0},{Blue_Bird_Editor:0},{Bomb_Bird_Editor:0},{Red_Bird_Editor:0},{White_Bird_Editor:0},{Yellow_Bird_Editor:0},{Big_Brother_Bird_Editor:0},
{Boomerang_Bird_Editor:0},{King_Pig_Editor:0},{Medium_Pig_Editor:0},{Small_Pig_Editor:0},{Bird_Order_Editor:0},{Editor_Bar:0},{Editor_Bar_Birds:0},{ambient_dropdown:0},{Wood_Plank_Editor:0},{Wood_Plank_Thick_Editor:0},{Wood_Triangle_Editor:0},{Editor_Delete_Button:0},{Editor_Duplicate_Button:0},{Editor_Rotate_Button:0},{Small_Pig:0},{PigPuff:0},{PigScore:0},{ExplosionPuff:0},{Medium_Pig:0},{King_Pig:0},{Pig_Debug_Healthbar:0},{Magnet_Pig:0},{Magnet_Pig_Field:0},{Big_Pig:0},{Corporal_Pig:0},{Heli_Pig:0},
{Heli_Pig_Propeller:0},{Helmet_Pig:0},{Large_Lard:0},{Brute_Warthog:0},{Medium_Warthog:0},{Small_Warthog:0},{Pig_Boss_Eye1_CannonDuck:0},{Pig_Boss_Eye1_Overlay_CannonDuck:0},{Pig_Boss_Eye2_CannonDuck2:0},{Pig_Boss_Eye2_Overlay_CannonDuck:0},{Pig_Boss_SnoutOverlay:0},{Pig_Boss_SnoutOverlay2:0},{Foreman_Pig:0},{Moustache_Pig:0},{Boss_Pig_Health:0},{Boss_Pig_Health_HUD:0},{Boss_Pig_HUD:0},{Boss_Pig_Text_IMG:0},{Large_Pig:0},{CatAlien:0},{CatAlien_Eye1:0},{CatAlien_Eye2:0},{CatAlien_Mouth:0},{ElPorkador:0},
{ElPorkador_FoodEath:0},{ElPorkador_FoodEath2:0},{Marmoset:0},{Medium_PigZombie:0},{Pig_Knockout:0},{Pig_Scare_Emotion_Range:0},{Small_PigZombie:0},{ZombiePigSpawner:0},{Large_PigZombie:0},{UI_Text_BirdDays:0},{BluePortal1:0},{OrangePortal1:0},{BluePortal2:0},{OrangePortal2:0},{Hat:0},{goldenegg_swirl2:0},{LevelIcon_AllHamsOnDeck:0},{SeingRed_Hills3:0},{SeingRed_Hills4:0},{CannonDuck_Big:0},{CannonDuck_Bomb:0},{Sprite7:0},{LevelIcon_NonCannonDucks:0},{BP_Effects:0},{LevelIcon_HammingAround:0},{cannon_wheel:0},
{cannon:0},{Tutorials:0},{ExplosionEffect_CannonDuck:0},{LevelIcon_RacingAvians:0},{Jumpthru:0},{SpriteObjects:0},{SlingshotTween:0},{Timer:0},{Birds:0},{LineOfSight:0},{Pigs:0},{Buttons_Size_Control:0},{Buttons:0},{Tiled_Ground:0},{BreakableObjects:0},{Puffs:0},{BirdDots:0},{Marmosets:0},{WoodObjects:0},{GlassObjects:0},{StoneObjects:0},{Editor_Objects:0},{Editor_Pigs:0},{Editor_Birds:0},{Object_Score:0},{Editor_Wood:0},{Slingshot_Pins:0},{Feathers:0},{Title_Parallax_1:0},{Title_Parallax_2:0},{"1_Size_Tween":0},
{"2_Pos_Tween":0},{ScoreAnimated:0},{PartsThatEngine:0},{Propellers:0},{Pin2:0},{UI_Text:0},{LevelButtons:0},{Bird_Hats:0},{MinigamePigs:0},{BlockParticles:0},{CamToFollow:0},{MetalObjects:0},{BirdIcons:0},{Portals:0},{SpecialCostumeObjects:0},{BirdNum:0},{Boomerang_Force:0},{Boomerang_Impulse:0},{Boomerang_Values:0},{Boomerang_Rot:0},{Oil_LaunchAway:0},{Oil_LaunchUp:0},{QuakeImpulse:0},{Attract_Power:0},{Repel_Power:0},{Caged_Resize:0},{direction:0},{ScrollSpeed:0},{MAX_SCALE:0},{MARGIN:0},{prevX:0},
{prevY:0},{TitleScreen_Ground_XCoord:0},{TitleScreen_Ground_YCoord:0},{TitleScreen_Ground_Width:0},{TitleScreen_Ground_Height:0},{TitleScreen_FG_XCoord:0},{TitleScreen_FG_YCoord:0},{TitleScreen_FG_Width:0},{TitleScreen_FG_Height:0},{TitleScreen_PBG_XCoord:0},{TitleScreen_PBG_YCoord:0},{TitleScreen_PBG_Width:0},{TitleScreen_PBG_Height:0},{TitleScreen_EpisodeSelected:0},{direction2:0},{ScrollSpeed2:0},{TitleScreen_CreditsSpeed:0},{MousePosX:0},{MousePosY:0},{IsPulling:0},{BirdArtStyle:0},{PigArtStyle:0},
{FontStyle:0},{AnimatedTutorials:0},{TutorialInUse:0},{Red_Costume:0},{RedUpgrade:0},{Unlocked_Red:0},{TheBlues_Costume:0},{TheBluesUpgrade:0},{Unlocked_TheBlues:0},{Chuck_Costume:0},{ChuckUpgrade:0},{Unlocked_Chuck:0},{Bomb_Costume:0},{BombUpgrade:0},{Unlocked_Bomb:0},{Matilda_Costume:0},{MatildaUpgrade:0},{Hal_Costume:0},{HalUpgrade:0},{Unlocked_Hal:0},{Terence_Costume:0},{TerenceUpgrade:0},{Unlocked_Terence:0},{Bubbles_Costume:0},{BubbleUpgrade:0},{Stella_Costume:0},{StellaUpgrade:0},{Alex_Costume:0},
{Unlocked_ArcherBird:0},{Lachie_Angle:0},{AlexUpgrade:0},{Unlocked_AlexBird:0},{Earl_Costume:0},{Paused:0},{BirdCount:0},{BirdNumber:0},{BirdRotationIsEnabled:0},{BirdAfterImageIsEnabled:0},{EagleSpawned:0},{EagleBounced:0},{EaglePigDestroyerEnabled:0},{AmountOfSuperSeeds:0},{AmountOfSlingScope:0},{AmountOfKingSling:0},{AmountOfBirdquake:0},{AmountOfHomingBird:0},{AmountOfHeikkiTerence:0},{AmountOfBlanks:0},{PowerUpIsEnabled:0},{IsSlingScopeActive:0},{IsKingSlingActive:0},{IsHeikkiUsed:0},{IsSilentAudio:0},
{Glass_Health:0},{Wood_Health:0},{Stone_Health:0},{Metal_Health:0},{LavaSpeed:0},{DotCount:0},{Velocity:0},{Initial_Velocity_X:0},{Initial_Velocity_Y:0},{Vertical_Displacement:0},{Gravity:0},{Ground:0},{Scale:0},{Targeting:0},{Counter:0},{CounterWidth:0},{Score:0},{High_Score:0},{Zoom:0},{ZoomValue:0},{CameraMovement:0},{CameraStartMoving:0},{Screen_Number:0},{Screen_Number_Limit:0},{Enable_End_Level:0},{HasCompletedEpisode1Level1:0},{LevelHighscore1:0},{HasCompletedEpisode1Level2:0},{LevelHighscore2:0},
{HasCompletedEpisode1Level3:0},{LevelHighscore3:0},{HasCompletedEpisode1Level4:0},{LevelHighscore4:0},{HasCompletedEpisode1Level5:0},{LevelHighscore5:0},{HasCompletedEpisode1Level6:0},{LevelHighscore6:0},{HasCompletedEpisode1Level7:0},{LevelHighscore7:0},{HasCompletedEpisode1Level8:0},{LevelHighscore8:0},{IsInEditor:0},{StepIncrement:0},{ScoreCount:0},{ZombiePigPop_Count:0},{IsInC3Runtime:0},{GroundX:0},{GroundY:0},{GroundWidth:0},{GroundHeight:0},{Allow_New_Ground:0},{ScrollBook:0},{CostumeSwapDelay:0}];
